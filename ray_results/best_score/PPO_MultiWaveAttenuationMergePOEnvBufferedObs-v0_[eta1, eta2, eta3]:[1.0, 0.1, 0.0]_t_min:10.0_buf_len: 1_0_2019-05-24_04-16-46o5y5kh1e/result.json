{"timesteps_this_iter": 41478, "episodes_total": 41, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 41478, "training_iteration": 1, "episode_reward_max": -32.14996850300711, "pid": 334, "time_this_iter_s": 57.530648946762085, "time_total_s": 57.530648946762085, "episodes_this_iter": 41, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 1, "episode_len_mean": 317.9268292682927, "info": {"grad_time_ms": 11424.618, "update_time_ms": 1181.623, "sample_time_ms": 44714.635, "num_steps_trained": 41478, "load_time_ms": 59.34, "default": {"vf_loss": 36.963375091552734, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0003446592600084841, "total_loss": 36.96328353881836, "cur_lr": 0.0005000000237487257, "kl": 0.001247435575351119, "entropy": 1.4197072982788086, "vf_explained_var": -4.363464540801942e-06}, "num_steps_sampled": 41478}, "hostname": "flow-main", "date": "2019-05-24_04-18-23", "episode_reward_mean": -695.9218141086349, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ace10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acdd8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acda0>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 57.530648946762085, "timestamp": 1558671503, "custom_metrics": {"system_level_velocity_max": 18.366994037316942, "cost1_mean": 119.52446133403117, "cost2_max": -21.29422594045756, "cost1_max": 144.91166635363737, "cost2_mean": -46.71381366911444, "outflow_rate_min": 377.6422119815668, "system_level_velocity_min": 8.430004395152089, "cost2_min": -78.41231625996315, "outflow_rate_mean": 740.8675495756057, "cost1_min": 22.885914091725237, "system_level_velocity_mean": 10.367834738061076, "outflow_rate_max": 941.5132660781841}, "timesteps_since_restore": 41478, "episode_reward_min": -1052.3621603425522}
{"timesteps_this_iter": 43894, "episodes_total": 81, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 85372, "training_iteration": 2, "episode_reward_max": -32.14996850300711, "pid": 334, "time_this_iter_s": 31.452167510986328, "time_total_s": 88.98281645774841, "episodes_this_iter": 40, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 2, "episode_len_mean": 321.41975308641975, "info": {"grad_time_ms": 10866.322, "update_time_ms": 594.609, "sample_time_ms": 32876.169, "num_steps_trained": 85372, "load_time_ms": 31.601, "default": {"vf_loss": 37.014225006103516, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.001343002077192068, "total_loss": 37.01323318481445, "cur_lr": 0.0005000000237487257, "kl": 0.003466980764642358, "entropy": 1.4124130010604858, "vf_explained_var": 0.36546003818511963}, "num_steps_sampled": 85372}, "hostname": "flow-main", "date": "2019-05-24_04-18-55", "episode_reward_mean": -712.2447928285444, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb080>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb048>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 88.98281645774841, "timestamp": 1558671535, "custom_metrics": {"system_level_velocity_max": 18.366994037316942, "cost1_mean": 121.68220553474973, "cost2_max": -21.29422594045756, "cost1_max": 150.90827406425524, "cost2_mean": -49.03543058468065, "outflow_rate_min": 377.6422119815668, "system_level_velocity_min": 8.430004395152089, "cost2_min": -88.34092751511483, "outflow_rate_mean": 745.0819026485964, "cost1_min": 22.885914091725237, "system_level_velocity_mean": 10.319163733133372, "outflow_rate_max": 978.7765607826706}, "timesteps_since_restore": 85372, "episode_reward_min": -1052.3621603425522}
{"timesteps_this_iter": 42350, "episodes_total": 121, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 127722, "training_iteration": 3, "episode_reward_max": -32.14996850300711, "pid": 334, "time_this_iter_s": 28.814294576644897, "time_total_s": 117.79711103439331, "episodes_this_iter": 40, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 3, "episode_len_mean": 322.1, "info": {"grad_time_ms": 10456.986, "update_time_ms": 399.538, "sample_time_ms": 28274.525, "num_steps_trained": 127722, "load_time_ms": 22.293, "default": {"vf_loss": 46.01689910888672, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.002566444920375943, "total_loss": 46.01479721069336, "cur_lr": 0.0005000000237487257, "kl": 0.00930485688149929, "entropy": 1.4058599472045898, "vf_explained_var": 0.6210852265357971}, "num_steps_sampled": 127722}, "hostname": "flow-main", "date": "2019-05-24_04-19-24", "episode_reward_mean": -700.4763437639848, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e15c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1b00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e17f0>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 117.79711103439331, "timestamp": 1558671564, "custom_metrics": {"system_level_velocity_max": 18.366994037316942, "cost1_mean": 123.15833345617907, "cost2_max": -21.29422594045756, "cost1_max": 150.90827406425524, "cost2_mean": -48.606975449451674, "outflow_rate_min": 380.8258512396696, "system_level_velocity_min": 8.127665937427572, "cost2_min": -88.34092751511483, "outflow_rate_mean": 747.4283470712519, "cost1_min": 22.885914091725237, "system_level_velocity_mean": 10.395529579473745, "outflow_rate_max": 978.7765607826706}, "timesteps_since_restore": 127722, "episode_reward_min": -1004.5950105003561}
{"timesteps_this_iter": 36988, "episodes_total": 181, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 164710, "training_iteration": 4, "episode_reward_max": -401.9025647171006, "pid": 334, "time_this_iter_s": 30.097099781036377, "time_total_s": 147.8942108154297, "episodes_this_iter": 60, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 4, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10047.68, "update_time_ms": 302.037, "sample_time_ms": 26503.712, "num_steps_trained": 164710, "load_time_ms": 17.852, "default": {"vf_loss": 75.65103912353516, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002270854078233242, "total_loss": 75.64922332763672, "cur_lr": 0.0005000000237487257, "kl": 0.009131621569395065, "entropy": 1.3991868495941162, "vf_explained_var": 0.6723003387451172}, "num_steps_sampled": 164710}, "hostname": "flow-main", "date": "2019-05-24_04-19-54", "episode_reward_mean": -649.1794339942658, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebcc0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb470>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 147.8942108154297, "timestamp": 1558671594, "custom_metrics": {"system_level_velocity_max": 13.622767490554205, "cost1_mean": 130.2813297582242, "cost2_max": -25.812415299749826, "cost1_max": 167.1097693432149, "cost2_mean": -48.3272822822613, "outflow_rate_min": 393.57, "system_level_velocity_min": 8.127665937427572, "cost2_min": -76.90750737024915, "outflow_rate_mean": 800.6606295303169, "cost1_min": 99.53465371303491, "system_level_velocity_mean": 10.904628922548898, "outflow_rate_max": 1091.2262689470983}, "timesteps_since_restore": 164710, "episode_reward_min": -995.2066689167774}
{"timesteps_this_iter": 36027, "episodes_total": 221, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 200737, "training_iteration": 5, "episode_reward_max": -377.8875778294027, "pid": 334, "time_this_iter_s": 26.048917293548584, "time_total_s": 173.94312810897827, "episodes_this_iter": 40, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 5, "episode_len_mean": 325.0, "info": {"grad_time_ms": 9774.424, "update_time_ms": 243.36, "sample_time_ms": 24660.188, "num_steps_trained": 200737, "load_time_ms": 15.148, "default": {"vf_loss": 52.1413688659668, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.003916448447853327, "total_loss": 52.13798522949219, "cur_lr": 0.0005000000237487257, "kl": 0.01075994223356247, "entropy": 1.3767107725143433, "vf_explained_var": 0.8012781143188477}, "num_steps_sampled": 200737}, "hostname": "flow-main", "date": "2019-05-24_04-20-20", "episode_reward_mean": -572.0560974641195, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be37b9e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1f60>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 173.94312810897827, "timestamp": 1558671620, "custom_metrics": {"system_level_velocity_max": 15.82273594087335, "cost1_mean": 141.49527124498383, "cost2_max": -24.86178708148506, "cost1_max": 189.43966789790022, "cost2_mean": -50.64160445130278, "outflow_rate_min": 682.7841322314048, "system_level_velocity_min": 9.115073648624133, "cost2_min": -95.67971637781494, "outflow_rate_mean": 890.237684553659, "cost1_min": 109.6454363329561, "system_level_velocity_mean": 11.915371904792824, "outflow_rate_max": 1231.2188675306159}, "timesteps_since_restore": 200737, "episode_reward_min": -865.1137949991203}
{"timesteps_this_iter": 39036, "episodes_total": 261, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 239773, "training_iteration": 6, "episode_reward_max": -367.978819501021, "pid": 334, "time_this_iter_s": 28.54556894302368, "time_total_s": 202.48869705200195, "episodes_this_iter": 40, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 6, "episode_len_mean": 325.0, "info": {"grad_time_ms": 9776.829, "update_time_ms": 204.152, "sample_time_ms": 23661.715, "num_steps_trained": 239773, "load_time_ms": 13.138, "default": {"vf_loss": 44.12214660644531, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.004354152362793684, "total_loss": 44.118412017822266, "cur_lr": 0.0005000000237487257, "kl": 0.012440272606909275, "entropy": 1.3512684106826782, "vf_explained_var": 0.8000490069389343}, "num_steps_sampled": 239773}, "hostname": "flow-main", "date": "2019-05-24_04-20-48", "episode_reward_mean": -517.9742830609298, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da2e8>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 202.48869705200195, "timestamp": 1558671648, "custom_metrics": {"system_level_velocity_max": 16.868016070443268, "cost1_mean": 157.58928302998777, "cost2_max": -24.86178708148506, "cost1_max": 203.5148128378342, "cost2_mean": -61.90144948176631, "outflow_rate_min": 710.7533359711947, "system_level_velocity_min": 10.058600796997279, "cost2_min": -120.89153013298423, "outflow_rate_mean": 1005.674762866562, "cost1_min": 118.70663968509108, "system_level_velocity_mean": 13.224210152197683, "outflow_rate_max": 1334.0659893246345}, "timesteps_since_restore": 239773, "episode_reward_min": -745.4577682653807}
{"timesteps_this_iter": 43025, "episodes_total": 322, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 282798, "training_iteration": 7, "episode_reward_max": -32.64084307849546, "pid": 334, "time_this_iter_s": 31.77373242378235, "time_total_s": 234.2624294757843, "episodes_this_iter": 61, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 7, "episode_len_mean": 322.1, "info": {"grad_time_ms": 9910.521, "update_time_ms": 176.515, "sample_time_ms": 23277.228, "num_steps_trained": 282798, "load_time_ms": 11.887, "default": {"vf_loss": 58.12296676635742, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0021912504453212023, "total_loss": 58.121116638183594, "cur_lr": 0.0005000000237487257, "kl": 0.006839115172624588, "entropy": 1.36630380153656, "vf_explained_var": 0.6904571056365967}, "num_steps_sampled": 282798}, "hostname": "flow-main", "date": "2019-05-24_04-21-20", "episode_reward_mean": -510.72586952451667, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1320>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1b70>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 234.2624294757843, "timestamp": 1558671680, "custom_metrics": {"system_level_velocity_max": 18.476284452821695, "cost1_mean": 176.25801997807844, "cost2_max": -23.885476007119713, "cost1_max": 215.62863498514787, "cost2_mean": -88.8659870955384, "outflow_rate_min": 471.8345490104016, "system_level_velocity_min": 10.498010242145051, "cost2_min": -125.4582689566191, "outflow_rate_mean": 1145.3238554453817, "cost1_min": 23.09077303518141, "system_level_velocity_mean": 14.834308642934504, "outflow_rate_max": 1375.0670500927652}, "timesteps_since_restore": 282798, "episode_reward_min": -902.3732088836186}
{"timesteps_this_iter": 43891, "episodes_total": 362, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 326689, "training_iteration": 8, "episode_reward_max": -32.64084307849546, "pid": 334, "time_this_iter_s": 31.005910634994507, "time_total_s": 265.2683401107788, "episodes_this_iter": 40, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 8, "episode_len_mean": 322.1, "info": {"grad_time_ms": 10017.205, "update_time_ms": 155.281, "sample_time_ms": 22886.336, "num_steps_trained": 326689, "load_time_ms": 10.985, "default": {"vf_loss": 39.639835357666016, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.001922301365993917, "total_loss": 39.63827896118164, "cur_lr": 0.0005000000237487257, "kl": 0.007320983335375786, "entropy": 1.3692737817764282, "vf_explained_var": 0.7748091816902161}, "num_steps_sampled": 326689}, "hostname": "flow-main", "date": "2019-05-24_04-21-51", "episode_reward_mean": -544.5892754338446, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebd68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebdd8>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 265.2683401107788, "timestamp": 1558671711, "custom_metrics": {"system_level_velocity_max": 18.476284452821695, "cost1_mean": 179.30242916450234, "cost2_max": -23.885476007119713, "cost1_max": 215.62863498514787, "cost2_mean": -100.98989177416757, "outflow_rate_min": 471.8345490104016, "system_level_velocity_min": 10.711374904184357, "cost2_min": -130.7921084083714, "outflow_rate_mean": 1166.630003006728, "cost1_min": 23.09077303518141, "system_level_velocity_mean": 15.05932262661603, "outflow_rate_max": 1386.2989291169597}, "timesteps_since_restore": 326689, "episode_reward_min": -928.5794617316602}
{"timesteps_this_iter": 42684, "episodes_total": 402, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 369373, "training_iteration": 9, "episode_reward_max": -318.4061008091967, "pid": 334, "time_this_iter_s": 30.790528059005737, "time_total_s": 296.05886816978455, "episodes_this_iter": 40, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 9, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10108.539, "update_time_ms": 139.002, "sample_time_ms": 22549.816, "num_steps_trained": 369373, "load_time_ms": 10.282, "default": {"vf_loss": 39.224159240722656, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0021226960234344006, "total_loss": 39.222354888916016, "cur_lr": 0.0005000000237487257, "kl": 0.006411111447960138, "entropy": 1.3674187660217285, "vf_explained_var": 0.7871313691139221}, "num_steps_sampled": 369373}, "hostname": "flow-main", "date": "2019-05-24_04-22-22", "episode_reward_mean": -541.8226392440012, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebe80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb0f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb320>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 296.05886816978455, "timestamp": 1558671742, "custom_metrics": {"system_level_velocity_max": 18.01466386720723, "cost1_mean": 181.2438853059338, "cost2_max": -53.090480338449055, "cost1_max": 215.62863498514787, "cost2_mean": -103.4599852122874, "outflow_rate_min": 883.8565961206067, "system_level_velocity_min": 11.19939594358035, "cost2_min": -130.7921084083714, "outflow_rate_mean": 1179.9974171491053, "cost1_min": 132.53267832401923, "system_level_velocity_mean": 15.031203549113066, "outflow_rate_max": 1389.4499775773584}, "timesteps_since_restore": 369373, "episode_reward_min": -928.5794617316602}
{"timesteps_this_iter": 37509, "episodes_total": 460, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 406882, "training_iteration": 10, "episode_reward_max": -308.9865329968265, "pid": 334, "time_this_iter_s": 29.370423793792725, "time_total_s": 325.42929196357727, "episodes_this_iter": 58, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 10, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10022.487, "update_time_ms": 125.89, "sample_time_ms": 22298.616, "num_steps_trained": 406882, "load_time_ms": 9.6, "default": {"vf_loss": 39.086997985839844, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0023225615732371807, "total_loss": 39.08503723144531, "cur_lr": 0.0005000000237487257, "kl": 0.007273105438798666, "entropy": 1.3576104640960693, "vf_explained_var": 0.759826123714447}, "num_steps_sampled": 406882}, "hostname": "flow-main", "date": "2019-05-24_04-22-51", "episode_reward_mean": -505.1200525801551, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daef0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da7b8>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 325.42929196357727, "timestamp": 1558671771, "custom_metrics": {"system_level_velocity_max": 17.63764585186276, "cost1_mean": 179.20472622965738, "cost2_max": -36.973091531115685, "cost1_max": 212.0885294596141, "cost2_mean": -95.27902461236796, "outflow_rate_min": 708.3704354261745, "system_level_velocity_min": 10.897141123474604, "cost2_min": -130.7921084083714, "outflow_rate_mean": 1160.0533924047365, "cost1_min": 124.7044635649375, "system_level_velocity_mean": 14.90055597074989, "outflow_rate_max": 1389.4499775773584}, "timesteps_since_restore": 406882, "episode_reward_min": -889.4780608547503}
{"timesteps_this_iter": 36998, "episodes_total": 502, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 443880, "training_iteration": 11, "episode_reward_max": -308.9865329968265, "pid": 334, "time_this_iter_s": 27.63556718826294, "time_total_s": 353.0648591518402, "episodes_this_iter": 42, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 11, "episode_len_mean": 325.0, "info": {"grad_time_ms": 9793.528, "update_time_ms": 8.548, "sample_time_ms": 19669.27, "num_steps_trained": 443880, "load_time_ms": 4.051, "default": {"vf_loss": 27.448043823242188, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0037839727010577917, "total_loss": 27.444700241088867, "cur_lr": 0.0005000000237487257, "kl": 0.008809057995676994, "entropy": 1.3552935123443604, "vf_explained_var": 0.8343313336372375}, "num_steps_sampled": 443880}, "hostname": "flow-main", "date": "2019-05-24_04-23-19", "episode_reward_mean": -473.93980311663904, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1a58>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1588>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 353.0648591518402, "timestamp": 1558671799, "custom_metrics": {"system_level_velocity_max": 17.63185450437481, "cost1_mean": 177.74660206976634, "cost2_max": -36.973091531115685, "cost1_max": 211.72881339978338, "cost2_mean": -86.14022221121353, "outflow_rate_min": 708.3704354261745, "system_level_velocity_min": 10.897141123474604, "cost2_min": -128.00413697854785, "outflow_rate_mean": 1144.305783370979, "cost1_min": 124.7044635649375, "system_level_velocity_mean": 14.843719445461293, "outflow_rate_max": 1375.5532249114092}, "timesteps_since_restore": 443880, "episode_reward_min": -889.4780608547503}
{"timesteps_this_iter": 38474, "episodes_total": 543, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 482354, "training_iteration": 12, "episode_reward_max": -33.408487541422396, "pid": 334, "time_this_iter_s": 27.698968172073364, "time_total_s": 380.7638273239136, "episodes_this_iter": 41, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 12, "episode_len_mean": 322.1, "info": {"grad_time_ms": 9693.025, "update_time_ms": 8.559, "sample_time_ms": 19393.9, "num_steps_trained": 482354, "load_time_ms": 4.047, "default": {"vf_loss": 28.575885772705078, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002747867489233613, "total_loss": 28.573514938354492, "cur_lr": 0.0005000000237487257, "kl": 0.007594570517539978, "entropy": 1.3294514417648315, "vf_explained_var": 0.8334036469459534}, "num_steps_sampled": 482354}, "hostname": "flow-main", "date": "2019-05-24_04-23-47", "episode_reward_mean": -465.05172711006264, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb470>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eba90>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 380.7638273239136, "timestamp": 1558671827, "custom_metrics": {"system_level_velocity_max": 18.417857902455502, "cost1_mean": 177.5131393724731, "cost2_max": -25.1401243753437, "cost1_max": 211.72881339978338, "cost2_mean": -85.0267150484049, "outflow_rate_min": 460.7989278777953, "system_level_velocity_min": 10.897141123474604, "cost2_min": -128.00413697854785, "outflow_rate_mean": 1144.4605869933503, "cost1_min": 23.07001021118273, "system_level_velocity_mean": 15.019691058590546, "outflow_rate_max": 1362.8594581647862}, "timesteps_since_restore": 482354, "episode_reward_min": -889.4780608547503}
{"timesteps_this_iter": 42073, "episodes_total": 600, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 524427, "training_iteration": 13, "episode_reward_max": -33.408487541422396, "pid": 334, "time_this_iter_s": 31.094407558441162, "time_total_s": 411.85823488235474, "episodes_this_iter": 57, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 13, "episode_len_mean": 321.82, "info": {"grad_time_ms": 9744.057, "update_time_ms": 8.453, "sample_time_ms": 19572.173, "num_steps_trained": 524427, "load_time_ms": 4.026, "default": {"vf_loss": 37.86777114868164, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.001545107807032764, "total_loss": 37.86648941040039, "cur_lr": 0.0005000000237487257, "kl": 0.005261720158159733, "entropy": 1.313707947731018, "vf_explained_var": 0.7853220701217651}, "num_steps_sampled": 524427}, "hostname": "flow-main", "date": "2019-05-24_04-24-18", "episode_reward_mean": -485.8157249408485, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee8d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeb38>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 411.85823488235474, "timestamp": 1558671858, "custom_metrics": {"system_level_velocity_max": 18.417857902455502, "cost1_mean": 180.63266274737015, "cost2_max": -25.1401243753437, "cost1_max": 213.11405116326307, "cost2_mean": -94.62625589438359, "outflow_rate_min": 460.7989278777953, "system_level_velocity_min": 11.029111981124949, "cost2_min": -123.84795233847619, "outflow_rate_mean": 1170.8471298731015, "cost1_min": 23.07001021118273, "system_level_velocity_mean": 15.273076554401964, "outflow_rate_max": 1381.0364259891946}, "timesteps_since_restore": 524427, "episode_reward_min": -841.8895280567374}
{"timesteps_this_iter": 38621, "episodes_total": 643, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 563048, "training_iteration": 14, "episode_reward_max": -292.16383641041057, "pid": 334, "time_this_iter_s": 28.191030502319336, "time_total_s": 440.0492653846741, "episodes_this_iter": 43, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 14, "episode_len_mean": 324.72, "info": {"grad_time_ms": 9766.209, "update_time_ms": 8.286, "sample_time_ms": 19359.754, "num_steps_trained": 563048, "load_time_ms": 3.928, "default": {"vf_loss": 23.509084701538086, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.003157917410135269, "total_loss": 23.506349563598633, "cur_lr": 0.0005000000237487257, "kl": 0.008497778326272964, "entropy": 1.3107329607009888, "vf_explained_var": 0.8538063764572144}, "num_steps_sampled": 563048}, "hostname": "flow-main", "date": "2019-05-24_04-24-46", "episode_reward_mean": -482.03905722077195, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebef0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebf28>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 440.0492653846741, "timestamp": 1558671886, "custom_metrics": {"system_level_velocity_max": 18.365491797044502, "cost1_mean": 186.1529454481302, "cost2_max": -47.22330544548811, "cost1_max": 217.73651960804267, "cost2_mean": -99.58189289106416, "outflow_rate_min": 961.1071990924561, "system_level_velocity_min": 11.956331970711489, "cost2_min": -123.84795233847619, "outflow_rate_mean": 1206.4787589184334, "cost1_min": 142.60374187113013, "system_level_velocity_mean": 15.560134157936034, "outflow_rate_max": 1381.0364259891946}, "timesteps_since_restore": 563048, "episode_reward_min": -841.8895280567374}
{"timesteps_this_iter": 40570, "episodes_total": 686, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 603618, "training_iteration": 15, "episode_reward_max": -32.81946810194321, "pid": 334, "time_this_iter_s": 29.53488039970398, "time_total_s": 469.58414578437805, "episodes_this_iter": 43, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 15, "episode_len_mean": 317.74, "info": {"grad_time_ms": 9792.678, "update_time_ms": 8.165, "sample_time_ms": 19682.024, "num_steps_trained": 603618, "load_time_ms": 3.905, "default": {"vf_loss": 32.454864501953125, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0024425392039120197, "total_loss": 32.45283889770508, "cur_lr": 0.0005000000237487257, "kl": 0.008257894776761532, "entropy": 1.2955176830291748, "vf_explained_var": 0.8162656426429749}, "num_steps_sampled": 603618}, "hostname": "flow-main", "date": "2019-05-24_04-25-16", "episode_reward_mean": -465.2214439458764, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee860>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeef0>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 469.58414578437805, "timestamp": 1558671916, "custom_metrics": {"system_level_velocity_max": 18.6378333407132, "cost1_mean": 184.69095074130985, "cost2_max": -25.72582348902704, "cost1_max": 219.45838766595114, "cost2_mean": -100.12127415634997, "outflow_rate_min": 462.43348918263234, "system_level_velocity_min": 12.018856973308495, "cost2_min": -123.85898059369642, "outflow_rate_mean": 1205.5474924872794, "cost1_min": 23.227860955137125, "system_level_velocity_mean": 15.857999282671203, "outflow_rate_max": 1403.043432533047}, "timesteps_since_restore": 603618, "episode_reward_min": -841.8895280567374}
{"timesteps_this_iter": 44348, "episodes_total": 727, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 647966, "training_iteration": 16, "episode_reward_max": -32.81946810194321, "pid": 334, "time_this_iter_s": 32.6209819316864, "time_total_s": 502.20512771606445, "episodes_this_iter": 41, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 16, "episode_len_mean": 318.02, "info": {"grad_time_ms": 9844.51, "update_time_ms": 7.998, "sample_time_ms": 20034.507, "num_steps_trained": 647966, "load_time_ms": 4.081, "default": {"vf_loss": 24.34571075439453, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0018282567616552114, "total_loss": 24.344207763671875, "cur_lr": 0.0005000000237487257, "kl": 0.006490563508123159, "entropy": 1.2842830419540405, "vf_explained_var": 0.8552382588386536}, "num_steps_sampled": 647966}, "hostname": "flow-main", "date": "2019-05-24_04-25-48", "episode_reward_mean": -499.4632448108433, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e12b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1ac8>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 502.20512771606445, "timestamp": 1558671948, "custom_metrics": {"system_level_velocity_max": 18.6378333407132, "cost1_mean": 181.08213379415767, "cost2_max": -25.72582348902704, "cost1_max": 221.02793344083753, "cost2_mean": -104.34749053441983, "outflow_rate_min": 462.43348918263234, "system_level_velocity_min": 12.051275321164173, "cost2_min": -132.3449338912297, "outflow_rate_mean": 1194.6619001394204, "cost1_min": 23.227860955137125, "system_level_velocity_mean": 15.538181773859215, "outflow_rate_max": 1403.043432533047}, "timesteps_since_restore": 647966, "episode_reward_min": -765.0397867607857}
{"timesteps_this_iter": 42785, "episodes_total": 785, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 690751, "training_iteration": 17, "episode_reward_max": -32.454045768965685, "pid": 334, "time_this_iter_s": 32.20074534416199, "time_total_s": 534.4058730602264, "episodes_this_iter": 58, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 17, "episode_len_mean": 320.04, "info": {"grad_time_ms": 9839.196, "update_time_ms": 7.821, "sample_time_ms": 20082.092, "num_steps_trained": 690751, "load_time_ms": 4.096, "default": {"vf_loss": 34.032310485839844, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.00288297887891531, "total_loss": 34.02983856201172, "cur_lr": 0.0005000000237487257, "kl": 0.008209401741623878, "entropy": 1.26981520652771, "vf_explained_var": 0.8116344809532166}, "num_steps_sampled": 690751}, "hostname": "flow-main", "date": "2019-05-24_04-26-21", "episode_reward_mean": -545.1970865430434, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da6d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daa90>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 534.4058730602264, "timestamp": 1558671981, "custom_metrics": {"system_level_velocity_max": 18.8990213696288, "cost1_mean": 178.27212762855524, "cost2_max": -23.491940195406173, "cost1_max": 221.02793344083753, "cost2_mean": -109.57066846885056, "outflow_rate_min": 516.6949329797634, "system_level_velocity_min": 11.924707235956259, "cost2_min": -132.3449338912297, "outflow_rate_mean": 1180.2292529517429, "cost1_min": 24.579645172530334, "system_level_velocity_mean": 15.169358379128152, "outflow_rate_max": 1399.4082436611016}, "timesteps_since_restore": 690751, "episode_reward_min": -784.5241734296008}
{"timesteps_this_iter": 42473, "episodes_total": 828, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 733224, "training_iteration": 18, "episode_reward_max": -32.454045768965685, "pid": 334, "time_this_iter_s": 30.994178295135498, "time_total_s": 565.4000513553619, "episodes_this_iter": 43, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 18, "episode_len_mean": 317.96, "info": {"grad_time_ms": 9876.966, "update_time_ms": 8.128, "sample_time_ms": 20042.784, "num_steps_trained": 733224, "load_time_ms": 4.019, "default": {"vf_loss": 28.542219161987305, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002518148859962821, "total_loss": 28.54008674621582, "cur_lr": 0.0005000000237487257, "kl": 0.007701023947447538, "entropy": 1.2557563781738281, "vf_explained_var": 0.845399796962738}, "num_steps_sampled": 733224}, "hostname": "flow-main", "date": "2019-05-24_04-26-52", "episode_reward_mean": -526.8423409201677, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1358>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1160>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 565.4000513553619, "timestamp": 1558672012, "custom_metrics": {"system_level_velocity_max": 18.8990213696288, "cost1_mean": 179.932415165647, "cost2_max": -23.491940195406173, "cost1_max": 218.3213825354665, "cost2_mean": -110.98464202244746, "outflow_rate_min": 516.6949329797634, "system_level_velocity_min": 11.924707235956259, "cost2_min": -138.98612661644358, "outflow_rate_mean": 1190.4529048058255, "cost1_min": 24.579645172530334, "system_level_velocity_mean": 15.420993318772823, "outflow_rate_max": 1408.480864805693}, "timesteps_since_restore": 733224, "episode_reward_min": -784.5241734296008}
{"timesteps_this_iter": 43216, "episodes_total": 870, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 776440, "training_iteration": 19, "episode_reward_max": -33.70882066457092, "pid": 334, "time_this_iter_s": 30.563352823257446, "time_total_s": 595.9634041786194, "episodes_this_iter": 42, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 19, "episode_len_mean": 320.04, "info": {"grad_time_ms": 9891.518, "update_time_ms": 8.313, "sample_time_ms": 20004.71, "num_steps_trained": 776440, "load_time_ms": 3.913, "default": {"vf_loss": 26.5565242767334, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002285600174218416, "total_loss": 26.554636001586914, "cur_lr": 0.0005000000237487257, "kl": 0.00795026309788227, "entropy": 1.2432721853256226, "vf_explained_var": 0.8593810796737671}, "num_steps_sampled": 776440}, "hostname": "flow-main", "date": "2019-05-24_04-27-22", "episode_reward_mean": -531.6032079568787, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e15c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee710>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee6a0>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 595.9634041786194, "timestamp": 1558672042, "custom_metrics": {"system_level_velocity_max": 18.72963320439352, "cost1_mean": 181.14267252727652, "cost2_max": -22.59345074533082, "cost1_max": 219.55617624541847, "cost2_mean": -113.25459590725632, "outflow_rate_min": 499.32327442849015, "system_level_velocity_min": 12.374139621120028, "cost2_min": -138.98612661644358, "outflow_rate_mean": 1199.4817071747611, "cost1_min": 24.424361086226828, "system_level_velocity_mean": 15.407551709462123, "outflow_rate_max": 1417.8930310906906}, "timesteps_since_restore": 776440, "episode_reward_min": -774.0155560703154}
{"timesteps_this_iter": 44017, "episodes_total": 926, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 820457, "training_iteration": 20, "episode_reward_max": -33.70882066457092, "pid": 334, "time_this_iter_s": 31.537413835525513, "time_total_s": 627.5008180141449, "episodes_this_iter": 56, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 20, "episode_len_mean": 322.12, "info": {"grad_time_ms": 10037.438, "update_time_ms": 8.508, "sample_time_ms": 20074.26, "num_steps_trained": 820457, "load_time_ms": 4.055, "default": {"vf_loss": 33.735164642333984, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002544550923630595, "total_loss": 33.73306655883789, "cur_lr": 0.0005000000237487257, "kl": 0.008837876841425896, "entropy": 1.2404346466064453, "vf_explained_var": 0.8268617391586304}, "num_steps_sampled": 820457}, "hostname": "flow-main", "date": "2019-05-24_04-27-54", "episode_reward_mean": -543.0108052639273, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb38>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb400>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 627.5008180141449, "timestamp": 1558672074, "custom_metrics": {"system_level_velocity_max": 18.72963320439352, "cost1_mean": 181.24446065113924, "cost2_max": -22.59345074533082, "cost1_max": 219.55617624541847, "cost2_mean": -115.20252250291958, "outflow_rate_min": 499.32327442849015, "system_level_velocity_min": 12.165040190525943, "cost2_min": -137.33032039455193, "outflow_rate_mean": 1202.9304642666207, "cost1_min": 24.424361086226828, "system_level_velocity_mean": 15.298114522879311, "outflow_rate_max": 1417.8930310906906}, "timesteps_since_restore": 820457, "episode_reward_min": -813.2750605164005}
{"timesteps_this_iter": 44569, "episodes_total": 970, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 865026, "training_iteration": 21, "episode_reward_max": -116.26341897661486, "pid": 334, "time_this_iter_s": 31.955320358276367, "time_total_s": 659.4561383724213, "episodes_this_iter": 44, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 21, "episode_len_mean": 323.02, "info": {"grad_time_ms": 10183.092, "update_time_ms": 8.647, "sample_time_ms": 20358.13, "num_steps_trained": 865026, "load_time_ms": 4.265, "default": {"vf_loss": 27.190095901489258, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002377714728936553, "total_loss": 27.18813705444336, "cur_lr": 0.0005000000237487257, "kl": 0.008332301862537861, "entropy": 1.2316031455993652, "vf_explained_var": 0.8519415259361267}, "num_steps_sampled": 865026}, "hostname": "flow-main", "date": "2019-05-24_04-28-26", "episode_reward_mean": -565.5014366738606, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e14a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1eb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeb38>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 659.4561383724213, "timestamp": 1558672106, "custom_metrics": {"system_level_velocity_max": 18.66986357162869, "cost1_mean": 179.0192579542702, "cost2_max": -54.038657656656504, "cost1_max": 216.772677099676, "cost2_mean": -118.56047081220639, "outflow_rate_min": 816.0479041726607, "system_level_velocity_min": 12.101561568687282, "cost2_min": -142.64649628314362, "outflow_rate_mean": 1197.056648784463, "cost1_min": 85.81330555221538, "system_level_velocity_mean": 15.038015242922318, "outflow_rate_max": 1413.2577669632929}, "timesteps_since_restore": 865026, "episode_reward_min": -829.1463504400161}
{"timesteps_this_iter": 43419, "episodes_total": 1011, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 908445, "training_iteration": 22, "episode_reward_max": -116.26341897661486, "pid": 334, "time_this_iter_s": 29.869669675827026, "time_total_s": 689.3258080482483, "episodes_this_iter": 41, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 22, "episode_len_mean": 323.02, "info": {"grad_time_ms": 10265.944, "update_time_ms": 8.715, "sample_time_ms": 20490.933, "num_steps_trained": 908445, "load_time_ms": 4.328, "default": {"vf_loss": 29.065441131591797, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0018217109609395266, "total_loss": 29.064014434814453, "cur_lr": 0.0005000000237487257, "kl": 0.007873584516346455, "entropy": 1.235084891319275, "vf_explained_var": 0.8407430648803711}, "num_steps_sampled": 908445}, "hostname": "flow-main", "date": "2019-05-24_04-28-56", "episode_reward_mean": -563.8683790461982, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8dae80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be37b9e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb38>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 689.3258080482483, "timestamp": 1558672136, "custom_metrics": {"system_level_velocity_max": 18.66986357162869, "cost1_mean": 178.93649685950197, "cost2_max": -54.038657656656504, "cost1_max": 218.23478900876634, "cost2_mean": -118.45218890952339, "outflow_rate_min": 816.0479041726607, "system_level_velocity_min": 11.675636324375986, "cost2_min": -142.64649628314362, "outflow_rate_mean": 1199.48000643729, "cost1_min": 85.81330555221538, "system_level_velocity_mean": 15.006524815393405, "outflow_rate_max": 1413.8442668349273}, "timesteps_since_restore": 908445, "episode_reward_min": -829.1463504400161}
{"timesteps_this_iter": 42134, "episodes_total": 1062, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 950579, "training_iteration": 23, "episode_reward_max": -318.7799464261097, "pid": 334, "time_this_iter_s": 31.115396738052368, "time_total_s": 720.4412047863007, "episodes_this_iter": 51, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 23, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10270.216, "update_time_ms": 8.922, "sample_time_ms": 20485.978, "num_steps_trained": 950579, "load_time_ms": 4.214, "default": {"vf_loss": 31.806005477905273, "cur_kl_coeff": 0.05000000074505806, "policy_loss": -0.002066374057903886, "total_loss": 31.80434226989746, "cur_lr": 0.0005000000237487257, "kl": 0.008083146065473557, "entropy": 1.2386277914047241, "vf_explained_var": 0.8150389790534973}, "num_steps_sampled": 950579}, "hostname": "flow-main", "date": "2019-05-24_04-29-27", "episode_reward_mean": -537.328834656673, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb7f0>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 720.4412047863007, "timestamp": 1558672167, "custom_metrics": {"system_level_velocity_max": 18.409634457545355, "cost1_mean": 183.21536989438115, "cost2_max": -92.99092673631455, "cost1_max": 218.23478900876634, "cost2_mean": -115.59516501237867, "outflow_rate_min": 992.9877265745006, "system_level_velocity_min": 11.675636324375986, "cost2_min": -142.64649628314362, "outflow_rate_mean": 1216.5643440995004, "cost1_min": 137.7396224033081, "system_level_velocity_mean": 15.225067064011176, "outflow_rate_max": 1413.8442668349273}, "timesteps_since_restore": 950579, "episode_reward_min": -823.6320089715259}
{"timesteps_this_iter": 42093, "episodes_total": 1109, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 992672, "training_iteration": 24, "episode_reward_max": -318.7799464261097, "pid": 334, "time_this_iter_s": 31.980273962020874, "time_total_s": 752.4214787483215, "episodes_this_iter": 47, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 24, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10544.624, "update_time_ms": 9.19, "sample_time_ms": 20586.982, "num_steps_trained": 992672, "load_time_ms": 4.285, "default": {"vf_loss": 26.938512802124023, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002723387675359845, "total_loss": 26.936166763305664, "cur_lr": 0.0005000000237487257, "kl": 0.007539885118603706, "entropy": 1.2283297777175903, "vf_explained_var": 0.8364424109458923}, "num_steps_sampled": 992672}, "hostname": "flow-main", "date": "2019-05-24_04-29-59", "episode_reward_mean": -511.57492094977715, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eee10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee3c8>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 752.4214787483215, "timestamp": 1558672199, "custom_metrics": {"system_level_velocity_max": 18.291728823598575, "cost1_mean": 186.324394858791, "cost2_max": -90.58790803171729, "cost1_max": 217.3881576512119, "cost2_mean": -113.00696384991866, "outflow_rate_min": 992.9877265745006, "system_level_velocity_min": 12.062750235326629, "cost2_min": -139.82472722685816, "outflow_rate_mean": 1227.5041754307222, "cost1_min": 143.07594518494045, "system_level_velocity_mean": 15.463096649696235, "outflow_rate_max": 1406.4108889381214}, "timesteps_since_restore": 992672, "episode_reward_min": -816.7619471578971}
{"timesteps_this_iter": 42630, "episodes_total": 1151, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1035302, "training_iteration": 25, "episode_reward_max": -327.0692303702631, "pid": 334, "time_this_iter_s": 30.802902936935425, "time_total_s": 783.224381685257, "episodes_this_iter": 42, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 25, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10785.475, "update_time_ms": 9.515, "sample_time_ms": 20470.053, "num_steps_trained": 1035302, "load_time_ms": 4.276, "default": {"vf_loss": 21.941429138183594, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0014736352022737265, "total_loss": 21.94028663635254, "cur_lr": 0.0005000000237487257, "kl": 0.006564408075064421, "entropy": 1.2286996841430664, "vf_explained_var": 0.8707541227340698}, "num_steps_sampled": 1035302}, "hostname": "flow-main", "date": "2019-05-24_04-30-30", "episode_reward_mean": -516.5363908973127, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e14a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1cf8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1ac8>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 783.224381685257, "timestamp": 1558672230, "custom_metrics": {"system_level_velocity_max": 17.893043375321923, "cost1_mean": 185.74327251145678, "cost2_max": -90.58790803171729, "cost1_max": 214.4520407704444, "cost2_mean": -113.46421275790325, "outflow_rate_min": 1024.0213852405768, "system_level_velocity_min": 12.183925427170287, "cost2_min": -137.86999471006834, "outflow_rate_mean": 1222.8018699315512, "cost1_min": 143.07594518494045, "system_level_velocity_mean": 15.405886378389571, "outflow_rate_max": 1386.6809846710669}, "timesteps_since_restore": 1035302, "episode_reward_min": -784.0080721623358}
{"timesteps_this_iter": 41761, "episodes_total": 1203, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1077063, "training_iteration": 26, "episode_reward_max": -23.636477517896402, "pid": 334, "time_this_iter_s": 31.095393896102905, "time_total_s": 814.3197755813599, "episodes_this_iter": 52, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 26, "episode_len_mean": 320.92, "info": {"grad_time_ms": 10856.986, "update_time_ms": 9.662, "sample_time_ms": 20248.109, "num_steps_trained": 1077063, "load_time_ms": 4.151, "default": {"vf_loss": 27.53390121459961, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0028716560918837786, "total_loss": 27.531423568725586, "cur_lr": 0.0005000000237487257, "kl": 0.007867716252803802, "entropy": 1.2382891178131104, "vf_explained_var": 0.8276140689849854}, "num_steps_sampled": 1077063}, "hostname": "flow-main", "date": "2019-05-24_04-31-01", "episode_reward_mean": -495.35937018230806, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f16d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1550>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 814.3197755813599, "timestamp": 1558672261, "custom_metrics": {"system_level_velocity_max": 17.97695897496613, "cost1_mean": 185.23779514488643, "cost2_max": -18.014381103713987, "cost1_max": 214.4520407704444, "cost2_mean": -110.83977265895498, "outflow_rate_min": 487.8590816741719, "system_level_velocity_min": 12.544450573840686, "cost2_min": -133.51780260946254, "outflow_rate_mean": 1218.6887744906292, "cost1_min": 18.047696157494357, "system_level_velocity_mean": 15.564892190636751, "outflow_rate_max": 1386.6809846710669}, "timesteps_since_restore": 1077063, "episode_reward_min": -747.9165128517083}
{"timesteps_this_iter": 42092, "episodes_total": 1247, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1119155, "training_iteration": 27, "episode_reward_max": -23.636477517896402, "pid": 334, "time_this_iter_s": 29.809544324874878, "time_total_s": 844.1293199062347, "episodes_this_iter": 44, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 27, "episode_len_mean": 320.92, "info": {"grad_time_ms": 10844.141, "update_time_ms": 9.775, "sample_time_ms": 20021.135, "num_steps_trained": 1119155, "load_time_ms": 4.122, "default": {"vf_loss": 22.95629119873047, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002340899081900716, "total_loss": 22.954336166381836, "cur_lr": 0.0005000000237487257, "kl": 0.007713922765105963, "entropy": 1.2202935218811035, "vf_explained_var": 0.8549724817276001}, "num_steps_sampled": 1119155}, "hostname": "flow-main", "date": "2019-05-24_04-31-31", "episode_reward_mean": -497.08403859813035, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebbe0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee6a0>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 844.1293199062347, "timestamp": 1558672291, "custom_metrics": {"system_level_velocity_max": 17.97695897496613, "cost1_mean": 184.4921353815733, "cost2_max": -18.014381103713987, "cost1_max": 215.67308592600526, "cost2_mean": -111.15531435040391, "outflow_rate_min": 487.8590816741719, "system_level_velocity_min": 11.365597079758192, "cost2_min": -131.2534645416535, "outflow_rate_mean": 1215.7327116863116, "cost1_min": 18.047696157494357, "system_level_velocity_mean": 15.498451400231154, "outflow_rate_max": 1402.9134627698957}, "timesteps_since_restore": 1119155, "episode_reward_min": -801.4497051219954}
{"timesteps_this_iter": 42988, "episodes_total": 1292, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1162143, "training_iteration": 28, "episode_reward_max": -322.99713102535105, "pid": 334, "time_this_iter_s": 31.293497323989868, "time_total_s": 875.4228172302246, "episodes_this_iter": 45, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 28, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10840.874, "update_time_ms": 9.619, "sample_time_ms": 20054.011, "num_steps_trained": 1162143, "load_time_ms": 4.175, "default": {"vf_loss": 23.655683517456055, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.003089405596256256, "total_loss": 23.652982711791992, "cur_lr": 0.0005000000237487257, "kl": 0.007750018499791622, "entropy": 1.2059129476547241, "vf_explained_var": 0.8587226271629333}, "num_steps_sampled": 1162143}, "hostname": "flow-main", "date": "2019-05-24_04-32-02", "episode_reward_mean": -525.7139393662059, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f13c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1710>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 875.4228172302246, "timestamp": 1558672322, "custom_metrics": {"system_level_velocity_max": 17.97576642512338, "cost1_mean": 183.93417810464013, "cost2_max": -90.9507700084455, "cost1_max": 215.67308592600526, "cost2_mean": -115.64038620234565, "outflow_rate_min": 1009.7969930875572, "system_level_velocity_min": 11.365597079758192, "cost2_min": -135.37924680885646, "outflow_rate_mean": 1210.6585224225769, "cost1_min": 137.54535932547614, "system_level_velocity_mean": 15.217610108174473, "outflow_rate_max": 1402.9134627698957}, "timesteps_since_restore": 1162143, "episode_reward_min": -801.4497051219954}
{"timesteps_this_iter": 42124, "episodes_total": 1334, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1204267, "training_iteration": 29, "episode_reward_max": -317.5554056893945, "pid": 334, "time_this_iter_s": 31.872348308563232, "time_total_s": 907.2951655387878, "episodes_this_iter": 42, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 29, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10877.251, "update_time_ms": 9.527, "sample_time_ms": 20147.179, "num_steps_trained": 1204267, "load_time_ms": 4.304, "default": {"vf_loss": 22.910751342773438, "cur_kl_coeff": 0.05000000074505806, "policy_loss": -0.002387808635830879, "total_loss": 22.90873908996582, "cur_lr": 0.0005000000237487257, "kl": 0.007494109682738781, "entropy": 1.2136491537094116, "vf_explained_var": 0.8498141765594482}, "num_steps_sampled": 1204267}, "hostname": "flow-main", "date": "2019-05-24_04-32-34", "episode_reward_mean": -533.3398829409601, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee320>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee198>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 907.2951655387878, "timestamp": 1558672354, "custom_metrics": {"system_level_velocity_max": 18.223141075295167, "cost1_mean": 182.97178445913957, "cost2_max": -90.9507700084455, "cost1_max": 216.7069215857591, "cost2_mean": -116.23135614824801, "outflow_rate_min": 986.818677722624, "system_level_velocity_min": 11.365597079758192, "cost2_min": -135.37924680885646, "outflow_rate_mean": 1207.9848206623756, "cost1_min": 137.54535932547614, "system_level_velocity_mean": 15.153686563637757, "outflow_rate_max": 1408.1676749873502}, "timesteps_since_restore": 1204267, "episode_reward_min": -808.046792410162}
{"timesteps_this_iter": 41179, "episodes_total": 1387, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1245446, "training_iteration": 30, "episode_reward_max": -316.0968639425643, "pid": 334, "time_this_iter_s": 30.766129970550537, "time_total_s": 938.0612955093384, "episodes_this_iter": 53, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 30, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10919.831, "update_time_ms": 9.424, "sample_time_ms": 20027.632, "num_steps_trained": 1245446, "load_time_ms": 4.388, "default": {"vf_loss": 26.79207992553711, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002098993631079793, "total_loss": 26.790386199951172, "cur_lr": 0.0005000000237487257, "kl": 0.008083661086857319, "entropy": 1.2171943187713623, "vf_explained_var": 0.8239275217056274}, "num_steps_sampled": 1245446}, "hostname": "flow-main", "date": "2019-05-24_04-33-05", "episode_reward_mean": -497.5672808950728, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9015c0>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 938.0612955093384, "timestamp": 1558672385, "custom_metrics": {"system_level_velocity_max": 18.223141075295167, "cost1_mean": 187.50674399082817, "cost2_max": -88.85417730787157, "cost1_max": 216.7069215857591, "cost2_mean": -111.83249936294554, "outflow_rate_min": 986.818677722624, "system_level_velocity_min": 11.861614871267816, "cost2_min": -138.28063930677982, "outflow_rate_mean": 1234.1735761450482, "cost1_min": 140.3066704503671, "system_level_velocity_mean": 15.555283824315437, "outflow_rate_max": 1408.1676749873502}, "timesteps_since_restore": 1245446, "episode_reward_min": -808.046792410162}
{"timesteps_this_iter": 40109, "episodes_total": 1431, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1285555, "training_iteration": 31, "episode_reward_max": -316.0968639425643, "pid": 334, "time_this_iter_s": 28.571946620941162, "time_total_s": 966.6332421302795, "episodes_this_iter": 44, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 31, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10940.762, "update_time_ms": 9.246, "sample_time_ms": 19670.609, "num_steps_trained": 1285555, "load_time_ms": 4.097, "default": {"vf_loss": 21.33115577697754, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002288635354489088, "total_loss": 21.329261779785156, "cur_lr": 0.0005000000237487257, "kl": 0.007898328825831413, "entropy": 1.221008539199829, "vf_explained_var": 0.8340639472007751}, "num_steps_sampled": 1285555}, "hostname": "flow-main", "date": "2019-05-24_04-33-33", "episode_reward_mean": -467.1568261997483, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e10f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee5c0>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 966.6332421302795, "timestamp": 1558672413, "custom_metrics": {"system_level_velocity_max": 17.998742680236283, "cost1_mean": 190.78613693654964, "cost2_max": -87.17369864712157, "cost1_max": 214.53218397888935, "cost2_mean": -106.45337429155924, "outflow_rate_min": 1026.140357142857, "system_level_velocity_min": 11.96838313226334, "cost2_min": -138.28063930677982, "outflow_rate_mean": 1249.0689418923812, "cost1_min": 142.84113265698934, "system_level_velocity_mean": 15.816696298224501, "outflow_rate_max": 1399.0822872293231}, "timesteps_since_restore": 1285555, "episode_reward_min": -789.6796441675455}
{"timesteps_this_iter": 42323, "episodes_total": 1474, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1327878, "training_iteration": 32, "episode_reward_max": -211.9966064083273, "pid": 334, "time_this_iter_s": 29.91865062713623, "time_total_s": 996.5518927574158, "episodes_this_iter": 43, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 32, "episode_len_mean": 323.82, "info": {"grad_time_ms": 11013.923, "update_time_ms": 9.187, "sample_time_ms": 19605.21, "num_steps_trained": 1327878, "load_time_ms": 4.122, "default": {"vf_loss": 22.406856536865234, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.002674627583473921, "total_loss": 22.40459632873535, "cur_lr": 0.0005000000237487257, "kl": 0.008319880813360214, "entropy": 1.190704107284546, "vf_explained_var": 0.8350939154624939}, "num_steps_sampled": 1327878}, "hostname": "flow-main", "date": "2019-05-24_04-34-03", "episode_reward_mean": -480.2530864128461, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee3c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee6d8>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 996.5518927574158, "timestamp": 1558672443, "custom_metrics": {"system_level_velocity_max": 17.905583078952215, "cost1_mean": 187.4837457522804, "cost2_max": -72.52202380115531, "cost1_max": 212.95541782020015, "cost2_mean": -107.65007445886604, "outflow_rate_min": 1020.587156715349, "system_level_velocity_min": 11.96838313226334, "cost2_min": -141.89625671656017, "outflow_rate_mean": 1236.6086820126716, "cost1_min": 132.0719011645728, "system_level_velocity_mean": 15.560081420684314, "outflow_rate_max": 1396.6759994607596}, "timesteps_since_restore": 1327878, "episode_reward_min": -789.6796441675455}
{"timesteps_this_iter": 42917, "episodes_total": 1527, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1370795, "training_iteration": 33, "episode_reward_max": -24.393918960137455, "pid": 334, "time_this_iter_s": 31.510655164718628, "time_total_s": 1028.0625479221344, "episodes_this_iter": 53, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 33, "episode_len_mean": 320.85, "info": {"grad_time_ms": 11027.741, "update_time_ms": 8.895, "sample_time_ms": 19633.577, "num_steps_trained": 1370795, "load_time_ms": 4.298, "default": {"vf_loss": 24.902530670166016, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0024874666705727577, "total_loss": 24.900501251220703, "cur_lr": 0.0005000000237487257, "kl": 0.009227639995515347, "entropy": 1.1800767183303833, "vf_explained_var": 0.8239156603813171}, "num_steps_sampled": 1370795}, "hostname": "flow-main", "date": "2019-05-24_04-34-35", "episode_reward_mean": -503.9174250562272, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e14e0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f16a0>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1028.0625479221344, "timestamp": 1558672475, "custom_metrics": {"system_level_velocity_max": 19.09253810035153, "cost1_mean": 183.21623163461933, "cost2_max": -18.56199915785392, "cost1_max": 212.95541782020015, "cost2_mean": -112.37052471613279, "outflow_rate_min": 497.50056700217027, "system_level_velocity_min": 11.911871949522297, "cost2_min": -141.89625671656017, "outflow_rate_mean": 1220.872764781979, "cost1_min": 18.460768122384145, "system_level_velocity_mean": 15.366040631212556, "outflow_rate_max": 1396.6759994607596}, "timesteps_since_restore": 1370795, "episode_reward_min": -770.2422419997217}
{"timesteps_this_iter": 41946, "episodes_total": 1572, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1412741, "training_iteration": 34, "episode_reward_max": -24.393918960137455, "pid": 334, "time_this_iter_s": 31.28430414199829, "time_total_s": 1059.3468520641327, "episodes_this_iter": 45, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 34, "episode_len_mean": 321.75, "info": {"grad_time_ms": 10897.015, "update_time_ms": 8.66, "sample_time_ms": 19696.978, "num_steps_trained": 1412741, "load_time_ms": 4.178, "default": {"vf_loss": 24.515869140625, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002938917838037014, "total_loss": 24.513385772705078, "cur_lr": 0.0005000000237487257, "kl": 0.009069942869246006, "entropy": 1.180800199508667, "vf_explained_var": 0.8272525072097778}, "num_steps_sampled": 1412741}, "hostname": "flow-main", "date": "2019-05-24_04-35-06", "episode_reward_mean": -506.6646243604607, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1438>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1588>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1059.3468520641327, "timestamp": 1558672506, "custom_metrics": {"system_level_velocity_max": 19.09253810035153, "cost1_mean": 184.71847528340072, "cost2_max": -18.56199915785392, "cost1_max": 212.79428484698025, "cost2_mean": -114.87956028855154, "outflow_rate_min": 497.50056700217027, "system_level_velocity_min": 11.911871949522297, "cost2_min": -133.98508178744413, "outflow_rate_mean": 1232.0126405349063, "cost1_min": 18.460768122384145, "system_level_velocity_mean": 15.435404678144314, "outflow_rate_max": 1403.5836062351486}, "timesteps_since_restore": 1412741, "episode_reward_min": -770.2422419997217}
{"timesteps_this_iter": 42411, "episodes_total": 1615, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1455152, "training_iteration": 35, "episode_reward_max": -321.4262764642066, "pid": 334, "time_this_iter_s": 31.820234298706055, "time_total_s": 1091.1670863628387, "episodes_this_iter": 43, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 35, "episode_len_mean": 324.72, "info": {"grad_time_ms": 10809.841, "update_time_ms": 8.352, "sample_time_ms": 19885.509, "num_steps_trained": 1455152, "load_time_ms": 4.214, "default": {"vf_loss": 21.810583114624023, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0019935776945203543, "total_loss": 21.80904769897461, "cur_lr": 0.0005000000237487257, "kl": 0.009234831668436527, "entropy": 1.1679308414459229, "vf_explained_var": 0.841463565826416}, "num_steps_sampled": 1455152}, "hostname": "flow-main", "date": "2019-05-24_04-35-38", "episode_reward_mean": -508.88219252641073, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9013c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901be0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9015f8>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1091.1670863628387, "timestamp": 1558672538, "custom_metrics": {"system_level_velocity_max": 17.702069119566165, "cost1_mean": 186.7868788807418, "cost2_max": -92.69278231208312, "cost1_max": 212.79428484698025, "cost2_mean": -115.91916519843612, "outflow_rate_min": 1036.285777215923, "system_level_velocity_min": 12.732500583321547, "cost2_min": -133.9428032018241, "outflow_rate_mean": 1244.2392630325512, "cost1_min": 154.24102157404803, "system_level_velocity_mean": 15.41423481815378, "outflow_rate_max": 1403.5836062351486}, "timesteps_since_restore": 1455152, "episode_reward_min": -746.2148297319405}
{"timesteps_this_iter": 41758, "episodes_total": 1664, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1496910, "training_iteration": 36, "episode_reward_max": -337.22896820648185, "pid": 334, "time_this_iter_s": 30.973814964294434, "time_total_s": 1122.1409013271332, "episodes_this_iter": 49, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 36, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10701.915, "update_time_ms": 8.536, "sample_time_ms": 19981.901, "num_steps_trained": 1496910, "load_time_ms": 4.219, "default": {"vf_loss": 24.649991989135742, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002022410510107875, "total_loss": 24.64836883544922, "cur_lr": 0.0005000000237487257, "kl": 0.007970243692398071, "entropy": 1.1622647047042847, "vf_explained_var": 0.8252432346343994}, "num_steps_sampled": 1496910}, "hostname": "flow-main", "date": "2019-05-24_04-36-09", "episode_reward_mean": -499.115377084363, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eec88>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1122.1409013271332, "timestamp": 1558672569, "custom_metrics": {"system_level_velocity_max": 18.073693336448123, "cost1_mean": 188.34421281013337, "cost2_max": -93.2236164082669, "cost1_max": 214.85156374127783, "cost2_mean": -115.16426111400422, "outflow_rate_min": 1049.1137897463518, "system_level_velocity_min": 12.201971555844608, "cost2_min": -133.9428032018241, "outflow_rate_mean": 1255.2555492151776, "cost1_min": 147.2754494432629, "system_level_velocity_mean": 15.561246487344544, "outflow_rate_max": 1415.8880924392724}, "timesteps_since_restore": 1496910, "episode_reward_min": -800.1474055409675}
{"timesteps_this_iter": 41490, "episodes_total": 1712, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1538400, "training_iteration": 37, "episode_reward_max": -107.01354736244028, "pid": 334, "time_this_iter_s": 29.510697603225708, "time_total_s": 1151.651598930359, "episodes_this_iter": 48, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 37, "episode_len_mean": 322.92, "info": {"grad_time_ms": 10512.582, "update_time_ms": 8.249, "sample_time_ms": 20143.406, "num_steps_trained": 1538400, "load_time_ms": 4.132, "default": {"vf_loss": 23.30082893371582, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0020764009095728397, "total_loss": 23.29922866821289, "cur_lr": 0.0005000000237487257, "kl": 0.009487512521445751, "entropy": 1.154901146888733, "vf_explained_var": 0.8268300890922546}, "num_steps_sampled": 1538400}, "hostname": "flow-main", "date": "2019-05-24_04-36-39", "episode_reward_mean": -483.98407363009176, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e15f8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1ba8>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1151.651598930359, "timestamp": 1558672599, "custom_metrics": {"system_level_velocity_max": 18.318041246348486, "cost1_mean": 189.15292798756442, "cost2_max": -51.667756154487925, "cost1_max": 214.85156374127783, "cost2_mean": -113.81434857855687, "outflow_rate_min": 752.8520714332232, "system_level_velocity_min": 12.201971555844608, "cost2_min": -134.4770309181921, "outflow_rate_mean": 1258.977956187315, "cost1_min": 77.65820813799937, "system_level_velocity_mean": 15.78747770845574, "outflow_rate_max": 1415.8880924392724}, "timesteps_since_restore": 1538400, "episode_reward_min": -800.1474055409675}
{"timesteps_this_iter": 42057, "episodes_total": 1757, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1580457, "training_iteration": 38, "episode_reward_max": -107.01354736244028, "pid": 334, "time_this_iter_s": 29.606173038482666, "time_total_s": 1181.2577719688416, "episodes_this_iter": 45, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 38, "episode_len_mean": 320.56, "info": {"grad_time_ms": 10269.949, "update_time_ms": 8.163, "sample_time_ms": 20217.817, "num_steps_trained": 1580457, "load_time_ms": 4.057, "default": {"vf_loss": 22.869678497314453, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0023346920497715473, "total_loss": 22.867794036865234, "cur_lr": 0.0005000000237487257, "kl": 0.00897752121090889, "entropy": 1.1348817348480225, "vf_explained_var": 0.8417572379112244}, "num_steps_sampled": 1580457}, "hostname": "flow-main", "date": "2019-05-24_04-37-08", "episode_reward_mean": -473.8157571598489, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901208>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9015c0>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1181.2577719688416, "timestamp": 1558672628, "custom_metrics": {"system_level_velocity_max": 18.318041246348486, "cost1_mean": 188.95712099455312, "cost2_max": -51.667756154487925, "cost1_max": 214.04474021967272, "cost2_mean": -113.03532180430815, "outflow_rate_min": 752.8520714332232, "system_level_velocity_min": 12.6163207867925, "cost2_min": -134.4770309181921, "outflow_rate_mean": 1257.0008427603138, "cost1_min": 77.64266817264841, "system_level_velocity_mean": 15.895828023269114, "outflow_rate_max": 1415.8880924392724}, "timesteps_since_restore": 1580457, "episode_reward_min": -725.3801883621593}
{"timesteps_this_iter": 42434, "episodes_total": 1805, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1622891, "training_iteration": 39, "episode_reward_max": -109.20263415194053, "pid": 334, "time_this_iter_s": 32.30920195579529, "time_total_s": 1213.5669739246368, "episodes_this_iter": 48, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 39, "episode_len_mean": 322.64, "info": {"grad_time_ms": 10168.288, "update_time_ms": 7.986, "sample_time_ms": 20363.866, "num_steps_trained": 1622891, "load_time_ms": 3.957, "default": {"vf_loss": 22.994665145874023, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002947012661024928, "total_loss": 22.992237091064453, "cur_lr": 0.0005000000237487257, "kl": 0.010369878262281418, "entropy": 1.1224160194396973, "vf_explained_var": 0.8347439169883728}, "num_steps_sampled": 1622891}, "hostname": "flow-main", "date": "2019-05-24_04-37-41", "episode_reward_mean": -488.8153748789807, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683208>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683710>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1213.5669739246368, "timestamp": 1558672661, "custom_metrics": {"system_level_velocity_max": 18.01843342153609, "cost1_mean": 187.58809039137006, "cost2_max": -54.99170467667577, "cost1_max": 214.35779444842814, "cost2_mean": -113.66989138050882, "outflow_rate_min": 755.7557551322111, "system_level_velocity_min": 12.451744975638157, "cost2_min": -135.04221683947327, "outflow_rate_mean": 1248.5721419333374, "cost1_min": 77.64266817264841, "system_level_velocity_mean": 15.634574224573285, "outflow_rate_max": 1412.988011101801}, "timesteps_since_restore": 1622891, "episode_reward_min": -707.5221197908639}
{"timesteps_this_iter": 42470, "episodes_total": 1848, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1665361, "training_iteration": 40, "episode_reward_max": -317.17368702606274, "pid": 334, "time_this_iter_s": 31.468786001205444, "time_total_s": 1245.0357599258423, "episodes_this_iter": 43, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 40, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10124.054, "update_time_ms": 8.11, "sample_time_ms": 20477.238, "num_steps_trained": 1665361, "load_time_ms": 3.588, "default": {"vf_loss": 22.580591201782227, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004102559294551611, "total_loss": 22.57712173461914, "cur_lr": 0.0005000000237487257, "kl": 0.01263369806110859, "entropy": 1.1149741411209106, "vf_explained_var": 0.8449674844741821}, "num_steps_sampled": 1665361}, "hostname": "flow-main", "date": "2019-05-24_04-38-12", "episode_reward_mean": -510.38704692856953, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f16a0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f14a8>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1245.0357599258423, "timestamp": 1558672692, "custom_metrics": {"system_level_velocity_max": 18.250570077032354, "cost1_mean": 186.1315123761273, "cost2_max": -96.31313858674227, "cost1_max": 217.4194121775255, "cost2_mean": -114.80044672915612, "outflow_rate_min": 1018.9504703832749, "system_level_velocity_min": 12.0329966665231, "cost2_min": -135.04221683947327, "outflow_rate_mean": 1237.7974410492216, "cost1_min": 145.80155603216923, "system_level_velocity_mean": 15.37274240446121, "outflow_rate_max": 1423.697258350354}, "timesteps_since_restore": 1665361, "episode_reward_min": -793.8214211305394}
{"timesteps_this_iter": 42661, "episodes_total": 1895, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1708022, "training_iteration": 41, "episode_reward_max": -317.17368702606274, "pid": 334, "time_this_iter_s": 30.8600754737854, "time_total_s": 1275.8958353996277, "episodes_this_iter": 47, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 41, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10090.6, "update_time_ms": 8.244, "sample_time_ms": 20738.639, "num_steps_trained": 1708022, "load_time_ms": 3.593, "default": {"vf_loss": 25.025253295898438, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0035833301953971386, "total_loss": 25.022197723388672, "cur_lr": 0.0005000000237487257, "kl": 0.010554959997534752, "entropy": 1.128440022468567, "vf_explained_var": 0.8331660032272339}, "num_steps_sampled": 1708022}, "hostname": "flow-main", "date": "2019-05-24_04-38-43", "episode_reward_mean": -519.2415660505268, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901cf8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901278>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1275.8958353996277, "timestamp": 1558672723, "custom_metrics": {"system_level_velocity_max": 18.250570077032354, "cost1_mean": 184.68639153732047, "cost2_max": -96.31313858674227, "cost1_max": 217.4194121775255, "cost2_mean": -114.45948323542234, "outflow_rate_min": 1018.9504703832749, "system_level_velocity_min": 11.692915426201536, "cost2_min": -132.15648020915614, "outflow_rate_mean": 1228.531813459474, "cost1_min": 141.54066168677673, "system_level_velocity_mean": 15.246937206028486, "outflow_rate_max": 1423.697258350354}, "timesteps_since_restore": 1708022, "episode_reward_min": -804.3626231134773}
{"timesteps_this_iter": 41491, "episodes_total": 1939, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1749513, "training_iteration": 42, "episode_reward_max": -323.8420047651692, "pid": 334, "time_this_iter_s": 30.149489402770996, "time_total_s": 1306.0453248023987, "episodes_this_iter": 44, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 42, "episode_len_mean": 325.0, "info": {"grad_time_ms": 9974.175, "update_time_ms": 8.328, "sample_time_ms": 20877.001, "num_steps_trained": 1749513, "load_time_ms": 3.471, "default": {"vf_loss": 23.180940628051758, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0036337648052722216, "total_loss": 23.177812576293945, "cur_lr": 0.0005000000237487257, "kl": 0.010081611573696136, "entropy": 1.128241777420044, "vf_explained_var": 0.841748833656311}, "num_steps_sampled": 1749513}, "hostname": "flow-main", "date": "2019-05-24_04-39-13", "episode_reward_mean": -507.8657325948136, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6839b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac080>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee940>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1306.0453248023987, "timestamp": 1558672753, "custom_metrics": {"system_level_velocity_max": 18.0958669812229, "cost1_mean": 185.81577787265033, "cost2_max": -93.12893314152409, "cost1_max": 214.95958301696288, "cost2_mean": -112.2346992387806, "outflow_rate_min": 1024.5571753246757, "system_level_velocity_min": 11.692915426201536, "cost2_min": -134.8015611488695, "outflow_rate_mean": 1230.3172883401585, "cost1_min": 141.54066168677673, "system_level_velocity_mean": 15.360406061924637, "outflow_rate_max": 1406.0211922472954}, "timesteps_since_restore": 1749513, "episode_reward_min": -804.3626231134773}
{"timesteps_this_iter": 41886, "episodes_total": 1987, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1791399, "training_iteration": 43, "episode_reward_max": -323.8420047651692, "pid": 334, "time_this_iter_s": 31.623914003372192, "time_total_s": 1337.6692388057709, "episodes_this_iter": 48, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 43, "episode_len_mean": 325.0, "info": {"grad_time_ms": 9949.53, "update_time_ms": 8.305, "sample_time_ms": 20912.727, "num_steps_trained": 1791399, "load_time_ms": 3.525, "default": {"vf_loss": 25.440235137939453, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0031249194871634245, "total_loss": 25.437612533569336, "cur_lr": 0.0005000000237487257, "kl": 0.010036096908152103, "entropy": 1.1125094890594482, "vf_explained_var": 0.8346253633499146}, "num_steps_sampled": 1791399}, "hostname": "flow-main", "date": "2019-05-24_04-39-45", "episode_reward_mean": -503.4981880762295, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8dab00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8dad30>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1337.6692388057709, "timestamp": 1558672785, "custom_metrics": {"system_level_velocity_max": 18.0958669812229, "cost1_mean": 186.326411110237, "cost2_max": -92.1627131973936, "cost1_max": 214.95958301696288, "cost2_mean": -111.34177511715455, "outflow_rate_min": 1035.6125890513688, "system_level_velocity_min": 11.960372334594886, "cost2_min": -134.8015611488695, "outflow_rate_mean": 1228.4966214987157, "cost1_min": 143.05134275764982, "system_level_velocity_mean": 15.417118317453703, "outflow_rate_max": 1406.0211922472954}, "timesteps_since_restore": 1791399, "episode_reward_min": -790.5136285976363}
{"timesteps_this_iter": 42123, "episodes_total": 2035, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1833522, "training_iteration": 44, "episode_reward_max": -100.5060001810284, "pid": 334, "time_this_iter_s": 31.983914613723755, "time_total_s": 1369.6531534194946, "episodes_this_iter": 48, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 44, "episode_len_mean": 322.72, "info": {"grad_time_ms": 10004.528, "update_time_ms": 8.549, "sample_time_ms": 20925.806, "num_steps_trained": 1833522, "load_time_ms": 3.651, "default": {"vf_loss": 24.14332389831543, "cur_kl_coeff": 0.05000000074505806, "policy_loss": -0.0038969062734395266, "total_loss": 24.13995933532715, "cur_lr": 0.0005000000237487257, "kl": 0.010678389109671116, "entropy": 1.1243497133255005, "vf_explained_var": 0.8437815308570862}, "num_steps_sampled": 1833522}, "hostname": "flow-main", "date": "2019-05-24_04-40-17", "episode_reward_mean": -503.7181323542971, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9016d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9013c8>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1369.6531534194946, "timestamp": 1558672817, "custom_metrics": {"system_level_velocity_max": 18.57096077091238, "cost1_mean": 184.8995275829675, "cost2_max": -49.5517591588843, "cost1_max": 218.13650626394875, "cost2_mean": -111.94497438555611, "outflow_rate_min": 782.6861930269631, "system_level_velocity_min": 11.960372334594886, "cost2_min": -133.22785969918115, "outflow_rate_mean": 1223.1119189115725, "cost1_min": 78.85297021712928, "system_level_velocity_mean": 15.427777907723287, "outflow_rate_max": 1408.7999792857102}, "timesteps_since_restore": 1833522, "episode_reward_min": -790.5136285976363}
{"timesteps_this_iter": 42399, "episodes_total": 2078, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1875921, "training_iteration": 45, "episode_reward_max": -100.5060001810284, "pid": 334, "time_this_iter_s": 35.97874641418457, "time_total_s": 1405.6318998336792, "episodes_this_iter": 43, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 45, "episode_len_mean": 322.52, "info": {"grad_time_ms": 10526.918, "update_time_ms": 8.722, "sample_time_ms": 20811.185, "num_steps_trained": 1875921, "load_time_ms": 3.574, "default": {"vf_loss": 22.564176559448242, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00422530947253108, "total_loss": 22.560596466064453, "cur_lr": 0.0005000000237487257, "kl": 0.012894933111965656, "entropy": 1.1187589168548584, "vf_explained_var": 0.8584221601486206}, "num_steps_sampled": 1875921}, "hostname": "flow-main", "date": "2019-05-24_04-40-53", "episode_reward_mean": -502.59223984345607, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901e10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eea90>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1405.6318998336792, "timestamp": 1558672853, "custom_metrics": {"system_level_velocity_max": 18.57096077091238, "cost1_mean": 184.85070243975863, "cost2_max": -49.5517591588843, "cost1_max": 218.13650626394875, "cost2_mean": -110.6062210755983, "outflow_rate_min": 782.6861930269631, "system_level_velocity_min": 11.979108959813392, "cost2_min": -129.1331022851105, "outflow_rate_mean": 1222.882565128746, "cost1_min": 78.85297021712928, "system_level_velocity_mean": 15.478050013408849, "outflow_rate_max": 1408.7999792857102}, "timesteps_since_restore": 1875921, "episode_reward_min": -769.9718097246254}
{"timesteps_this_iter": 42307, "episodes_total": 2127, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1918228, "training_iteration": 46, "episode_reward_max": -288.43217145029564, "pid": 334, "time_this_iter_s": 51.79702115058899, "time_total_s": 1457.4289209842682, "episodes_this_iter": 49, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 46, "episode_len_mean": 324.8, "info": {"grad_time_ms": 11061.428, "update_time_ms": 9.869, "sample_time_ms": 22351.37, "num_steps_trained": 1918228, "load_time_ms": 4.276, "default": {"vf_loss": 20.047224044799805, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0035991622135043144, "total_loss": 20.044160842895508, "cur_lr": 0.0005000000237487257, "kl": 0.01073998399078846, "entropy": 1.1018918752670288, "vf_explained_var": 0.8802477121353149}, "num_steps_sampled": 1918228}, "hostname": "flow-main", "date": "2019-05-24_04-41-45", "episode_reward_mean": -525.1053940571724, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb2b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebe80>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1457.4289209842682, "timestamp": 1558672905, "custom_metrics": {"system_level_velocity_max": 18.2311384968239, "cost1_mean": 182.37314554681092, "cost2_max": -84.80133355378621, "cost1_max": 216.45314648147388, "cost2_mean": -110.59029319251485, "outflow_rate_min": 1012.513191131482, "system_level_velocity_min": 11.979108959813392, "cost2_min": -129.1331022851105, "outflow_rate_mean": 1209.0369649035033, "cost1_min": 144.18640575313088, "system_level_velocity_mean": 15.132637749216697, "outflow_rate_max": 1406.9156614902033}, "timesteps_since_restore": 1918228, "episode_reward_min": -769.9718097246254}
{"timesteps_this_iter": 41487, "episodes_total": 2174, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1959715, "training_iteration": 47, "episode_reward_max": -305.15248238773245, "pid": 334, "time_this_iter_s": 30.662736892700195, "time_total_s": 1488.0916578769684, "episodes_this_iter": 47, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 47, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11240.69, "update_time_ms": 9.985, "sample_time_ms": 22286.835, "num_steps_trained": 1959715, "load_time_ms": 4.265, "default": {"vf_loss": 20.843212127685547, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.006262040231376886, "total_loss": 20.837642669677734, "cur_lr": 0.0005000000237487257, "kl": 0.013868885114789009, "entropy": 1.0839325189590454, "vf_explained_var": 0.8735488057136536}, "num_steps_sampled": 1959715}, "hostname": "flow-main", "date": "2019-05-24_04-42-15", "episode_reward_mean": -527.4114116308677, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683780>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1488.0916578769684, "timestamp": 1558672935, "custom_metrics": {"system_level_velocity_max": 18.288938252864956, "cost1_mean": 181.1238111945485, "cost2_max": -84.80133355378621, "cost1_max": 215.74540877615766, "cost2_mean": -108.64893014248985, "outflow_rate_min": 1044.3703986710964, "system_level_velocity_min": 12.143843183654415, "cost2_min": -126.75409051493901, "outflow_rate_mean": 1201.6644689251978, "cost1_min": 147.5665525827872, "system_level_velocity_mean": 15.014260397398296, "outflow_rate_max": 1402.8588123863271}, "timesteps_since_restore": 1959715, "episode_reward_min": -749.2274261479266}
{"timesteps_this_iter": 40273, "episodes_total": 2219, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1999988, "training_iteration": 48, "episode_reward_max": -100.86302632632216, "pid": 334, "time_this_iter_s": 29.398266553878784, "time_total_s": 1517.4899244308472, "episodes_this_iter": 45, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 48, "episode_len_mean": 320.67, "info": {"grad_time_ms": 11401.522, "update_time_ms": 10.178, "sample_time_ms": 22106.099, "num_steps_trained": 1999988, "load_time_ms": 4.228, "default": {"vf_loss": 21.331504821777344, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0050000762566924095, "total_loss": 21.327190399169922, "cur_lr": 0.0005000000237487257, "kl": 0.013698216527700424, "entropy": 1.070565938949585, "vf_explained_var": 0.8680347204208374}, "num_steps_sampled": 1999988}, "hostname": "flow-main", "date": "2019-05-24_04-42-45", "episode_reward_mean": -493.87628066054293, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6833c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683470>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683a58>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1517.4899244308472, "timestamp": 1558672965, "custom_metrics": {"system_level_velocity_max": 18.524183314454326, "cost1_mean": 182.006595691221, "cost2_max": -45.473326800279054, "cost1_max": 217.22889389620713, "cost2_mean": -104.03578714116288, "outflow_rate_min": 762.5164692258692, "system_level_velocity_min": 11.928479671139526, "cost2_min": -126.75409051493901, "outflow_rate_mean": 1204.6907561544765, "cost1_min": 78.20420440415634, "system_level_velocity_mean": 15.365856888051983, "outflow_rate_max": 1403.1417240478875}, "timesteps_since_restore": 1999988, "episode_reward_min": -780.269128784577}
{"timesteps_this_iter": 39969, "episodes_total": 2269, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 2039957, "training_iteration": 49, "episode_reward_max": -100.86302632632216, "pid": 334, "time_this_iter_s": 29.54074454307556, "time_total_s": 1547.0306689739227, "episodes_this_iter": 50, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 49, "episode_len_mean": 320.67, "info": {"grad_time_ms": 11364.994, "update_time_ms": 10.433, "sample_time_ms": 21866.499, "num_steps_trained": 2039957, "load_time_ms": 4.286, "default": {"vf_loss": 21.105138778686523, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.005233503878116608, "total_loss": 21.10059356689453, "cur_lr": 0.0005000000237487257, "kl": 0.013778463006019592, "entropy": 1.0659186840057373, "vf_explained_var": 0.8681343197822571}, "num_steps_sampled": 2039957}, "hostname": "flow-main", "date": "2019-05-24_04-43-14", "episode_reward_mean": -471.87632019276606, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c45c0>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1547.0306689739227, "timestamp": 1558672994, "custom_metrics": {"system_level_velocity_max": 18.524183314454326, "cost1_mean": 183.24334571603373, "cost2_max": -45.473326800279054, "cost1_max": 217.22889389620713, "cost2_mean": -98.97549268525538, "outflow_rate_min": 762.5164692258692, "system_level_velocity_min": 11.837791740739293, "cost2_min": -119.29699798183334, "outflow_rate_mean": 1204.9834474732538, "cost1_min": 78.20420440415634, "system_level_velocity_mean": 15.493426281703396, "outflow_rate_max": 1403.1417240478875}, "timesteps_since_restore": 2039957, "episode_reward_min": -780.269128784577}
{"timesteps_this_iter": 38804, "episodes_total": 2314, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 2078761, "training_iteration": 50, "episode_reward_max": -295.5137157822536, "pid": 334, "time_this_iter_s": 28.82722783088684, "time_total_s": 1575.8578968048096, "episodes_this_iter": 45, "experiment_id": "985f1bb7cb594804a1d6949378f4d8d8", "iterations_since_restore": 50, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11158.881, "update_time_ms": 10.147, "sample_time_ms": 21810.543, "num_steps_trained": 2078761, "load_time_ms": 4.437, "default": {"vf_loss": 18.683032989501953, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.006363145541399717, "total_loss": 18.677337646484375, "cur_lr": 0.0005000000237487257, "kl": 0.013400187715888023, "entropy": 1.0640015602111816, "vf_explained_var": 0.8760692477226257}, "num_steps_sampled": 2078761}, "hostname": "flow-main", "date": "2019-05-24_04-43-43", "episode_reward_mean": -476.82265802573517, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1a58>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1588>", "on_train_result": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "custom_preprocessor": null, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "num_cpus_for_driver": 1, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "monitor": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": true, "node_ip": "10.138.0.2", "time_since_restore": 1575.8578968048096, "timestamp": 1558673023, "custom_metrics": {"system_level_velocity_max": 18.3470757422284, "cost1_mean": 183.81664252377337, "cost2_max": -62.52452565991488, "cost1_max": 214.90983897043947, "cost2_mean": -96.02326704431242, "outflow_rate_min": 1018.733971291866, "system_level_velocity_min": 11.837791740739293, "cost2_min": -111.8409219494068, "outflow_rate_mean": 1199.4688562934355, "cost1_min": 144.42421393142448, "system_level_velocity_mean": 15.30825630601763, "outflow_rate_max": 1376.6368279408448}, "timesteps_since_restore": 2078761, "episode_reward_min": -687.9961860589536}

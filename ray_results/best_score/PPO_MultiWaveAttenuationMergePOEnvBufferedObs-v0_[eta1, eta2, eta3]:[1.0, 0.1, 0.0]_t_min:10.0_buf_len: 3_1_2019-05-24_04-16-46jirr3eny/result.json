{"timesteps_this_iter": 42016, "episodes_total": 40, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 1, "episode_reward_max": -436.5002152781544, "pid": 277, "time_this_iter_s": 57.77568078041077, "time_total_s": 57.77568078041077, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 1, "episode_len_mean": 325.0, "info": {"grad_time_ms": 12088.62, "update_time_ms": 1175.887, "sample_time_ms": 44250.391, "num_steps_trained": 42016, "load_time_ms": 75.792, "default": {"vf_loss": 34.83741760253906, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.4201616048812866, "total_loss": 34.8366813659668, "cur_lr": 0.0005000000237487257, "kl": 0.002904139691963792, "vf_explained_var": -3.1455988391826395e-06, "policy_loss": -0.0013171161990612745}, "num_steps_sampled": 42016}, "timesteps_total": 42016, "date": "2019-05-24_04-18-24", "episode_reward_mean": -715.6932512503578, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4e48>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4d30>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671504, "node_ip": "10.138.0.2", "time_since_restore": 57.77568078041077, "custom_metrics": {"system_level_velocity_max": 13.270815014020544, "cost1_mean": 123.68013435761664, "cost2_max": -24.595880065663124, "outflow_rate_min": 496.32732283464566, "cost2_mean": -51.2759087566295, "cost1_max": 164.08767683180454, "system_level_velocity_min": 8.59711630605153, "cost2_min": -94.13364385530465, "outflow_rate_mean": 755.5509274507856, "cost1_min": 104.31366015962992, "system_level_velocity_mean": 10.258009637955848, "outflow_rate_max": 1068.3673135009356}, "timesteps_since_restore": 42016, "episode_reward_min": -933.5937554957014}
{"timesteps_this_iter": 40561, "episodes_total": 81, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 2, "episode_reward_max": -24.65974400845769, "pid": 277, "time_this_iter_s": 28.704967975616455, "time_total_s": 86.48064875602722, "episodes_this_iter": 41, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 2, "episode_len_mean": 321.320987654321, "info": {"grad_time_ms": 10621.584, "update_time_ms": 592.635, "sample_time_ms": 31848.604, "num_steps_trained": 82577, "load_time_ms": 45.624, "default": {"vf_loss": 33.434757232666016, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.4168884754180908, "total_loss": 33.433815002441406, "cur_lr": 0.0005000000237487257, "kl": 0.004655582830309868, "vf_explained_var": 0.45540890097618103, "policy_loss": -0.0014081925619393587}, "num_steps_sampled": 82577}, "timesteps_total": 82577, "date": "2019-05-24_04-18-52", "episode_reward_mean": -682.2793284609443, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daa90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daa58>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daac8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671532, "node_ip": "10.138.0.2", "time_since_restore": 86.48064875602722, "custom_metrics": {"system_level_velocity_max": 17.238806814923457, "cost1_mean": 123.2970536883201, "cost2_max": -16.711310342917045, "outflow_rate_min": 426.592, "cost2_mean": -48.22560987195687, "cost1_max": 164.08767683180454, "system_level_velocity_min": 8.59711630605153, "cost2_min": -94.13364385530465, "outflow_rate_mean": 760.6004742134674, "cost1_min": 17.491811668587115, "system_level_velocity_mean": 10.449170880038972, "outflow_rate_max": 1068.3673135009356}, "timesteps_since_restore": 82577, "episode_reward_min": -933.5937554957014}
{"timesteps_this_iter": 36552, "episodes_total": 121, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 3, "episode_reward_max": -24.65974400845769, "pid": 277, "time_this_iter_s": 26.801084995269775, "time_total_s": 113.281733751297, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 3, "episode_len_mean": 322.02, "info": {"grad_time_ms": 9991.151, "update_time_ms": 397.395, "sample_time_ms": 27225.752, "num_steps_trained": 119129, "load_time_ms": 33.556, "default": {"vf_loss": 40.868690490722656, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.4111748933792114, "total_loss": 40.86677551269531, "cur_lr": 0.0005000000237487257, "kl": 0.00816861167550087, "vf_explained_var": 0.6753432750701904, "policy_loss": -0.0023205887991935015}, "num_steps_sampled": 119129}, "timesteps_total": 119129, "date": "2019-05-24_04-19-19", "episode_reward_mean": -640.358956217084, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb70>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671559, "node_ip": "10.138.0.2", "time_since_restore": 113.281733751297, "custom_metrics": {"system_level_velocity_max": 17.238806814923457, "cost1_mean": 126.00093019096498, "cost2_max": -16.711310342917045, "outflow_rate_min": 426.592, "cost2_mean": -44.28118354568441, "cost1_max": 164.08767683180454, "system_level_velocity_min": 8.618619722948695, "cost2_min": -76.9329813266765, "outflow_rate_mean": 776.9803541578981, "cost1_min": 17.491811668587115, "system_level_velocity_mean": 10.694276700677522, "outflow_rate_max": 1068.3673135009356}, "timesteps_since_restore": 119129, "episode_reward_min": -933.5937554957014}
{"timesteps_this_iter": 35890, "episodes_total": 181, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 4, "episode_reward_max": -370.89380925634026, "pid": 277, "time_this_iter_s": 28.78844380378723, "time_total_s": 142.07017755508423, "episodes_this_iter": 60, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 4, "episode_len_mean": 325.0, "info": {"grad_time_ms": 9866.271, "update_time_ms": 299.838, "sample_time_ms": 25217.62, "num_steps_trained": 155019, "load_time_ms": 27.579, "default": {"vf_loss": 46.77565383911133, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.394199013710022, "total_loss": 46.77131652832031, "cur_lr": 0.0005000000237487257, "kl": 0.014905537478625774, "vf_explained_var": 0.7691227793693542, "policy_loss": -0.005081916227936745}, "num_steps_sampled": 155019}, "timesteps_total": 155019, "date": "2019-05-24_04-19-48", "episode_reward_mean": -557.4875110368677, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1be0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1e48>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671588, "node_ip": "10.138.0.2", "time_since_restore": 142.07017755508423, "custom_metrics": {"system_level_velocity_max": 13.711552392426817, "cost1_mean": 138.3830015224802, "cost2_max": -24.615977724338993, "outflow_rate_min": 695.8045984251968, "cost2_mean": -43.037481720541706, "cost1_max": 166.0843506396562, "system_level_velocity_min": 9.153135198706428, "cost2_min": -69.33014868864699, "outflow_rate_mean": 863.3650969558663, "cost1_min": 108.36542642810646, "system_level_velocity_mean": 11.652495722858225, "outflow_rate_max": 1108.7224607640953}, "timesteps_since_restore": 155019, "episode_reward_min": -742.8308794739772}
{"timesteps_this_iter": 38318, "episodes_total": 221, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 5, "episode_reward_max": -370.89380925634026, "pid": 277, "time_this_iter_s": 26.98103356361389, "time_total_s": 169.05121111869812, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 5, "episode_len_mean": 325.0, "info": {"grad_time_ms": 9823.343, "update_time_ms": 241.581, "sample_time_ms": 23621.994, "num_steps_trained": 193337, "load_time_ms": 23.812, "default": {"vf_loss": 39.79154586791992, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.3833928108215332, "total_loss": 39.78852081298828, "cur_lr": 0.0005000000237487257, "kl": 0.011702765710651875, "vf_explained_var": 0.822516143321991, "policy_loss": -0.003609761828556657}, "num_steps_sampled": 193337}, "timesteps_total": 193337, "date": "2019-05-24_04-20-15", "episode_reward_mean": -521.7688297168403, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8dae48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daa90>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8dab38>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671615, "node_ip": "10.138.0.2", "time_since_restore": 169.05121111869812, "custom_metrics": {"system_level_velocity_max": 15.794451563151384, "cost1_mean": 150.8955336269959, "cost2_max": -24.615977724338993, "outflow_rate_min": 709.46, "cost2_mean": -50.341743817395944, "cost1_max": 192.14287611940793, "system_level_velocity_min": 9.54062906674936, "cost2_min": -89.32964261627484, "outflow_rate_mean": 960.063564422096, "cost1_min": 115.69890500371567, "system_level_velocity_mean": 12.69365237804317, "outflow_rate_max": 1231.1832964185483}, "timesteps_since_restore": 193337, "episode_reward_min": -695.5551339964574}
{"timesteps_this_iter": 40027, "episodes_total": 261, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 6, "episode_reward_max": -405.54894655997185, "pid": 277, "time_this_iter_s": 28.568372011184692, "time_total_s": 197.6195831298828, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 6, "episode_len_mean": 325.0, "info": {"grad_time_ms": 9977.055, "update_time_ms": 202.561, "sample_time_ms": 22639.001, "num_steps_trained": 233364, "load_time_ms": 21.569, "default": {"vf_loss": 36.387874603271484, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.3940573930740356, "total_loss": 36.385108947753906, "cur_lr": 0.0005000000237487257, "kl": 0.00983407162129879, "vf_explained_var": 0.8178457617759705, "policy_loss": -0.0032564164139330387}, "num_steps_sampled": 233364}, "timesteps_total": 233364, "date": "2019-05-24_04-20-44", "episode_reward_mean": -502.7806389693664, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1eb8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1b00>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671644, "node_ip": "10.138.0.2", "time_since_restore": 197.6195831298828, "custom_metrics": {"system_level_velocity_max": 16.290489386323948, "cost1_mean": 163.0330642157869, "cost2_max": -32.517303022681794, "outflow_rate_min": 797.9778399228543, "cost2_mean": -62.96202771981766, "cost1_max": 195.24279329609732, "system_level_velocity_min": 9.54062906674936, "cost2_min": -103.09256116930904, "outflow_rate_mean": 1055.5972868029348, "cost1_min": 115.69890500371567, "system_level_velocity_mean": 13.642041292136442, "outflow_rate_max": 1273.0537541579504}, "timesteps_since_restore": 233364, "episode_reward_min": -655.8435989681772}
{"timesteps_this_iter": 41291, "episodes_total": 322, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 7, "episode_reward_max": -23.121029164148627, "pid": 277, "time_this_iter_s": 31.209832668304443, "time_total_s": 228.82941579818726, "episodes_this_iter": 61, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 7, "episode_len_mean": 322.02, "info": {"grad_time_ms": 10069.007, "update_time_ms": 174.666, "sample_time_ms": 22332.093, "num_steps_trained": 274655, "load_time_ms": 20.085, "default": {"vf_loss": 41.09868240356445, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.3853824138641357, "total_loss": 41.09602355957031, "cur_lr": 0.0005000000237487257, "kl": 0.008745451457798481, "vf_explained_var": 0.7497802376747131, "policy_loss": -0.0030917259864509106}, "num_steps_sampled": 274655}, "timesteps_total": 274655, "date": "2019-05-24_04-21-15", "episode_reward_mean": -487.6673560751029, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eba90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be37b9e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebc18>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671675, "node_ip": "10.138.0.2", "time_since_restore": 228.82941579818726, "custom_metrics": {"system_level_velocity_max": 17.93051989191851, "cost1_mean": 176.96401850807106, "cost2_max": -18.35934081102652, "outflow_rate_min": 493.8123238995481, "cost2_mean": -86.42884624219754, "cost1_max": 204.63214344498962, "system_level_velocity_min": 12.383160531408466, "cost2_min": -126.54552381800838, "outflow_rate_mean": 1157.8157821118727, "cost1_min": 18.040915026452556, "system_level_velocity_mean": 14.83292711029107, "outflow_rate_max": 1348.6389446910002}, "timesteps_since_restore": 274655, "episode_reward_min": -786.5147666188914}
{"timesteps_this_iter": 42239, "episodes_total": 362, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 8, "episode_reward_max": -23.121029164148627, "pid": 277, "time_this_iter_s": 29.8687105178833, "time_total_s": 258.69812631607056, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 8, "episode_len_mean": 322.02, "info": {"grad_time_ms": 10198.809, "update_time_ms": 153.82, "sample_time_ms": 21870.922, "num_steps_trained": 316894, "load_time_ms": 20.154, "default": {"vf_loss": 30.5800724029541, "cur_kl_coeff": 0.05000000074505806, "entropy": 1.3896191120147705, "total_loss": 30.577987670898438, "cur_lr": 0.0005000000237487257, "kl": 0.00652819499373436, "vf_explained_var": 0.7938612699508667, "policy_loss": -0.0024116490967571735}, "num_steps_sampled": 316894}, "timesteps_total": 316894, "date": "2019-05-24_04-21-45", "episode_reward_mean": -498.26685319247343, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb0f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8dac18>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671705, "node_ip": "10.138.0.2", "time_since_restore": 258.69812631607056, "custom_metrics": {"system_level_velocity_max": 17.93051989191851, "cost1_mean": 181.25316804211897, "cost2_max": -18.35934081102652, "outflow_rate_min": 493.8123238995481, "cost2_mean": -98.54859149616169, "cost1_max": 208.05102225662043, "system_level_velocity_min": 11.603437610301148, "cost2_min": -126.54552381800838, "outflow_rate_mean": 1189.6782584298212, "cost1_min": 18.040915026452556, "system_level_velocity_mean": 15.129997477062803, "outflow_rate_max": 1358.9223338225556}, "timesteps_since_restore": 316894, "episode_reward_min": -830.555036544123}
{"timesteps_this_iter": 43078, "episodes_total": 402, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 9, "episode_reward_max": -353.4170963583269, "pid": 277, "time_this_iter_s": 30.161271333694458, "time_total_s": 288.859397649765, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 9, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10337.18, "update_time_ms": 137.687, "sample_time_ms": 21507.896, "num_steps_trained": 359972, "load_time_ms": 19.792, "default": {"vf_loss": 29.253923416137695, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.4193300008773804, "total_loss": 29.251461029052734, "cur_lr": 0.0005000000237487257, "kl": 0.007550797890871763, "vf_explained_var": 0.8052014112472534, "policy_loss": -0.0028384681791067123}, "num_steps_sampled": 359972}, "timesteps_total": 359972, "date": "2019-05-24_04-22-15", "episode_reward_mean": -515.6930431088487, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da780>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da668>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671735, "node_ip": "10.138.0.2", "time_since_restore": 288.859397649765, "custom_metrics": {"system_level_velocity_max": 17.20904681256071, "cost1_mean": 183.09008730880132, "cost2_max": -55.95273869603406, "outflow_rate_min": 974.6851007326009, "cost2_mean": -103.98825678278108, "cost1_max": 208.05102225662043, "system_level_velocity_min": 11.603437610301148, "cost2_min": -130.80145732296467, "outflow_rate_mean": 1198.7367246822728, "cost1_min": 137.34507999854213, "system_level_velocity_mean": 15.09261846809678, "outflow_rate_max": 1358.9223338225556}, "timesteps_since_restore": 359972, "episode_reward_min": -830.555036544123}
{"timesteps_this_iter": 41666, "episodes_total": 460, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 10, "episode_reward_max": -335.338636492828, "pid": 277, "time_this_iter_s": 31.261415719985962, "time_total_s": 320.120813369751, "episodes_this_iter": 58, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 10, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10387.663, "update_time_ms": 124.748, "sample_time_ms": 21388.42, "num_steps_trained": 401638, "load_time_ms": 19.013, "default": {"vf_loss": 31.09422492980957, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.41005277633667, "total_loss": 31.091995239257812, "cur_lr": 0.0005000000237487257, "kl": 0.008458242751657963, "vf_explained_var": 0.794325590133667, "policy_loss": -0.0026514835190027952}, "num_steps_sampled": 401638}, "timesteps_total": 401638, "date": "2019-05-24_04-22-46", "episode_reward_mean": -511.2660239766509, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e15c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e14a8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671766, "node_ip": "10.138.0.2", "time_since_restore": 320.120813369751, "custom_metrics": {"system_level_velocity_max": 17.54198697845748, "cost1_mean": 183.34806119980584, "cost2_max": -66.07444625649197, "outflow_rate_min": 1033.0789601603196, "cost2_mean": -103.98660214587926, "cost1_max": 212.0463059603552, "system_level_velocity_min": 12.42578210889694, "cost2_min": -130.80145732296467, "outflow_rate_mean": 1198.1343985047235, "cost1_min": 149.75989064640487, "system_level_velocity_mean": 15.125355056735605, "outflow_rate_max": 1373.5482337156395}, "timesteps_since_restore": 401638, "episode_reward_min": -767.9111578034679}
{"timesteps_this_iter": 41181, "episodes_total": 504, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 11, "episode_reward_max": -24.222554763022558, "pid": 277, "time_this_iter_s": 30.003943920135498, "time_total_s": 350.1247572898865, "episodes_this_iter": 44, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 11, "episode_len_mean": 319.04, "info": {"grad_time_ms": 10229.334, "update_time_ms": 7.848, "sample_time_ms": 18903.916, "num_steps_trained": 442819, "load_time_ms": 12.324, "default": {"vf_loss": 25.549503326416016, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.4169214963912964, "total_loss": 25.54693603515625, "cur_lr": 0.0005000000237487257, "kl": 0.007266058120876551, "vf_explained_var": 0.8255811333656311, "policy_loss": -0.0029314288403838873}, "num_steps_sampled": 442819}, "timesteps_total": 442819, "date": "2019-05-24_04-23-16", "episode_reward_mean": -494.21180687510764, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb9b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebbe0>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671796, "node_ip": "10.138.0.2", "time_since_restore": 350.1247572898865, "custom_metrics": {"system_level_velocity_max": 17.885393923155508, "cost1_mean": 179.54276540368335, "cost2_max": -17.472406692268585, "outflow_rate_min": 468.51797875626045, "cost2_mean": -100.06571873589667, "cost1_max": 212.0463059603552, "system_level_velocity_min": 11.74232976057374, "cost2_min": -129.01080598109849, "outflow_rate_mean": 1179.644767469584, "cost1_min": 17.783861481846174, "system_level_velocity_mean": 15.136730102446638, "outflow_rate_max": 1373.5482337156395}, "timesteps_since_restore": 442819, "episode_reward_min": -802.0042864080224}
{"timesteps_this_iter": 40833, "episodes_total": 544, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 12, "episode_reward_max": -24.222554763022558, "pid": 277, "time_this_iter_s": 28.837451934814453, "time_total_s": 378.9622092247009, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 12, "episode_len_mean": 319.04, "info": {"grad_time_ms": 10362.997, "update_time_ms": 7.727, "sample_time_ms": 18783.385, "num_steps_trained": 483652, "load_time_ms": 11.619, "default": {"vf_loss": 24.795515060424805, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.4008677005767822, "total_loss": 24.793277740478516, "cur_lr": 0.0005000000237487257, "kl": 0.009594045579433441, "vf_explained_var": 0.8237110376358032, "policy_loss": -0.0027176346629858017}, "num_steps_sampled": 483652}, "timesteps_total": 483652, "date": "2019-05-24_04-23-45", "episode_reward_mean": -486.3685789690793, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daf28>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be37ba20>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671825, "node_ip": "10.138.0.2", "time_since_restore": 378.9622092247009, "custom_metrics": {"system_level_velocity_max": 17.885393923155508, "cost1_mean": 180.86057675683148, "cost2_max": -17.472406692268585, "outflow_rate_min": 468.51797875626045, "cost2_mean": -98.35809905117421, "cost1_max": 213.3082820838817, "system_level_velocity_min": 11.06793519825453, "cost2_min": -129.01080598109849, "outflow_rate_mean": 1184.2234626064474, "cost1_min": 17.783861481846174, "system_level_velocity_mean": 15.239705642310483, "outflow_rate_max": 1390.7309737291077}, "timesteps_since_restore": 483652, "episode_reward_min": -860.6804875979738}
{"timesteps_this_iter": 42061, "episodes_total": 600, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 13, "episode_reward_max": -33.63898024461491, "pid": 277, "time_this_iter_s": 31.668642282485962, "time_total_s": 410.6308515071869, "episodes_this_iter": 56, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 13, "episode_len_mean": 321.92, "info": {"grad_time_ms": 10532.92, "update_time_ms": 7.758, "sample_time_ms": 19098.432, "num_steps_trained": 525713, "load_time_ms": 12.611, "default": {"vf_loss": 32.4008903503418, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.3872175216674805, "total_loss": 32.398807525634766, "cur_lr": 0.0005000000237487257, "kl": 0.008368653245270252, "vf_explained_var": 0.773604154586792, "policy_loss": -0.0025018679443746805}, "num_steps_sampled": 525713}, "timesteps_total": 525713, "date": "2019-05-24_04-24-17", "episode_reward_mean": -474.93645705027046, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da9e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da6d8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671857, "node_ip": "10.138.0.2", "time_since_restore": 410.6308515071869, "custom_metrics": {"system_level_velocity_max": 18.272372446860714, "cost1_mean": 185.2920302015178, "cost2_max": -25.359364274198974, "outflow_rate_min": 465.8227828158284, "cost2_mean": -98.23998451953784, "cost1_max": 213.3082820838817, "system_level_velocity_min": 11.06793519825453, "cost2_min": -122.8308371444254, "outflow_rate_mean": 1204.903588799734, "cost1_min": 22.847257779548254, "system_level_velocity_mean": 15.467482495149868, "outflow_rate_max": 1390.7309737291077}, "timesteps_since_restore": 525713, "episode_reward_min": -860.6804875979738}
{"timesteps_this_iter": 40411, "episodes_total": 645, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 14, "episode_reward_max": -33.63898024461491, "pid": 277, "time_this_iter_s": 29.949028730392456, "time_total_s": 440.57988023757935, "episodes_this_iter": 45, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 14, "episode_len_mean": 321.92, "info": {"grad_time_ms": 10589.217, "update_time_ms": 7.747, "sample_time_ms": 19158.685, "num_steps_trained": 566124, "load_time_ms": 12.78, "default": {"vf_loss": 23.45061492919922, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.365935206413269, "total_loss": 23.448354721069336, "cur_lr": 0.0005000000237487257, "kl": 0.00845057237893343, "vf_explained_var": 0.8257496953010559, "policy_loss": -0.002685391344130039}, "num_steps_sampled": 566124}, "timesteps_total": 566124, "date": "2019-05-24_04-24-47", "episode_reward_mean": -479.27624841553546, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e18d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1d68>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1198>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671887, "node_ip": "10.138.0.2", "time_since_restore": 440.57988023757935, "custom_metrics": {"system_level_velocity_max": 18.272372446860714, "cost1_mean": 185.32890981875227, "cost2_max": -25.359364274198974, "outflow_rate_min": 465.8227828158284, "cost2_mean": -101.23305174104685, "cost1_max": 216.73288264180817, "system_level_velocity_min": 11.79863145878097, "cost2_min": -122.8308371444254, "outflow_rate_mean": 1209.3236425331575, "cost1_min": 22.847257779548254, "system_level_velocity_mean": 15.473381437813156, "outflow_rate_max": 1402.3092487385115}, "timesteps_since_restore": 566124, "episode_reward_min": -771.5906439266618}
{"timesteps_this_iter": 39728, "episodes_total": 685, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 15, "episode_reward_max": -322.9461931765847, "pid": 277, "time_this_iter_s": 28.821446895599365, "time_total_s": 469.4013271331787, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 15, "episode_len_mean": 324.82, "info": {"grad_time_ms": 10550.735, "update_time_ms": 7.818, "sample_time_ms": 19379.575, "num_steps_trained": 605852, "load_time_ms": 13.487, "default": {"vf_loss": 20.442476272583008, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.350712537765503, "total_loss": 20.439802169799805, "cur_lr": 0.0005000000237487257, "kl": 0.009316649287939072, "vf_explained_var": 0.8406497836112976, "policy_loss": -0.0031407049391418695}, "num_steps_sampled": 605852}, "timesteps_total": 605852, "date": "2019-05-24_04-25-16", "episode_reward_mean": -472.3551916070188, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebef0>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671916, "node_ip": "10.138.0.2", "time_since_restore": 469.4013271331787, "custom_metrics": {"system_level_velocity_max": 17.91609367286677, "cost1_mean": 188.7514263954355, "cost2_max": -72.5460666154472, "outflow_rate_min": 1019.9543653386784, "cost2_mean": -100.99054493957077, "cost1_max": 216.73288264180817, "system_level_velocity_min": 11.948680480366068, "cost2_min": -122.8308371444254, "outflow_rate_mean": 1225.7605411122568, "cost1_min": 144.82139909737418, "system_level_velocity_mean": 15.627675245703761, "outflow_rate_max": 1402.3092487385115}, "timesteps_since_restore": 605852, "episode_reward_min": -769.5116468119046}
{"timesteps_this_iter": 41733, "episodes_total": 725, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 16, "episode_reward_max": -320.05004924446877, "pid": 277, "time_this_iter_s": 29.80376935005188, "time_total_s": 499.2050964832306, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 16, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10398.425, "update_time_ms": 7.774, "sample_time_ms": 19654.698, "num_steps_trained": 647585, "load_time_ms": 14.409, "default": {"vf_loss": 25.729228973388672, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.3339364528656006, "total_loss": 25.726343154907227, "cur_lr": 0.0005000000237487257, "kl": 0.008494989015161991, "vf_explained_var": 0.8076426386833191, "policy_loss": -0.003310545114800334}, "num_steps_sampled": 647585}, "timesteps_total": 647585, "date": "2019-05-24_04-25-46", "episode_reward_mean": -458.3021891889411, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da7b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebe80>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671946, "node_ip": "10.138.0.2", "time_since_restore": 499.2050964832306, "custom_metrics": {"system_level_velocity_max": 17.91609367286677, "cost1_mean": 191.16724129224116, "cost2_max": -72.5460666154472, "outflow_rate_min": 1027.8740195869705, "cost2_mean": -100.36393604124083, "cost1_max": 216.73288264180817, "system_level_velocity_min": 11.948680480366068, "cost2_min": -122.28510574635524, "outflow_rate_mean": 1240.293727502495, "cost1_min": 144.82139909737418, "system_level_velocity_mean": 15.81823635254681, "outflow_rate_max": 1402.3092487385115}, "timesteps_since_restore": 647585, "episode_reward_min": -769.5116468119046}
{"timesteps_this_iter": 39490, "episodes_total": 785, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 17, "episode_reward_max": -320.05004924446877, "pid": 277, "time_this_iter_s": 30.559951305389404, "time_total_s": 529.76504778862, "episodes_this_iter": 60, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 17, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10262.369, "update_time_ms": 7.724, "sample_time_ms": 19724.502, "num_steps_trained": 687075, "load_time_ms": 14.104, "default": {"vf_loss": 24.636837005615234, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.3244261741638184, "total_loss": 24.633258819580078, "cur_lr": 0.0005000000237487257, "kl": 0.008836565539240837, "vf_explained_var": 0.8080978393554688, "policy_loss": -0.004017496947199106}, "num_steps_sampled": 687075}, "timesteps_total": 687075, "date": "2019-05-24_04-26-16", "episode_reward_mean": -465.952881529141, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb00>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558671976, "node_ip": "10.138.0.2", "time_since_restore": 529.76504778862, "custom_metrics": {"system_level_velocity_max": 17.703366677895385, "cost1_mean": 189.9223869110687, "cost2_max": -82.47219636392512, "outflow_rate_min": 1011.0476891205966, "cost2_mean": -102.21482954597538, "cost1_max": 212.24065032611634, "system_level_velocity_min": 11.804106647657386, "cost2_min": -124.47338753281184, "outflow_rate_mean": 1240.9521313817977, "cost1_min": 140.6937449837281, "system_level_velocity_mean": 15.68506405184079, "outflow_rate_max": 1375.9680551566792}, "timesteps_since_restore": 687075, "episode_reward_min": -796.0481180331698}
{"timesteps_this_iter": 41685, "episodes_total": 826, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 18, "episode_reward_max": -23.68358993724382, "pid": 277, "time_this_iter_s": 31.03363585472107, "time_total_s": 560.7986836433411, "episodes_this_iter": 41, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 18, "episode_len_mean": 322.02, "info": {"grad_time_ms": 10205.959, "update_time_ms": 7.718, "sample_time_ms": 19898.069, "num_steps_trained": 728760, "load_time_ms": 13.123, "default": {"vf_loss": 20.36513900756836, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.2978854179382324, "total_loss": 20.362932205200195, "cur_lr": 0.0005000000237487257, "kl": 0.008224218152463436, "vf_explained_var": 0.8437556624412537, "policy_loss": -0.0026166781317442656}, "num_steps_sampled": 728760}, "timesteps_total": 728760, "date": "2019-05-24_04-26-47", "episode_reward_mean": -471.9617329464379, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee860>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee9e8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672007, "node_ip": "10.138.0.2", "time_since_restore": 560.7986836433411, "custom_metrics": {"system_level_velocity_max": 18.354856113407255, "cost1_mean": 186.68676252744538, "cost2_max": -17.80109940129787, "outflow_rate_min": 492.0625426222078, "cost2_mean": -102.88018835589948, "cost1_max": 218.3186294880437, "system_level_velocity_min": 11.804106647657386, "cost2_min": -125.39561624113159, "outflow_rate_mean": 1226.2494325191242, "cost1_min": 17.720201415957042, "system_level_velocity_mean": 15.575760450749355, "outflow_rate_max": 1382.7343650793657}, "timesteps_since_restore": 728760, "episode_reward_min": -796.0481180331698}
{"timesteps_this_iter": 41279, "episodes_total": 866, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 19, "episode_reward_max": -23.68358993724382, "pid": 277, "time_this_iter_s": 29.630204439163208, "time_total_s": 590.4288880825043, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 19, "episode_len_mean": 322.02, "info": {"grad_time_ms": 10138.81, "update_time_ms": 7.729, "sample_time_ms": 19913.393, "num_steps_trained": 770039, "load_time_ms": 12.386, "default": {"vf_loss": 21.825429916381836, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2770321369171143, "total_loss": 21.82419776916504, "cur_lr": 0.0005000000237487257, "kl": 0.00750928046181798, "vf_explained_var": 0.8458991050720215, "policy_loss": -0.0016078670741990209}, "num_steps_sampled": 770039}, "timesteps_total": 770039, "date": "2019-05-24_04-27-17", "episode_reward_mean": -482.51232853095496, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb4e0>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672037, "node_ip": "10.138.0.2", "time_since_restore": 590.4288880825043, "custom_metrics": {"system_level_velocity_max": 18.354856113407255, "cost1_mean": 185.18851998281167, "cost2_max": -17.80109940129787, "outflow_rate_min": 492.0625426222078, "cost2_mean": -104.96075673328042, "cost1_max": 218.3186294880437, "system_level_velocity_min": 11.828075312208947, "cost2_min": -125.39561624113159, "outflow_rate_mean": 1219.0586574710544, "cost1_min": 17.720201415957042, "system_level_velocity_mean": 15.43170550271128, "outflow_rate_max": 1385.6665295815294}, "timesteps_since_restore": 770039, "episode_reward_min": -794.1980132400888}
{"timesteps_this_iter": 41695, "episodes_total": 927, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 20, "episode_reward_max": -23.437570285814566, "pid": 277, "time_this_iter_s": 32.662853717803955, "time_total_s": 623.0917418003082, "episodes_this_iter": 61, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 20, "episode_len_mean": 319.12, "info": {"grad_time_ms": 10139.584, "update_time_ms": 7.738, "sample_time_ms": 20053.842, "num_steps_trained": 811734, "load_time_ms": 12.154, "default": {"vf_loss": 27.591291427612305, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.2646880149841309, "total_loss": 27.588319778442383, "cur_lr": 0.0005000000237487257, "kl": 0.008454575203359127, "vf_explained_var": 0.8139252066612244, "policy_loss": -0.0033953816164284945}, "num_steps_sampled": 811734}, "timesteps_total": 811734, "date": "2019-05-24_04-27-50", "episode_reward_mean": -477.8405036954257, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee6d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeb00>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672070, "node_ip": "10.138.0.2", "time_since_restore": 623.0917418003082, "custom_metrics": {"system_level_velocity_max": 18.251109451064448, "cost1_mean": 184.95550067187497, "cost2_max": -19.516239886088375, "outflow_rate_min": 460.7989278777953, "cost2_mean": -104.05262087983755, "cost1_max": 217.35605345094552, "system_level_velocity_min": 12.442460947130785, "cost2_min": -123.01327425188967, "outflow_rate_mean": 1213.8157178343158, "cost1_min": 18.282757933600998, "system_level_velocity_mean": 15.621792246205008, "outflow_rate_max": 1397.4823329026358}, "timesteps_since_restore": 811734, "episode_reward_min": -730.6166639062508}
{"timesteps_this_iter": 40761, "episodes_total": 970, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 21, "episode_reward_max": -23.437570285814566, "pid": 277, "time_this_iter_s": 29.951016902923584, "time_total_s": 653.0427587032318, "episodes_this_iter": 43, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 21, "episode_len_mean": 317.96, "info": {"grad_time_ms": 10114.603, "update_time_ms": 7.729, "sample_time_ms": 20073.2, "num_steps_trained": 852495, "load_time_ms": 12.312, "default": {"vf_loss": 19.509218215942383, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.2732453346252441, "total_loss": 19.506792068481445, "cur_lr": 0.0005000000237487257, "kl": 0.009576268494129181, "vf_explained_var": 0.868335485458374, "policy_loss": -0.00290315761230886}, "num_steps_sampled": 852495}, "timesteps_total": 852495, "date": "2019-05-24_04-28-20", "episode_reward_mean": -479.6644606220357, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e14e0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee240>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672100, "node_ip": "10.138.0.2", "time_since_restore": 653.0427587032318, "custom_metrics": {"system_level_velocity_max": 18.742226968188437, "cost1_mean": 183.8800000920286, "cost2_max": -19.516239886088375, "outflow_rate_min": 470.30216034021953, "cost2_mean": -103.90987567891598, "cost1_max": 218.30500215054292, "system_level_velocity_min": 12.442460947130785, "cost2_min": -122.03843040557052, "outflow_rate_mean": 1209.4025310752356, "cost1_min": 18.282757933600998, "system_level_velocity_mean": 15.613747660627434, "outflow_rate_max": 1397.4823329026358}, "timesteps_since_restore": 852495, "episode_reward_min": -730.6166639062508}
{"timesteps_this_iter": 41287, "episodes_total": 1011, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 22, "episode_reward_max": -34.05350982223804, "pid": 277, "time_this_iter_s": 29.85334849357605, "time_total_s": 682.8961071968079, "episodes_this_iter": 41, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 22, "episode_len_mean": 318.04, "info": {"grad_time_ms": 10106.706, "update_time_ms": 7.603, "sample_time_ms": 20182.337, "num_steps_trained": 893782, "load_time_ms": 12.691, "default": {"vf_loss": 22.085285186767578, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.250792145729065, "total_loss": 22.08174705505371, "cur_lr": 0.0005000000237487257, "kl": 0.011076701804995537, "vf_explained_var": 0.8531261682510376, "policy_loss": -0.004095721058547497}, "num_steps_sampled": 893782}, "timesteps_total": 893782, "date": "2019-05-24_04-28-49", "episode_reward_mean": -470.35409913735305, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eed68>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee080>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672129, "node_ip": "10.138.0.2", "time_since_restore": 682.8961071968079, "custom_metrics": {"system_level_velocity_max": 18.742226968188437, "cost1_mean": 184.99098396565807, "cost2_max": -24.142257793946346, "outflow_rate_min": 464.52408151712706, "cost2_mean": -103.55996129258365, "cost1_max": 218.32383896069896, "system_level_velocity_min": 12.643893241818235, "cost2_min": -124.1235795461071, "outflow_rate_mean": 1217.0250021939914, "cost1_min": 22.524726344412734, "system_level_velocity_mean": 15.681567009869461, "outflow_rate_max": 1397.4823329026358}, "timesteps_since_restore": 893782, "episode_reward_min": -679.6260407808539}
{"timesteps_this_iter": 41128, "episodes_total": 1062, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 23, "episode_reward_max": -34.05350982223804, "pid": 277, "time_this_iter_s": 30.244054794311523, "time_total_s": 713.1401619911194, "episodes_this_iter": 51, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 23, "episode_len_mean": 320.12, "info": {"grad_time_ms": 10021.338, "update_time_ms": 7.579, "sample_time_ms": 20124.953, "num_steps_trained": 934910, "load_time_ms": 11.95, "default": {"vf_loss": 19.406742095947266, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2499034404754639, "total_loss": 19.405052185058594, "cur_lr": 0.0005000000237487257, "kl": 0.008749092929065228, "vf_explained_var": 0.8696950674057007, "policy_loss": -0.0021295587066560984}, "num_steps_sampled": 934910}, "timesteps_total": 934910, "date": "2019-05-24_04-29-20", "episode_reward_mean": -475.2869893492329, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eee10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee3c8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee2b0>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672160, "node_ip": "10.138.0.2", "time_since_restore": 713.1401619911194, "custom_metrics": {"system_level_velocity_max": 18.742226968188437, "cost1_mean": 185.3715288787464, "cost2_max": -24.142257793946346, "outflow_rate_min": 464.52408151712706, "cost2_mean": -102.43052812626144, "cost1_max": 218.32383896069896, "system_level_velocity_min": 12.18507943231941, "cost2_min": -124.1235795461071, "outflow_rate_mean": 1217.8803923451833, "cost1_min": 22.524726344412734, "system_level_velocity_mean": 15.578104362216939, "outflow_rate_max": 1391.7519583569342}, "timesteps_since_restore": 934910, "episode_reward_min": -758.0880304576655}
{"timesteps_this_iter": 40216, "episodes_total": 1110, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 24, "episode_reward_max": -312.01280108220294, "pid": 277, "time_this_iter_s": 30.676695823669434, "time_total_s": 743.8168578147888, "episodes_this_iter": 48, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 24, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10008.653, "update_time_ms": 7.536, "sample_time_ms": 20210.17, "num_steps_trained": 975126, "load_time_ms": 11.645, "default": {"vf_loss": 19.564565658569336, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2546855211257935, "total_loss": 19.561574935913086, "cur_lr": 0.0005000000237487257, "kl": 0.0092990817502141, "vf_explained_var": 0.8609199523925781, "policy_loss": -0.0034537690225988626}, "num_steps_sampled": 975126}, "timesteps_total": 975126, "date": "2019-05-24_04-29-50", "episode_reward_mean": -481.3274715463117, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e14a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1cf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1940>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672190, "node_ip": "10.138.0.2", "time_since_restore": 743.8168578147888, "custom_metrics": {"system_level_velocity_max": 18.067708078946282, "cost1_mean": 187.0603782502319, "cost2_max": -82.50886354198326, "outflow_rate_min": 1027.197308146399, "cost2_mean": -100.18650315853053, "cost1_max": 215.8803123427345, "system_level_velocity_min": 11.313444999961124, "cost2_min": -116.16483137558431, "outflow_rate_mean": 1220.8165709490088, "cost1_min": 137.3898311703733, "system_level_velocity_mean": 15.441845750575398, "outflow_rate_max": 1387.7802070956247}, "timesteps_since_restore": 975126, "episode_reward_min": -758.0880304576655}
{"timesteps_this_iter": 39692, "episodes_total": 1152, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 25, "episode_reward_max": -32.16256850085504, "pid": 277, "time_this_iter_s": 30.39999294281006, "time_total_s": 774.2168507575989, "episodes_this_iter": 42, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 25, "episode_len_mean": 322.1, "info": {"grad_time_ms": 10113.705, "update_time_ms": 7.396, "sample_time_ms": 20260.819, "num_steps_trained": 1014818, "load_time_ms": 11.839, "default": {"vf_loss": 17.954830169677734, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.224177598953247, "total_loss": 17.953039169311523, "cur_lr": 0.0005000000237487257, "kl": 0.009527371264994144, "vf_explained_var": 0.8713991045951843, "policy_loss": -0.002265324117615819}, "num_steps_sampled": 1014818}, "timesteps_total": 1014818, "date": "2019-05-24_04-30-21", "episode_reward_mean": -468.21507838295366, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1b38>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1eb8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672221, "node_ip": "10.138.0.2", "time_since_restore": 774.2168507575989, "custom_metrics": {"system_level_velocity_max": 18.651864169122288, "cost1_mean": 185.59505214243512, "cost2_max": -24.02589105356643, "outflow_rate_min": 480.192857131199, "cost2_mean": -96.30234937160049, "cost1_max": 215.8803123427345, "system_level_velocity_min": 11.313444999961124, "cost2_min": -112.60215417683335, "outflow_rate_mean": 1211.6433749089608, "cost1_min": 23.173082799018953, "system_level_velocity_mean": 15.476422310493465, "outflow_rate_max": 1381.3179304944392}, "timesteps_since_restore": 1014818, "episode_reward_min": -758.0880304576655}
{"timesteps_this_iter": 39831, "episodes_total": 1203, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 26, "episode_reward_max": -32.16256850085504, "pid": 277, "time_this_iter_s": 30.399522066116333, "time_total_s": 804.6163728237152, "episodes_this_iter": 51, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 26, "episode_len_mean": 322.1, "info": {"grad_time_ms": 10269.944, "update_time_ms": 7.654, "sample_time_ms": 20164.191, "num_steps_trained": 1054649, "load_time_ms": 10.753, "default": {"vf_loss": 19.07555389404297, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.22554612159729, "total_loss": 19.072845458984375, "cur_lr": 0.0005000000237487257, "kl": 0.010690423659980297, "vf_explained_var": 0.8516591787338257, "policy_loss": -0.003243150422349572}, "num_steps_sampled": 1054649}, "timesteps_total": 1054649, "date": "2019-05-24_04-30-51", "episode_reward_mean": -448.2828964732595, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e15f8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e14e0>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672251, "node_ip": "10.138.0.2", "time_since_restore": 804.6163728237152, "custom_metrics": {"system_level_velocity_max": 18.651864169122288, "cost1_mean": 186.170517484706, "cost2_max": -24.02589105356643, "outflow_rate_min": 480.192857131199, "cost2_mean": -90.52799467746335, "cost1_max": 213.33781068226745, "system_level_velocity_min": 11.045901412955441, "cost2_min": -109.60867925101708, "outflow_rate_mean": 1217.1759846181908, "cost1_min": 23.173082799018953, "system_level_velocity_mean": 15.535415553698451, "outflow_rate_max": 1366.3143145161291}, "timesteps_since_restore": 1054649, "episode_reward_min": -671.1805659449802}
{"timesteps_this_iter": 38929, "episodes_total": 1250, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 27, "episode_reward_max": -319.03783797303254, "pid": 277, "time_this_iter_s": 29.763720512390137, "time_total_s": 834.3800933361053, "episodes_this_iter": 47, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 27, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10424.087, "update_time_ms": 7.806, "sample_time_ms": 19932.304, "num_steps_trained": 1093578, "load_time_ms": 11.006, "default": {"vf_loss": 15.99301815032959, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.2321958541870117, "total_loss": 15.990105628967285, "cur_lr": 0.0005000000237487257, "kl": 0.009525583125650883, "vf_explained_var": 0.8765826225280762, "policy_loss": -0.003389407182112336}, "num_steps_sampled": 1093578}, "timesteps_total": 1093578, "date": "2019-05-24_04-31-21", "episode_reward_mean": -456.52592876849553, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee208>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeb00>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672281, "node_ip": "10.138.0.2", "time_since_restore": 834.3800933361053, "custom_metrics": {"system_level_velocity_max": 17.65955136158327, "cost1_mean": 185.031356813895, "cost2_max": -72.46921471424189, "outflow_rate_min": 996.3008470484971, "cost2_mean": -87.96024694803062, "cost1_max": 211.23455945660146, "system_level_velocity_min": 11.045901412955441, "cost2_min": -102.19578151007138, "outflow_rate_mean": 1217.0141850502514, "cost1_min": 134.40497640503267, "system_level_velocity_mean": 15.285014193415737, "outflow_rate_max": 1356.2496279117715}, "timesteps_since_restore": 1093578, "episode_reward_min": -671.1805659449802}
{"timesteps_this_iter": 38180, "episodes_total": 1293, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 28, "episode_reward_max": -33.61250118336808, "pid": 277, "time_this_iter_s": 28.578303575515747, "time_total_s": 862.9583969116211, "episodes_this_iter": 43, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 28, "episode_len_mean": 322.12, "info": {"grad_time_ms": 10427.695, "update_time_ms": 7.708, "sample_time_ms": 19684.874, "num_steps_trained": 1131758, "load_time_ms": 10.94, "default": {"vf_loss": 15.940502166748047, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.2383216619491577, "total_loss": 15.936137199401855, "cur_lr": 0.0005000000237487257, "kl": 0.012901934795081615, "vf_explained_var": 0.862062394618988, "policy_loss": -0.005010392516851425}, "num_steps_sampled": 1131758}, "timesteps_total": 1131758, "date": "2019-05-24_04-31-50", "episode_reward_mean": -444.61559195477787, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9012e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901e80>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672310, "node_ip": "10.138.0.2", "time_since_restore": 862.9583969116211, "custom_metrics": {"system_level_velocity_max": 18.590135791656376, "cost1_mean": 183.18164213699052, "cost2_max": -21.99293114463763, "outflow_rate_min": 503.0980853371426, "cost2_mean": -83.66120702345631, "cost1_max": 208.71194076227852, "system_level_velocity_min": 11.892460370739263, "cost2_min": -99.8351012911241, "outflow_rate_mean": 1205.87918333959, "cost1_min": 24.270818938978863, "system_level_velocity_mean": 15.333714401282418, "outflow_rate_max": 1340.4797526644363}, "timesteps_since_restore": 1131758, "episode_reward_min": -635.198653225086}
{"timesteps_this_iter": 38839, "episodes_total": 1333, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 29, "episode_reward_max": -33.61250118336808, "pid": 277, "time_this_iter_s": 27.50053119659424, "time_total_s": 890.4589281082153, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 29, "episode_len_mean": 322.12, "info": {"grad_time_ms": 10429.571, "update_time_ms": 7.605, "sample_time_ms": 19470.466, "num_steps_trained": 1170597, "load_time_ms": 11.065, "default": {"vf_loss": 15.197850227355957, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.2173664569854736, "total_loss": 15.195740699768066, "cur_lr": 0.0005000000237487257, "kl": 0.012018449604511261, "vf_explained_var": 0.8798691034317017, "policy_loss": -0.002709980821236968}, "num_steps_sampled": 1170597}, "timesteps_total": 1170597, "date": "2019-05-24_04-32-17", "episode_reward_mean": -430.78487708710577, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901cf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901b38>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672337, "node_ip": "10.138.0.2", "time_since_restore": 890.4589281082153, "custom_metrics": {"system_level_velocity_max": 18.590135791656376, "cost1_mean": 185.12731952471498, "cost2_max": -21.99293114463763, "outflow_rate_min": 503.0980853371426, "cost2_mean": -82.14126249626219, "cost1_max": 208.71194076227852, "system_level_velocity_min": 11.892460370739263, "cost2_min": -102.79071179074118, "outflow_rate_mean": 1212.862179408259, "cost1_min": 24.270818938978863, "system_level_velocity_mean": 15.52317562846475, "outflow_rate_max": 1339.262275160257}, "timesteps_since_restore": 1170597, "episode_reward_min": -618.2228391811535}
{"timesteps_this_iter": 38615, "episodes_total": 1390, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 30, "episode_reward_max": -325.67486213051166, "pid": 277, "time_this_iter_s": 28.434703826904297, "time_total_s": 918.8936319351196, "episodes_this_iter": 57, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 30, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10366.754, "update_time_ms": 7.788, "sample_time_ms": 19107.853, "num_steps_trained": 1209212, "load_time_ms": 10.96, "default": {"vf_loss": 17.653316497802734, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.2349317073822021, "total_loss": 17.65130043029785, "cur_lr": 0.0005000000237487257, "kl": 0.011175883002579212, "vf_explained_var": 0.8581445813179016, "policy_loss": -0.002575743244960904}, "num_steps_sampled": 1209212}, "timesteps_total": 1209212, "date": "2019-05-24_04-32-46", "episode_reward_mean": -440.9650888970442, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1470>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672366, "node_ip": "10.138.0.2", "time_since_restore": 918.8936319351196, "custom_metrics": {"system_level_velocity_max": 17.470067132631147, "cost1_mean": 185.16030814476306, "cost2_max": -71.68219977586558, "outflow_rate_min": 1013.9752886356155, "cost2_mean": -83.60838275883472, "cost1_max": 207.2331522435328, "system_level_velocity_min": 11.892460370739263, "cost2_min": -102.79071179074118, "outflow_rate_mean": 1217.3613002754582, "cost1_min": 143.2782573523213, "system_level_velocity_mean": 15.341460156817107, "outflow_rate_max": 1339.262275160257}, "timesteps_since_restore": 1209212, "episode_reward_min": -618.2228391811535}
{"timesteps_this_iter": 38376, "episodes_total": 1433, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 31, "episode_reward_max": -332.6369696740052, "pid": 277, "time_this_iter_s": 28.891840934753418, "time_total_s": 947.785472869873, "episodes_this_iter": 43, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 31, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10324.025, "update_time_ms": 8.036, "sample_time_ms": 19041.316, "num_steps_trained": 1247588, "load_time_ms": 11.419, "default": {"vf_loss": 15.252080917358398, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2330341339111328, "total_loss": 15.248724937438965, "cur_lr": 0.0005000000237487257, "kl": 0.00975597370415926, "vf_explained_var": 0.8758417367935181, "policy_loss": -0.0038438751362264156}, "num_steps_sampled": 1247588}, "timesteps_total": 1247588, "date": "2019-05-24_04-33-15", "episode_reward_mean": -440.40689632100054, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eee80>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee320>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672395, "node_ip": "10.138.0.2", "time_since_restore": 947.785472869873, "custom_metrics": {"system_level_velocity_max": 17.428831702341668, "cost1_mean": 185.6753010122519, "cost2_max": -71.68219977586558, "outflow_rate_min": 1107.722089728453, "cost2_mean": -84.60687768621021, "cost1_max": 206.57039619747135, "system_level_velocity_min": 12.211057620567399, "cost2_min": -104.3627730984064, "outflow_rate_mean": 1220.5906363446975, "cost1_min": 150.20472374499832, "system_level_velocity_mean": 15.397221352145225, "outflow_rate_max": 1339.2521045808119}, "timesteps_since_restore": 1247588, "episode_reward_min": -585.1126603235273}
{"timesteps_this_iter": 38850, "episodes_total": 1473, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 32, "episode_reward_max": -330.0154202467828, "pid": 277, "time_this_iter_s": 27.80082893371582, "time_total_s": 975.5863018035889, "episodes_this_iter": 40, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 32, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10249.088, "update_time_ms": 8.176, "sample_time_ms": 18911.689, "num_steps_trained": 1286438, "load_time_ms": 11.101, "default": {"vf_loss": 16.386857986450195, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.2426565885543823, "total_loss": 16.384004592895508, "cur_lr": 0.0005000000237487257, "kl": 0.011793842539191246, "vf_explained_var": 0.8665070533752441, "policy_loss": -0.0034427905920892954}, "num_steps_sampled": 1286438}, "timesteps_total": 1286438, "date": "2019-05-24_04-33-42", "episode_reward_mean": -430.64235332534366, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f19b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f16d8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672422, "node_ip": "10.138.0.2", "time_since_restore": 975.5863018035889, "custom_metrics": {"system_level_velocity_max": 17.437633339168887, "cost1_mean": 188.49192821799278, "cost2_max": -70.8049686736132, "outflow_rate_min": 1104.4489943276094, "cost2_mean": -85.39671682039139, "cost1_max": 206.57039619747135, "system_level_velocity_min": 13.244364729541333, "cost2_min": -104.3627730984064, "outflow_rate_mean": 1231.3317533028114, "cost1_min": 161.86054371686828, "system_level_velocity_mean": 15.647336973589455, "outflow_rate_max": 1339.2521045808119}, "timesteps_since_restore": 1286438, "episode_reward_min": -585.1126603235273}
{"timesteps_this_iter": 38578, "episodes_total": 1528, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 33, "episode_reward_max": -321.11353543523904, "pid": 277, "time_this_iter_s": 30.012967109680176, "time_total_s": 1005.599268913269, "episodes_this_iter": 55, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 33, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10314.058, "update_time_ms": 8.381, "sample_time_ms": 18822.553, "num_steps_trained": 1325016, "load_time_ms": 10.791, "default": {"vf_loss": 18.416921615600586, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.2208086252212524, "total_loss": 18.41335105895996, "cur_lr": 0.0005000000237487257, "kl": 0.010182038880884647, "vf_explained_var": 0.8467504382133484, "policy_loss": -0.0040771751664578915}, "num_steps_sampled": 1325016}, "timesteps_total": 1325016, "date": "2019-05-24_04-34-13", "episode_reward_mean": -437.2830036352376, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901c18>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9016d8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672453, "node_ip": "10.138.0.2", "time_since_restore": 1005.599268913269, "custom_metrics": {"system_level_velocity_max": 17.601733460483295, "cost1_mean": 186.75879007587983, "cost2_max": -70.8049686736132, "outflow_rate_min": 921.4096742976815, "cost2_mean": -85.36906337840485, "cost1_max": 209.10269655225258, "system_level_velocity_min": 11.097543864145146, "cost2_min": -105.7629920177899, "outflow_rate_mean": 1223.4963788399407, "cost1_min": 134.92913676533638, "system_level_velocity_mean": 15.5000682969427, "outflow_rate_max": 1338.766292870826}, "timesteps_since_restore": 1325016, "episode_reward_min": -661.9207364516078}
{"timesteps_this_iter": 38587, "episodes_total": 1573, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 34, "episode_reward_max": -200.4382237718358, "pid": 277, "time_this_iter_s": 29.17332410812378, "time_total_s": 1034.7725930213928, "episodes_this_iter": 45, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 34, "episode_len_mean": 323.82, "info": {"grad_time_ms": 10363.981, "update_time_ms": 8.607, "sample_time_ms": 18621.161, "num_steps_trained": 1363603, "load_time_ms": 10.329, "default": {"vf_loss": 17.497604370117188, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.2226200103759766, "total_loss": 17.495542526245117, "cur_lr": 0.0005000000237487257, "kl": 0.012134050950407982, "vf_explained_var": 0.8524811863899231, "policy_loss": -0.00266799028031528}, "num_steps_sampled": 1363603}, "timesteps_total": 1363603, "date": "2019-05-24_04-34-42", "episode_reward_mean": -445.46598283412067, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee630>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee1d0>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672482, "node_ip": "10.138.0.2", "time_since_restore": 1034.7725930213928, "custom_metrics": {"system_level_velocity_max": 17.90206400653186, "cost1_mean": 183.30998879460248, "cost2_max": -74.17997472299618, "outflow_rate_min": 921.4096742976815, "cost2_mean": -84.13154750532881, "cost1_max": 209.10269655225258, "system_level_velocity_min": 11.097543864145146, "cost2_min": -105.7629920177899, "outflow_rate_mean": 1206.2969537127992, "cost1_min": 134.92913676533638, "system_level_velocity_mean": 15.265492417738463, "outflow_rate_max": 1338.766292870826}, "timesteps_since_restore": 1363603, "episode_reward_min": -661.9207364516078}
{"timesteps_this_iter": 38703, "episodes_total": 1614, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 35, "episode_reward_max": -200.4382237718358, "pid": 277, "time_this_iter_s": 29.709415197372437, "time_total_s": 1064.4820082187653, "episodes_this_iter": 41, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 35, "episode_len_mean": 323.54, "info": {"grad_time_ms": 10439.068, "update_time_ms": 8.817, "sample_time_ms": 18478.112, "num_steps_trained": 1402306, "load_time_ms": 9.459, "default": {"vf_loss": 15.519682884216309, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2155687808990479, "total_loss": 15.517020225524902, "cur_lr": 0.0005000000237487257, "kl": 0.011594022624194622, "vf_explained_var": 0.8783645033836365, "policy_loss": -0.003242387203499675}, "num_steps_sampled": 1402306}, "timesteps_total": 1402306, "date": "2019-05-24_04-35-11", "episode_reward_mean": -437.5291437294626, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eec50>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672511, "node_ip": "10.138.0.2", "time_since_restore": 1064.4820082187653, "custom_metrics": {"system_level_velocity_max": 17.90206400653186, "cost1_mean": 184.91017611663844, "cost2_max": -74.17997472299618, "outflow_rate_min": 921.4096742976815, "cost2_mean": -84.31632040970493, "cost1_max": 210.6359795214185, "system_level_velocity_min": 11.097543864145146, "cost2_min": -96.39045455406122, "outflow_rate_mean": 1213.9065327103738, "cost1_min": 134.92913676533638, "system_level_velocity_mean": 15.432025973304146, "outflow_rate_max": 1344.6765780066303}, "timesteps_since_restore": 1402306, "episode_reward_min": -661.9207364516078}
{"timesteps_this_iter": 39018, "episodes_total": 1666, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 36, "episode_reward_max": -117.79928753728242, "pid": 277, "time_this_iter_s": 29.57876944541931, "time_total_s": 1094.0607776641846, "episodes_this_iter": 52, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 36, "episode_len_mean": 320.36, "info": {"grad_time_ms": 10363.626, "update_time_ms": 9.022, "sample_time_ms": 18472.425, "num_steps_trained": 1441324, "load_time_ms": 9.506, "default": {"vf_loss": 19.316272735595703, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.2004884481430054, "total_loss": 19.311128616333008, "cur_lr": 0.0005000000237487257, "kl": 0.013030383735895157, "vf_explained_var": 0.8568831086158752, "policy_loss": -0.005795198027044535}, "num_steps_sampled": 1441324}, "timesteps_total": 1441324, "date": "2019-05-24_04-35-41", "episode_reward_mean": -433.03977277988525, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f18d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f15c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f16d8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672541, "node_ip": "10.138.0.2", "time_since_restore": 1094.0607776641846, "custom_metrics": {"system_level_velocity_max": 18.302609275145027, "cost1_mean": 185.37866754315183, "cost2_max": -55.086243569956906, "outflow_rate_min": 799.7162837053303, "cost2_mean": -87.69451317903004, "cost1_max": 211.62658964047608, "system_level_velocity_min": 11.721878580828667, "cost2_min": -106.11301528642865, "outflow_rate_mean": 1218.4842191650437, "cost1_min": 83.06567626849689, "system_level_velocity_mean": 15.647206991152418, "outflow_rate_max": 1371.2890273497685}, "timesteps_since_restore": 1441324, "episode_reward_min": -729.1226903747056}
{"timesteps_this_iter": 39097, "episodes_total": 1713, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 37, "episode_reward_max": -117.79928753728242, "pid": 277, "time_this_iter_s": 29.44721508026123, "time_total_s": 1123.5079927444458, "episodes_this_iter": 47, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 37, "episode_len_mean": 320.44, "info": {"grad_time_ms": 10281.664, "update_time_ms": 8.876, "sample_time_ms": 18522.485, "num_steps_trained": 1480421, "load_time_ms": 9.364, "default": {"vf_loss": 18.122085571289062, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.183890700340271, "total_loss": 18.118534088134766, "cur_lr": 0.0005000000237487257, "kl": 0.012663590721786022, "vf_explained_var": 0.8597832322120667, "policy_loss": -0.004184620454907417}, "num_steps_sampled": 1480421}, "timesteps_total": 1480421, "date": "2019-05-24_04-36-11", "episode_reward_mean": -442.3622103707185, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901860>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9019e8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672571, "node_ip": "10.138.0.2", "time_since_restore": 1123.5079927444458, "custom_metrics": {"system_level_velocity_max": 18.302609275145027, "cost1_mean": 183.83968501554392, "cost2_max": -55.086243569956906, "outflow_rate_min": 799.7162837053303, "cost2_mean": -89.71492051532627, "cost1_max": 212.17195306822987, "system_level_velocity_min": 11.721878580828667, "cost2_min": -106.11301528642865, "outflow_rate_mean": 1217.8401573853455, "cost1_min": 83.06567626849689, "system_level_velocity_mean": 15.48935138477154, "outflow_rate_max": 1371.2890273497685}, "timesteps_since_restore": 1480421, "episode_reward_min": -729.1226903747056}
{"timesteps_this_iter": 40362, "episodes_total": 1758, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 38, "episode_reward_max": -33.02617793990251, "pid": 277, "time_this_iter_s": 30.300153255462646, "time_total_s": 1153.8081459999084, "episodes_this_iter": 45, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 38, "episode_len_mean": 319.82, "info": {"grad_time_ms": 10188.119, "update_time_ms": 9.107, "sample_time_ms": 18787.905, "num_steps_trained": 1520783, "load_time_ms": 9.32, "default": {"vf_loss": 20.437255859375, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.1624419689178467, "total_loss": 20.433469772338867, "cur_lr": 0.0005000000237487257, "kl": 0.011438379995524883, "vf_explained_var": 0.8585905432701111, "policy_loss": -0.0043586185202002525}, "num_steps_sampled": 1520783}, "timesteps_total": 1520783, "date": "2019-05-24_04-36-41", "episode_reward_mean": -453.090471424802, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eec50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eee80>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672601, "node_ip": "10.138.0.2", "time_since_restore": 1153.8081459999084, "custom_metrics": {"system_level_velocity_max": 18.444646194906856, "cost1_mean": 182.25505086762257, "cost2_max": -24.04198700092238, "outflow_rate_min": 463.7321904813336, "cost2_mean": -91.59086940800745, "cost1_max": 212.85136811742433, "system_level_velocity_min": 12.499169935878534, "cost2_min": -110.32954057055164, "outflow_rate_mean": 1212.9399899048788, "cost1_min": 22.948328421654328, "system_level_velocity_mean": 15.371063868866015, "outflow_rate_max": 1378.7560546301784}, "timesteps_since_restore": 1520783, "episode_reward_min": -630.9226624792691}
{"timesteps_this_iter": 39363, "episodes_total": 1808, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 39, "episode_reward_max": -33.02617793990251, "pid": 277, "time_this_iter_s": 30.365386486053467, "time_total_s": 1184.173532485962, "episodes_this_iter": 50, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 39, "episode_len_mean": 319.74, "info": {"grad_time_ms": 10085.018, "update_time_ms": 9.384, "sample_time_ms": 19174.482, "num_steps_trained": 1560146, "load_time_ms": 9.84, "default": {"vf_loss": 24.004743576049805, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1602810621261597, "total_loss": 24.00052833557129, "cur_lr": 0.0005000000237487257, "kl": 0.01353793777525425, "vf_explained_var": 0.819851279258728, "policy_loss": -0.004891728516668081}, "num_steps_sampled": 1560146}, "timesteps_total": 1560146, "date": "2019-05-24_04-37-11", "episode_reward_mean": -460.2017433827142, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb1d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebeb8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672631, "node_ip": "10.138.0.2", "time_since_restore": 1184.173532485962, "custom_metrics": {"system_level_velocity_max": 18.444646194906856, "cost1_mean": 181.2546857309234, "cost2_max": -24.04198700092238, "outflow_rate_min": 463.7321904813336, "cost2_mean": -92.09653109974343, "cost1_max": 217.98039063586106, "system_level_velocity_min": 12.499169935878534, "cost2_min": -110.32954057055164, "outflow_rate_mean": 1206.9708600214926, "cost1_min": 22.948328421654328, "system_level_velocity_mean": 15.277257797331046, "outflow_rate_max": 1416.1996214949393}, "timesteps_since_restore": 1560146, "episode_reward_min": -630.9226624792691}
{"timesteps_this_iter": 39360, "episodes_total": 1854, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 40, "episode_reward_max": -32.90852108520534, "pid": 277, "time_this_iter_s": 30.207061052322388, "time_total_s": 1214.3805935382843, "episodes_this_iter": 46, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 40, "episode_len_mean": 316.86, "info": {"grad_time_ms": 10064.918, "update_time_ms": 9.299, "sample_time_ms": 19374.193, "num_steps_trained": 1599506, "load_time_ms": 9.418, "default": {"vf_loss": 21.008220672607422, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1347801685333252, "total_loss": 21.0046443939209, "cur_lr": 0.0005000000237487257, "kl": 0.01395558100193739, "vf_explained_var": 0.8476192951202393, "policy_loss": -0.004274510312825441}, "num_steps_sampled": 1599506}, "timesteps_total": 1599506, "date": "2019-05-24_04-37-42", "episode_reward_mean": -447.11004631965346, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9019b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901b00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901d68>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672662, "node_ip": "10.138.0.2", "time_since_restore": 1214.3805935382843, "custom_metrics": {"system_level_velocity_max": 18.694032096907033, "cost1_mean": 179.6249659662222, "cost2_max": -22.750970424223407, "outflow_rate_min": 471.8345490104016, "cost2_mean": -88.27205073240266, "cost1_max": 217.98039063586106, "system_level_velocity_min": 11.885464041092353, "cost2_min": -107.71380079432083, "outflow_rate_mean": 1197.7453872371616, "cost1_min": 22.983643808389658, "system_level_velocity_mean": 15.322305543773668, "outflow_rate_max": 1416.1996214949393}, "timesteps_since_restore": 1599506, "episode_reward_min": -700.0364031235395}
{"timesteps_this_iter": 40158, "episodes_total": 1897, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 41, "episode_reward_max": -32.90852108520534, "pid": 277, "time_this_iter_s": 29.7658851146698, "time_total_s": 1244.146478652954, "episodes_this_iter": 43, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 41, "episode_len_mean": 319.04, "info": {"grad_time_ms": 10115.69, "update_time_ms": 9.226, "sample_time_ms": 19414.146, "num_steps_trained": 1639664, "load_time_ms": 8.74, "default": {"vf_loss": 18.16360092163086, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.1376208066940308, "total_loss": 18.159500122070312, "cur_lr": 0.0005000000237487257, "kl": 0.014274612069129944, "vf_explained_var": 0.8695240020751953, "policy_loss": -0.004815379623323679}, "num_steps_sampled": 1639664}, "timesteps_total": 1639664, "date": "2019-05-24_04-38-11", "episode_reward_mean": -459.5323994036624, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee5f8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eec50>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672691, "node_ip": "10.138.0.2", "time_since_restore": 1244.146478652954, "custom_metrics": {"system_level_velocity_max": 18.694032096907033, "cost1_mean": 178.7340248370479, "cost2_max": -22.750970424223407, "outflow_rate_min": 471.8345490104016, "cost2_mean": -88.14105686886967, "cost1_max": 214.0739452248192, "system_level_velocity_min": 11.76747450169613, "cost2_min": -107.71380079432083, "outflow_rate_mean": 1192.1617834744202, "cost1_min": 22.983643808389658, "system_level_velocity_mean": 15.106355312869777, "outflow_rate_max": 1398.532835005903}, "timesteps_since_restore": 1639664, "episode_reward_min": -700.0364031235395}
{"timesteps_this_iter": 39881, "episodes_total": 1941, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 42, "episode_reward_max": -33.721175123059844, "pid": 277, "time_this_iter_s": 29.39391040802002, "time_total_s": 1273.5403890609741, "episodes_this_iter": 44, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 42, "episode_len_mean": 321.94, "info": {"grad_time_ms": 10160.671, "update_time_ms": 9.319, "sample_time_ms": 19526.752, "num_steps_trained": 1679545, "load_time_ms": 10.081, "default": {"vf_loss": 21.620927810668945, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.129541277885437, "total_loss": 21.616315841674805, "cur_lr": 0.0005000000237487257, "kl": 0.013883541338145733, "vf_explained_var": 0.8496137857437134, "policy_loss": -0.0053057256154716015}, "num_steps_sampled": 1679545}, "timesteps_total": 1679545, "date": "2019-05-24_04-38-41", "episode_reward_mean": -466.4835170792477, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb208>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb00>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672721, "node_ip": "10.138.0.2", "time_since_restore": 1273.5403890609741, "custom_metrics": {"system_level_velocity_max": 18.694032096907033, "cost1_mean": 180.52396565013936, "cost2_max": -22.750970424223407, "outflow_rate_min": 492.95596726901135, "cost2_mean": -89.8581607160512, "cost1_max": 214.0739452248192, "system_level_velocity_min": 11.76747450169613, "cost2_min": -105.05934251771336, "outflow_rate_mean": 1199.808551882129, "cost1_min": 24.403150496740864, "system_level_velocity_mean": 15.074806740014457, "outflow_rate_max": 1398.532835005903}, "timesteps_since_restore": 1679545, "episode_reward_min": -652.1694219545635}
{"timesteps_this_iter": 39454, "episodes_total": 1994, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 43, "episode_reward_max": -318.4555171102929, "pid": 277, "time_this_iter_s": 29.49314546585083, "time_total_s": 1303.033534526825, "episodes_this_iter": 53, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 43, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10107.344, "update_time_ms": 9.327, "sample_time_ms": 19530.41, "num_steps_trained": 1718999, "load_time_ms": 10.207, "default": {"vf_loss": 15.885481834411621, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.139795184135437, "total_loss": 15.88169002532959, "cur_lr": 0.0005000000237487257, "kl": 0.01239905133843422, "vf_explained_var": 0.889345645904541, "policy_loss": -0.00441358657553792}, "num_steps_sampled": 1718999}, "timesteps_total": 1718999, "date": "2019-05-24_04-39-10", "episode_reward_mean": -471.65948129427466, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f16a0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1438>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672750, "node_ip": "10.138.0.2", "time_since_restore": 1303.033534526825, "custom_metrics": {"system_level_velocity_max": 18.147499008519468, "cost1_mean": 183.07605820701895, "cost2_max": -74.80174814641961, "outflow_rate_min": 992.9024839532586, "cost2_mean": -91.03035533276383, "cost1_max": 216.930282964705, "system_level_velocity_min": 11.76747450169613, "cost2_min": -105.05934251771336, "outflow_rate_mean": 1210.2310217245513, "cost1_min": 141.70198485482385, "system_level_velocity_mean": 15.124254855759364, "outflow_rate_max": 1418.3966317742475}, "timesteps_since_restore": 1718999, "episode_reward_min": -652.1694219545635}
{"timesteps_this_iter": 39128, "episodes_total": 2038, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 44, "episode_reward_max": -119.49232553016674, "pid": 277, "time_this_iter_s": 29.1702241897583, "time_total_s": 1332.2037587165833, "episodes_this_iter": 44, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 44, "episode_len_mean": 319.92, "info": {"grad_time_ms": 10013.315, "update_time_ms": 9.118, "sample_time_ms": 19625.294, "num_steps_trained": 1758127, "load_time_ms": 10.714, "default": {"vf_loss": 18.234556198120117, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.1539757251739502, "total_loss": 18.23043441772461, "cur_lr": 0.0005000000237487257, "kl": 0.01317511685192585, "vf_explained_var": 0.8745271563529968, "policy_loss": -0.004781312309205532}, "num_steps_sampled": 1758127}, "timesteps_total": 1758127, "date": "2019-05-24_04-39-40", "episode_reward_mean": -457.12180876155514, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6838d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683780>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672780, "node_ip": "10.138.0.2", "time_since_restore": 1332.2037587165833, "custom_metrics": {"system_level_velocity_max": 18.311636095694723, "cost1_mean": 181.89160007748654, "cost2_max": -57.8569241069368, "outflow_rate_min": 785.9646521584474, "cost2_mean": -89.47925946287961, "cost1_max": 216.930282964705, "system_level_velocity_min": 11.881914321496064, "cost2_min": -102.69106205521611, "outflow_rate_mean": 1205.5959514180533, "cost1_min": 83.59997775713073, "system_level_velocity_mean": 15.336961002564024, "outflow_rate_max": 1418.3966317742475}, "timesteps_since_restore": 1758127, "episode_reward_min": -598.3383194688729}
{"timesteps_this_iter": 39210, "episodes_total": 2084, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 45, "episode_reward_max": -104.82029970415351, "pid": 277, "time_this_iter_s": 28.76499605178833, "time_total_s": 1360.9687547683716, "episodes_this_iter": 46, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 45, "episode_len_mean": 317.66, "info": {"grad_time_ms": 9813.658, "update_time_ms": 8.925, "sample_time_ms": 19733.023, "num_steps_trained": 1797337, "load_time_ms": 10.754, "default": {"vf_loss": 16.502084732055664, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1630440950393677, "total_loss": 16.496049880981445, "cur_lr": 0.0005000000237487257, "kl": 0.01778760366141796, "vf_explained_var": 0.8840164542198181, "policy_loss": -0.006924884859472513}, "num_steps_sampled": 1797337}, "timesteps_total": 1797337, "date": "2019-05-24_04-40-08", "episode_reward_mean": -448.0907395265103, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1b00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683470>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672808, "node_ip": "10.138.0.2", "time_since_restore": 1360.9687547683716, "custom_metrics": {"system_level_velocity_max": 18.311636095694723, "cost1_mean": 180.97238208527557, "cost2_max": -51.81487230537079, "outflow_rate_min": 759.9117570566013, "cost2_mean": -88.38660796742096, "cost1_max": 216.930282964705, "system_level_velocity_min": 11.881914321496064, "cost2_min": -104.28052461360461, "outflow_rate_mean": 1201.7436145575791, "cost1_min": 77.75836494589937, "system_level_velocity_mean": 15.394491721230663, "outflow_rate_max": 1405.8009179387286}, "timesteps_since_restore": 1797337, "episode_reward_min": -667.4068618396426}
{"timesteps_this_iter": 38634, "episodes_total": 2134, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 46, "episode_reward_max": -104.82029970415351, "pid": 277, "time_this_iter_s": 29.42044496536255, "time_total_s": 1390.3891997337341, "episodes_this_iter": 50, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 46, "episode_len_mean": 319.64, "info": {"grad_time_ms": 9734.85, "update_time_ms": 8.427, "sample_time_ms": 19796.499, "num_steps_trained": 1835971, "load_time_ms": 10.816, "default": {"vf_loss": 18.68411636352539, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.1600589752197266, "total_loss": 18.680072784423828, "cur_lr": 0.0005000000237487257, "kl": 0.016622887924313545, "vf_explained_var": 0.864084005355835, "policy_loss": -0.00487506715580821}, "num_steps_sampled": 1835971}, "timesteps_total": 1835971, "date": "2019-05-24_04-40-38", "episode_reward_mean": -442.5620696543517, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac400>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac8d0>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672838, "node_ip": "10.138.0.2", "time_since_restore": 1390.3891997337341, "custom_metrics": {"system_level_velocity_max": 18.572777570205204, "cost1_mean": 183.78540066867063, "cost2_max": -51.81487230537079, "outflow_rate_min": 759.9117570566013, "cost2_mean": -89.00398447132933, "cost1_max": 219.25221824396624, "system_level_velocity_min": 11.570113389686416, "cost2_min": -106.33173949682929, "outflow_rate_mean": 1215.5479523835659, "cost1_min": 77.75836494589937, "system_level_velocity_mean": 15.540468838780923, "outflow_rate_max": 1418.840648166057}, "timesteps_since_restore": 1835971, "episode_reward_min": -667.4068618396426}
{"timesteps_this_iter": 38309, "episodes_total": 2178, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 47, "episode_reward_max": -103.38701880451444, "pid": 277, "time_this_iter_s": 48.82506084442139, "time_total_s": 1439.2142605781555, "episodes_this_iter": 44, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 47, "episode_len_mean": 320.64, "info": {"grad_time_ms": 10312.729, "update_time_ms": 8.505, "sample_time_ms": 21138.604, "num_steps_trained": 1874280, "load_time_ms": 11.766, "default": {"vf_loss": 19.920888900756836, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1829577684402466, "total_loss": 19.91648292541504, "cur_lr": 0.0005000000237487257, "kl": 0.013407062739133835, "vf_explained_var": 0.8572009205818176, "policy_loss": -0.005075997672975063}, "num_steps_sampled": 1874280}, "timesteps_total": 1874280, "date": "2019-05-24_04-41-27", "episode_reward_mean": -426.49706304859063, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f13c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1828>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f10f0>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672887, "node_ip": "10.138.0.2", "time_since_restore": 1439.2142605781555, "custom_metrics": {"system_level_velocity_max": 18.809334521674657, "cost1_mean": 187.10341862426142, "cost2_max": -56.73101098039526, "outflow_rate_min": 778.4662223586835, "cost2_mean": -89.97817172349825, "cost1_max": 219.25221824396624, "system_level_velocity_min": 11.570113389686416, "cost2_min": -106.33173949682929, "outflow_rate_mean": 1235.2129224950177, "cost1_min": 80.3802615098915, "system_level_velocity_mean": 15.780805252533275, "outflow_rate_max": 1418.840648166057}, "timesteps_since_restore": 1874280, "episode_reward_min": -600.4996968242289}
{"timesteps_this_iter": 39299, "episodes_total": 2226, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 48, "episode_reward_max": -33.290789411961214, "pid": 277, "time_this_iter_s": 34.43613934516907, "time_total_s": 1473.6503999233246, "episodes_this_iter": 48, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 48, "episode_len_mean": 319.74, "info": {"grad_time_ms": 10420.219, "update_time_ms": 13.187, "sample_time_ms": 21438.47, "num_steps_trained": 1913579, "load_time_ms": 11.886, "default": {"vf_loss": 19.070117950439453, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1481069326400757, "total_loss": 19.06614112854004, "cur_lr": 0.0005000000237487257, "kl": 0.014317426830530167, "vf_explained_var": 0.8641842603683472, "policy_loss": -0.004692625720053911}, "num_steps_sampled": 1913579}, "timesteps_total": 1913579, "date": "2019-05-24_04-42-01", "episode_reward_mean": -433.69812131391075, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3874a8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4128>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672921, "node_ip": "10.138.0.2", "time_since_restore": 1473.6503999233246, "custom_metrics": {"system_level_velocity_max": 18.809334521674657, "cost1_mean": 184.91229511367277, "cost2_max": -25.084308080905313, "outflow_rate_min": 462.43348918263234, "cost2_mean": -89.99741944406354, "cost1_max": 216.77065057945356, "system_level_velocity_min": 12.231868752583507, "cost2_min": -104.75098035705048, "outflow_rate_mean": 1223.3261253590722, "cost1_min": 22.966175546767637, "system_level_velocity_mean": 15.651680900584019, "outflow_rate_max": 1414.422752463054}, "timesteps_since_restore": 1913579, "episode_reward_min": -636.9434932442883}
{"timesteps_this_iter": 39191, "episodes_total": 2274, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 49, "episode_reward_max": -33.290789411961214, "pid": 277, "time_this_iter_s": 28.784465074539185, "time_total_s": 1502.4348649978638, "episodes_this_iter": 48, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 49, "episode_len_mean": 321.82, "info": {"grad_time_ms": 10562.817, "update_time_ms": 12.913, "sample_time_ms": 21138.009, "num_steps_trained": 1952770, "load_time_ms": 11.879, "default": {"vf_loss": 20.198715209960938, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1331582069396973, "total_loss": 20.19589614868164, "cur_lr": 0.0005000000237487257, "kl": 0.013676208443939686, "vf_explained_var": 0.8580476641654968, "policy_loss": -0.003503201762214303}, "num_steps_sampled": 1952770}, "timesteps_total": 1952770, "date": "2019-05-24_04-42-30", "episode_reward_mean": -454.4513466676323, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac860>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac7b8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672950, "node_ip": "10.138.0.2", "time_since_restore": 1502.4348649978638, "custom_metrics": {"system_level_velocity_max": 18.378600599927953, "cost1_mean": 182.59024964202754, "cost2_max": -25.084308080905313, "outflow_rate_min": 462.43348918263234, "cost2_mean": -89.90579021060812, "cost1_max": 217.98575201536042, "system_level_velocity_min": 12.231868752583507, "cost2_min": -103.89951795060854, "outflow_rate_mean": 1207.8420099181858, "cost1_min": 22.966175546767637, "system_level_velocity_mean": 15.307060699861193, "outflow_rate_max": 1410.1755962730351}, "timesteps_since_restore": 1952770, "episode_reward_min": -636.9434932442883}
{"timesteps_this_iter": 38684, "episodes_total": 2319, "done": true, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 50, "episode_reward_max": -310.71921422049155, "pid": 277, "time_this_iter_s": 28.79003071784973, "time_total_s": 1531.2248957157135, "episodes_this_iter": 45, "experiment_id": "185dd0192b4647d6b25d803f3a2694fe", "iterations_since_restore": 50, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10684.911, "update_time_ms": 12.997, "sample_time_ms": 20871.233, "num_steps_trained": 1991454, "load_time_ms": 12.861, "default": {"vf_loss": 19.33018684387207, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1228643655776978, "total_loss": 19.324806213378906, "cur_lr": 0.0005000000237487257, "kl": 0.015254996716976166, "vf_explained_var": 0.8629545569419861, "policy_loss": -0.006142488215118647}, "num_steps_sampled": 1991454}, "timesteps_total": 1991454, "date": "2019-05-24_04-42-59", "episode_reward_mean": -447.2808831705781, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6839b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683ac8>", "on_sample_end": null}, "train_batch_size": 15000, "num_gpus_per_worker": 0, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_use_prev_action_reward": false, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "lambda": 0.97, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672979, "node_ip": "10.138.0.2", "time_since_restore": 1531.2248957157135, "custom_metrics": {"system_level_velocity_max": 18.386168250284303, "cost1_mean": 186.4069174876071, "cost2_max": -80.64666723614475, "outflow_rate_min": 1039.8878269286108, "cost2_mean": -91.09542014718303, "cost1_max": 218.94284258308426, "system_level_velocity_min": 12.202204626888646, "cost2_min": -104.25407000823938, "outflow_rate_mean": 1229.1793934299237, "cost1_min": 147.23186284462986, "system_level_velocity_mean": 15.44364404313125, "outflow_rate_max": 1410.8918965517234}, "timesteps_since_restore": 1991454, "episode_reward_min": -614.7671993573813}

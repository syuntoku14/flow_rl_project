{"timesteps_this_iter": 41846, "episodes_total": 40, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 1, "episode_reward_max": -499.2054383613711, "pid": 292, "time_this_iter_s": 81.39748764038086, "time_total_s": 81.39748764038086, "episodes_this_iter": 40, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 1, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10865.093, "update_time_ms": 2577.441, "sample_time_ms": 67722.235, "num_steps_trained": 41846, "num_steps_sampled": 41846, "default": {"vf_loss": 36.968265533447266, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.000670884270220995, "total_loss": 36.96797180175781, "cur_lr": 0.0005000000237487257, "kl": 0.0018618132453411818, "entropy": 1.4164360761642456, "vf_explained_var": -3.3438936952734366e-06}, "load_time_ms": 83.158}, "timesteps_total": 41846, "date": "2019-05-24_04-42-15", "episode_reward_mean": -717.0873482396855, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9019e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901d68>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672935, "node_ip": "10.138.0.2", "time_since_restore": 81.39748764038086, "custom_metrics": {"system_level_velocity_max": 12.09435194532119, "cost1_mean": 123.62587977111623, "cost1_min": 108.55109352273357, "cost1_max": 144.89396230812076, "cost2_mean": -49.1851031528539, "outflow_rate_min": 679.6555927889716, "system_level_velocity_min": 8.958430996855837, "cost2_min": -73.8024906865496, "outflow_rate_mean": 740.26823053651, "cost2_max": -28.18483637524539, "system_level_velocity_mean": 10.251847022314356, "outflow_rate_max": 965.0331707317068}, "timesteps_since_restore": 41846, "episode_reward_min": -924.3833401834553}
{"timesteps_this_iter": 43195, "episodes_total": 80, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 2, "episode_reward_max": -499.2054383613711, "pid": 292, "time_this_iter_s": 29.00833010673523, "time_total_s": 110.40581774711609, "episodes_this_iter": 40, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 2, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10631.747, "update_time_ms": 1293.894, "sample_time_ms": 43107.866, "num_steps_trained": 85041, "num_steps_sampled": 85041, "default": {"vf_loss": 37.6032600402832, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0010522354859858751, "total_loss": 37.6025505065918, "cur_lr": 0.0005000000237487257, "kl": 0.003452741075307131, "entropy": 1.4025473594665527, "vf_explained_var": 0.3735879361629486}, "load_time_ms": 44.702}, "timesteps_total": 85041, "date": "2019-05-24_04-42-44", "episode_reward_mean": -711.5356495084613, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb4e0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb38>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672964, "node_ip": "10.138.0.2", "time_since_restore": 110.40581774711609, "custom_metrics": {"system_level_velocity_max": 12.106934233850193, "cost1_mean": 124.93252187007859, "cost1_min": 102.05654099093788, "cost1_max": 148.1162043878321, "cost2_mean": -50.35053211864616, "outflow_rate_min": 486.204923076923, "system_level_velocity_min": 8.499646480671998, "cost2_min": -76.18659618506656, "outflow_rate_mean": 760.3988578179022, "cost2_max": -28.18483637524539, "system_level_velocity_mean": 10.353569082571056, "outflow_rate_max": 965.0331707317068}, "timesteps_since_restore": 85041, "episode_reward_min": -924.3833401834553}
{"timesteps_this_iter": 45800, "episodes_total": 120, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 3, "episode_reward_max": -509.57174764636875, "pid": 292, "time_this_iter_s": 30.009265899658203, "time_total_s": 140.4150836467743, "episodes_this_iter": 40, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 3, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10763.925, "update_time_ms": 865.923, "sample_time_ms": 35035.286, "num_steps_trained": 130841, "num_steps_sampled": 130841, "default": {"vf_loss": 47.77511215209961, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0019223723793402314, "total_loss": 47.77356719970703, "cur_lr": 0.0005000000237487257, "kl": 0.007622537203133106, "entropy": 1.3821101188659668, "vf_explained_var": 0.5729638338088989}, "load_time_ms": 30.881}, "timesteps_total": 130841, "date": "2019-05-24_04-43-14", "episode_reward_mean": -705.6056511272308, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac390>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac518>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558672994, "node_ip": "10.138.0.2", "time_since_restore": 140.4150836467743, "custom_metrics": {"system_level_velocity_max": 12.842563163576214, "cost1_mean": 127.97622777061629, "cost1_min": 102.05654099093788, "cost1_max": 159.88987551930853, "cost2_mean": -53.011496927690224, "outflow_rate_min": 486.204923076923, "system_level_velocity_min": 8.499646480671998, "cost2_min": -94.45669089123354, "outflow_rate_mean": 793.8593685120608, "cost2_max": -29.56878195224477, "system_level_velocity_mean": 10.582004999697041, "outflow_rate_max": 1052.864419563254}, "timesteps_since_restore": 130841, "episode_reward_min": -898.6828948080531}
{"timesteps_this_iter": 42635, "episodes_total": 181, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 4, "episode_reward_max": -25.153418988203896, "pid": 292, "time_this_iter_s": 31.242369651794434, "time_total_s": 171.65745329856873, "episodes_this_iter": 61, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 4, "episode_len_mean": 322.03, "info": {"grad_time_ms": 10416.135, "update_time_ms": 651.495, "sample_time_ms": 31721.377, "num_steps_trained": 173476, "num_steps_sampled": 173476, "default": {"vf_loss": 60.87022018432617, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0024778516963124275, "total_loss": 60.868160247802734, "cur_lr": 0.0005000000237487257, "kl": 0.00834583304822445, "entropy": 1.3757399320602417, "vf_explained_var": 0.6848437190055847}, "load_time_ms": 24.076}, "timesteps_total": 173476, "date": "2019-05-24_04-43-45", "episode_reward_mean": -684.8491065473361, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ace10>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acc50>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673025, "node_ip": "10.138.0.2", "time_since_restore": 171.65745329856873, "custom_metrics": {"system_level_velocity_max": 17.748293528684915, "cost1_mean": 135.03242035863096, "cost1_min": 18.250598889543017, "cost1_max": 171.0185520433062, "cost2_mean": -60.12991331820062, "outflow_rate_min": 495.38848385431965, "system_level_velocity_min": 9.308556274246268, "cost2_min": -94.45669089123354, "outflow_rate_mean": 866.4506768898867, "cost2_max": -18.102770353099174, "system_level_velocity_mean": 11.316298279515518, "outflow_rate_max": 1103.0640325629402}, "timesteps_since_restore": 173476, "episode_reward_min": -911.9547369728415}
{"timesteps_this_iter": 40671, "episodes_total": 222, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 5, "episode_reward_max": -25.153418988203896, "pid": 292, "time_this_iter_s": 29.3464777469635, "time_total_s": 201.00393104553223, "episodes_this_iter": 41, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 5, "episode_len_mean": 319.13, "info": {"grad_time_ms": 10386.452, "update_time_ms": 522.829, "sample_time_ms": 29174.534, "num_steps_trained": 214147, "num_steps_sampled": 214147, "default": {"vf_loss": 45.58028030395508, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0023975565563887358, "total_loss": 45.578365325927734, "cur_lr": 0.0005000000237487257, "kl": 0.009679180569946766, "entropy": 1.3618301153182983, "vf_explained_var": 0.8057908415794373}, "load_time_ms": 20.007}, "timesteps_total": 214147, "date": "2019-05-24_04-44-14", "episode_reward_mean": -624.3336635391071, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6833c8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683198>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673054, "node_ip": "10.138.0.2", "time_since_restore": 201.00393104553223, "custom_metrics": {"system_level_velocity_max": 18.500136358494192, "cost1_mean": 143.19663297393384, "cost1_min": 18.250598889543017, "cost1_max": 177.53417855974993, "cost2_mean": -61.63521040427646, "outflow_rate_min": 495.38848385431965, "system_level_velocity_min": 9.308556274246268, "cost2_min": -94.28567760585142, "outflow_rate_mean": 935.6136674177469, "cost2_max": -18.102770353099174, "system_level_velocity_mean": 12.213923863181178, "outflow_rate_max": 1140.8833092958007}, "timesteps_since_restore": 214147, "episode_reward_min": -887.6496377965335}
{"timesteps_this_iter": 40984, "episodes_total": 262, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 6, "episode_reward_max": -31.839713974810635, "pid": 292, "time_this_iter_s": 28.719871044158936, "time_total_s": 229.72380208969116, "episodes_this_iter": 40, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 6, "episode_len_mean": 322.1, "info": {"grad_time_ms": 10373.979, "update_time_ms": 436.92, "sample_time_ms": 27361.866, "num_steps_trained": 255131, "num_steps_sampled": 255131, "default": {"vf_loss": 42.604827880859375, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002538504544645548, "total_loss": 42.602783203125, "cur_lr": 0.0005000000237487257, "kl": 0.009916992858052254, "entropy": 1.353269338607788, "vf_explained_var": 0.8097000122070312}, "load_time_ms": 17.402}, "timesteps_total": 255131, "date": "2019-05-24_04-44-43", "episode_reward_mean": -570.1472187604976, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c40b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1eb8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683a20>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673083, "node_ip": "10.138.0.2", "time_since_restore": 229.72380208969116, "custom_metrics": {"system_level_velocity_max": 18.500136358494192, "cost1_mean": 154.64644087536837, "cost1_min": 22.94747518733915, "cost1_max": 197.2233544097549, "cost2_mean": -67.09460778356129, "outflow_rate_min": 501.51511380796376, "system_level_velocity_min": 7.296739847894671, "cost2_min": -101.3979072946701, "outflow_rate_mean": 1014.4358431433934, "cost2_max": -21.458556832008636, "system_level_velocity_mean": 13.018612433653368, "outflow_rate_max": 1273.865928462606}, "timesteps_since_restore": 255131, "episode_reward_min": -867.7877448227679}
{"timesteps_this_iter": 41881, "episodes_total": 322, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 7, "episode_reward_max": -348.9148553096785, "pid": 292, "time_this_iter_s": 31.78308916091919, "time_total_s": 261.50689125061035, "episodes_this_iter": 60, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 7, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10390.841, "update_time_ms": 375.865, "sample_time_ms": 26480.993, "num_steps_trained": 297012, "num_steps_sampled": 297012, "default": {"vf_loss": 49.42307662963867, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00154859758913517, "total_loss": 49.42180633544922, "cur_lr": 0.0005000000237487257, "kl": 0.0056099980138242245, "entropy": 1.3458738327026367, "vf_explained_var": 0.7394521832466125}, "load_time_ms": 15.556}, "timesteps_total": 297012, "date": "2019-05-24_04-45-15", "episode_reward_mean": -520.3335329737323, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1b38>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901e10>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673115, "node_ip": "10.138.0.2", "time_since_restore": 261.50689125061035, "custom_metrics": {"system_level_velocity_max": 17.395722080850806, "cost1_mean": 172.56633858761035, "cost1_min": 88.32243283794716, "cost1_max": 209.2598558136113, "cost2_mean": -85.62817134631318, "outflow_rate_min": 738.9123800904977, "system_level_velocity_min": 7.296739847894671, "cost2_min": -120.74500141299316, "outflow_rate_mean": 1138.2121789694306, "cost2_max": -59.137001770290425, "system_level_velocity_mean": 14.275799236387659, "outflow_rate_max": 1346.9269369710746}, "timesteps_since_restore": 297012, "episode_reward_min": -926.4675891025545}
{"timesteps_this_iter": 42077, "episodes_total": 362, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 8, "episode_reward_max": -338.0175141759553, "pid": 292, "time_this_iter_s": 30.370850563049316, "time_total_s": 291.87774181365967, "episodes_this_iter": 40, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 8, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10506.753, "update_time_ms": 330.173, "sample_time_ms": 25538.194, "num_steps_trained": 339089, "num_steps_sampled": 339089, "default": {"vf_loss": 38.182796478271484, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0011889112647622824, "total_loss": 38.181861877441406, "cur_lr": 0.0005000000237487257, "kl": 0.005118187516927719, "entropy": 1.3430315256118774, "vf_explained_var": 0.7778533101081848}, "load_time_ms": 14.098}, "timesteps_total": 339089, "date": "2019-05-24_04-45-45", "episode_reward_mean": -515.2186209350839, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6880b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6880f0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673145, "node_ip": "10.138.0.2", "time_since_restore": 291.87774181365967, "custom_metrics": {"system_level_velocity_max": 17.499233724180296, "cost1_mean": 179.4157043736063, "cost1_min": 129.47982050839403, "cost1_max": 209.60872845988422, "cost2_mean": -97.86172322668385, "outflow_rate_min": 806.338797609629, "system_level_velocity_min": 10.943476016927397, "cost2_min": -122.87940391907588, "outflow_rate_mean": 1182.337690513711, "cost2_max": -59.137001770290425, "system_level_velocity_mean": 14.789458544150914, "outflow_rate_max": 1379.231955205811}, "timesteps_since_restore": 339089, "episode_reward_min": -926.4675891025545}
{"timesteps_this_iter": 41428, "episodes_total": 404, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 9, "episode_reward_max": -32.96134320301657, "pid": 292, "time_this_iter_s": 28.891594648361206, "time_total_s": 320.7693364620209, "episodes_this_iter": 42, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 9, "episode_len_mean": 320.94, "info": {"grad_time_ms": 10507.013, "update_time_ms": 294.332, "sample_time_ms": 24732.886, "num_steps_trained": 380517, "num_steps_sampled": 380517, "default": {"vf_loss": 33.88835906982422, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0016968953423202038, "total_loss": 33.88691329956055, "cur_lr": 0.0005000000237487257, "kl": 0.0049972254782915115, "entropy": 1.359178066253662, "vf_explained_var": 0.7929368019104004}, "load_time_ms": 12.979}, "timesteps_total": 380517, "date": "2019-05-24_04-46-14", "episode_reward_mean": -491.6843687104655, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be387e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acba8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac6d8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673174, "node_ip": "10.138.0.2", "time_since_restore": 320.7693364620209, "custom_metrics": {"system_level_velocity_max": 18.970995491999865, "cost1_mean": 181.93481544003416, "cost1_min": 24.680535074010155, "cost1_max": 214.72500911585308, "cost2_mean": -100.18118591325114, "outflow_rate_min": 498.53964097987165, "system_level_velocity_min": 11.848449127415694, "cost2_min": -125.46571494039773, "outflow_rate_mean": 1201.4749397895653, "cost2_max": -24.116440696717437, "system_level_velocity_mean": 15.225391556943343, "outflow_rate_max": 1379.231955205811}, "timesteps_since_restore": 380517, "episode_reward_min": -786.054486124682}
{"timesteps_this_iter": 42928, "episodes_total": 460, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 10, "episode_reward_max": -32.96134320301657, "pid": 292, "time_this_iter_s": 31.842929124832153, "time_total_s": 352.612265586853, "episodes_this_iter": 56, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 10, "episode_len_mean": 318.09, "info": {"grad_time_ms": 10555.2, "update_time_ms": 265.913, "sample_time_ms": 24336.029, "num_steps_trained": 423445, "num_steps_sampled": 423445, "default": {"vf_loss": 38.96782302856445, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0010622923728078604, "total_loss": 38.966896057128906, "cur_lr": 0.0005000000237487257, "kl": 0.0053906855173408985, "entropy": 1.347040057182312, "vf_explained_var": 0.7504894137382507}, "load_time_ms": 12.118}, "timesteps_total": 423445, "date": "2019-05-24_04-46-46", "episode_reward_mean": -489.85898909944126, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688160>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688e48>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673206, "node_ip": "10.138.0.2", "time_since_restore": 352.612265586853, "custom_metrics": {"system_level_velocity_max": 18.970995491999865, "cost1_mean": 182.4992300071382, "cost1_min": 24.680535074010155, "cost1_max": 214.72500911585308, "cost2_mean": -103.25434317587478, "outflow_rate_min": 478.78673622163006, "system_level_velocity_min": 12.08731200794532, "cost2_min": -129.42518735312242, "outflow_rate_mean": 1208.56483439882, "cost2_max": -24.116440696717437, "system_level_velocity_mean": 15.434376398412391, "outflow_rate_max": 1382.2489520217357}, "timesteps_since_restore": 423445, "episode_reward_min": -786.054486124682}
{"timesteps_this_iter": 41846, "episodes_total": 504, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 11, "episode_reward_max": -37.646146604248024, "pid": 292, "time_this_iter_s": 30.61119246482849, "time_total_s": 383.2234580516815, "episodes_this_iter": 44, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 11, "episode_len_mean": 322.15, "info": {"grad_time_ms": 10583.422, "update_time_ms": 8.818, "sample_time_ms": 19500.059, "num_steps_trained": 465291, "num_steps_sampled": 465291, "default": {"vf_loss": 31.643327713012695, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0018529972294345498, "total_loss": 31.641618728637695, "cur_lr": 0.0005000000237487257, "kl": 0.005763282999396324, "entropy": 1.3520528078079224, "vf_explained_var": 0.7895801663398743}, "load_time_ms": 4.248}, "timesteps_total": 465291, "date": "2019-05-24_04-47-17", "episode_reward_mean": -504.084563573212, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acb00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da400>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673237, "node_ip": "10.138.0.2", "time_since_restore": 383.2234580516815, "custom_metrics": {"system_level_velocity_max": 18.409086089753348, "cost1_mean": 184.69318964735936, "cost1_min": 26.338484150742083, "cost1_max": 217.7586015760172, "cost2_mean": -106.10498081065329, "outflow_rate_min": 478.78673622163006, "system_level_velocity_min": 11.810103606315469, "cost2_min": -129.42518735312242, "outflow_rate_mean": 1217.8977968247973, "cost2_max": -27.64045581124886, "system_level_velocity_mean": 15.388121423209927, "outflow_rate_max": 1422.557693001443}, "timesteps_since_restore": 465291, "episode_reward_min": -818.3636020415405}
{"timesteps_this_iter": 41734, "episodes_total": 545, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 12, "episode_reward_max": -37.646146604248024, "pid": 292, "time_this_iter_s": 29.075700283050537, "time_total_s": 412.29915833473206, "episodes_this_iter": 41, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 12, "episode_len_mean": 322.15, "info": {"grad_time_ms": 10651.137, "update_time_ms": 8.605, "sample_time_ms": 19439.712, "num_steps_trained": 507025, "num_steps_sampled": 507025, "default": {"vf_loss": 29.441112518310547, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0024868869222700596, "total_loss": 29.43883514404297, "cur_lr": 0.0005000000237487257, "kl": 0.008371069096028805, "entropy": 1.3387280702590942, "vf_explained_var": 0.7946483492851257}, "load_time_ms": 3.92}, "timesteps_total": 507025, "date": "2019-05-24_04-47-46", "episode_reward_mean": -490.43134092482904, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6880f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688a20>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688278>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673266, "node_ip": "10.138.0.2", "time_since_restore": 412.29915833473206, "custom_metrics": {"system_level_velocity_max": 18.409086089753348, "cost1_mean": 186.2591417600249, "cost1_min": 26.338484150742083, "cost1_max": 217.7586015760172, "cost2_mean": -105.90829122052314, "outflow_rate_min": 478.78673622163006, "system_level_velocity_min": 10.82164699499147, "cost2_min": -125.1306376216846, "outflow_rate_mean": 1230.153560794237, "cost2_max": -27.64045581124886, "system_level_velocity_mean": 15.517470982616798, "outflow_rate_max": 1422.557693001443}, "timesteps_since_restore": 507025, "episode_reward_min": -907.1643067176341}
{"timesteps_this_iter": 40639, "episodes_total": 601, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 13, "episode_reward_max": -33.24838903052646, "pid": 292, "time_this_iter_s": 30.072379112243652, "time_total_s": 442.3715374469757, "episodes_this_iter": 56, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 13, "episode_len_mean": 322.1, "info": {"grad_time_ms": 10598.032, "update_time_ms": 8.434, "sample_time_ms": 19499.287, "num_steps_trained": 547664, "num_steps_sampled": 547664, "default": {"vf_loss": 29.87277603149414, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0036474845837801695, "total_loss": 29.869295120239258, "cur_lr": 0.0005000000237487257, "kl": 0.00655044661834836, "entropy": 1.3369791507720947, "vf_explained_var": 0.77984619140625}, "load_time_ms": 4.02}, "timesteps_total": 547664, "date": "2019-05-24_04-48-16", "episode_reward_mean": -483.3044248196258, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688c88>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673296, "node_ip": "10.138.0.2", "time_since_restore": 442.3715374469757, "custom_metrics": {"system_level_velocity_max": 18.53045967599384, "cost1_mean": 183.21342837614003, "cost1_min": 23.121013180000332, "cost1_max": 213.82671283776557, "cost2_mean": -99.87413274315038, "outflow_rate_min": 465.10626898076305, "system_level_velocity_min": 10.82164699499147, "cost2_min": -125.1306376216846, "outflow_rate_mean": 1211.8208021310081, "cost2_max": -24.881504041364952, "system_level_velocity_mean": 15.318114494140193, "outflow_rate_max": 1387.7146543986298}, "timesteps_since_restore": 547664, "episode_reward_min": -907.1643067176341}
{"timesteps_this_iter": 37408, "episodes_total": 645, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 14, "episode_reward_max": -33.24838903052646, "pid": 292, "time_this_iter_s": 27.72197699546814, "time_total_s": 470.09351444244385, "episodes_this_iter": 44, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 14, "episode_len_mean": 322.1, "info": {"grad_time_ms": 10610.251, "update_time_ms": 8.412, "sample_time_ms": 19133.091, "num_steps_trained": 585072, "num_steps_sampled": 585072, "default": {"vf_loss": 25.802104949951172, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.005203089211136103, "total_loss": 25.797260284423828, "cur_lr": 0.0005000000237487257, "kl": 0.014229676686227322, "entropy": 1.3152049779891968, "vf_explained_var": 0.8196300268173218}, "load_time_ms": 4.048}, "timesteps_total": 585072, "date": "2019-05-24_04-48-44", "episode_reward_mean": -470.5553630836016, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688b00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688c18>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673324, "node_ip": "10.138.0.2", "time_since_restore": 470.09351444244385, "custom_metrics": {"system_level_velocity_max": 18.53045967599384, "cost1_mean": 177.4255947472646, "cost1_min": 23.121013180000332, "cost1_max": 209.34852679714015, "cost2_mean": -88.54417628453854, "outflow_rate_min": 465.10626898076305, "system_level_velocity_min": 11.428207962284427, "cost2_min": -121.97760025978988, "outflow_rate_mean": 1174.5711944801456, "cost2_max": -24.881504041364952, "system_level_velocity_mean": 14.96189877133239, "outflow_rate_max": 1345.6613035958594}, "timesteps_since_restore": 585072, "episode_reward_min": -811.650232159326}
{"timesteps_this_iter": 36623, "episodes_total": 685, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 15, "episode_reward_max": -33.24838903052646, "pid": 292, "time_this_iter_s": 26.471633672714233, "time_total_s": 496.5651481151581, "episodes_this_iter": 40, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 15, "episode_len_mean": 322.1, "info": {"grad_time_ms": 10534.237, "update_time_ms": 8.495, "sample_time_ms": 18921.929, "num_steps_trained": 621695, "num_steps_sampled": 621695, "default": {"vf_loss": 19.650598526000977, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.004561675246804953, "total_loss": 19.646411895751953, "cur_lr": 0.0005000000237487257, "kl": 0.014967658556997776, "entropy": 1.3172154426574707, "vf_explained_var": 0.8705751299858093}, "load_time_ms": 4.056}, "timesteps_total": 621695, "date": "2019-05-24_04-49-10", "episode_reward_mean": -454.2506516998858, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac7f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac320>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673350, "node_ip": "10.138.0.2", "time_since_restore": 496.5651481151581, "custom_metrics": {"system_level_velocity_max": 18.53045967599384, "cost1_mean": 174.25099908883286, "cost1_min": 23.121013180000332, "cost1_max": 209.34852679714015, "cost2_mean": -80.45911766300455, "outflow_rate_min": 465.10626898076305, "system_level_velocity_min": 11.672665491737222, "cost2_min": -111.78040152431842, "outflow_rate_mean": 1154.559768284044, "cost2_max": -24.881504041364952, "system_level_velocity_mean": 14.807948714823054, "outflow_rate_max": 1339.9083129809298}, "timesteps_since_restore": 621695, "episode_reward_min": -657.4452813877433}
{"timesteps_this_iter": 37025, "episodes_total": 726, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 16, "episode_reward_max": -314.0144721818809, "pid": 292, "time_this_iter_s": 27.277494192123413, "time_total_s": 523.8426423072815, "episodes_this_iter": 41, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 16, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10482.465, "update_time_ms": 8.6, "sample_time_ms": 18831.536, "num_steps_trained": 658720, "num_steps_sampled": 658720, "default": {"vf_loss": 24.00784683227539, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.003215068718418479, "total_loss": 24.00485610961914, "cur_lr": 0.0005000000237487257, "kl": 0.00903584249317646, "entropy": 1.31718909740448, "vf_explained_var": 0.840259313583374}, "load_time_ms": 3.985}, "timesteps_total": 658720, "date": "2019-05-24_04-49-37", "episode_reward_mean": -443.0225012053868, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688630>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6880b8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673377, "node_ip": "10.138.0.2", "time_since_restore": 523.8426423072815, "custom_metrics": {"system_level_velocity_max": 17.60353983024145, "cost1_mean": 176.46941695454746, "cost1_min": 134.2462413547359, "cost1_max": 209.2771206383236, "cost2_mean": -76.7646961471528, "outflow_rate_min": 929.3148942888863, "system_level_velocity_min": 11.300839662486426, "cost2_min": -96.18278575255823, "outflow_rate_mean": 1161.7164943094883, "cost2_max": -52.600754650299294, "system_level_velocity_mean": 14.873456967294585, "outflow_rate_max": 1339.9083129809298}, "timesteps_since_restore": 658720, "episode_reward_min": -648.1108282108221}
{"timesteps_this_iter": 38852, "episodes_total": 785, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 17, "episode_reward_max": -320.53079339036066, "pid": 292, "time_this_iter_s": 28.988231420516968, "time_total_s": 552.8308737277985, "episodes_this_iter": 59, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 17, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10412.695, "update_time_ms": 8.351, "sample_time_ms": 18622.166, "num_steps_trained": 697572, "num_steps_sampled": 697572, "default": {"vf_loss": 28.502649307250977, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.003021469572558999, "total_loss": 28.49987030029297, "cur_lr": 0.0005000000237487257, "kl": 0.00984228402376175, "entropy": 1.3136595487594604, "vf_explained_var": 0.8033701181411743}, "load_time_ms": 3.934}, "timesteps_total": 697572, "date": "2019-05-24_04-50-06", "episode_reward_mean": -448.85522325513534, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac908>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac470>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673406, "node_ip": "10.138.0.2", "time_since_restore": 552.8308737277985, "custom_metrics": {"system_level_velocity_max": 17.523327001738586, "cost1_mean": 181.05987703919968, "cost1_min": 134.2462413547359, "cost1_max": 207.54436591196713, "cost2_mean": -82.6872203915509, "outflow_rate_min": 941.2042857142858, "system_level_velocity_min": 11.300839662486426, "cost2_min": -112.11433831286183, "outflow_rate_mean": 1191.8236919876388, "cost2_max": -58.001705913800826, "system_level_velocity_mean": 15.144624383544887, "outflow_rate_max": 1346.2390893738723}, "timesteps_since_restore": 697572, "episode_reward_min": -680.5942555626002}
{"timesteps_this_iter": 38032, "episodes_total": 825, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 18, "episode_reward_max": -329.51035090813536, "pid": 292, "time_this_iter_s": 27.07104730606079, "time_total_s": 579.9019210338593, "episodes_this_iter": 40, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 18, "episode_len_mean": 324.8, "info": {"grad_time_ms": 10207.114, "update_time_ms": 8.026, "sample_time_ms": 18498.428, "num_steps_trained": 735604, "num_steps_sampled": 735604, "default": {"vf_loss": 17.908714294433594, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.002928119385614991, "total_loss": 17.90601921081543, "cur_lr": 0.0005000000237487257, "kl": 0.009326966479420662, "entropy": 1.3197016716003418, "vf_explained_var": 0.8586052656173706}, "load_time_ms": 3.893}, "timesteps_total": 735604, "date": "2019-05-24_04-50-34", "episode_reward_mean": -441.7119742802157, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688668>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688828>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673434, "node_ip": "10.138.0.2", "time_since_restore": 579.9019210338593, "custom_metrics": {"system_level_velocity_max": 17.523327001738586, "cost1_mean": 185.45431697475362, "cost1_min": 143.13044303343366, "cost1_max": 207.54436591196713, "cost2_mean": -85.86594579320113, "outflow_rate_min": 1059.4615272120532, "system_level_velocity_min": 11.810591098217026, "cost2_min": -112.11433831286183, "outflow_rate_mean": 1221.487912154047, "cost2_max": -62.735208861105356, "system_level_velocity_mean": 15.496476878058088, "outflow_rate_max": 1346.2390893738723}, "timesteps_since_restore": 735604, "episode_reward_min": -680.5942555626002}
{"timesteps_this_iter": 37334, "episodes_total": 867, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 19, "episode_reward_max": -33.39808630798983, "pid": 292, "time_this_iter_s": 29.364235162734985, "time_total_s": 609.2661561965942, "episodes_this_iter": 42, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 19, "episode_len_mean": 321.62, "info": {"grad_time_ms": 10059.86, "update_time_ms": 8.282, "sample_time_ms": 18693.316, "num_steps_trained": 772938, "num_steps_sampled": 772938, "default": {"vf_loss": 19.132192611694336, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0027755359187722206, "total_loss": 19.129676818847656, "cur_lr": 0.0005000000237487257, "kl": 0.010384844616055489, "entropy": 1.2827602624893188, "vf_explained_var": 0.8424236178398132}, "load_time_ms": 3.817}, "timesteps_total": 772938, "date": "2019-05-24_04-51-03", "episode_reward_mean": -431.316857878462, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688be0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688470>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673463, "node_ip": "10.138.0.2", "time_since_restore": 609.2661561965942, "custom_metrics": {"system_level_velocity_max": 18.410484583749124, "cost1_mean": 182.52536016211806, "cost1_min": 22.957002751235592, "cost1_max": 207.54436591196713, "cost2_mean": -80.89244197620796, "outflow_rate_min": 460.7989278777953, "system_level_velocity_min": 11.670210018941388, "cost2_min": -110.67200450582199, "outflow_rate_mean": 1202.4967778747352, "cost2_max": -24.10682461182025, "system_level_velocity_mean": 15.459173413811639, "outflow_rate_max": 1326.84061632658}, "timesteps_since_restore": 772938, "episode_reward_min": -633.071694693227}
{"timesteps_this_iter": 36039, "episodes_total": 926, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 20, "episode_reward_max": -33.15624520744664, "pid": 292, "time_this_iter_s": 27.247665882110596, "time_total_s": 636.5138220787048, "episodes_this_iter": 59, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 20, "episode_len_mean": 318.92, "info": {"grad_time_ms": 9842.267, "update_time_ms": 7.989, "sample_time_ms": 18451.987, "num_steps_trained": 808977, "num_steps_sampled": 808977, "default": {"vf_loss": 21.857728958129883, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.002741212723776698, "total_loss": 21.855205535888672, "cur_lr": 0.0005000000237487257, "kl": 0.008688530884683132, "entropy": 1.2639662027359009, "vf_explained_var": 0.8258548378944397}, "load_time_ms": 3.687}, "timesteps_total": 808977, "date": "2019-05-24_04-51-30", "episode_reward_mean": -423.0026680402509, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688630>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688c50>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673490, "node_ip": "10.138.0.2", "time_since_restore": 636.5138220787048, "custom_metrics": {"system_level_velocity_max": 18.410484583749124, "cost1_mean": 176.23522880188438, "cost1_min": 22.811011241188403, "cost1_max": 206.8697102210877, "cost2_mean": -72.0944158670537, "outflow_rate_min": 460.7989278777953, "system_level_velocity_min": 11.670210018941388, "cost2_min": -99.31771841087371, "outflow_rate_mean": 1157.0615511908977, "cost2_max": -23.109454069948914, "system_level_velocity_mean": 15.1411895768482, "outflow_rate_max": 1322.7817381888997}, "timesteps_since_restore": 808977, "episode_reward_min": -633.071694693227}
{"timesteps_this_iter": 36150, "episodes_total": 967, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 21, "episode_reward_max": -33.15624520744664, "pid": 292, "time_this_iter_s": 26.282800436019897, "time_total_s": 662.7966225147247, "episodes_this_iter": 41, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 21, "episode_len_mean": 322.1, "info": {"grad_time_ms": 9626.059, "update_time_ms": 8.153, "sample_time_ms": 18234.711, "num_steps_trained": 845127, "num_steps_sampled": 845127, "default": {"vf_loss": 16.527332305908203, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.002984127728268504, "total_loss": 16.524599075317383, "cur_lr": 0.0005000000237487257, "kl": 0.010053389705717564, "entropy": 1.2300382852554321, "vf_explained_var": 0.8627190589904785}, "load_time_ms": 3.577}, "timesteps_total": 845127, "date": "2019-05-24_04-51-57", "episode_reward_mean": -413.6464334527219, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688f28>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6885f8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673517, "node_ip": "10.138.0.2", "time_since_restore": 662.7966225147247, "custom_metrics": {"system_level_velocity_max": 18.342339306489723, "cost1_mean": 179.39305708668633, "cost1_min": 22.811011241188403, "cost1_max": 205.2524865237828, "cost2_mean": -70.37076625940745, "outflow_rate_min": 474.5084323459513, "system_level_velocity_min": 11.663912791375603, "cost2_min": -89.33208768604058, "outflow_rate_mean": 1168.2102898226888, "cost2_max": -23.109454069948914, "system_level_velocity_mean": 15.276535917815982, "outflow_rate_max": 1299.5687755102042}, "timesteps_since_restore": 845127, "episode_reward_min": -553.2188677326561}
{"timesteps_this_iter": 35427, "episodes_total": 1008, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 22, "episode_reward_max": -32.36368756432875, "pid": 292, "time_this_iter_s": 26.513021230697632, "time_total_s": 689.3096437454224, "episodes_this_iter": 41, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 22, "episode_len_mean": 321.92, "info": {"grad_time_ms": 9423.487, "update_time_ms": 8.293, "sample_time_ms": 18182.728, "num_steps_trained": 880554, "num_steps_sampled": 880554, "default": {"vf_loss": 18.7266902923584, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.003585485043004155, "total_loss": 18.72340202331543, "cur_lr": 0.0005000000237487257, "kl": 0.011859176680445671, "entropy": 1.2167131900787354, "vf_explained_var": 0.8432244658470154}, "load_time_ms": 3.629}, "timesteps_total": 880554, "date": "2019-05-24_04-52-23", "episode_reward_mean": -407.60472074760787, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6885c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6882e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688a58>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673543, "node_ip": "10.138.0.2", "time_since_restore": 689.3096437454224, "custom_metrics": {"system_level_velocity_max": 18.784692631347543, "cost1_mean": 180.09647119355733, "cost1_min": 24.299672486709735, "cost1_max": 205.2524865237828, "cost2_mean": -68.9693208267978, "outflow_rate_min": 518.6392970701784, "system_level_velocity_min": 11.663912791375603, "cost2_min": -87.07425662546459, "outflow_rate_mean": 1169.888229858489, "cost2_max": -21.94901155198064, "system_level_velocity_mean": 15.393595637942585, "outflow_rate_max": 1299.5687755102042}, "timesteps_since_restore": 880554, "episode_reward_min": -546.5010772657298}
{"timesteps_this_iter": 35563, "episodes_total": 1067, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 23, "episode_reward_max": -32.36368756432875, "pid": 292, "time_this_iter_s": 27.19664478302002, "time_total_s": 716.5062885284424, "episodes_this_iter": 59, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 23, "episode_len_mean": 317.94, "info": {"grad_time_ms": 9294.295, "update_time_ms": 8.208, "sample_time_ms": 18025.269, "num_steps_trained": 916117, "num_steps_sampled": 916117, "default": {"vf_loss": 21.15692710876465, "cur_kl_coeff": 0.02500000037252903, "policy_loss": -0.0023711405228823423, "total_loss": 21.154727935791016, "cur_lr": 0.0005000000237487257, "kl": 0.006942078936845064, "entropy": 1.2090511322021484, "vf_explained_var": 0.8400753140449524}, "load_time_ms": 3.603}, "timesteps_total": 916117, "date": "2019-05-24_04-52-50", "episode_reward_mean": -397.09180384870626, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6882b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688518>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673570, "node_ip": "10.138.0.2", "time_since_restore": 716.5062885284424, "custom_metrics": {"system_level_velocity_max": 18.784692631347543, "cost1_mean": 177.4460829584272, "cost1_min": 22.74878681429032, "cost1_max": 201.34066242961194, "cost2_mean": -67.31057774294068, "outflow_rate_min": 462.43348918263234, "system_level_velocity_min": 12.092590221653408, "cost2_min": -85.27495089008752, "outflow_rate_mean": 1160.3808828964743, "cost2_max": -21.94901155198064, "system_level_velocity_mean": 15.42706339353805, "outflow_rate_max": 1301.0640085524235}, "timesteps_since_restore": 916117, "episode_reward_min": -534.2241482070435}
{"timesteps_this_iter": 35426, "episodes_total": 1109, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 24, "episode_reward_max": -33.420782089501316, "pid": 292, "time_this_iter_s": 27.00726008415222, "time_total_s": 743.5135486125946, "episodes_this_iter": 42, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 24, "episode_len_mean": 321.02, "info": {"grad_time_ms": 9265.498, "update_time_ms": 8.069, "sample_time_ms": 17985.063, "num_steps_trained": 951543, "num_steps_sampled": 951543, "default": {"vf_loss": 15.762157440185547, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0036510410718619823, "total_loss": 15.758755683898926, "cur_lr": 0.0005000000237487257, "kl": 0.00999192614108324, "entropy": 1.220518708229065, "vf_explained_var": 0.8730702996253967}, "load_time_ms": 3.581}, "timesteps_total": 951543, "date": "2019-05-24_04-53-17", "episode_reward_mean": -402.9513256622568, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acfd0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ace48>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673597, "node_ip": "10.138.0.2", "time_since_restore": 743.5135486125946, "custom_metrics": {"system_level_velocity_max": 18.237741936859262, "cost1_mean": 178.6374286265809, "cost1_min": 22.74878681429032, "cost1_max": 201.34066242961194, "cost2_mean": -68.58416773645853, "outflow_rate_min": 462.43348918263234, "system_level_velocity_min": 11.959542414856607, "cost2_min": -87.60116243601524, "outflow_rate_mean": 1164.64027540946, "cost2_max": -23.44343019955097, "system_level_velocity_mean": 15.330763231893089, "outflow_rate_max": 1301.0640085524235}, "timesteps_since_restore": 951543, "episode_reward_min": -610.136794710028}
{"timesteps_this_iter": 34875, "episodes_total": 1149, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 25, "episode_reward_max": -224.42209500511422, "pid": 292, "time_this_iter_s": 25.551217317581177, "time_total_s": 769.0647659301758, "episodes_this_iter": 40, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 25, "episode_len_mean": 323.92, "info": {"grad_time_ms": 9232.475, "update_time_ms": 8.166, "sample_time_ms": 17926.049, "num_steps_trained": 986418, "num_steps_sampled": 986418, "default": {"vf_loss": 13.840619087219238, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.003875269554555416, "total_loss": 13.836986541748047, "cur_lr": 0.0005000000237487257, "kl": 0.009696239605545998, "entropy": 1.1998984813690186, "vf_explained_var": 0.8795428276062012}, "load_time_ms": 3.533}, "timesteps_total": 986418, "date": "2019-05-24_04-53-43", "episode_reward_mean": -397.1275299680051, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acdd8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac630>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673623, "node_ip": "10.138.0.2", "time_since_restore": 769.0647659301758, "custom_metrics": {"system_level_velocity_max": 17.45493174109486, "cost1_mean": 182.80315773002104, "cost1_min": 133.39369398039145, "cost1_max": 205.0640144475366, "cost2_mean": -67.74173185980716, "outflow_rate_min": 961.375566391598, "system_level_velocity_min": 11.959542414856607, "cost2_min": -87.60116243601524, "outflow_rate_mean": 1177.5282356029684, "cost2_max": -48.24861041329973, "system_level_velocity_mean": 15.557432713422585, "outflow_rate_max": 1305.4563755375489}, "timesteps_since_restore": 986418, "episode_reward_min": -610.136794710028}
{"timesteps_this_iter": 34924, "episodes_total": 1205, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 26, "episode_reward_max": -268.3032620144839, "pid": 292, "time_this_iter_s": 27.234400272369385, "time_total_s": 796.2991662025452, "episodes_this_iter": 56, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 26, "episode_len_mean": 323.82, "info": {"grad_time_ms": 9179.359, "update_time_ms": 8.17, "sample_time_ms": 17975.066, "num_steps_trained": 1021342, "num_steps_sampled": 1021342, "default": {"vf_loss": 20.110458374023438, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0044909315183758736, "total_loss": 20.10625457763672, "cur_lr": 0.0005000000237487257, "kl": 0.011508943513035774, "entropy": 1.1925852298736572, "vf_explained_var": 0.84256911277771}, "load_time_ms": 3.377}, "timesteps_total": 1021342, "date": "2019-05-24_04-54-10", "episode_reward_mean": -388.6921778471019, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c43c8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c45c0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673650, "node_ip": "10.138.0.2", "time_since_restore": 796.2991662025452, "custom_metrics": {"system_level_velocity_max": 17.72230498818136, "cost1_mean": 183.88947590459074, "cost1_min": 117.62802384473704, "cost1_max": 205.0640144475366, "cost2_mean": -66.39963507682894, "outflow_rate_min": 926.2954791397165, "system_level_velocity_min": 12.034305264036787, "cost2_min": -85.46285917306307, "outflow_rate_mean": 1179.8872695222217, "cost2_max": -48.24861041329973, "system_level_velocity_mean": 15.671975292078155, "outflow_rate_max": 1307.460692344257}, "timesteps_since_restore": 1021342, "episode_reward_min": -548.6448449986984}
{"timesteps_this_iter": 35118, "episodes_total": 1249, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 27, "episode_reward_max": -223.04680020413664, "pid": 292, "time_this_iter_s": 26.611791133880615, "time_total_s": 822.9109573364258, "episodes_this_iter": 44, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 27, "episode_len_mean": 322.64, "info": {"grad_time_ms": 9139.26, "update_time_ms": 8.187, "sample_time_ms": 17777.619, "num_steps_trained": 1056460, "num_steps_sampled": 1056460, "default": {"vf_loss": 14.746809959411621, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0031304683070629835, "total_loss": 14.743934631347656, "cur_lr": 0.0005000000237487257, "kl": 0.010237044654786587, "entropy": 1.1770315170288086, "vf_explained_var": 0.8838362693786621}, "load_time_ms": 3.381}, "timesteps_total": 1056460, "date": "2019-05-24_04-54-37", "episode_reward_mean": -394.2260051376821, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e17b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eebe0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673677, "node_ip": "10.138.0.2", "time_since_restore": 822.9109573364258, "custom_metrics": {"system_level_velocity_max": 17.72230498818136, "cost1_mean": 181.94271411484038, "cost1_min": 117.62802384473704, "cost1_max": 203.24734752827055, "cost2_mean": -66.53106543754369, "outflow_rate_min": 926.2954791397165, "system_level_velocity_min": 11.714497356362735, "cost2_min": -86.75996918432496, "outflow_rate_mean": 1171.6981088333712, "cost2_max": -53.21034308267209, "system_level_velocity_mean": 15.541933030240466, "outflow_rate_max": 1307.460692344257}, "timesteps_since_restore": 1056460, "episode_reward_min": -620.9924709562944}
{"timesteps_this_iter": 35069, "episodes_total": 1289, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 28, "episode_reward_max": -184.9773640609206, "pid": 292, "time_this_iter_s": 25.655335187911987, "time_total_s": 848.5662925243378, "episodes_this_iter": 40, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 28, "episode_len_mean": 322.08, "info": {"grad_time_ms": 9182.974, "update_time_ms": 8.246, "sample_time_ms": 17594.515, "num_steps_trained": 1091529, "num_steps_sampled": 1091529, "default": {"vf_loss": 16.05389976501465, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.004093122202903032, "total_loss": 16.050113677978516, "cur_lr": 0.0005000000237487257, "kl": 0.012307161465287209, "entropy": 1.1620804071426392, "vf_explained_var": 0.8635842800140381}, "load_time_ms": 3.42}, "timesteps_total": 1091529, "date": "2019-05-24_04-55-03", "episode_reward_mean": -392.7588266954018, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac940>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac6a0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673703, "node_ip": "10.138.0.2", "time_since_restore": 848.5662925243378, "custom_metrics": {"system_level_velocity_max": 17.67566762048056, "cost1_mean": 181.8735235741412, "cost1_min": 125.78404047064566, "cost1_max": 203.10449021104614, "cost2_mean": -66.9873596306458, "outflow_rate_min": 985.8553500701698, "system_level_velocity_min": 11.714497356362735, "cost2_min": -86.75996918432496, "outflow_rate_mean": 1173.3553766583518, "cost2_max": -43.29814449463282, "system_level_velocity_mean": 15.5346550090848, "outflow_rate_max": 1307.460692344257}, "timesteps_since_restore": 1091529, "episode_reward_min": -620.9924709562944}
{"timesteps_this_iter": 35538, "episodes_total": 1337, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 29, "episode_reward_max": -179.5905457092829, "pid": 292, "time_this_iter_s": 27.55312752723694, "time_total_s": 876.1194200515747, "episodes_this_iter": 48, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 29, "episode_len_mean": 322.08, "info": {"grad_time_ms": 9268.124, "update_time_ms": 8.031, "sample_time_ms": 17328.774, "num_steps_trained": 1127067, "num_steps_sampled": 1127067, "default": {"vf_loss": 22.055246353149414, "cur_kl_coeff": 0.02500000037252903, "policy_loss": -0.002649236936122179, "total_loss": 22.052885055541992, "cur_lr": 0.0005000000237487257, "kl": 0.011473418213427067, "entropy": 1.161275863647461, "vf_explained_var": 0.8378158211708069}, "load_time_ms": 3.509}, "timesteps_total": 1127067, "date": "2019-05-24_04-55-30", "episode_reward_mean": -386.92644469054676, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f2e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f320>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673730, "node_ip": "10.138.0.2", "time_since_restore": 876.1194200515747, "custom_metrics": {"system_level_velocity_max": 17.906081162630926, "cost1_mean": 184.3365134986734, "cost1_min": 130.44920582270407, "cost1_max": 209.17398396818228, "cost2_mean": -68.24480202160993, "outflow_rate_min": 937.59125, "system_level_velocity_min": 11.15668339734499, "cost2_min": -94.77569266627239, "outflow_rate_mean": 1179.9022176595417, "cost2_max": -43.29814449463282, "system_level_velocity_mean": 15.739223468868168, "outflow_rate_max": 1302.8736496431395}, "timesteps_since_restore": 1127067, "episode_reward_min": -659.3294474786442}
{"timesteps_this_iter": 34491, "episodes_total": 1389, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 30, "episode_reward_max": -179.5905457092829, "pid": 292, "time_this_iter_s": 27.36993670463562, "time_total_s": 903.4893567562103, "episodes_this_iter": 52, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 30, "episode_len_mean": 323.82, "info": {"grad_time_ms": 9442.209, "update_time_ms": 8.022, "sample_time_ms": 17166.277, "num_steps_trained": 1161558, "num_steps_sampled": 1161558, "default": {"vf_loss": 20.797441482543945, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.004044859204441309, "total_loss": 20.79372215270996, "cur_lr": 0.0005000000237487257, "kl": 0.012963411398231983, "entropy": 1.1409876346588135, "vf_explained_var": 0.8209008574485779}, "load_time_ms": 3.549}, "timesteps_total": 1161558, "date": "2019-05-24_04-55-58", "episode_reward_mean": -381.40163815321057, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688b38>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688898>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673758, "node_ip": "10.138.0.2", "time_since_restore": 903.4893567562103, "custom_metrics": {"system_level_velocity_max": 17.923112458888525, "cost1_mean": 187.91741279776204, "cost1_min": 132.4692996923884, "cost1_max": 209.17398396818228, "cost2_mean": -69.04721193208574, "outflow_rate_min": 937.59125, "system_level_velocity_min": 11.15668339734499, "cost2_min": -94.77569266627239, "outflow_rate_mean": 1184.389196390334, "cost2_max": -47.84502640912232, "system_level_velocity_mean": 15.964415496720028, "outflow_rate_max": 1310.033192219017}, "timesteps_since_restore": 1161558, "episode_reward_min": -659.3294474786442}
{"timesteps_this_iter": 33787, "episodes_total": 1429, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 31, "episode_reward_max": -265.2185185875641, "pid": 292, "time_this_iter_s": 25.159291982650757, "time_total_s": 928.6486487388611, "episodes_this_iter": 40, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 31, "episode_len_mean": 324.8, "info": {"grad_time_ms": 9499.849, "update_time_ms": 8.236, "sample_time_ms": 16996.325, "num_steps_trained": 1195345, "num_steps_sampled": 1195345, "default": {"vf_loss": 14.41319751739502, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0039039382245391607, "total_loss": 14.409554481506348, "cur_lr": 0.0005000000237487257, "kl": 0.010471723973751068, "entropy": 1.1269876956939697, "vf_explained_var": 0.8662976026535034}, "load_time_ms": 3.62}, "timesteps_total": 1195345, "date": "2019-05-24_04-56-23", "episode_reward_mean": -372.49138100113765, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f2e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f3c8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673783, "node_ip": "10.138.0.2", "time_since_restore": 928.6486487388611, "custom_metrics": {"system_level_velocity_max": 18.067389290473717, "cost1_mean": 189.52892972472108, "cost1_min": 147.23485076055346, "cost1_max": 206.58524547665647, "cost2_mean": -67.60734076074591, "outflow_rate_min": 948.5910303030303, "system_level_velocity_min": 12.268130889371708, "cost2_min": -90.51612538266848, "outflow_rate_mean": 1179.4788116363898, "cost2_max": -48.026309312887435, "system_level_velocity_mean": 16.06299918844114, "outflow_rate_max": 1310.033192219017}, "timesteps_since_restore": 1195345, "episode_reward_min": -587.0652956393715}
{"timesteps_this_iter": 32288, "episodes_total": 1473, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 32, "episode_reward_max": -242.49053093438835, "pid": 292, "time_this_iter_s": 25.617493152618408, "time_total_s": 954.2661418914795, "episodes_this_iter": 44, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 32, "episode_len_mean": 324.8, "info": {"grad_time_ms": 9506.427, "update_time_ms": 8.251, "sample_time_ms": 16899.545, "num_steps_trained": 1227633, "num_steps_sampled": 1227633, "default": {"vf_loss": 17.102203369140625, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.004220426082611084, "total_loss": 17.098236083984375, "cur_lr": 0.0005000000237487257, "kl": 0.010073915123939514, "entropy": 1.1268545389175415, "vf_explained_var": 0.8464164733886719}, "load_time_ms": 3.613}, "timesteps_total": 1227633, "date": "2019-05-24_04-56-48", "episode_reward_mean": -360.03248958516997, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fe10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f9e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1a58>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673808, "node_ip": "10.138.0.2", "time_since_restore": 954.2661418914795, "custom_metrics": {"system_level_velocity_max": 18.21070744405406, "cost1_mean": 189.28733104971866, "cost1_min": 147.23485076055346, "cost1_max": 208.61636206268076, "cost2_mean": -64.13663677347427, "outflow_rate_min": 917.2508743718594, "system_level_velocity_min": 12.268130889371708, "cost2_min": -85.52412020273317, "outflow_rate_mean": 1151.478466205806, "cost2_max": -38.740577846196224, "system_level_velocity_mean": 16.07857738476818, "outflow_rate_max": 1279.4547790634908}, "timesteps_since_restore": 1227633, "episode_reward_min": -563.1256351475567}
{"timesteps_this_iter": 31019, "episodes_total": 1529, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 33, "episode_reward_max": -29.713289383106456, "pid": 292, "time_this_iter_s": 25.053605556488037, "time_total_s": 979.3197474479675, "episodes_this_iter": 56, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 33, "episode_len_mean": 320.92, "info": {"grad_time_ms": 9461.916, "update_time_ms": 8.459, "sample_time_ms": 16729.162, "num_steps_trained": 1258652, "num_steps_sampled": 1258652, "default": {"vf_loss": 16.967849731445312, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.004557047970592976, "total_loss": 16.963584899902344, "cur_lr": 0.0005000000237487257, "kl": 0.011680642142891884, "entropy": 1.12772536277771, "vf_explained_var": 0.8420706391334534}, "load_time_ms": 3.522}, "timesteps_total": 1258652, "date": "2019-05-24_04-57-14", "episode_reward_mean": -332.9214087559573, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be387f98>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7080>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673834, "node_ip": "10.138.0.2", "time_since_restore": 979.3197474479675, "custom_metrics": {"system_level_velocity_max": 18.788082713931722, "cost1_mean": 188.18411866701183, "cost1_min": 23.061941039806957, "cost1_max": 210.61612316804218, "cost2_mean": -59.580155562867866, "outflow_rate_min": 508.5934821910148, "system_level_velocity_min": 12.204775215478469, "cost2_min": -79.64764814283184, "outflow_rate_mean": 1105.9705107118432, "cost2_max": -19.901199878406985, "system_level_velocity_mean": 16.245404539617013, "outflow_rate_max": 1279.4547790634908}, "timesteps_since_restore": 1258652, "episode_reward_min": -551.3350425582663}
{"timesteps_this_iter": 28906, "episodes_total": 1571, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 34, "episode_reward_max": -29.713289383106456, "pid": 292, "time_this_iter_s": 22.11347508430481, "time_total_s": 1001.4332225322723, "episodes_this_iter": 42, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 34, "episode_len_mean": 320.24, "info": {"grad_time_ms": 9342.271, "update_time_ms": 8.737, "sample_time_ms": 16359.533, "num_steps_trained": 1287558, "num_steps_sampled": 1287558, "default": {"vf_loss": 12.435677528381348, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.004669494926929474, "total_loss": 12.43131160736084, "cur_lr": 0.0005000000237487257, "kl": 0.012136908248066902, "entropy": 1.1193923950195312, "vf_explained_var": 0.8801597952842712}, "load_time_ms": 3.434}, "timesteps_total": 1287558, "date": "2019-05-24_04-57-36", "episode_reward_mean": -308.48167536824485, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a71d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7160>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673856, "node_ip": "10.138.0.2", "time_since_restore": 1001.4332225322723, "custom_metrics": {"system_level_velocity_max": 18.84636760019447, "cost1_mean": 188.4788318335043, "cost1_min": 23.061941039806957, "cost1_max": 214.26037544095703, "cost2_mean": -55.49051511561752, "outflow_rate_min": 508.5934821910148, "system_level_velocity_min": 12.204775215478469, "cost2_min": -77.10638411189635, "outflow_rate_mean": 1070.1558543717533, "cost2_max": -19.901199878406985, "system_level_velocity_mean": 16.368110744510346, "outflow_rate_max": 1253.084155844156}, "timesteps_since_restore": 1287558, "episode_reward_min": -551.3350425582663}
{"timesteps_this_iter": 29538, "episodes_total": 1616, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 35, "episode_reward_max": -166.01191587914488, "pid": 292, "time_this_iter_s": 23.404099225997925, "time_total_s": 1024.8373217582703, "episodes_this_iter": 45, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 35, "episode_len_mean": 322.09, "info": {"grad_time_ms": 9231.313, "update_time_ms": 8.778, "sample_time_ms": 16256.28, "num_steps_trained": 1317096, "num_steps_sampled": 1317096, "default": {"vf_loss": 12.545214653015137, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.004973430186510086, "total_loss": 12.540641784667969, "cur_lr": 0.0005000000237487257, "kl": 0.015999512746930122, "entropy": 1.0842336416244507, "vf_explained_var": 0.8665837645530701}, "load_time_ms": 3.397}, "timesteps_total": 1317096, "date": "2019-05-24_04-57-59", "episode_reward_mean": -293.712090052953, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1ef0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1208>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673879, "node_ip": "10.138.0.2", "time_since_restore": 1024.8373217582703, "custom_metrics": {"system_level_velocity_max": 18.84636760019447, "cost1_mean": 191.71606653158315, "cost1_min": 132.70495372213492, "cost1_max": 214.26037544095703, "cost2_mean": -52.65172639179085, "outflow_rate_min": 869.3479223300965, "system_level_velocity_min": 14.374368021692398, "cost2_min": -68.8651158641428, "outflow_rate_mean": 1064.8831422220533, "cost2_max": -36.04724944221106, "system_level_velocity_mean": 16.603422047073156, "outflow_rate_max": 1253.084155844156}, "timesteps_since_restore": 1317096, "episode_reward_min": -387.1169206567823}
{"timesteps_this_iter": 29879, "episodes_total": 1670, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 36, "episode_reward_max": -166.01191587914488, "pid": 292, "time_this_iter_s": 24.249885320663452, "time_total_s": 1049.0872070789337, "episodes_this_iter": 54, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 36, "episode_len_mean": 321.41, "info": {"grad_time_ms": 9098.0, "update_time_ms": 8.899, "sample_time_ms": 16091.789, "num_steps_trained": 1346975, "num_steps_sampled": 1346975, "default": {"vf_loss": 12.973779678344727, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0032362090423703194, "total_loss": 12.970832824707031, "cur_lr": 0.0005000000237487257, "kl": 0.011581175029277802, "entropy": 1.075994610786438, "vf_explained_var": 0.8703091144561768}, "load_time_ms": 3.486}, "timesteps_total": 1346975, "date": "2019-05-24_04-58-23", "episode_reward_mean": -290.2240888079853, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688048>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7d30>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673903, "node_ip": "10.138.0.2", "time_since_restore": 1049.0872070789337, "custom_metrics": {"system_level_velocity_max": 18.795890981920287, "cost1_mean": 193.3692300367898, "cost1_min": 124.75859774306954, "cost1_max": 211.64256502052783, "cost2_mean": -51.183353235313206, "outflow_rate_min": 869.3479223300965, "system_level_velocity_min": 13.566141601806272, "cost2_min": -65.96630713453227, "outflow_rate_mean": 1080.0005671335327, "cost2_max": -37.10540995547875, "system_level_velocity_mean": 16.79424452712618, "outflow_rate_max": 1227.2877022950775}, "timesteps_since_restore": 1346975, "episode_reward_min": -442.245655542936}
{"timesteps_this_iter": 30674, "episodes_total": 1712, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 37, "episode_reward_max": -200.70492583250683, "pid": 292, "time_this_iter_s": 24.016576528549194, "time_total_s": 1073.103783607483, "episodes_this_iter": 42, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 37, "episode_len_mean": 323.64, "info": {"grad_time_ms": 8931.749, "update_time_ms": 9.244, "sample_time_ms": 15998.067, "num_steps_trained": 1377649, "num_steps_sampled": 1377649, "default": {"vf_loss": 11.851905822753906, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0028877544682472944, "total_loss": 11.84931755065918, "cur_lr": 0.0005000000237487257, "kl": 0.011958745308220387, "entropy": 1.0648086071014404, "vf_explained_var": 0.880877673625946}, "load_time_ms": 3.353}, "timesteps_total": 1377649, "date": "2019-05-24_04-58-47", "episode_reward_mean": -294.5477988835556, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7b70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a79e8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673927, "node_ip": "10.138.0.2", "time_since_restore": 1073.103783607483, "custom_metrics": {"system_level_velocity_max": 18.875265827976843, "cost1_mean": 195.10632090351478, "cost1_min": 124.75859774306954, "cost1_max": 213.73750991208536, "cost2_mean": -51.73984446531491, "outflow_rate_min": 886.0130898215065, "system_level_velocity_min": 12.155839093220463, "cost2_min": -65.96630713453227, "outflow_rate_mean": 1094.3978273027426, "cost2_max": -37.10540995547875, "system_level_velocity_mean": 16.795252614458633, "outflow_rate_max": 1254.475818214586}, "timesteps_since_restore": 1377649, "episode_reward_min": -442.245655542936}
{"timesteps_this_iter": 30859, "episodes_total": 1759, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 38, "episode_reward_max": -159.77647729280108, "pid": 292, "time_this_iter_s": 24.172805309295654, "time_total_s": 1097.2765889167786, "episodes_this_iter": 47, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 38, "episode_len_mean": 320.26, "info": {"grad_time_ms": 8697.105, "update_time_ms": 9.514, "sample_time_ms": 16083.956, "num_steps_trained": 1408508, "num_steps_sampled": 1408508, "default": {"vf_loss": 12.24666690826416, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.003987031988799572, "total_loss": 12.243026733398438, "cur_lr": 0.0005000000237487257, "kl": 0.013882939703762531, "entropy": 1.0579636096954346, "vf_explained_var": 0.8630147576332092}, "load_time_ms": 3.218}, "timesteps_total": 1408508, "date": "2019-05-24_04-59-12", "episode_reward_mean": -298.8047900850714, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a71d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7198>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673952, "node_ip": "10.138.0.2", "time_since_restore": 1097.2765889167786, "custom_metrics": {"system_level_velocity_max": 18.875265827976843, "cost1_mean": 193.126203853199, "cost1_min": 135.28646153042655, "cost1_max": 213.73750991208536, "cost2_mean": -53.79596464298997, "outflow_rate_min": 923.2074277758442, "system_level_velocity_min": 12.155839093220463, "cost2_min": -72.14781255388846, "outflow_rate_mean": 1106.0158766425566, "cost2_max": -36.10819163984963, "system_level_velocity_mean": 16.738971164526546, "outflow_rate_max": 1254.475818214586}, "timesteps_since_restore": 1408508, "episode_reward_min": -435.9474966986325}
{"timesteps_this_iter": 31133, "episodes_total": 1808, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 39, "episode_reward_max": -159.77647729280108, "pid": 292, "time_this_iter_s": 25.323095321655273, "time_total_s": 1122.5996842384338, "episodes_this_iter": 49, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 39, "episode_len_mean": 316.9, "info": {"grad_time_ms": 8425.895, "update_time_ms": 9.74, "sample_time_ms": 16132.351, "num_steps_trained": 1439641, "num_steps_sampled": 1439641, "default": {"vf_loss": 13.564413070678711, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.004118560813367367, "total_loss": 13.560579299926758, "cur_lr": 0.0005000000237487257, "kl": 0.01141743641346693, "entropy": 1.0606101751327515, "vf_explained_var": 0.8626219034194946}, "load_time_ms": 3.094}, "timesteps_total": 1439641, "date": "2019-05-24_04-59-37", "episode_reward_mean": -297.18619550405873, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7390>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7080>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558673977, "node_ip": "10.138.0.2", "time_since_restore": 1122.5996842384338, "custom_metrics": {"system_level_velocity_max": 18.642615127775972, "cost1_mean": 192.58227388358236, "cost1_min": 135.28646153042655, "cost1_max": 214.139207824415, "cost2_mean": -54.60873987366672, "outflow_rate_min": 976.9798359670411, "system_level_velocity_min": 13.515307800706248, "cost2_min": -72.14781255388846, "outflow_rate_mean": 1120.0482583840194, "cost2_max": -36.10819163984963, "system_level_velocity_mean": 16.86369584397825, "outflow_rate_max": 1260.8621505959968}, "timesteps_since_restore": 1439641, "episode_reward_min": -520.7287377297699}
{"timesteps_this_iter": 32261, "episodes_total": 1853, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 40, "episode_reward_max": -162.09604053697797, "pid": 292, "time_this_iter_s": 25.59650754928589, "time_total_s": 1148.1961917877197, "episodes_this_iter": 45, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 40, "episode_len_mean": 320.46, "info": {"grad_time_ms": 8077.898, "update_time_ms": 9.875, "sample_time_ms": 16303.278, "num_steps_trained": 1471902, "num_steps_sampled": 1471902, "default": {"vf_loss": 13.007651329040527, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0033286374527961016, "total_loss": 13.004673957824707, "cur_lr": 0.0005000000237487257, "kl": 0.014068268239498138, "entropy": 1.0585311651229858, "vf_explained_var": 0.8656409978866577}, "load_time_ms": 3.027}, "timesteps_total": 1471902, "date": "2019-05-24_05-00-03", "episode_reward_mean": -312.1337804162468, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6995f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699be0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699198>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558674003, "node_ip": "10.138.0.2", "time_since_restore": 1148.1961917877197, "custom_metrics": {"system_level_velocity_max": 18.642615127775972, "cost1_mean": 193.58289743921202, "cost1_min": 136.34656335161282, "cost1_max": 214.139207824415, "cost2_mean": -57.1841597603162, "outflow_rate_min": 988.587151389171, "system_level_velocity_min": 13.416222933113156, "cost2_min": -81.53254743853283, "outflow_rate_mean": 1133.8768634785679, "cost2_max": -39.4923506785532, "system_level_velocity_mean": 16.703164838852505, "outflow_rate_max": 1266.80722481666}, "timesteps_since_restore": 1471902, "episode_reward_min": -520.7287377297699}
{"timesteps_this_iter": 32076, "episodes_total": 1897, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 41, "episode_reward_max": -33.36583753481074, "pid": 292, "time_this_iter_s": 24.715290307998657, "time_total_s": 1172.9114820957184, "episodes_this_iter": 44, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 41, "episode_len_mean": 321.02, "info": {"grad_time_ms": 7787.691, "update_time_ms": 9.87, "sample_time_ms": 16552.468, "num_steps_trained": 1503978, "num_steps_sampled": 1503978, "default": {"vf_loss": 11.604701042175293, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.003740234998986125, "total_loss": 11.601292610168457, "cur_lr": 0.0005000000237487257, "kl": 0.01331326737999916, "entropy": 1.053750991821289, "vf_explained_var": 0.8715296983718872}, "load_time_ms": 2.91}, "timesteps_total": 1503978, "date": "2019-05-24_05-00-27", "episode_reward_mean": -314.7945821274118, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a70f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7208>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a79b0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558674027, "node_ip": "10.138.0.2", "time_since_restore": 1172.9114820957184, "custom_metrics": {"system_level_velocity_max": 18.624110142764255, "cost1_mean": 194.04305060204584, "cost1_min": 24.422887437993474, "cost1_max": 213.4647062526741, "cost2_mean": -57.56555783412443, "outflow_rate_min": 493.42824139203054, "system_level_velocity_min": 13.416222933113156, "cost2_min": -81.53254743853283, "outflow_rate_mean": 1141.999322245786, "cost2_max": -23.330128762801202, "system_level_velocity_mean": 16.673456795548848, "outflow_rate_max": 1266.80722481666}, "timesteps_since_restore": 1503978, "episode_reward_min": -504.450608689151}
{"timesteps_this_iter": 32601, "episodes_total": 1948, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 42, "episode_reward_max": -22.80858699265455, "pid": 292, "time_this_iter_s": 26.570398092269897, "time_total_s": 1199.4818801879883, "episodes_this_iter": 51, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 42, "episode_len_mean": 312.18, "info": {"grad_time_ms": 7600.614, "update_time_ms": 9.66, "sample_time_ms": 16836.763, "num_steps_trained": 1536579, "num_steps_sampled": 1536579, "default": {"vf_loss": 15.487265586853027, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.004649808630347252, "total_loss": 15.482955932617188, "cur_lr": 0.0005000000237487257, "kl": 0.013576149009168148, "entropy": 1.02827787399292, "vf_explained_var": 0.8509249091148376}, "load_time_ms": 2.85}, "timesteps_total": 1536579, "date": "2019-05-24_05-00-54", "episode_reward_mean": -310.58246199084243, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7668>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a78d0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558674054, "node_ip": "10.138.0.2", "time_since_restore": 1199.4818801879883, "custom_metrics": {"system_level_velocity_max": 18.624110142764255, "cost1_mean": 187.620232842939, "cost1_min": 18.13745689041836, "cost1_max": 213.4647062526741, "cost2_mean": -55.80301226174073, "outflow_rate_min": 478.34341239403955, "system_level_velocity_min": 13.610198446047526, "cost2_min": -82.05426535364329, "outflow_rate_mean": 1121.9127064152904, "cost2_max": -18.150620141376653, "system_level_velocity_mean": 16.608027235103208, "outflow_rate_max": 1274.7175163526952}, "timesteps_since_restore": 1536579, "episode_reward_min": -452.20513068878}
{"timesteps_this_iter": 33660, "episodes_total": 1996, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 43, "episode_reward_max": -22.80858699265455, "pid": 292, "time_this_iter_s": 27.51332187652588, "time_total_s": 1226.9952020645142, "episodes_this_iter": 48, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 43, "episode_len_mean": 312.32, "info": {"grad_time_ms": 7520.637, "update_time_ms": 9.465, "sample_time_ms": 17163.457, "num_steps_trained": 1570239, "num_steps_sampled": 1570239, "default": {"vf_loss": 15.793285369873047, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.004634004086256027, "total_loss": 15.78896713256836, "cur_lr": 0.0005000000237487257, "kl": 0.012635267339646816, "entropy": 1.0398075580596924, "vf_explained_var": 0.8758445978164673}, "load_time_ms": 2.843}, "timesteps_total": 1570239, "date": "2019-05-24_05-01-22", "episode_reward_mean": -329.35871314541515, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a79e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7898>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7da0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558674082, "node_ip": "10.138.0.2", "time_since_restore": 1226.9952020645142, "custom_metrics": {"system_level_velocity_max": 18.54398306452865, "cost1_mean": 184.96467347896592, "cost1_min": 18.13745689041836, "cost1_max": 212.97241459453187, "cost2_mean": -58.31135799256873, "outflow_rate_min": 478.34341239403955, "system_level_velocity_min": 12.779077609729685, "cost2_min": -82.05426535364329, "outflow_rate_mean": 1120.9933045375546, "cost2_max": -18.150620141376653, "system_level_velocity_mean": 16.324833224879992, "outflow_rate_max": 1311.7766672535113}, "timesteps_since_restore": 1570239, "episode_reward_min": -599.9212895615884}
{"timesteps_this_iter": 32059, "episodes_total": 2041, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 44, "episode_reward_max": -34.06411156130982, "pid": 292, "time_this_iter_s": 25.71598243713379, "time_total_s": 1252.711184501648, "episodes_this_iter": 45, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 44, "episode_len_mean": 314.74, "info": {"grad_time_ms": 7474.596, "update_time_ms": 9.39, "sample_time_ms": 17570.204, "num_steps_trained": 1602298, "num_steps_sampled": 1602298, "default": {"vf_loss": 13.120095252990723, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.004976766649633646, "total_loss": 13.115486145019531, "cur_lr": 0.0005000000237487257, "kl": 0.014705274254083633, "entropy": 1.0200549364089966, "vf_explained_var": 0.8586048483848572}, "load_time_ms": 2.892}, "timesteps_total": 1602298, "date": "2019-05-24_05-01-47", "episode_reward_mean": -327.911547073418, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7080>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7470>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558674107, "node_ip": "10.138.0.2", "time_since_restore": 1252.711184501648, "custom_metrics": {"system_level_velocity_max": 18.52893056567827, "cost1_mean": 187.96306371719783, "cost1_min": 24.192086301049414, "cost1_max": 213.79262333098092, "cost2_mean": -58.326047143525976, "outflow_rate_min": 478.34341239403955, "system_level_velocity_min": 12.779077609729685, "cost2_min": -80.56386179449817, "outflow_rate_mean": 1133.7488158877975, "cost2_max": -23.500802650960104, "system_level_velocity_mean": 16.459965842554062, "outflow_rate_max": 1311.7766672535113}, "timesteps_since_restore": 1602298, "episode_reward_min": -599.9212895615884}
{"timesteps_this_iter": 31911, "episodes_total": 2089, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 45, "episode_reward_max": -162.27646835533216, "pid": 292, "time_this_iter_s": 25.05691647529602, "time_total_s": 1277.768100976944, "episodes_this_iter": 48, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 45, "episode_len_mean": 321.54, "info": {"grad_time_ms": 7411.933, "update_time_ms": 9.265, "sample_time_ms": 17798.697, "num_steps_trained": 1634209, "num_steps_sampled": 1634209, "default": {"vf_loss": 11.704981803894043, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.005090730730444193, "total_loss": 11.70025634765625, "cur_lr": 0.0005000000237487257, "kl": 0.014636346139013767, "entropy": 1.002667784690857, "vf_explained_var": 0.8767824172973633}, "load_time_ms": 2.88}, "timesteps_total": 1634209, "date": "2019-05-24_05-02-12", "episode_reward_mean": -318.4253572280601, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7ac8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558674132, "node_ip": "10.138.0.2", "time_since_restore": 1277.768100976944, "custom_metrics": {"system_level_velocity_max": 18.425311081994526, "cost1_mean": 194.774609951453, "cost1_min": 127.4687950333277, "cost1_max": 213.79262333098092, "cost2_mean": -56.81462642365087, "outflow_rate_min": 926.3754929577467, "system_level_velocity_min": 12.779077609729685, "cost2_min": -78.66777583626214, "outflow_rate_mean": 1150.8502819229814, "cost2_max": -35.862756020485016, "system_level_velocity_mean": 16.690550270929506, "outflow_rate_max": 1277.3899208529567}, "timesteps_since_restore": 1634209, "episode_reward_min": -563.2209714984544}
{"timesteps_this_iter": 32265, "episodes_total": 2134, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 46, "episode_reward_max": -170.2570798126724, "pid": 292, "time_this_iter_s": 25.92322325706482, "time_total_s": 1303.6913242340088, "episodes_this_iter": 45, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 46, "episode_len_mean": 322.87, "info": {"grad_time_ms": 7393.639, "update_time_ms": 9.015, "sample_time_ms": 17984.854, "num_steps_trained": 1666474, "num_steps_sampled": 1666474, "default": {"vf_loss": 12.322571754455566, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.004141122568398714, "total_loss": 12.318764686584473, "cur_lr": 0.0005000000237487257, "kl": 0.013371105305850506, "entropy": 0.9952613711357117, "vf_explained_var": 0.8713875412940979}, "load_time_ms": 2.891}, "timesteps_total": 1666474, "date": "2019-05-24_05-02-38", "episode_reward_mean": -313.8137846519488, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c45c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7b70>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558674158, "node_ip": "10.138.0.2", "time_since_restore": 1303.6913242340088, "custom_metrics": {"system_level_velocity_max": 18.41227435995981, "cost1_mean": 196.6463794948423, "cost1_min": 127.82380970071583, "cost1_max": 213.53886502029414, "cost2_mean": -56.37443373537377, "outflow_rate_min": 917.6680264668748, "system_level_velocity_min": 13.317601076087952, "cost2_min": -78.66777583626214, "outflow_rate_mean": 1155.6033761499887, "cost2_max": -36.36465662063301, "system_level_velocity_mean": 16.780589531017, "outflow_rate_max": 1286.1314102293813}, "timesteps_since_restore": 1666474, "episode_reward_min": -563.2209714984544}
{"timesteps_this_iter": 31824, "episodes_total": 2183, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 47, "episode_reward_max": -23.55961818593902, "pid": 292, "time_this_iter_s": 25.395602464675903, "time_total_s": 1329.0869266986847, "episodes_this_iter": 49, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 47, "episode_len_mean": 319.89, "info": {"grad_time_ms": 7370.876, "update_time_ms": 8.784, "sample_time_ms": 18147.698, "num_steps_trained": 1698298, "num_steps_sampled": 1698298, "default": {"vf_loss": 11.93234634399414, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0037746592424809933, "total_loss": 11.928982734680176, "cur_lr": 0.0005000000237487257, "kl": 0.01643267087638378, "entropy": 0.9704359769821167, "vf_explained_var": 0.8611937761306763}, "load_time_ms": 2.886}, "timesteps_total": 1698298, "date": "2019-05-24_05-03-04", "episode_reward_mean": -307.04403642086675, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7668>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7748>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558674184, "node_ip": "10.138.0.2", "time_since_restore": 1329.0869266986847, "custom_metrics": {"system_level_velocity_max": 18.498172834363707, "cost1_mean": 195.84793077628413, "cost1_min": 17.73754205372076, "cost1_max": 213.50289145909863, "cost2_mean": -55.04040740262952, "outflow_rate_min": 492.0625426222078, "system_level_velocity_min": 12.648615129211578, "cost2_min": -76.41623190389456, "outflow_rate_mean": 1153.9857511351197, "cost2_max": -17.39618315986232, "system_level_velocity_mean": 16.89905439913821, "outflow_rate_max": 1286.1314102293813}, "timesteps_since_restore": 1698298, "episode_reward_min": -507.0874537152386}
{"timesteps_this_iter": 33349, "episodes_total": 2230, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 48, "episode_reward_max": -23.55961818593902, "pid": 292, "time_this_iter_s": 26.7755925655365, "time_total_s": 1355.8625192642212, "episodes_this_iter": 47, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 48, "episode_len_mean": 322.02, "info": {"grad_time_ms": 7455.713, "update_time_ms": 8.607, "sample_time_ms": 18323.154, "num_steps_trained": 1731647, "num_steps_sampled": 1731647, "default": {"vf_loss": 11.664291381835938, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0021072395611554384, "total_loss": 11.662500381469727, "cur_lr": 0.0005000000237487257, "kl": 0.012638764455914497, "entropy": 0.9543835520744324, "vf_explained_var": 0.8829336166381836}, "load_time_ms": 2.893}, "timesteps_total": 1731647, "date": "2019-05-24_05-03-31", "episode_reward_mean": -317.2719487292814, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7320>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7da0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558674211, "node_ip": "10.138.0.2", "time_since_restore": 1355.8625192642212, "custom_metrics": {"system_level_velocity_max": 18.498172834363707, "cost1_mean": 195.9241337940101, "cost1_min": 17.73754205372076, "cost1_max": 214.9396270120034, "cost2_mean": -56.21230251878879, "outflow_rate_min": 492.0625426222078, "system_level_velocity_min": 12.648615129211578, "cost2_min": -75.90022579192905, "outflow_rate_mean": 1167.4122317247736, "cost2_max": -17.39618315986232, "system_level_velocity_mean": 16.74487656139292, "outflow_rate_max": 1275.41834622824}, "timesteps_since_restore": 1731647, "episode_reward_min": -525.096772270003}
{"timesteps_this_iter": 31908, "episodes_total": 2275, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 49, "episode_reward_max": -244.3611050706807, "pid": 292, "time_this_iter_s": 25.292065620422363, "time_total_s": 1381.1545848846436, "episodes_this_iter": 45, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 49, "episode_len_mean": 324.16, "info": {"grad_time_ms": 7554.705, "update_time_ms": 8.6, "sample_time_ms": 18220.508, "num_steps_trained": 1763555, "num_steps_sampled": 1763555, "default": {"vf_loss": 10.149781227111816, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.004120389930903912, "total_loss": 10.146004676818848, "cur_lr": 0.0005000000237487257, "kl": 0.013769245706498623, "entropy": 0.9672265648841858, "vf_explained_var": 0.8835822343826294}, "load_time_ms": 2.912}, "timesteps_total": 1763555, "date": "2019-05-24_05-03-56", "episode_reward_mean": -322.131482024915, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a79e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7c50>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558674236, "node_ip": "10.138.0.2", "time_since_restore": 1381.1545848846436, "custom_metrics": {"system_level_velocity_max": 18.70234710423115, "cost1_mean": 196.26286749349288, "cost1_min": 152.33889842550036, "cost1_max": 216.16288766213023, "cost2_mean": -56.46391072917058, "outflow_rate_min": 986.1016528925622, "system_level_velocity_min": 12.648615129211578, "cost2_min": -75.90022579192905, "outflow_rate_mean": 1169.2753199551566, "cost2_max": -39.8269489940951, "system_level_velocity_mean": 16.624416860840142, "outflow_rate_max": 1273.4040730445088}, "timesteps_since_restore": 1763555, "episode_reward_min": -525.096772270003}
{"timesteps_this_iter": 31855, "episodes_total": 2322, "done": true, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "hostname": "flow-main", "training_iteration": 50, "episode_reward_max": -244.3611050706807, "pid": 292, "time_this_iter_s": 25.279788494110107, "time_total_s": 1406.4343733787537, "episodes_this_iter": 47, "experiment_id": "3ae42663502146aa84b90f4ef1009ca2", "iterations_since_restore": 50, "episode_len_mean": 324.16, "info": {"grad_time_ms": 7633.804, "update_time_ms": 8.784, "sample_time_ms": 18108.311, "num_steps_trained": 1795410, "num_steps_sampled": 1795410, "default": {"vf_loss": 11.241554260253906, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0043338085524737835, "total_loss": 11.237560272216797, "cur_lr": 0.0005000000237487257, "kl": 0.01360439881682396, "entropy": 0.9703190326690674, "vf_explained_var": 0.8773783445358276}, "load_time_ms": 2.917}, "timesteps_total": 1795410, "date": "2019-05-24_05-04-21", "episode_reward_mean": -308.12629245943646, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4278>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7a58>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "timestamp": 1558674261, "node_ip": "10.138.0.2", "time_since_restore": 1406.4343733787537, "custom_metrics": {"system_level_velocity_max": 18.70234710423115, "cost1_mean": 198.9268707781857, "cost1_min": 151.17729236848712, "cost1_max": 216.16288766213023, "cost2_mean": -54.79119732014293, "outflow_rate_min": 924.0933022148129, "system_level_velocity_min": 12.440148459653726, "cost2_min": -71.34445108487144, "outflow_rate_mean": 1171.1912617729968, "cost2_max": -39.744612328963406, "system_level_velocity_mean": 16.901518578363053, "outflow_rate_max": 1273.4040730445088}, "timesteps_since_restore": 1795410, "episode_reward_min": -487.0124079912868}

{"iterations_since_restore": 1, "info": {"default": {"kl": 0.002226036274805665, "total_loss": 36.365379333496094, "vf_loss": 36.365928649902344, "vf_explained_var": -3.796635326125397e-07, "cur_lr": 0.0005000000237487257, "entropy": 1.4127435684204102, "cur_kl_coeff": 0.20000004768371582, "policy_loss": -0.0009949493687599897}, "num_steps_trained": 42284, "update_time_ms": 2532.582, "num_steps_sampled": 42284, "sample_time_ms": 65668.162, "load_time_ms": 93.074, "grad_time_ms": 12364.284}, "hostname": "flow-main", "episode_reward_max": -529.781866356766, "timesteps_this_iter": 42284, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 146.81549461986123, "cost1_min": 101.82008538949958, "system_level_velocity_mean": 10.288853397294565, "cost2_mean": -50.19860614683662, "cost2_max": -29.28010408211781, "outflow_rate_max": 924.4370023419201, "cost1_mean": 124.1256008301832, "system_level_velocity_min": 8.48788204600678, "system_level_velocity_max": 11.944144217041487, "outflow_rate_min": 417.68931147541, "cost2_min": -87.40782188711759, "outflow_rate_mean": 746.5032352867479}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 42284, "time_total_s": 80.78251433372498, "timestamp": 1558609968, "time_since_restore": 80.78251433372498, "training_iteration": 1, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a390>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 40, "timesteps_total": 42284, "episode_reward_mean": -713.7177936552122, "episodes_this_iter": 40, "date": "2019-05-23_11-12-48", "time_this_iter_s": 80.78251433372498, "num_metric_batches_dropped": 0, "episode_reward_min": -922.6946972818213}
{"iterations_since_restore": 2, "info": {"default": {"kl": 0.006330989301204681, "total_loss": 60.54017639160156, "vf_loss": 60.54152297973633, "vf_explained_var": -2.6277712095179595e-07, "cur_lr": 0.0005000000237487257, "entropy": 1.4057414531707764, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0019850037060678005}, "num_steps_trained": 83749, "update_time_ms": 1269.898, "num_steps_sampled": 83749, "sample_time_ms": 41733.612, "load_time_ms": 60.211, "grad_time_ms": 11780.098}, "hostname": "flow-main", "episode_reward_max": -505.92017567421584, "timesteps_this_iter": 41465, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 155.9106854787799, "cost1_min": 101.82008538949958, "system_level_velocity_mean": 10.6012392226061, "cost2_mean": -50.6379948564681, "cost2_max": -24.89406800069881, "outflow_rate_max": 982.3781074530634, "cost1_mean": 127.75850439325545, "system_level_velocity_min": 8.419338996633241, "system_level_velocity_max": 12.646685118069458, "outflow_rate_min": 417.68931147541, "cost2_min": -87.40782188711759, "outflow_rate_mean": 785.5608431133971}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 83749, "time_total_s": 109.89687061309814, "timestamp": 1558609997, "time_since_restore": 109.89687061309814, "training_iteration": 2, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84698eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846980f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846987f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 80, "timesteps_total": 83749, "episode_reward_mean": -686.1699175879974, "episodes_this_iter": 40, "date": "2019-05-23_11-13-17", "time_this_iter_s": 29.11435627937317, "num_metric_batches_dropped": 0, "episode_reward_min": -922.6946972818213}
{"iterations_since_restore": 3, "info": {"default": {"kl": 0.005704553797841072, "total_loss": 84.6838150024414, "vf_loss": 84.6848373413086, "vf_explained_var": -5.426966254162835e-08, "cur_lr": 0.0005000000237487257, "entropy": 1.4058127403259277, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0015857638791203499}, "num_steps_trained": 125328, "update_time_ms": 849.889, "num_steps_sampled": 125328, "sample_time_ms": 33866.383, "load_time_ms": 49.218, "grad_time_ms": 11622.705}, "hostname": "flow-main", "episode_reward_max": -494.64131656583703, "timesteps_this_iter": 41579, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 165.24773929088258, "cost1_min": 101.82008538949958, "system_level_velocity_mean": 11.067338512548456, "cost2_mean": -51.542635316551554, "cost2_max": -24.89406800069881, "outflow_rate_max": 1105.2631524284695, "cost1_mean": 132.85830464842599, "system_level_velocity_min": 8.419338996633241, "system_level_velocity_max": 13.689628613903109, "outflow_rate_min": 650.3969032258065, "cost2_min": -89.09245118775453, "outflow_rate_mean": 828.6118363453107}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 125328, "time_total_s": 139.46858072280884, "timestamp": 1558610026, "time_since_restore": 139.46858072280884, "training_iteration": 3, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2cc0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 120, "timesteps_total": 125328, "episode_reward_mean": -650.563248344518, "episodes_this_iter": 40, "date": "2019-05-23_11-13-46", "time_this_iter_s": 29.571710109710693, "num_metric_batches_dropped": 0, "episode_reward_min": -888.8541016774194}
{"iterations_since_restore": 4, "info": {"default": {"kl": 0.004069484304636717, "total_loss": 111.74442291259766, "vf_loss": 111.7453842163086, "vf_explained_var": -1.9868215517249155e-08, "cur_lr": 0.0005000000237487257, "entropy": 1.3884347677230835, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0013728516642004251}, "num_steps_trained": 165699, "update_time_ms": 639.499, "num_steps_sampled": 165699, "sample_time_ms": 30389.455, "load_time_ms": 42.381, "grad_time_ms": 11504.333}, "hostname": "flow-main", "episode_reward_max": -29.89824609748217, "timesteps_this_iter": 40371, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 183.08847796991355, "cost1_min": 22.88239155357826, "system_level_velocity_mean": 12.304198308375259, "cost2_mean": -60.62105166741254, "cost2_max": -21.4183008379338, "outflow_rate_max": 1167.8726977040815, "cost1_mean": 146.04129361361086, "system_level_velocity_min": 9.248680116188972, "system_level_velocity_max": 18.354569870864623, "outflow_rate_min": 488.20707635093754, "cost2_min": -97.99039529000473, "outflow_rate_mean": 927.8551360826366}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 165699, "time_total_s": 170.7061483860016, "timestamp": 1558610058, "time_since_restore": 170.7061483860016, "training_iteration": 4, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b5f8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 181, "timesteps_total": 165699, "episode_reward_mean": -584.3333065953329, "episodes_this_iter": 61, "date": "2019-05-23_11-14-18", "time_this_iter_s": 31.23756766319275, "num_metric_batches_dropped": 0, "episode_reward_min": -837.0556731024967}
{"iterations_since_restore": 5, "info": {"default": {"kl": 0.006915848236531019, "total_loss": 42.09636688232422, "vf_loss": 42.09815216064453, "vf_explained_var": 0.5713894367218018, "cur_lr": 0.0005000000237487257, "entropy": 1.3846585750579834, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0021324956323951483}, "num_steps_trained": 207232, "update_time_ms": 513.629, "num_steps_sampled": 207232, "sample_time_ms": 27856.632, "load_time_ms": 39.051, "grad_time_ms": 11458.57}, "hostname": "flow-main", "episode_reward_max": -29.89824609748217, "timesteps_this_iter": 41533, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 183.08847796991355, "cost1_min": 22.88239155357826, "system_level_velocity_mean": 13.009353411827288, "cost2_mean": -68.7695424021455, "cost2_max": -21.4183008379338, "outflow_rate_max": 1201.3227311501128, "cost1_mean": 155.47413562493628, "system_level_velocity_min": 9.248680116188972, "system_level_velocity_max": 18.354569870864623, "outflow_rate_min": 488.20707635093754, "cost2_min": -100.08330144193665, "outflow_rate_mean": 1000.5226850815463}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 207232, "time_total_s": 199.82850003242493, "timestamp": 1558610087, "time_since_restore": 199.82850003242493, "training_iteration": 5, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa978>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 221, "timesteps_total": 207232, "episode_reward_mean": -553.9318454595691, "episodes_this_iter": 40, "date": "2019-05-23_11-14-47", "time_this_iter_s": 29.12235164642334, "num_metric_batches_dropped": 0, "episode_reward_min": -837.0556731024967}
{"iterations_since_restore": 6, "info": {"default": {"kl": 0.009050910361111164, "total_loss": 44.502220153808594, "vf_loss": 44.504459381103516, "vf_explained_var": 0.6873610019683838, "cur_lr": 0.0005000000237487257, "entropy": 1.3768876791000366, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0026885722763836384}, "num_steps_trained": 250280, "update_time_ms": 429.665, "num_steps_sampled": 250280, "sample_time_ms": 26575.658, "load_time_ms": 37.488, "grad_time_ms": 11545.133}, "hostname": "flow-main", "episode_reward_max": -424.7632073577037, "timesteps_this_iter": 43048, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 192.4288769373302, "cost1_min": 67.13249948088279, "system_level_velocity_mean": 13.353874524797389, "cost2_mean": -75.5813147805202, "cost2_max": -41.10472377233255, "outflow_rate_max": 1210.855826599451, "cost1_mean": 162.1671352902626, "system_level_velocity_min": 5.6971631170071415, "system_level_velocity_max": 15.816244085327506, "outflow_rate_min": 347.13428571428574, "cost2_min": -117.40627130696222, "outflow_rate_mean": 1046.039473900741}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 250280, "time_total_s": 232.1376235485077, "timestamp": 1558610119, "time_since_restore": 232.1376235485077, "training_iteration": 6, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f20f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2b38>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 261, "timesteps_total": 250280, "episode_reward_mean": -547.7894739558238, "episodes_this_iter": 40, "date": "2019-05-23_11-15-19", "time_this_iter_s": 32.309123516082764, "num_metric_batches_dropped": 0, "episode_reward_min": -1335.7315145538266}
{"iterations_since_restore": 7, "info": {"default": {"kl": 0.008836755529046059, "total_loss": 41.90263366699219, "vf_loss": 41.9053840637207, "vf_explained_var": 0.7530782222747803, "cur_lr": 0.0005000000237487257, "entropy": 1.3581390380859375, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0031939195469021797}, "num_steps_trained": 290627, "update_time_ms": 370.641, "num_steps_sampled": 290627, "sample_time_ms": 25690.682, "load_time_ms": 36.428, "grad_time_ms": 11494.415}, "hostname": "flow-main", "episode_reward_max": -31.996428821933765, "timesteps_this_iter": 40347, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 201.2713759304648, "cost1_min": 23.972677282030855, "system_level_velocity_mean": 14.087015268254891, "cost2_mean": -82.07086103297624, "cost2_max": -22.462787329556882, "outflow_rate_max": 1295.4251703526595, "cost1_mean": 169.77139985675197, "system_level_velocity_min": 5.6971631170071415, "system_level_velocity_max": 18.303904668981865, "outflow_rate_min": 347.13428571428574, "cost2_min": -117.99028684583595, "outflow_rate_mean": 1113.217013760438}, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 290627, "time_total_s": 263.8437979221344, "timestamp": 1558610151, "time_since_restore": 263.8437979221344, "training_iteration": 7, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faa20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa4a8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 322, "timesteps_total": 290627, "episode_reward_mean": -505.94636148635806, "episodes_this_iter": 61, "date": "2019-05-23_11-15-51", "time_this_iter_s": 31.70617437362671, "num_metric_batches_dropped": 0, "episode_reward_min": -1335.7315145538266}
{"iterations_since_restore": 8, "info": {"default": {"kl": 0.015054258517920971, "total_loss": 31.825271606445312, "vf_loss": 31.83018684387207, "vf_explained_var": 0.8067165613174438, "cur_lr": 0.0005000000237487257, "entropy": 1.354562520980835, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.005667896009981632}, "num_steps_trained": 329544, "update_time_ms": 325.455, "num_steps_sampled": 329544, "sample_time_ms": 24793.87, "load_time_ms": 35.256, "grad_time_ms": 11383.873}, "hostname": "flow-main", "episode_reward_max": -21.21654136340041, "timesteps_this_iter": 38917, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 201.2713759304648, "cost1_min": 17.952866710528422, "system_level_velocity_mean": 14.494935863281407, "cost2_mean": -79.4228324647896, "cost2_max": -18.561107167016516, "outflow_rate_max": 1308.780748935426, "cost1_mean": 171.8603202045768, "system_level_velocity_min": 10.37088799556216, "system_level_velocity_max": 18.303904668981865, "outflow_rate_min": 488.7227691798811, "cost2_min": -117.99028684583595, "outflow_rate_mean": 1131.5409638819326}, "episode_len_mean": 319.14, "node_ip": "10.138.0.2", "timesteps_since_restore": 329544, "time_total_s": 293.1006169319153, "timestamp": 1558610180, "time_since_restore": 293.1006169319153, "training_iteration": 8, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a2b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 363, "timesteps_total": 329544, "episode_reward_mean": -472.84522191121505, "episodes_this_iter": 41, "date": "2019-05-23_11-16-20", "time_this_iter_s": 29.256819009780884, "num_metric_batches_dropped": 0, "episode_reward_min": -824.3972879243205}
{"iterations_since_restore": 9, "info": {"default": {"kl": 0.009476780891418457, "total_loss": 32.6900634765625, "vf_loss": 32.69392395019531, "vf_explained_var": 0.7985471487045288, "cur_lr": 0.0005000000237487257, "entropy": 1.3502272367477417, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004329988267272711}, "num_steps_trained": 370096, "update_time_ms": 290.552, "num_steps_sampled": 370096, "sample_time_ms": 24162.102, "load_time_ms": 32.674, "grad_time_ms": 11304.034}, "hostname": "flow-main", "episode_reward_max": -21.21654136340041, "timesteps_this_iter": 40552, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 209.6995825456521, "cost1_min": 17.952866710528422, "system_level_velocity_mean": 14.654278846856466, "cost2_mean": -80.01755226836568, "cost2_max": -18.561107167016516, "outflow_rate_max": 1350.2807834101377, "cost1_mean": 175.19559449088047, "system_level_velocity_min": 10.37088799556216, "system_level_velocity_max": 17.843624598383897, "outflow_rate_min": 492.0625426222078, "cost2_min": -120.11940995836324, "outflow_rate_mean": 1140.0110947002013}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 370096, "time_total_s": 322.97552824020386, "timestamp": 1558610210, "time_since_restore": 322.97552824020386, "training_iteration": 9, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f25f8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 403, "timesteps_total": 370096, "episode_reward_mean": -472.08766578319205, "episodes_this_iter": 40, "date": "2019-05-23_11-16-50", "time_this_iter_s": 29.874911308288574, "num_metric_batches_dropped": 0, "episode_reward_min": -832.1734461212299}
{"iterations_since_restore": 10, "info": {"default": {"kl": 0.009931893087923527, "total_loss": 41.85535430908203, "vf_loss": 41.858436584472656, "vf_explained_var": 0.7447054982185364, "cur_lr": 0.0005000000237487257, "entropy": 1.340080976486206, "cur_kl_coeff": 0.05000000074505806, "policy_loss": -0.003574841655790806}, "num_steps_trained": 412245, "update_time_ms": 262.297, "num_steps_sampled": 412245, "sample_time_ms": 23849.648, "load_time_ms": 31.855, "grad_time_ms": 11308.673}, "hostname": "flow-main", "episode_reward_max": -311.44121764130347, "timesteps_this_iter": 42149, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 211.9702554507361, "cost1_min": 126.8044570435788, "system_level_velocity_mean": 14.983487458841028, "cost2_mean": -92.80287982076945, "cost2_max": -50.616636308763745, "outflow_rate_max": 1391.5470171056595, "cost1_mean": 181.0405608276543, "system_level_velocity_min": 10.517049172310623, "system_level_velocity_max": 17.70689992179555, "outflow_rate_min": 859.1960564494054, "cost2_min": -125.16598701088894, "outflow_rate_mean": 1171.3610387556685}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 412245, "time_total_s": 355.47662830352783, "timestamp": 1558610243, "time_since_restore": 355.47662830352783, "training_iteration": 10, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f25c0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 460, "timesteps_total": 412245, "episode_reward_mean": -482.5251134621147, "episodes_this_iter": 57, "date": "2019-05-23_11-17-23", "time_this_iter_s": 32.501100063323975, "num_metric_batches_dropped": 0, "episode_reward_min": -832.1734461212299}
{"iterations_since_restore": 11, "info": {"default": {"kl": 0.007440271321684122, "total_loss": 34.386192321777344, "vf_loss": 34.3889274597168, "vf_explained_var": 0.7700650095939636, "cur_lr": 0.0005000000237487257, "entropy": 1.3276407718658447, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.003105290699750185}, "num_steps_trained": 454999, "update_time_ms": 10.068, "num_steps_sampled": 454999, "sample_time_ms": 19443.124, "load_time_ms": 24.856, "grad_time_ms": 11233.888}, "hostname": "flow-main", "episode_reward_max": -293.77197007508676, "timesteps_this_iter": 42754, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 216.1601292133903, "cost1_min": 147.38834502012526, "system_level_velocity_mean": 15.138731363481146, "cost2_mean": -103.75566783443101, "cost2_max": -58.00740221246231, "outflow_rate_max": 1394.3584439240176, "cost1_mean": 183.01561066628892, "system_level_velocity_min": 12.17850488298517, "system_level_velocity_max": 18.075626778040046, "outflow_rate_min": 920.7465524834843, "cost2_min": -132.48582857562783, "outflow_rate_mean": 1192.746350864581}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 454999, "time_total_s": 388.8191683292389, "timestamp": 1558610276, "time_since_restore": 388.8191683292389, "training_iteration": 11, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845652e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565c18>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 503, "timesteps_total": 454999, "episode_reward_mean": -497.2206202564472, "episodes_this_iter": 43, "date": "2019-05-23_11-17-56", "time_this_iter_s": 33.34254002571106, "num_metric_batches_dropped": 0, "episode_reward_min": -803.1656553806682}
{"iterations_since_restore": 12, "info": {"default": {"kl": 0.008465724997222424, "total_loss": 28.647335052490234, "vf_loss": 28.649566650390625, "vf_explained_var": 0.8228045105934143, "cur_lr": 0.0005000000237487257, "entropy": 1.3224456310272217, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0026550665497779846}, "num_steps_trained": 498575, "update_time_ms": 10.544, "num_steps_sampled": 498575, "sample_time_ms": 19679.748, "load_time_ms": 24.936, "grad_time_ms": 11286.559}, "hostname": "flow-main", "episode_reward_max": -293.77197007508676, "timesteps_this_iter": 43576, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 216.1601292133903, "cost1_min": 148.66738462500973, "system_level_velocity_mean": 15.15840946960845, "cost2_mean": -109.22389080393972, "cost2_max": -70.25463326211823, "outflow_rate_max": 1405.1444897959177, "cost1_mean": 183.19797905411758, "system_level_velocity_min": 12.36816996276054, "system_level_velocity_max": 18.075626778040046, "outflow_rate_min": 982.2121970576846, "cost2_min": -133.5291342260696, "outflow_rate_mean": 1202.2257655861074}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 498575, "time_total_s": 420.84488010406494, "timestamp": 1558610308, "time_since_restore": 420.84488010406494, "training_iteration": 12, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b5f8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 543, "timesteps_total": 498575, "episode_reward_mean": -508.73097116971365, "episodes_this_iter": 40, "date": "2019-05-23_11-18-28", "time_this_iter_s": 32.02571177482605, "num_metric_batches_dropped": 0, "episode_reward_min": -771.716278608904}
{"iterations_since_restore": 13, "info": {"default": {"kl": 0.00844679307192564, "total_loss": 35.98750686645508, "vf_loss": 35.989593505859375, "vf_explained_var": 0.7737322449684143, "cur_lr": 0.0005000000237487257, "entropy": 1.3153257369995117, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002510267775505781}, "num_steps_trained": 541002, "update_time_ms": 10.51, "num_steps_sampled": 541002, "sample_time_ms": 19964.369, "load_time_ms": 24.834, "grad_time_ms": 11315.013}, "hostname": "flow-main", "episode_reward_max": -292.2083943857366, "timesteps_this_iter": 42427, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 219.04341977685345, "cost1_min": 149.42900898147082, "system_level_velocity_mean": 15.450352311500728, "cost2_mean": -110.91059327531418, "cost2_max": -83.24342545257687, "outflow_rate_max": 1416.462264616792, "cost1_mean": 186.59943132604502, "system_level_velocity_min": 12.42101792269056, "system_level_velocity_max": 18.23236349208537, "outflow_rate_min": 1035.261523022432, "cost2_min": -134.03811799598353, "outflow_rate_mean": 1225.4052227364161}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 541002, "time_total_s": 453.5341432094574, "timestamp": 1558610341, "time_since_restore": 453.5341432094574, "training_iteration": 13, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84698898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846987f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84698080>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 600, "timesteps_total": 541002, "episode_reward_mean": -490.9882591735246, "episodes_this_iter": 57, "date": "2019-05-23_11-19-01", "time_this_iter_s": 32.689263105392456, "num_metric_batches_dropped": 0, "episode_reward_min": -771.716278608904}
{"iterations_since_restore": 14, "info": {"default": {"kl": 0.008636119775474072, "total_loss": 30.583757400512695, "vf_loss": 30.58652114868164, "vf_explained_var": 0.796143114566803, "cur_lr": 0.0005000000237487257, "entropy": 1.3124737739562988, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.00319574773311615}, "num_steps_trained": 583889, "update_time_ms": 10.523, "num_steps_sampled": 583889, "sample_time_ms": 20051.442, "load_time_ms": 25.114, "grad_time_ms": 11418.829}, "hostname": "flow-main", "episode_reward_max": -285.60869124498515, "timesteps_this_iter": 42887, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.00922717099812, "cost1_min": 112.26796373815887, "system_level_velocity_mean": 15.355458120682554, "cost2_mean": -111.51675554186531, "cost2_max": -83.24342545257687, "outflow_rate_max": 1431.7818298930256, "cost1_mean": 185.4257528932514, "system_level_velocity_min": 9.313208087327657, "system_level_velocity_max": 18.390434537755215, "outflow_rate_min": 961.1768339768337, "cost2_min": -134.03811799598353, "outflow_rate_mean": 1222.7097536223707}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 583889, "time_total_s": 486.67015647888184, "timestamp": 1558610374, "time_since_restore": 486.67015647888184, "training_iteration": 14, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84961ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa4a8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 643, "timesteps_total": 583889, "episode_reward_mean": -495.0442741734327, "episodes_this_iter": 43, "date": "2019-05-23_11-19-34", "time_this_iter_s": 33.13601326942444, "num_metric_batches_dropped": 0, "episode_reward_min": -802.1905842607833}
{"iterations_since_restore": 15, "info": {"default": {"kl": 0.010781054385006428, "total_loss": 28.507978439331055, "vf_loss": 28.510602951049805, "vf_explained_var": 0.8264991044998169, "cur_lr": 0.0005000000237487257, "entropy": 1.3184751272201538, "cur_kl_coeff": 0.05000000074505806, "policy_loss": -0.0031646359711885452}, "num_steps_trained": 626002, "update_time_ms": 10.33, "num_steps_sampled": 626002, "sample_time_ms": 20211.836, "load_time_ms": 24.772, "grad_time_ms": 11456.865}, "hostname": "flow-main", "episode_reward_max": -285.60869124498515, "timesteps_this_iter": 42113, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.00922717099812, "cost1_min": 112.26796373815887, "system_level_velocity_mean": 15.283227811126281, "cost2_mean": -112.43176040023451, "cost2_max": -87.64421483170996, "outflow_rate_max": 1431.7818298930256, "cost1_mean": 184.70749329275384, "system_level_velocity_min": 9.313208087327657, "system_level_velocity_max": 18.390434537755215, "outflow_rate_min": 961.1768339768337, "cost2_min": -130.36986205641705, "outflow_rate_mean": 1217.4864061388566}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 626002, "time_total_s": 517.7697417736053, "timestamp": 1558610405, "time_since_restore": 517.7697417736053, "training_iteration": 15, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845419e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2dd8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 683, "timesteps_total": 626002, "episode_reward_mean": -499.68133087148124, "episodes_this_iter": 40, "date": "2019-05-23_11-20-05", "time_this_iter_s": 31.09958529472351, "num_metric_batches_dropped": 0, "episode_reward_min": -802.1905842607833}
{"iterations_since_restore": 16, "info": {"default": {"kl": 0.007418063934892416, "total_loss": 24.74592399597168, "vf_loss": 24.748380661010742, "vf_explained_var": 0.8278017044067383, "cur_lr": 0.0005000000237487257, "entropy": 1.3191680908203125, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0028270280454307795}, "num_steps_trained": 667391, "update_time_ms": 10.355, "num_steps_sampled": 667391, "sample_time_ms": 20024.998, "load_time_ms": 24.327, "grad_time_ms": 11399.019}, "hostname": "flow-main", "episode_reward_max": -287.3908356629644, "timesteps_this_iter": 41389, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.16474463659046, "cost1_min": 112.26796373815887, "system_level_velocity_mean": 15.438820261686114, "cost2_mean": -110.96937134977233, "cost2_max": -87.64421483170996, "outflow_rate_max": 1408.1449972704283, "cost1_mean": 186.57328078521485, "system_level_velocity_min": 9.313208087327657, "system_level_velocity_max": 18.233492579782947, "outflow_rate_min": 961.1768339768337, "cost2_min": -128.50510777324513, "outflow_rate_mean": 1224.9421741877816}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 667391, "time_total_s": 547.590891122818, "timestamp": 1558610435, "time_since_restore": 547.590891122818, "training_iteration": 16, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456ab00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a898>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 723, "timesteps_total": 667391, "episode_reward_mean": -485.97804588495035, "episodes_this_iter": 40, "date": "2019-05-23_11-20-35", "time_this_iter_s": 29.821149349212646, "num_metric_batches_dropped": 0, "episode_reward_min": -802.1905842607833}
{"iterations_since_restore": 17, "info": {"default": {"kl": 0.00807285588234663, "total_loss": 27.91340446472168, "vf_loss": 27.91545295715332, "vf_explained_var": 0.7932860851287842, "cur_lr": 0.0005000000237487257, "entropy": 1.3108139038085938, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0024551129899919033}, "num_steps_trained": 707867, "update_time_ms": 9.725, "num_steps_sampled": 707867, "sample_time_ms": 20017.579, "load_time_ms": 22.54, "grad_time_ms": 11388.968}, "hostname": "flow-main", "episode_reward_max": -287.3908356629644, "timesteps_this_iter": 40476, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.25880144668702, "cost1_min": 148.7760425192418, "system_level_velocity_mean": 15.740530347949164, "cost2_mean": -106.9390128918528, "cost2_max": -86.5566073668248, "outflow_rate_max": 1400.978150689071, "cost1_mean": 190.42460322198573, "system_level_velocity_min": 12.312022036907262, "system_level_velocity_max": 18.114262575574205, "outflow_rate_min": 1047.285116271399, "cost2_min": -125.71070287802654, "outflow_rate_mean": 1250.1227034291958}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 707867, "time_total_s": 579.090601682663, "timestamp": 1558610467, "time_since_restore": 579.090601682663, "training_iteration": 17, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84698160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84698080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846988d0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 783, "timesteps_total": 707867, "episode_reward_mean": -452.35649107779375, "episodes_this_iter": 60, "date": "2019-05-23_11-21-07", "time_this_iter_s": 31.49971055984497, "num_metric_batches_dropped": 0, "episode_reward_min": -756.4290615006261}
{"iterations_since_restore": 18, "info": {"default": {"kl": 0.011036057956516743, "total_loss": 20.788753509521484, "vf_loss": 20.79290008544922, "vf_explained_var": 0.8335897922515869, "cur_lr": 0.0005000000237487257, "entropy": 1.2847576141357422, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004700143821537495}, "num_steps_trained": 748349, "update_time_ms": 9.749, "num_steps_sampled": 748349, "sample_time_ms": 20110.504, "load_time_ms": 21.351, "grad_time_ms": 11494.007}, "hostname": "flow-main", "episode_reward_max": -110.79466261010178, "timesteps_this_iter": 40482, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 216.71295008880242, "cost1_min": 85.51676307330898, "system_level_velocity_mean": 15.68172004214316, "cost2_mean": -102.59102763858196, "cost2_max": -57.635915769356174, "outflow_rate_max": 1400.978150689071, "cost1_mean": 188.57401375623448, "system_level_velocity_min": 11.68431603844651, "system_level_velocity_max": 18.508607756887855, "outflow_rate_min": 813.6001084381402, "cost2_min": -121.9295092485733, "outflow_rate_mean": 1247.9089322024813}, "episode_len_mean": 323.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 748349, "time_total_s": 610.3057796955109, "timestamp": 1558610498, "time_since_restore": 610.3057796955109, "training_iteration": 18, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faf98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faba8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 824, "timesteps_total": 748349, "episode_reward_mean": -438.3854909293313, "episodes_this_iter": 41, "date": "2019-05-23_11-21-38", "time_this_iter_s": 31.2151780128479, "num_metric_batches_dropped": 0, "episode_reward_min": -676.6889503216397}
{"iterations_since_restore": 19, "info": {"default": {"kl": 0.012174904346466064, "total_loss": 19.781585693359375, "vf_loss": 19.786346435546875, "vf_explained_var": 0.8428174257278442, "cur_lr": 0.0005000000237487257, "entropy": 1.283874750137329, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.005369309801608324}, "num_steps_trained": 788688, "update_time_ms": 9.523, "num_steps_sampled": 788688, "sample_time_ms": 20126.802, "load_time_ms": 22.392, "grad_time_ms": 11512.949}, "hostname": "flow-main", "episode_reward_max": -30.529135170852157, "timesteps_this_iter": 40339, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 216.71295008880242, "cost1_min": 22.976923161952502, "system_level_velocity_mean": 15.416927129885053, "cost2_mean": -99.26058526946562, "cost2_max": -24.69132327817269, "outflow_rate_max": 1405.6265180980868, "cost1_mean": 183.65780437558413, "system_level_velocity_min": 10.965501896701369, "system_level_velocity_max": 18.508607756887855, "outflow_rate_min": 460.7989278777953, "cost2_min": -117.48541114060124, "outflow_rate_mean": 1232.5068933294199}, "episode_len_mean": 320.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 788688, "time_total_s": 640.5460307598114, "timestamp": 1558610528, "time_since_restore": 640.5460307598114, "training_iteration": 19, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456aac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456aa90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a748>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 865, "timesteps_total": 788688, "episode_reward_mean": -438.85721701380675, "episodes_this_iter": 41, "date": "2019-05-23_11-22-08", "time_this_iter_s": 30.240251064300537, "num_metric_batches_dropped": 0, "episode_reward_min": -734.8343521589037}
{"iterations_since_restore": 20, "info": {"default": {"kl": 0.008602399379014969, "total_loss": 25.41008949279785, "vf_loss": 25.413333892822266, "vf_explained_var": 0.8153907060623169, "cur_lr": 0.0005000000237487257, "entropy": 1.2777906656265259, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0036747492849826813}, "num_steps_trained": 830217, "update_time_ms": 9.699, "num_steps_sampled": 830217, "sample_time_ms": 20163.514, "load_time_ms": 22.178, "grad_time_ms": 11665.834}, "hostname": "flow-main", "episode_reward_max": -22.469447607425074, "timesteps_this_iter": 41529, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.15015103326388, "cost1_min": 17.655732666829863, "system_level_velocity_mean": 14.956173096539047, "cost2_mean": -99.36369391300222, "cost2_max": -17.33779623881617, "outflow_rate_max": 1416.7757293087593, "cost1_mean": 177.7338699602559, "system_level_velocity_min": 10.965501896701369, "system_level_velocity_max": 18.411371150524182, "outflow_rate_min": 460.7989278777953, "cost2_min": -117.48541114060124, "outflow_rate_mean": 1206.4337859088014}, "episode_len_mean": 319.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 830217, "time_total_s": 674.9611179828644, "timestamp": 1558610563, "time_since_restore": 674.9611179828644, "training_iteration": 20, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fabe0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 925, "timesteps_total": 830217, "episode_reward_mean": -466.47506315449186, "episodes_this_iter": 60, "date": "2019-05-23_11-22-43", "time_this_iter_s": 34.41508722305298, "num_metric_batches_dropped": 0, "episode_reward_min": -734.8343521589037}
{"iterations_since_restore": 21, "info": {"default": {"kl": 0.009287137538194656, "total_loss": 18.614030838012695, "vf_loss": 18.61792755126953, "vf_explained_var": 0.8711263537406921, "cur_lr": 0.0005000000237487257, "entropy": 1.2656481266021729, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004361978266388178}, "num_steps_trained": 871516, "update_time_ms": 10.2, "num_steps_sampled": 871516, "sample_time_ms": 20012.97, "load_time_ms": 22.538, "grad_time_ms": 11589.906}, "hostname": "flow-main", "episode_reward_max": -22.469447607425074, "timesteps_this_iter": 41299, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 219.04148722155657, "cost1_min": 17.655732666829863, "system_level_velocity_mean": 15.026297629211683, "cost2_mean": -102.48686993444129, "cost2_max": -17.33779623881617, "outflow_rate_max": 1424.1477909443347, "cost1_mean": 180.48789542554655, "system_level_velocity_min": 11.256620221501153, "system_level_velocity_max": 18.295770875224818, "outflow_rate_min": 477.24354782665716, "cost2_min": -115.37124848574763, "outflow_rate_mean": 1216.4191228952739}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 871516, "time_total_s": 706.0592586994171, "timestamp": 1558610594, "time_since_restore": 706.0592586994171, "training_iteration": 21, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f25f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2f60>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 966, "timesteps_total": 871516, "episode_reward_mean": -477.6060979309227, "episodes_this_iter": 41, "date": "2019-05-23_11-23-14", "time_this_iter_s": 31.098140716552734, "num_metric_batches_dropped": 0, "episode_reward_min": -710.891978894421}
{"iterations_since_restore": 22, "info": {"default": {"kl": 0.012033633887767792, "total_loss": 18.45624542236328, "vf_loss": 18.460004806518555, "vf_explained_var": 0.8848084807395935, "cur_lr": 0.0005000000237487257, "entropy": 1.25661301612854, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004360873252153397}, "num_steps_trained": 913401, "update_time_ms": 10.078, "num_steps_sampled": 913401, "sample_time_ms": 20000.52, "load_time_ms": 22.62, "grad_time_ms": 11603.705}, "hostname": "flow-main", "episode_reward_max": -108.02280939650622, "timesteps_this_iter": 41885, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 219.04148722155657, "cost1_min": 83.59966756516651, "system_level_velocity_mean": 15.373081110306691, "cost2_mean": -105.45139372660529, "cost2_max": -55.75800325793729, "outflow_rate_max": 1424.1477909443347, "cost1_mean": 184.93731349252644, "system_level_velocity_min": 12.589810929139032, "system_level_velocity_max": 18.495558869684547, "outflow_rate_min": 803.4336676656768, "cost2_min": -122.21720573265235, "outflow_rate_mean": 1235.1325086993318}, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 913401, "time_total_s": 738.1108684539795, "timestamp": 1558610626, "time_since_restore": 738.1108684539795, "training_iteration": 22, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa908>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1007, "timesteps_total": 913401, "episode_reward_mean": -471.31976464355535, "episodes_this_iter": 41, "date": "2019-05-23_11-23-46", "time_this_iter_s": 32.05160975456238, "num_metric_batches_dropped": 0, "episode_reward_min": -661.480211770046}
{"iterations_since_restore": 23, "info": {"default": {"kl": 0.013542354106903076, "total_loss": 17.595844268798828, "vf_loss": 17.6009521484375, "vf_explained_var": 0.887163519859314, "cur_lr": 0.0005000000237487257, "entropy": 1.2474472522735596, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.005785862449556589}, "num_steps_trained": 956249, "update_time_ms": 10.126, "num_steps_sampled": 956249, "sample_time_ms": 19947.899, "load_time_ms": 21.278, "grad_time_ms": 11603.621}, "hostname": "flow-main", "episode_reward_max": -105.88609868000412, "timesteps_this_iter": 42848, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.8665547380022, "cost1_min": 83.59966756516651, "system_level_velocity_mean": 15.119476941119284, "cost2_mean": -106.88425306887795, "cost2_max": -55.75800325793729, "outflow_rate_max": 1428.3442174127717, "cost1_mean": 180.4573588420905, "system_level_velocity_min": 11.960237289212523, "system_level_velocity_max": 18.58030633869225, "outflow_rate_min": 789.6792828930248, "cost2_min": -122.21720573265235, "outflow_rate_mean": 1216.5953619786335}, "episode_len_mean": 321.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 956249, "time_total_s": 770.2586133480072, "timestamp": 1558610658, "time_since_restore": 770.2586133480072, "training_iteration": 23, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846984a8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1060, "timesteps_total": 956249, "episode_reward_mean": -488.2657081505289, "episodes_this_iter": 53, "date": "2019-05-23_11-24-18", "time_this_iter_s": 32.14774489402771, "num_metric_batches_dropped": 0, "episode_reward_min": -665.9278698508803}
{"iterations_since_restore": 24, "info": {"default": {"kl": 0.012690658681094646, "total_loss": 16.44267463684082, "vf_loss": 16.447317123413086, "vf_explained_var": 0.8940539360046387, "cur_lr": 0.0005000000237487257, "entropy": 1.2452373504638672, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.005278551485389471}, "num_steps_trained": 996869, "update_time_ms": 10.157, "num_steps_sampled": 996869, "sample_time_ms": 19828.965, "load_time_ms": 20.472, "grad_time_ms": 11492.116}, "hostname": "flow-main", "episode_reward_max": -105.88609868000412, "timesteps_this_iter": 40620, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.40394402817077, "cost1_min": 84.30777195764895, "system_level_velocity_mean": 15.070573608227795, "cost2_mean": -107.66793840509648, "cost2_max": -64.0728508048781, "outflow_rate_max": 1449.4755484353843, "cost1_mean": 180.93722541883665, "system_level_velocity_min": 11.76225036300552, "system_level_velocity_max": 18.824526912572534, "outflow_rate_min": 789.6792828930248, "cost2_min": -119.02863988904551, "outflow_rate_mean": 1221.5749101699753}, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 996869, "time_total_s": 801.0765383243561, "timestamp": 1558610689, "time_since_restore": 801.0765383243561, "training_iteration": 24, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faa58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa860>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1107, "timesteps_total": 996869, "episode_reward_mean": -495.6009772615161, "episodes_this_iter": 47, "date": "2019-05-23_11-24-49", "time_this_iter_s": 30.817924976348877, "num_metric_batches_dropped": 0, "episode_reward_min": -710.1232542619023}
{"iterations_since_restore": 25, "info": {"default": {"kl": 0.011210991069674492, "total_loss": 19.383699417114258, "vf_loss": 19.388093948364258, "vf_explained_var": 0.8880501389503479, "cur_lr": 0.0005000000237487257, "entropy": 1.2482285499572754, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004953684750944376}, "num_steps_trained": 1040058, "update_time_ms": 10.173, "num_steps_sampled": 1040058, "sample_time_ms": 19840.004, "load_time_ms": 21.149, "grad_time_ms": 11488.739}, "hostname": "flow-main", "episode_reward_max": -31.271915536282872, "timesteps_this_iter": 43189, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.40394402817077, "cost1_min": 24.45880051383282, "system_level_velocity_mean": 15.021813423813601, "cost2_mean": -107.05945563538867, "cost2_max": -26.340291334811194, "outflow_rate_max": 1449.4755484353843, "cost1_mean": 178.07906129132266, "system_level_velocity_min": 11.573540786665784, "system_level_velocity_max": 18.824526912572534, "outflow_rate_min": 474.24614310207676, "cost2_min": -119.52646815866918, "outflow_rate_mean": 1209.6926895899483}, "episode_len_mean": 320.15, "node_ip": "10.138.0.2", "timesteps_since_restore": 1040058, "time_total_s": 832.2684383392334, "timestamp": 1558610720, "time_since_restore": 832.2684383392334, "training_iteration": 25, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456ada0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456ab00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456ad68>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1150, "timesteps_total": 1040058, "episode_reward_mean": -503.9204475041372, "episodes_this_iter": 43, "date": "2019-05-23_11-25-20", "time_this_iter_s": 31.19190001487732, "num_metric_batches_dropped": 0, "episode_reward_min": -710.1232542619023}
{"iterations_since_restore": 26, "info": {"default": {"kl": 0.010875244624912739, "total_loss": 24.046571731567383, "vf_loss": 24.049516677856445, "vf_explained_var": 0.8662015199661255, "cur_lr": 0.0005000000237487257, "entropy": 1.2371169328689575, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0034889173693954945}, "num_steps_trained": 1083440, "update_time_ms": 10.115, "num_steps_sampled": 1083440, "sample_time_ms": 20125.028, "load_time_ms": 22.013, "grad_time_ms": 11524.826}, "hostname": "flow-main", "episode_reward_max": -31.271915536282872, "timesteps_this_iter": 43382, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 222.5193880690716, "cost1_min": 24.45880051383282, "system_level_velocity_mean": 14.841412934500942, "cost2_mean": -106.34562748294016, "cost2_max": -23.84439178173091, "outflow_rate_max": 1442.68125430887, "cost1_mean": 172.5706062160292, "system_level_velocity_min": 9.079873529021828, "system_level_velocity_max": 18.729309768566036, "outflow_rate_min": 474.24614310207676, "cost2_min": -119.92709908595938, "outflow_rate_mean": 1188.6320364000976}, "episode_len_mean": 315.2, "node_ip": "10.138.0.2", "timesteps_since_restore": 1083440, "time_total_s": 865.3155169487, "timestamp": 1558610753, "time_since_restore": 865.3155169487, "training_iteration": 26, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501080>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1202, "timesteps_total": 1083440, "episode_reward_mean": -516.1468119568723, "episodes_this_iter": 52, "date": "2019-05-23_11-25-53", "time_this_iter_s": 33.04707860946655, "num_metric_batches_dropped": 0, "episode_reward_min": -839.6119597775313}
{"iterations_since_restore": 27, "info": {"default": {"kl": 0.011044101789593697, "total_loss": 23.98515510559082, "vf_loss": 23.98941993713379, "vf_explained_var": 0.8782833814620972, "cur_lr": 0.0005000000237487257, "entropy": 1.214414358139038, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00481660570949316}, "num_steps_trained": 1126572, "update_time_ms": 9.933, "num_steps_sampled": 1126572, "sample_time_ms": 20264.848, "load_time_ms": 22.08, "grad_time_ms": 11601.37}, "hostname": "flow-main", "episode_reward_max": -21.830648077523097, "timesteps_this_iter": 43132, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.09690206286817, "cost1_min": 17.994307081514172, "system_level_velocity_mean": 14.953685259896213, "cost2_mean": -107.0207747107448, "cost2_max": -19.30621576873424, "outflow_rate_max": 1442.68125430887, "cost1_mean": 172.23030906391702, "system_level_velocity_min": 8.128279206293128, "system_level_velocity_max": 18.934419907018455, "outflow_rate_min": 476.10320957347216, "cost2_min": -122.62248212495349, "outflow_rate_mean": 1185.3379020174914}, "episode_len_mean": 313.07, "node_ip": "10.138.0.2", "timesteps_since_restore": 1126572, "time_total_s": 898.9958009719849, "timestamp": 1558610787, "time_since_restore": 898.9958009719849, "training_iteration": 27, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456ac18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa940>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1248, "timesteps_total": 1126572, "episode_reward_mean": -514.6757042582768, "episodes_this_iter": 46, "date": "2019-05-23_11-26-27", "time_this_iter_s": 33.68028402328491, "num_metric_batches_dropped": 0, "episode_reward_min": -839.6119597775313}
{"iterations_since_restore": 28, "info": {"default": {"kl": 0.014506864361464977, "total_loss": 23.669580459594727, "vf_loss": 23.675012588500977, "vf_explained_var": 0.8864193558692932, "cur_lr": 0.0005000000237487257, "entropy": 1.1937764883041382, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.006155562121421099}, "num_steps_trained": 1169974, "update_time_ms": 9.895, "num_steps_sampled": 1169974, "sample_time_ms": 20398.099, "load_time_ms": 22.984, "grad_time_ms": 11593.601}, "hostname": "flow-main", "episode_reward_max": -21.830648077523097, "timesteps_this_iter": 43402, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.38908173359442, "cost1_min": 17.994307081514172, "system_level_velocity_mean": 15.089365996574067, "cost2_mean": -113.07332436900751, "cost2_max": -19.30621576873424, "outflow_rate_max": 1451.1976256408273, "cost1_mean": 175.71103698773797, "system_level_velocity_min": 8.128279206293128, "system_level_velocity_max": 18.934419907018455, "outflow_rate_min": 476.10320957347216, "cost2_min": -130.4347079276787, "outflow_rate_mean": 1201.8193684706107}, "episode_len_mean": 315.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 1169974, "time_total_s": 931.4737107753754, "timestamp": 1558610819, "time_since_restore": 931.4737107753754, "training_iteration": 28, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b5f8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1296, "timesteps_total": 1169974, "episode_reward_mean": -521.9103214765114, "episodes_this_iter": 48, "date": "2019-05-23_11-26-59", "time_this_iter_s": 32.4779098033905, "num_metric_batches_dropped": 0, "episode_reward_min": -809.7550658784007}
{"iterations_since_restore": 29, "info": {"default": {"kl": 0.014678854495286942, "total_loss": 24.22985076904297, "vf_loss": 24.2351131439209, "vf_explained_var": 0.8829035758972168, "cur_lr": 0.0005000000237487257, "entropy": 1.2015924453735352, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.005996858235448599}, "num_steps_trained": 1213236, "update_time_ms": 9.876, "num_steps_sampled": 1213236, "sample_time_ms": 20489.977, "load_time_ms": 23.481, "grad_time_ms": 11726.293}, "hostname": "flow-main", "episode_reward_max": -94.88146148446704, "timesteps_this_iter": 43262, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.89538769502224, "cost1_min": 79.98263552394829, "system_level_velocity_mean": 15.361908579152246, "cost2_mean": -116.38046403505534, "cost2_max": -61.33794889518041, "outflow_rate_max": 1452.5437367932277, "cost1_mean": 180.71029223539804, "system_level_velocity_min": 11.38959612972609, "system_level_velocity_max": 18.93990138154836, "outflow_rate_min": 761.4254757495632, "cost2_min": -130.4347079276787, "outflow_rate_mean": 1226.0849716690727}, "episode_len_mean": 318.69, "node_ip": "10.138.0.2", "timesteps_since_restore": 1213236, "time_total_s": 963.9872786998749, "timestamp": 1558610852, "time_since_restore": 963.9872786998749, "training_iteration": 29, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845019b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1338, "timesteps_total": 1213236, "episode_reward_mean": -515.1624412626351, "episodes_this_iter": 42, "date": "2019-05-23_11-27-32", "time_this_iter_s": 32.51356792449951, "num_metric_batches_dropped": 0, "episode_reward_min": -751.3289581754894}
{"iterations_since_restore": 30, "info": {"default": {"kl": 0.014226440340280533, "total_loss": 23.15569496154785, "vf_loss": 23.161300659179688, "vf_explained_var": 0.8811761140823364, "cur_lr": 0.0005000000237487257, "entropy": 1.188971996307373, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.006318462081253529}, "num_steps_trained": 1257170, "update_time_ms": 9.841, "num_steps_sampled": 1257170, "sample_time_ms": 20536.157, "load_time_ms": 24.348, "grad_time_ms": 11700.043}, "hostname": "flow-main", "episode_reward_max": -22.379955009572345, "timesteps_this_iter": 43934, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.89538769502224, "cost1_min": 17.680524871488252, "system_level_velocity_mean": 15.135817072170166, "cost2_mean": -114.22996109538256, "cost2_max": -17.211352081776948, "outflow_rate_max": 1452.5437367932277, "cost1_mean": 177.2397409389165, "system_level_velocity_min": 11.898335661766158, "system_level_velocity_max": 19.018105415861775, "outflow_rate_min": 477.24354782665716, "cost2_min": -128.38374189754325, "outflow_rate_mean": 1211.6282880834954}, "episode_len_mean": 317.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 1257170, "time_total_s": 998.6057107448578, "timestamp": 1558610887, "time_since_restore": 998.6057107448578, "training_iteration": 30, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a7b8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1390, "timesteps_total": 1257170, "episode_reward_mean": -527.6012530262093, "episodes_this_iter": 52, "date": "2019-05-23_11-28-07", "time_this_iter_s": 34.61843204498291, "num_metric_batches_dropped": 0, "episode_reward_min": -736.6302093786397}
{"iterations_since_restore": 31, "info": {"default": {"kl": 0.01548898033797741, "total_loss": 26.667673110961914, "vf_loss": 26.672462463378906, "vf_explained_var": 0.8678666353225708, "cur_lr": 0.0005000000237487257, "entropy": 1.1649553775787354, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0055639795027673244}, "num_steps_trained": 1298595, "update_time_ms": 9.232, "num_steps_sampled": 1298595, "sample_time_ms": 20486.484, "load_time_ms": 24.102, "grad_time_ms": 11772.097}, "hostname": "flow-main", "episode_reward_max": -22.379955009572345, "timesteps_this_iter": 41425, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.44796576257065, "cost1_min": 17.680524871488252, "system_level_velocity_mean": 15.27819497144726, "cost2_mean": -114.89328669656764, "cost2_max": -17.211352081776948, "outflow_rate_max": 1465.202577195723, "cost1_mean": 180.30450039451563, "system_level_velocity_min": 11.43441377033493, "system_level_velocity_max": 19.018105415861775, "outflow_rate_min": 477.24354782665716, "cost2_min": -128.97008499081952, "outflow_rate_mean": 1227.3709514614525}, "episode_len_mean": 320.05, "node_ip": "10.138.0.2", "timesteps_since_restore": 1298595, "time_total_s": 1029.92116355896, "timestamp": 1558610918, "time_since_restore": 1029.92116355896, "training_iteration": 31, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f28d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2ef0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1437, "timesteps_total": 1298595, "episode_reward_mean": -516.3588347355812, "episodes_this_iter": 47, "date": "2019-05-23_11-28-38", "time_this_iter_s": 31.315452814102173, "num_metric_batches_dropped": 0, "episode_reward_min": -754.4829820254188}
{"iterations_since_restore": 32, "info": {"default": {"kl": 0.014071641489863396, "total_loss": 30.23628807067871, "vf_loss": 30.24108123779297, "vf_explained_var": 0.8592509627342224, "cur_lr": 0.0005000000237487257, "entropy": 1.166447401046753, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.005499021150171757}, "num_steps_trained": 1342132, "update_time_ms": 9.085, "num_steps_sampled": 1342132, "sample_time_ms": 20431.677, "load_time_ms": 23.593, "grad_time_ms": 11834.339}, "hostname": "flow-main", "episode_reward_max": -103.7051743508168, "timesteps_this_iter": 43537, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.44796576257065, "cost1_min": 88.20085079442278, "system_level_velocity_mean": 15.572617369456898, "cost2_mean": -117.98042637381228, "cost2_max": -65.35698808582013, "outflow_rate_max": 1465.202577195723, "cost1_mean": 185.4394655574438, "system_level_velocity_min": 11.43441377033493, "system_level_velocity_max": 19.018105415861775, "outflow_rate_min": 830.6192796121966, "cost2_min": -133.46834952277544, "outflow_rate_mean": 1247.953394597987}, "episode_len_mean": 323.03, "node_ip": "10.138.0.2", "timesteps_since_restore": 1342132, "time_total_s": 1062.025565624237, "timestamp": 1558610950, "time_since_restore": 1062.025565624237, "training_iteration": 32, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846986d8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1480, "timesteps_total": 1342132, "episode_reward_mean": -506.6192332946971, "episodes_this_iter": 43, "date": "2019-05-23_11-29-10", "time_this_iter_s": 32.1044020652771, "num_metric_batches_dropped": 0, "episode_reward_min": -760.4116138545563}
{"iterations_since_restore": 33, "info": {"default": {"kl": 0.014344976283609867, "total_loss": 23.573225021362305, "vf_loss": 23.578147888183594, "vf_explained_var": 0.8870701193809509, "cur_lr": 0.0005000000237487257, "entropy": 1.1641672849655151, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.005641418043524027}, "num_steps_trained": 1386584, "update_time_ms": 8.789, "num_steps_sampled": 1386584, "sample_time_ms": 20390.981, "load_time_ms": 25.102, "grad_time_ms": 11977.614}, "hostname": "flow-main", "episode_reward_max": -261.4455505911696, "timesteps_this_iter": 44452, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.60404904665202, "cost1_min": 136.01951540292706, "system_level_velocity_mean": 15.295562324821503, "cost2_mean": -119.91609713009957, "cost2_max": -102.68510844317295, "outflow_rate_max": 1468.3821425617875, "cost1_mean": 183.52976256189092, "system_level_velocity_min": 11.477619389523998, "system_level_velocity_max": 18.985160483532056, "outflow_rate_min": 1000.1816234598582, "cost2_min": -133.46834952277544, "outflow_rate_mean": 1236.9279603653717}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1386584, "time_total_s": 1095.2301154136658, "timestamp": 1558610983, "time_since_restore": 1095.2301154136658, "training_iteration": 33, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501978>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1528, "timesteps_total": 1386584, "episode_reward_mean": -532.1230745888971, "episodes_this_iter": 48, "date": "2019-05-23_11-29-43", "time_this_iter_s": 33.20454978942871, "num_metric_batches_dropped": 0, "episode_reward_min": -760.4116138545563}
{"iterations_since_restore": 34, "info": {"default": {"kl": 0.016717247664928436, "total_loss": 23.420978546142578, "vf_loss": 23.425514221191406, "vf_explained_var": 0.8825586438179016, "cur_lr": 0.0005000000237487257, "entropy": 1.1641883850097656, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.005371157079935074}, "num_steps_trained": 1429122, "update_time_ms": 8.815, "num_steps_sampled": 1429122, "sample_time_ms": 20398.086, "load_time_ms": 25.999, "grad_time_ms": 12103.436}, "hostname": "flow-main", "episode_reward_max": -29.1503821993103, "timesteps_this_iter": 42538, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.60404904665202, "cost1_min": 24.637508218398906, "system_level_velocity_mean": 15.302563036820858, "cost2_mean": -117.1149030032742, "cost2_max": -24.754685935797617, "outflow_rate_max": 1468.3821425617875, "cost1_mean": 179.63040801788648, "system_level_velocity_min": 11.382051032373141, "system_level_velocity_max": 19.03399042348709, "outflow_rate_min": 518.6392970701784, "cost2_min": -131.9307185765889, "outflow_rate_mean": 1218.970537249483}, "episode_len_mean": 319.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 1429122, "time_total_s": 1127.3985447883606, "timestamp": 1558611015, "time_since_restore": 1127.3985447883606, "training_iteration": 34, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566f60>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1575, "timesteps_total": 1429122, "episode_reward_mean": -522.9484598005766, "episodes_this_iter": 47, "date": "2019-05-23_11-30-15", "time_this_iter_s": 32.168429374694824, "num_metric_batches_dropped": 0, "episode_reward_min": -759.3560356526455}
{"iterations_since_restore": 35, "info": {"default": {"kl": 0.01363933552056551, "total_loss": 29.00307273864746, "vf_loss": 29.008411407470703, "vf_explained_var": 0.8548861145973206, "cur_lr": 0.0005000000237487257, "entropy": 1.1617975234985352, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0060208141803741455}, "num_steps_trained": 1471178, "update_time_ms": 8.868, "num_steps_sampled": 1471178, "sample_time_ms": 20447.924, "load_time_ms": 24.679, "grad_time_ms": 12163.748}, "hostname": "flow-main", "episode_reward_max": -29.1503821993103, "timesteps_this_iter": 42056, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.21677903079424, "cost1_min": 24.637508218398906, "system_level_velocity_mean": 15.613145962325591, "cost2_mean": -115.26061962607004, "cost2_max": -24.754685935797617, "outflow_rate_max": 1468.3108601252734, "cost1_mean": 180.81475572947508, "system_level_velocity_min": 11.382051032373141, "system_level_velocity_max": 19.03399042348709, "outflow_rate_min": 518.6392970701784, "cost2_min": -132.7976562927441, "outflow_rate_mean": 1224.1321163419236}, "episode_len_mean": 315.85, "node_ip": "10.138.0.2", "timesteps_since_restore": 1471178, "time_total_s": 1159.6971662044525, "timestamp": 1558611048, "time_since_restore": 1159.6971662044525, "training_iteration": 35, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845080b8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1624, "timesteps_total": 1471178, "episode_reward_mean": -497.8052330264551, "episodes_this_iter": 49, "date": "2019-05-23_11-30-48", "time_this_iter_s": 32.29862141609192, "num_metric_batches_dropped": 0, "episode_reward_min": -759.3560356526455}
{"iterations_since_restore": 36, "info": {"default": {"kl": 0.017243336886167526, "total_loss": 21.222259521484375, "vf_loss": 21.229433059692383, "vf_explained_var": 0.8875970244407654, "cur_lr": 0.0005000000237487257, "entropy": 1.1413288116455078, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.008035977371037006}, "num_steps_trained": 1514065, "update_time_ms": 8.859, "num_steps_sampled": 1514065, "sample_time_ms": 20331.105, "load_time_ms": 23.72, "grad_time_ms": 12222.241}, "hostname": "flow-main", "episode_reward_max": -93.89996380533952, "timesteps_this_iter": 42887, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.93205092792962, "cost1_min": 81.81529175912783, "system_level_velocity_mean": 15.684111002678637, "cost2_mean": -117.7810941096839, "cost2_max": -63.93088806918781, "outflow_rate_max": 1468.3108601252734, "cost1_mean": 185.70671390542574, "system_level_velocity_min": 11.678956116623487, "system_level_velocity_max": 19.009715467053006, "outflow_rate_min": 784.2625431753099, "cost2_min": -132.7976562927441, "outflow_rate_mean": 1249.6275713410623}, "episode_len_mean": 321.55, "node_ip": "10.138.0.2", "timesteps_since_restore": 1514065, "time_total_s": 1192.1623194217682, "timestamp": 1558611080, "time_since_restore": 1192.1623194217682, "training_iteration": 36, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845085c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508860>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1670, "timesteps_total": 1514065, "episode_reward_mean": -499.9458719435385, "episodes_this_iter": 46, "date": "2019-05-23_11-31-20", "time_this_iter_s": 32.465153217315674, "num_metric_batches_dropped": 0, "episode_reward_min": -759.2994296993794}
{"iterations_since_restore": 37, "info": {"default": {"kl": 0.023230865597724915, "total_loss": 21.073631286621094, "vf_loss": 21.082950592041016, "vf_explained_var": 0.8862464427947998, "cur_lr": 0.0005000000237487257, "entropy": 1.1338953971862793, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.010480130091309547}, "num_steps_trained": 1556764, "update_time_ms": 9.123, "num_steps_sampled": 1556764, "sample_time_ms": 20207.288, "load_time_ms": 25.524, "grad_time_ms": 12259.747}, "hostname": "flow-main", "episode_reward_max": -109.01738654261776, "timesteps_this_iter": 42699, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.93205092792962, "cost1_min": 84.24252718198487, "system_level_velocity_mean": 15.59753327094032, "cost2_mean": -116.9932449984812, "cost2_max": -66.7243509605879, "outflow_rate_max": 1468.540642604149, "cost1_mean": 185.56352215089294, "system_level_velocity_min": 11.76273213527826, "system_level_velocity_max": 19.009715467053006, "outflow_rate_min": 774.1582411927272, "cost2_min": -129.6532308525164, "outflow_rate_mean": 1247.3273718921446}, "episode_len_mean": 322.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 1556764, "time_total_s": 1224.9972186088562, "timestamp": 1558611113, "time_since_restore": 1224.9972186088562, "training_iteration": 37, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845669b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566470>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1714, "timesteps_total": 1556764, "episode_reward_mean": -508.4052310943457, "episodes_this_iter": 44, "date": "2019-05-23_11-31-53", "time_this_iter_s": 32.83489918708801, "num_metric_batches_dropped": 0, "episode_reward_min": -719.157856835941}
{"iterations_since_restore": 38, "info": {"default": {"kl": 0.015593446791172028, "total_loss": 19.485965728759766, "vf_loss": 19.49094581604004, "vf_explained_var": 0.9046644568443298, "cur_lr": 0.0005000000237487257, "entropy": 1.129900336265564, "cur_kl_coeff": 0.07499999552965164, "policy_loss": -0.0061490717343986034}, "num_steps_trained": 1600156, "update_time_ms": 9.359, "num_steps_sampled": 1600156, "sample_time_ms": 20136.629, "load_time_ms": 24.474, "grad_time_ms": 12416.749}, "hostname": "flow-main", "episode_reward_max": -109.01738654261776, "timesteps_this_iter": 43392, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.93205092792962, "cost1_min": 84.24252718198487, "system_level_velocity_mean": 15.311802168802974, "cost2_mean": -116.1221970903407, "cost2_max": -66.7243509605879, "outflow_rate_max": 1468.540642604149, "cost1_mean": 182.4342429770906, "system_level_velocity_min": 12.149158250636482, "system_level_velocity_max": 19.009715467053006, "outflow_rate_min": 774.1582411927272, "cost2_min": -128.4073612522596, "outflow_rate_mean": 1233.1727551121492}, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1600156, "time_total_s": 1258.3534417152405, "timestamp": 1558611147, "time_since_restore": 1258.3534417152405, "training_iteration": 38, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2438>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1764, "timesteps_total": 1600156, "episode_reward_mean": -522.3455476288744, "episodes_this_iter": 50, "date": "2019-05-23_11-32-27", "time_this_iter_s": 33.35622310638428, "num_metric_batches_dropped": 0, "episode_reward_min": -734.7408039402131}
{"iterations_since_restore": 39, "info": {"default": {"kl": 0.015599455684423447, "total_loss": 24.874786376953125, "vf_loss": 24.88029670715332, "vf_explained_var": 0.8809311389923096, "cur_lr": 0.0005000000237487257, "entropy": 1.119396686553955, "cur_kl_coeff": 0.07499998807907104, "policy_loss": -0.006681584753096104}, "num_steps_trained": 1642498, "update_time_ms": 9.666, "num_steps_sampled": 1642498, "sample_time_ms": 20104.352, "load_time_ms": 24.091, "grad_time_ms": 12554.101}, "hostname": "flow-main", "episode_reward_max": -170.43802012994684, "timesteps_this_iter": 42342, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 227.24758384585078, "cost1_min": 139.77601609792885, "system_level_velocity_mean": 15.316291330096156, "cost2_mean": -117.61425122305569, "cost2_max": -94.81344133946179, "outflow_rate_max": 1470.5307032250805, "cost1_mean": 182.854171048778, "system_level_velocity_min": 11.725062891313911, "system_level_velocity_max": 19.08440210313807, "outflow_rate_min": 1053.7288940258613, "cost2_min": -133.36416975054, "outflow_rate_mean": 1237.1900858639542}, "episode_len_mean": 323.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 1642498, "time_total_s": 1291.906016588211, "timestamp": 1558611180, "time_since_restore": 1291.906016588211, "training_iteration": 39, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508f60>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1811, "timesteps_total": 1642498, "episode_reward_mean": -524.1477090572324, "episodes_this_iter": 47, "date": "2019-05-23_11-33-00", "time_this_iter_s": 33.55257487297058, "num_metric_batches_dropped": 0, "episode_reward_min": -734.7408039402131}
{"iterations_since_restore": 40, "info": {"default": {"kl": 0.020829694345593452, "total_loss": 17.975446701049805, "vf_loss": 17.982057571411133, "vf_explained_var": 0.909500777721405, "cur_lr": 0.0005000000237487257, "entropy": 1.1197912693023682, "cur_kl_coeff": 0.07499998807907104, "policy_loss": -0.008172189816832542}, "num_steps_trained": 1684745, "update_time_ms": 9.937, "num_steps_sampled": 1684745, "sample_time_ms": 19890.251, "load_time_ms": 22.653, "grad_time_ms": 12627.002}, "hostname": "flow-main", "episode_reward_max": -170.43802012994684, "timesteps_this_iter": 42247, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 227.24758384585078, "cost1_min": 136.92022028489896, "system_level_velocity_mean": 15.582519314218596, "cost2_mean": -116.99523598221394, "cost2_max": -94.81344133946179, "outflow_rate_max": 1470.5307032250805, "cost1_mean": 186.1795166166461, "system_level_velocity_min": 11.487048783658697, "system_level_velocity_max": 19.08440210313807, "outflow_rate_min": 1038.6866815611181, "cost2_min": -133.36416975054, "outflow_rate_mean": 1254.8512218908818}, "episode_len_mean": 323.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 1684745, "time_total_s": 1325.1027691364288, "timestamp": 1558611213, "time_since_restore": 1325.1027691364288, "training_iteration": 40, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508eb8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1853, "timesteps_total": 1684745, "episode_reward_mean": -503.3155445250353, "episodes_this_iter": 42, "date": "2019-05-23_11-33-33", "time_this_iter_s": 33.19675254821777, "num_metric_batches_dropped": 0, "episode_reward_min": -722.6270653171039}
{"iterations_since_restore": 41, "info": {"default": {"kl": 0.01606718823313713, "total_loss": 19.006189346313477, "vf_loss": 19.01288414001465, "vf_explained_var": 0.9089754819869995, "cur_lr": 0.0005000000237487257, "entropy": 1.1153508424758911, "cur_kl_coeff": 0.11250001192092896, "policy_loss": -0.008504403755068779}, "num_steps_trained": 1728520, "update_time_ms": 10.138, "num_steps_sampled": 1728520, "sample_time_ms": 19992.772, "load_time_ms": 22.903, "grad_time_ms": 12745.863}, "hostname": "flow-main", "episode_reward_max": -91.85710336682949, "timesteps_this_iter": 43775, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 227.24758384585078, "cost1_min": 81.54085773857776, "system_level_velocity_mean": 15.271503936807205, "cost2_mean": -115.8428549056678, "cost2_max": -63.42466118361759, "outflow_rate_max": 1469.7614280477583, "cost1_mean": 182.27663921391147, "system_level_velocity_min": 11.487048783658697, "system_level_velocity_max": 19.08440210313807, "outflow_rate_min": 777.4960623246283, "cost2_min": -128.8830615400727, "outflow_rate_mean": 1239.031855131341}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 1728520, "time_total_s": 1358.626002073288, "timestamp": 1558611247, "time_since_restore": 1358.626002073288, "training_iteration": 41, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845016a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a7f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1900, "timesteps_total": 1728520, "episode_reward_mean": -515.767164722656, "episodes_this_iter": 47, "date": "2019-05-23_11-34-07", "time_this_iter_s": 33.52323293685913, "num_metric_batches_dropped": 0, "episode_reward_min": -722.6270653171039}
{"iterations_since_restore": 42, "info": {"default": {"kl": 0.01703106239438057, "total_loss": 20.10276985168457, "vf_loss": 20.109025955200195, "vf_explained_var": 0.9085549712181091, "cur_lr": 0.0005000000237487257, "entropy": 1.1146985292434692, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.008172852918505669}, "num_steps_trained": 1771594, "update_time_ms": 10.157, "num_steps_sampled": 1771594, "sample_time_ms": 20089.993, "load_time_ms": 23.439, "grad_time_ms": 12751.783}, "hostname": "flow-main", "episode_reward_max": -91.85710336682949, "timesteps_this_iter": 43074, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.95286274458334, "cost1_min": 81.54085773857776, "system_level_velocity_mean": 15.003676663999403, "cost2_mean": -116.17384649048854, "cost2_max": -63.42466118361759, "outflow_rate_max": 1469.7614280477583, "cost1_mean": 179.24307746251117, "system_level_velocity_min": 11.620048027118582, "system_level_velocity_max": 19.063871745882032, "outflow_rate_min": 777.4960623246283, "cost2_min": -128.8830615400727, "outflow_rate_mean": 1223.8106382348533}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 1771594, "time_total_s": 1391.7545125484467, "timestamp": 1558611280, "time_since_restore": 1391.7545125484467, "training_iteration": 42, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508710>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1947, "timesteps_total": 1771594, "episode_reward_mean": -532.5293416517442, "episodes_this_iter": 47, "date": "2019-05-23_11-34-40", "time_this_iter_s": 33.12851047515869, "num_metric_batches_dropped": 0, "episode_reward_min": -734.8885291028681}
{"iterations_since_restore": 43, "info": {"default": {"kl": 0.014067967422306538, "total_loss": 24.845943450927734, "vf_loss": 24.85091209411621, "vf_explained_var": 0.8877493143081665, "cur_lr": 0.0005000000237487257, "entropy": 1.1030750274658203, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.006552936974912882}, "num_steps_trained": 1813880, "update_time_ms": 10.442, "num_steps_sampled": 1813880, "sample_time_ms": 20112.966, "load_time_ms": 23.565, "grad_time_ms": 12677.777}, "hostname": "flow-main", "episode_reward_max": -263.4606497275148, "timesteps_this_iter": 42286, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.94038065476764, "cost1_min": 138.60791655599598, "system_level_velocity_mean": 15.106671708568319, "cost2_mean": -116.10748973891907, "cost2_max": -98.01448035477412, "outflow_rate_max": 1469.1919461017296, "cost1_mean": 181.70085251549412, "system_level_velocity_min": 11.620048027118582, "system_level_velocity_max": 18.8946825633094, "outflow_rate_min": 1032.1669102990033, "cost2_min": -128.68951569618534, "outflow_rate_mean": 1232.9349729676737}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1813880, "time_total_s": 1424.442590713501, "timestamp": 1558611313, "time_since_restore": 1424.442590713501, "training_iteration": 43, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456ae48>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 1994, "timesteps_total": 1813880, "episode_reward_mean": -525.6536499517197, "episodes_this_iter": 47, "date": "2019-05-23_11-35-13", "time_this_iter_s": 32.68807816505432, "num_metric_batches_dropped": 0, "episode_reward_min": -734.8885291028681}
{"iterations_since_restore": 44, "info": {"default": {"kl": 0.015564000234007835, "total_loss": 22.537235260009766, "vf_loss": 22.544292449951172, "vf_explained_var": 0.8979820013046265, "cur_lr": 0.0005000000237487257, "entropy": 1.1099574565887451, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.008808214217424393}, "num_steps_trained": 1856788, "update_time_ms": 10.569, "num_steps_sampled": 1856788, "sample_time_ms": 20174.907, "load_time_ms": 22.387, "grad_time_ms": 12677.656}, "hostname": "flow-main", "episode_reward_max": -104.83012687942394, "timesteps_this_iter": 42908, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.84462705637074, "cost1_min": 86.63041743510922, "system_level_velocity_mean": 15.091927326489975, "cost2_mean": -115.09767835206875, "cost2_max": -66.45120043157807, "outflow_rate_max": 1468.8727679885487, "cost1_mean": 180.1171118043837, "system_level_velocity_min": 11.662036608416072, "system_level_velocity_max": 19.021969880511435, "outflow_rate_min": 816.3925514631778, "cost2_min": -128.68951569618534, "outflow_rate_mean": 1226.8789012348968}, "episode_len_mean": 323.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 1856788, "time_total_s": 1457.226574897766, "timestamp": 1558611346, "time_since_restore": 1457.226574897766, "training_iteration": 44, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508278>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2040, "timesteps_total": 1856788, "episode_reward_mean": -524.3721773940633, "episodes_this_iter": 46, "date": "2019-05-23_11-35-46", "time_this_iter_s": 32.78398418426514, "num_metric_batches_dropped": 0, "episode_reward_min": -719.8268449754971}
{"iterations_since_restore": 45, "info": {"default": {"kl": 0.017610257491469383, "total_loss": 19.285057067871094, "vf_loss": 19.29303550720215, "vf_explained_var": 0.912338137626648, "cur_lr": 0.0005000000237487257, "entropy": 1.1090508699417114, "cur_kl_coeff": 0.11250000447034836, "policy_loss": -0.009961825795471668}, "num_steps_trained": 1899523, "update_time_ms": 10.619, "num_steps_sampled": 1899523, "sample_time_ms": 20260.53, "load_time_ms": 23.292, "grad_time_ms": 12606.285}, "hostname": "flow-main", "episode_reward_max": -104.83012687942394, "timesteps_this_iter": 42735, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.84462705637074, "cost1_min": 86.63041743510922, "system_level_velocity_mean": 15.24725797919182, "cost2_mean": -115.04043099304363, "cost2_max": -66.45120043157807, "outflow_rate_max": 1468.8727679885487, "cost1_mean": 182.1248741015237, "system_level_velocity_min": 11.682280898295886, "system_level_velocity_max": 19.021969880511435, "outflow_rate_min": 816.3925514631778, "cost2_min": -128.68951569618534, "outflow_rate_mean": 1235.889802064724}, "episode_len_mean": 323.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 1899523, "time_total_s": 1489.6526403427124, "timestamp": 1558611378, "time_since_restore": 1489.6526403427124, "training_iteration": 45, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508a90>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2087, "timesteps_total": 1899523, "episode_reward_mean": -514.0363790980699, "episodes_this_iter": 47, "date": "2019-05-23_11-36-18", "time_this_iter_s": 32.42606544494629, "num_metric_batches_dropped": 0, "episode_reward_min": -719.8268449754971}
{"iterations_since_restore": 46, "info": {"default": {"kl": 0.016928348690271378, "total_loss": 19.3242244720459, "vf_loss": 19.331113815307617, "vf_explained_var": 0.9087152481079102, "cur_lr": 0.0005000000237487257, "entropy": 1.1027673482894897, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.008793709799647331}, "num_steps_trained": 1942418, "update_time_ms": 10.409, "num_steps_sampled": 1942418, "sample_time_ms": 20296.737, "load_time_ms": 23.028, "grad_time_ms": 12464.616}, "hostname": "flow-main", "episode_reward_max": -273.8236219607907, "timesteps_this_iter": 42895, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.21691806995693, "cost1_min": 131.96848655874362, "system_level_velocity_mean": 14.906524106937814, "cost2_mean": -114.19274139949793, "cost2_max": -97.2312007098235, "outflow_rate_max": 1460.548584508354, "cost1_mean": 179.38011930521148, "system_level_velocity_min": 11.107635767877065, "system_level_velocity_max": 18.841849366207555, "outflow_rate_min": 990.153835113485, "cost2_min": -123.9627206970173, "outflow_rate_mean": 1217.6290873268247}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1942418, "time_total_s": 1521.0375394821167, "timestamp": 1558611410, "time_since_restore": 1521.0375394821167, "training_iteration": 46, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f26d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2a90>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2133, "timesteps_total": 1942418, "episode_reward_mean": -538.3546908598046, "episodes_this_iter": 46, "date": "2019-05-23_11-36-50", "time_this_iter_s": 31.384899139404297, "num_metric_batches_dropped": 0, "episode_reward_min": -769.7279583873067}
{"iterations_since_restore": 47, "info": {"default": {"kl": 0.01718875579535961, "total_loss": 20.459882736206055, "vf_loss": 20.465778350830078, "vf_explained_var": 0.9098039865493774, "cur_lr": 0.0005000000237487257, "entropy": 1.0985734462738037, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.007828101515769958}, "num_steps_trained": 1985009, "update_time_ms": 10.108, "num_steps_sampled": 1985009, "sample_time_ms": 20349.795, "load_time_ms": 22.24, "grad_time_ms": 12408.67}, "hostname": "flow-main", "episode_reward_max": -105.32972527327827, "timesteps_this_iter": 42591, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.1608127996354, "cost1_min": 87.54504497779567, "system_level_velocity_mean": 14.97056453919636, "cost2_mean": -113.20021762118903, "cost2_max": -68.32407204541357, "outflow_rate_max": 1472.0955109932163, "cost1_mean": 177.7278001506697, "system_level_velocity_min": 11.107635767877065, "system_level_velocity_max": 18.91996949505235, "outflow_rate_min": 817.1760625469153, "cost2_min": -126.48763342523131, "outflow_rate_mean": 1211.6723845300703}, "episode_len_mean": 321.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 1985009, "time_total_s": 1553.8171107769012, "timestamp": 1558611442, "time_since_restore": 1553.8171107769012, "training_iteration": 47, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845015f8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2179, "timesteps_total": 1985009, "episode_reward_mean": -528.1841636667602, "episodes_this_iter": 46, "date": "2019-05-23_11-37-22", "time_this_iter_s": 32.779571294784546, "num_metric_batches_dropped": 0, "episode_reward_min": -769.7279583873067}
{"iterations_since_restore": 48, "info": {"default": {"kl": 0.015522897243499756, "total_loss": 25.54192543029785, "vf_loss": 25.547962188720703, "vf_explained_var": 0.893465518951416, "cur_lr": 0.0005000000237487257, "entropy": 1.082882046699524, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.007783240173012018}, "num_steps_trained": 2028246, "update_time_ms": 9.805, "num_steps_sampled": 2028246, "sample_time_ms": 20484.255, "load_time_ms": 23.726, "grad_time_ms": 12235.48}, "hostname": "flow-main", "episode_reward_max": -105.32972527327827, "timesteps_this_iter": 43237, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.1608127996354, "cost1_min": 87.31269180887033, "system_level_velocity_mean": 15.17141357447381, "cost2_mean": -115.00052040477047, "cost2_max": -66.63797118587367, "outflow_rate_max": 1472.0955109932163, "cost1_mean": 178.46492354513936, "system_level_velocity_min": 11.586208491965444, "system_level_velocity_max": 18.91996949505235, "outflow_rate_min": 813.0011555679627, "cost2_min": -131.70293106914295, "outflow_rate_mean": 1214.8264418985134}, "episode_len_mean": 319.66, "node_ip": "10.138.0.2", "timesteps_since_restore": 2028246, "time_total_s": 1586.7875952720642, "timestamp": 1558611475, "time_since_restore": 1586.7875952720642, "training_iteration": 48, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2320>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2226, "timesteps_total": 2028246, "episode_reward_mean": -517.4332965791109, "episodes_this_iter": 47, "date": "2019-05-23_11-37-55", "time_this_iter_s": 32.970484495162964, "num_metric_batches_dropped": 0, "episode_reward_min": -732.2352439548307}
{"iterations_since_restore": 49, "info": {"default": {"kl": 0.01729751192033291, "total_loss": 25.33884048461914, "vf_loss": 25.34470558166504, "vf_explained_var": 0.8917701244354248, "cur_lr": 0.0005000000237487257, "entropy": 1.1020177602767944, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.0078104110434651375}, "num_steps_trained": 2070712, "update_time_ms": 9.398, "num_steps_sampled": 2070712, "sample_time_ms": 20680.749, "load_time_ms": 23.688, "grad_time_ms": 12072.986}, "hostname": "flow-main", "episode_reward_max": -27.724098149575997, "timesteps_this_iter": 42466, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.82610110812257, "cost1_min": 23.11250284965875, "system_level_velocity_mean": 15.135330812281877, "cost2_mean": -116.70083449514091, "cost2_max": -23.647837871135536, "outflow_rate_max": 1467.5234276598835, "cost1_mean": 178.24001290799978, "system_level_velocity_min": 11.586208491965444, "system_level_velocity_max": 18.88550095940604, "outflow_rate_min": 516.5375004973323, "cost2_min": -131.70293106914295, "outflow_rate_mean": 1211.9909806224525}, "episode_len_mean": 320.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 2070712, "time_total_s": 1620.6649086475372, "timestamp": 1558611509, "time_since_restore": 1620.6649086475372, "training_iteration": 49, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f29e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2080>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2275, "timesteps_total": 2070712, "episode_reward_mean": -528.7859987134906, "episodes_this_iter": 49, "date": "2019-05-23_11-38-29", "time_this_iter_s": 33.87731337547302, "num_metric_batches_dropped": 0, "episode_reward_min": -762.4406801494483}
{"iterations_since_restore": 50, "info": {"default": {"kl": 0.017454111948609352, "total_loss": 22.57468605041504, "vf_loss": 22.581645965576172, "vf_explained_var": 0.8953788876533508, "cur_lr": 0.0005000000237487257, "entropy": 1.0914243459701538, "cur_kl_coeff": 0.11250000447034836, "policy_loss": -0.008921855129301548}, "num_steps_trained": 2112934, "update_time_ms": 9.23, "num_steps_sampled": 2112934, "sample_time_ms": 20776.636, "load_time_ms": 24.28, "grad_time_ms": 11909.608}, "hostname": "flow-main", "episode_reward_max": -27.724098149575997, "timesteps_this_iter": 42222, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.82529973120168, "cost1_min": 23.11250284965875, "system_level_velocity_mean": 15.348882726811796, "cost2_mean": -116.7074909945139, "cost2_max": -23.647837871135536, "outflow_rate_max": 1466.387911747343, "cost1_mean": 182.45069711846253, "system_level_velocity_min": 11.677160269622009, "system_level_velocity_max": 18.88550095940604, "outflow_rate_min": 516.5375004973323, "cost2_min": -131.70293106914295, "outflow_rate_mean": 1234.8199417274736}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 2112934, "time_total_s": 1653.1864714622498, "timestamp": 1558611542, "time_since_restore": 1653.1864714622498, "training_iteration": 50, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2940>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2319, "timesteps_total": 2112934, "episode_reward_mean": -513.5806917777998, "episodes_this_iter": 44, "date": "2019-05-23_11-39-02", "time_this_iter_s": 32.521562814712524, "num_metric_batches_dropped": 0, "episode_reward_min": -762.4406801494483}
{"iterations_since_restore": 51, "info": {"default": {"kl": 0.017340846359729767, "total_loss": 18.3328800201416, "vf_loss": 18.339569091796875, "vf_explained_var": 0.912642776966095, "cur_lr": 0.0005000000237487257, "entropy": 1.1066027879714966, "cur_kl_coeff": 0.11250000447034836, "policy_loss": -0.008640369400382042}, "num_steps_trained": 2156294, "update_time_ms": 8.967, "num_steps_sampled": 2156294, "sample_time_ms": 20806.421, "load_time_ms": 22.868, "grad_time_ms": 11839.972}, "hostname": "flow-main", "episode_reward_max": -108.87055936514548, "timesteps_this_iter": 43360, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.0375198603296, "cost1_min": 88.44292898954158, "system_level_velocity_mean": 15.199330880503707, "cost2_mean": -115.31533856216429, "cost2_max": -67.38712995634324, "outflow_rate_max": 1466.387911747343, "cost1_mean": 181.35049078730728, "system_level_velocity_min": 11.9942879402758, "system_level_velocity_max": 18.81660154332662, "outflow_rate_min": 826.426317766813, "cost2_min": -130.671664574772, "outflow_rate_mean": 1232.5034052856963}, "episode_len_mean": 323.05, "node_ip": "10.138.0.2", "timesteps_since_restore": 2156294, "time_total_s": 1686.2878243923187, "timestamp": 1558611575, "time_since_restore": 1686.2878243923187, "training_iteration": 51, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fe48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450ffd0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2367, "timesteps_total": 2156294, "episode_reward_mean": -523.8292931155358, "episodes_this_iter": 48, "date": "2019-05-23_11-39-35", "time_this_iter_s": 33.10135293006897, "num_metric_batches_dropped": 0, "episode_reward_min": -696.2223460416943}
{"iterations_since_restore": 52, "info": {"default": {"kl": 0.018369996920228004, "total_loss": 20.107656478881836, "vf_loss": 20.1149845123291, "vf_explained_var": 0.9087554216384888, "cur_lr": 0.0005000000237487257, "entropy": 1.0968884229660034, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.009393650107085705}, "num_steps_trained": 2199382, "update_time_ms": 8.783, "num_steps_sampled": 2199382, "sample_time_ms": 20933.155, "load_time_ms": 21.573, "grad_time_ms": 11768.321}, "hostname": "flow-main", "episode_reward_max": -108.87055936514548, "timesteps_this_iter": 43088, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.48705007492825, "cost1_min": 88.44292898954158, "system_level_velocity_mean": 14.993230858148928, "cost2_mean": -113.6162836064061, "cost2_max": -67.38712995634324, "outflow_rate_max": 1464.2236973367028, "cost1_mean": 178.0180859063039, "system_level_velocity_min": 11.972843366457457, "system_level_velocity_max": 18.86884146068299, "outflow_rate_min": 826.426317766813, "cost2_min": -123.48082936983354, "outflow_rate_mean": 1217.7489523068923}, "episode_len_mean": 321.87, "node_ip": "10.138.0.2", "timesteps_since_restore": 2199382, "time_total_s": 1719.9629867076874, "timestamp": 1558611609, "time_since_restore": 1719.9629867076874, "training_iteration": 52, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508160>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2416, "timesteps_total": 2199382, "episode_reward_mean": -535.4799134266507, "episodes_this_iter": 49, "date": "2019-05-23_11-40-09", "time_this_iter_s": 33.67516231536865, "num_metric_batches_dropped": 0, "episode_reward_min": -696.480840287695}
{"iterations_since_restore": 53, "info": {"default": {"kl": 0.01784634217619896, "total_loss": 19.980905532836914, "vf_loss": 19.98782730102539, "vf_explained_var": 0.9079166650772095, "cur_lr": 0.0005000000237487257, "entropy": 1.0973198413848877, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.008930452167987823}, "num_steps_trained": 2242456, "update_time_ms": 8.835, "num_steps_sampled": 2242456, "sample_time_ms": 20971.368, "load_time_ms": 20.149, "grad_time_ms": 11722.037}, "hostname": "flow-main", "episode_reward_max": -29.48636921887818, "timesteps_this_iter": 43074, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.48705007492825, "cost1_min": 23.238190510769588, "system_level_velocity_mean": 15.064313002686468, "cost2_mean": -112.76345970425825, "cost2_max": -24.47806210047352, "outflow_rate_max": 1464.2236973367028, "cost1_mean": 178.2662793315992, "system_level_velocity_min": 11.972843366457457, "system_level_velocity_max": 18.86884146068299, "outflow_rate_min": 476.19572143481514, "cost2_min": -123.48082936983354, "outflow_rate_mean": 1216.0767137490088}, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 2242456, "time_total_s": 1752.5507130622864, "timestamp": 1558611641, "time_since_restore": 1752.5507130622864, "training_iteration": 53, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f29e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2cf8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2460, "timesteps_total": 2242456, "episode_reward_mean": -527.3090069377794, "episodes_this_iter": 44, "date": "2019-05-23_11-40-41", "time_this_iter_s": 32.587726354599, "num_metric_batches_dropped": 0, "episode_reward_min": -706.7756012565953}
{"iterations_since_restore": 54, "info": {"default": {"kl": 0.016610929742455482, "total_loss": 20.7196044921875, "vf_loss": 20.724058151245117, "vf_explained_var": 0.9013563990592957, "cur_lr": 0.0005000000237487257, "entropy": 1.0978375673294067, "cur_kl_coeff": 0.11250000447034836, "policy_loss": -0.006319119594991207}, "num_steps_trained": 2285158, "update_time_ms": 8.659, "num_steps_sampled": 2285158, "sample_time_ms": 20999.712, "load_time_ms": 21.651, "grad_time_ms": 11647.089}, "hostname": "flow-main", "episode_reward_max": -29.48636921887818, "timesteps_this_iter": 42702, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.22306044344145, "cost1_min": 23.238190510769588, "system_level_velocity_mean": 15.192497119799333, "cost2_mean": -111.47049983987915, "cost2_max": -24.47806210047352, "outflow_rate_max": 1463.1012459230267, "cost1_mean": 179.95643659712564, "system_level_velocity_min": 12.07869673398135, "system_level_velocity_max": 18.761084681782563, "outflow_rate_min": 476.19572143481514, "cost2_min": -123.23096094778431, "outflow_rate_mean": 1222.524499931417}, "episode_len_mean": 321.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 2285158, "time_total_s": 1784.8722393512726, "timestamp": 1558611674, "time_since_restore": 1784.8722393512726, "training_iteration": 54, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456ae48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456ad68>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2505, "timesteps_total": 2285158, "episode_reward_mean": -514.0601568142995, "episodes_this_iter": 45, "date": "2019-05-23_11-41-14", "time_this_iter_s": 32.321526288986206, "num_metric_batches_dropped": 0, "episode_reward_min": -706.7756012565953}
{"iterations_since_restore": 55, "info": {"default": {"kl": 0.017926963046193123, "total_loss": 17.10296630859375, "vf_loss": 17.10981559753418, "vf_explained_var": 0.9194852709770203, "cur_lr": 0.0005000000237487257, "entropy": 1.0957937240600586, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.008867116644978523}, "num_steps_trained": 2327695, "update_time_ms": 8.633, "num_steps_sampled": 2327695, "sample_time_ms": 21020.949, "load_time_ms": 21.536, "grad_time_ms": 11630.283}, "hostname": "flow-main", "episode_reward_max": -188.4173322640668, "timesteps_this_iter": 42537, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.22306044344145, "cost1_min": 135.02788302939882, "system_level_velocity_mean": 14.818860279371176, "cost2_mean": -110.36786528203525, "cost2_max": -85.79279939682404, "outflow_rate_max": 1463.1012459230267, "cost1_mean": 177.80328701418878, "system_level_velocity_min": 11.317354099338568, "system_level_velocity_max": 18.761084681782563, "outflow_rate_min": 956.8039631336405, "cost2_min": -122.72104796646343, "outflow_rate_mean": 1211.966984680958}, "episode_len_mean": 323.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 2327695, "time_total_s": 1817.3443331718445, "timestamp": 1558611706, "time_since_restore": 1817.3443331718445, "training_iteration": 55, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845016d8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2553, "timesteps_total": 2327695, "episode_reward_mean": -532.4864253617619, "episodes_this_iter": 48, "date": "2019-05-23_11-41-46", "time_this_iter_s": 32.4720938205719, "num_metric_batches_dropped": 0, "episode_reward_min": -687.9496543064141}
{"iterations_since_restore": 56, "info": {"default": {"kl": 0.01817162334918976, "total_loss": 20.32155990600586, "vf_loss": 20.326993942260742, "vf_explained_var": 0.8971318602561951, "cur_lr": 0.0005000000237487257, "entropy": 1.0955325365066528, "cur_kl_coeff": 0.11250000447034836, "policy_loss": -0.007478703744709492}, "num_steps_trained": 2369649, "update_time_ms": 8.712, "num_steps_sampled": 2369649, "sample_time_ms": 21008.388, "load_time_ms": 22.452, "grad_time_ms": 11649.631}, "hostname": "flow-main", "episode_reward_max": -270.23484404610036, "timesteps_this_iter": 41954, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.83153508548435, "cost1_min": 135.02788302939882, "system_level_velocity_mean": 14.736272379964387, "cost2_mean": -108.4372930986203, "cost2_max": -85.79279939682404, "outflow_rate_max": 1460.3092220914557, "cost1_mean": 177.67294233133669, "system_level_velocity_min": 11.317354099338568, "system_level_velocity_max": 18.76802846162384, "outflow_rate_min": 956.8039631336405, "cost2_min": -125.28492291853178, "outflow_rate_mean": 1208.0357954847013}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2369649, "time_total_s": 1848.8173654079437, "timestamp": 1558611738, "time_since_restore": 1848.8173654079437, "training_iteration": 56, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f20f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2c88>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2600, "timesteps_total": 2369649, "episode_reward_mean": -531.7588661240302, "episodes_this_iter": 47, "date": "2019-05-23_11-42-18", "time_this_iter_s": 31.473032236099243, "num_metric_batches_dropped": 0, "episode_reward_min": -684.3996440611551}
{"iterations_since_restore": 57, "info": {"default": {"kl": 0.020216863602399826, "total_loss": 19.02694320678711, "vf_loss": 19.033979415893555, "vf_explained_var": 0.9005632996559143, "cur_lr": 0.0005000000237487257, "entropy": 1.081969141960144, "cur_kl_coeff": 0.11250000447034836, "policy_loss": -0.009312235750257969}, "num_steps_trained": 2411654, "update_time_ms": 8.862, "num_steps_sampled": 2411654, "sample_time_ms": 20893.706, "load_time_ms": 23.134, "grad_time_ms": 11606.363}, "hostname": "flow-main", "episode_reward_max": -29.07486159535335, "timesteps_this_iter": 42005, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.83153508548435, "cost1_min": 22.941556202773214, "system_level_velocity_mean": 15.016140891466637, "cost2_mean": -105.0678678936768, "cost2_max": -23.534316822484524, "outflow_rate_max": 1460.3092220914557, "cost1_mean": 177.30840619045094, "system_level_velocity_min": 11.555019866120166, "system_level_velocity_max": 18.76802846162384, "outflow_rate_min": 468.8485586228365, "cost2_min": -125.28492291853178, "outflow_rate_mean": 1209.239985712473}, "episode_len_mean": 319.2, "node_ip": "10.138.0.2", "timesteps_since_restore": 2411654, "time_total_s": 1880.0531566143036, "timestamp": 1558611769, "time_since_restore": 1880.0531566143036, "training_iteration": 57, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fab38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa4e0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2647, "timesteps_total": 2411654, "episode_reward_mean": -498.67371230540465, "episodes_this_iter": 47, "date": "2019-05-23_11-42-49", "time_this_iter_s": 31.235791206359863, "num_metric_batches_dropped": 0, "episode_reward_min": -672.381092777071}
{"iterations_since_restore": 58, "info": {"default": {"kl": 0.01827569119632244, "total_loss": 12.878951072692871, "vf_loss": 12.887275695800781, "vf_explained_var": 0.93310546875, "cur_lr": 0.0005000000237487257, "entropy": 1.1140305995941162, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.011408284306526184}, "num_steps_trained": 2453713, "update_time_ms": 8.936, "num_steps_sampled": 2453713, "sample_time_ms": 20723.295, "load_time_ms": 21.895, "grad_time_ms": 11678.493}, "hostname": "flow-main", "episode_reward_max": -29.07486159535335, "timesteps_this_iter": 42059, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 222.1085892200802, "cost1_min": 22.941556202773214, "system_level_velocity_mean": 14.475259171854201, "cost2_mean": -101.43367478948826, "cost2_max": -23.534316822484524, "outflow_rate_max": 1449.5341625615763, "cost1_mean": 170.9957381460638, "system_level_velocity_min": 11.486383639895456, "system_level_velocity_max": 18.58215149475211, "outflow_rate_min": 468.8485586228365, "cost2_min": -119.9195504045328, "outflow_rate_mean": 1178.2557756899894}, "episode_len_mean": 319.2, "node_ip": "10.138.0.2", "timesteps_since_restore": 2453713, "time_total_s": 1912.0337476730347, "timestamp": 1558611801, "time_since_restore": 1912.0337476730347, "training_iteration": 58, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845089b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450ffd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f0b8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2694, "timesteps_total": 2453713, "episode_reward_mean": -517.1368768302874, "episodes_this_iter": 47, "date": "2019-05-23_11-43-21", "time_this_iter_s": 31.98059105873108, "num_metric_batches_dropped": 0, "episode_reward_min": -662.319441675228}
{"iterations_since_restore": 59, "info": {"default": {"kl": 0.014939512126147747, "total_loss": 18.171070098876953, "vf_loss": 18.176105499267578, "vf_explained_var": 0.9130346775054932, "cur_lr": 0.0005000000237487257, "entropy": 1.0941964387893677, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.007556090131402016}, "num_steps_trained": 2495957, "update_time_ms": 9.203, "num_steps_sampled": 2495957, "sample_time_ms": 20551.984, "load_time_ms": 20.772, "grad_time_ms": 11673.034}, "hostname": "flow-main", "episode_reward_max": -29.07486159535335, "timesteps_this_iter": 42244, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.41236682169634, "cost1_min": 22.976674769556713, "system_level_velocity_mean": 14.272309482686076, "cost2_mean": -101.18729065915763, "cost2_max": -23.534316822484524, "outflow_rate_max": 1448.8414285714289, "cost1_mean": 169.1422908365799, "system_level_velocity_min": 11.486383639895456, "system_level_velocity_max": 18.76607788160626, "outflow_rate_min": 494.3801718868485, "cost2_min": -118.93554318021164, "outflow_rate_mean": 1168.2418776364282}, "episode_len_mean": 320.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 2495957, "time_total_s": 1944.1437656879425, "timestamp": 1558611833, "time_since_restore": 1944.1437656879425, "training_iteration": 59, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845081d0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2740, "timesteps_total": 2495957, "episode_reward_mean": -528.6404987597128, "episodes_this_iter": 46, "date": "2019-05-23_11-43-53", "time_this_iter_s": 32.11001801490784, "num_metric_batches_dropped": 0, "episode_reward_min": -663.9547616456551}
{"iterations_since_restore": 60, "info": {"default": {"kl": 0.017204202711582184, "total_loss": 16.267690658569336, "vf_loss": 16.27437400817871, "vf_explained_var": 0.9226141571998596, "cur_lr": 0.0005000000237487257, "entropy": 1.0794172286987305, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.00958579033613205}, "num_steps_trained": 2537838, "update_time_ms": 9.097, "num_steps_sampled": 2537838, "sample_time_ms": 20457.152, "load_time_ms": 21.027, "grad_time_ms": 11689.846}, "hostname": "flow-main", "episode_reward_max": -30.38427660055555, "timesteps_this_iter": 41881, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.29417295584255, "cost1_min": 23.02840986758768, "system_level_velocity_mean": 14.713123730158078, "cost2_mean": -102.9930574205518, "cost2_max": -25.060773926423735, "outflow_rate_max": 1445.2997016746344, "cost1_mean": 174.3950071240898, "system_level_velocity_min": 11.613661274078515, "system_level_velocity_max": 18.76607788160626, "outflow_rate_min": 460.7989278777953, "cost2_min": -118.93554318021164, "outflow_rate_mean": 1195.1141569797633}, "episode_len_mean": 320.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 2537838, "time_total_s": 1975.8766877651215, "timestamp": 1558611865, "time_since_restore": 1975.8766877651215, "training_iteration": 60, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84698400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84698080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846988d0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2787, "timesteps_total": 2537838, "episode_reward_mean": -511.6009621995414, "episodes_this_iter": 47, "date": "2019-05-23_11-44-25", "time_this_iter_s": 31.732922077178955, "num_metric_batches_dropped": 0, "episode_reward_min": -663.9547616456551}
{"iterations_since_restore": 61, "info": {"default": {"kl": 0.017588401213288307, "total_loss": 16.84126091003418, "vf_loss": 16.84713363647461, "vf_explained_var": 0.9106046557426453, "cur_lr": 0.0005000000237487257, "entropy": 1.0877047777175903, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.008841732516884804}, "num_steps_trained": 2578377, "update_time_ms": 9.026, "num_steps_sampled": 2578377, "sample_time_ms": 20183.654, "load_time_ms": 22.121, "grad_time_ms": 11599.576}, "hostname": "flow-main", "episode_reward_max": -30.38427660055555, "timesteps_this_iter": 40539, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.29417295584255, "cost1_min": 23.02840986758768, "system_level_velocity_mean": 14.983160588504967, "cost2_mean": -102.58682575086256, "cost2_max": -25.060773926423735, "outflow_rate_max": 1445.2997016746344, "cost1_mean": 179.05529540713485, "system_level_velocity_min": 11.613661274078515, "system_level_velocity_max": 18.451849484592227, "outflow_rate_min": 460.7989278777953, "cost2_min": -118.05940725870897, "outflow_rate_mean": 1218.2594347369418}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 2578377, "time_total_s": 2005.3445172309875, "timestamp": 1558611894, "time_since_restore": 2005.3445172309875, "training_iteration": 61, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f240>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2831, "timesteps_total": 2578377, "episode_reward_mean": -493.27063872697704, "episodes_this_iter": 44, "date": "2019-05-23_11-44-54", "time_this_iter_s": 29.46782946586609, "num_metric_batches_dropped": 0, "episode_reward_min": -650.0178117496298}
{"iterations_since_restore": 62, "info": {"default": {"kl": 0.017814675346016884, "total_loss": 16.714431762695312, "vf_loss": 16.72150230407715, "vf_explained_var": 0.9105442762374878, "cur_lr": 0.0005000000237487257, "entropy": 1.1084530353546143, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.010076044127345085}, "num_steps_trained": 2618528, "update_time_ms": 9.319, "num_steps_sampled": 2618528, "sample_time_ms": 19886.192, "load_time_ms": 22.971, "grad_time_ms": 11602.032}, "hostname": "flow-main", "episode_reward_max": -295.5849727174475, "timesteps_this_iter": 40151, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.55705143413817, "cost1_min": 140.28159615782926, "system_level_velocity_mean": 15.18544981950214, "cost2_mean": -101.39204521203654, "cost2_max": -78.08452088842213, "outflow_rate_max": 1443.4931525674788, "cost1_mean": 183.63366912103734, "system_level_velocity_min": 11.637611508275784, "system_level_velocity_max": 18.191687709718934, "outflow_rate_min": 985.6641322314048, "cost2_min": -118.42724388202606, "outflow_rate_mean": 1237.9656682559876}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2618528, "time_total_s": 2036.0706386566162, "timestamp": 1558611925, "time_since_restore": 2036.0706386566162, "training_iteration": 62, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456ad30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454be48>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2879, "timesteps_total": 2618528, "episode_reward_mean": -472.3579858339017, "episodes_this_iter": 48, "date": "2019-05-23_11-45-25", "time_this_iter_s": 30.726121425628662, "num_metric_batches_dropped": 0, "episode_reward_min": -625.7804642277373}
{"iterations_since_restore": 63, "info": {"default": {"kl": 0.018458198755979538, "total_loss": 12.283299446105957, "vf_loss": 12.290035247802734, "vf_explained_var": 0.9282295107841492, "cur_lr": 0.0005000000237487257, "entropy": 1.100928544998169, "cur_kl_coeff": 0.16875003278255463, "policy_loss": -0.009851207956671715}, "num_steps_trained": 2658551, "update_time_ms": 9.172, "num_steps_sampled": 2658551, "sample_time_ms": 19796.374, "load_time_ms": 23.857, "grad_time_ms": 11451.049}, "hostname": "flow-main", "episode_reward_max": -295.5849727174475, "timesteps_this_iter": 40023, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.55705143413817, "cost1_min": 140.28159615782926, "system_level_velocity_mean": 15.078658936368846, "cost2_mean": -99.2532060485233, "cost2_max": -73.88001179142127, "outflow_rate_max": 1443.4931525674788, "cost1_mean": 182.6002067149735, "system_level_velocity_min": 11.637611508275784, "system_level_velocity_max": 18.214574102624024, "outflow_rate_min": 985.6641322314048, "cost2_min": -118.42724388202606, "outflow_rate_mean": 1232.6549481342424}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2658551, "time_total_s": 2066.2874801158905, "timestamp": 1558611955, "time_since_restore": 2066.2874801158905, "training_iteration": 63, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456af60>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2926, "timesteps_total": 2658551, "episode_reward_mean": -464.95815781956503, "episodes_this_iter": 47, "date": "2019-05-23_11-45-55", "time_this_iter_s": 30.216841459274292, "num_metric_batches_dropped": 0, "episode_reward_min": -625.7804642277373}
{"iterations_since_restore": 64, "info": {"default": {"kl": 0.01696871779859066, "total_loss": 14.342710494995117, "vf_loss": 14.349790573120117, "vf_explained_var": 0.9194902181625366, "cur_lr": 0.0005000000237487257, "entropy": 1.1156173944473267, "cur_kl_coeff": 0.16875003278255463, "policy_loss": -0.009943497367203236}, "num_steps_trained": 2698545, "update_time_ms": 9.258, "num_steps_sampled": 2698545, "sample_time_ms": 19714.932, "load_time_ms": 22.57, "grad_time_ms": 11270.368}, "hostname": "flow-main", "episode_reward_max": -281.56568683642354, "timesteps_this_iter": 39994, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 222.2366622873979, "cost1_min": 141.29613937235135, "system_level_velocity_mean": 15.024810895475454, "cost2_mean": -98.79258169441069, "cost2_max": -73.88001179142127, "outflow_rate_max": 1449.336988331009, "cost1_mean": 181.813855912456, "system_level_velocity_min": 11.82211428636096, "system_level_velocity_max": 18.65166150066427, "outflow_rate_min": 997.4767792207795, "cost2_min": -114.26046289560396, "outflow_rate_mean": 1228.6564972331073}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2698545, "time_total_s": 2095.9879925251007, "timestamp": 1558611985, "time_since_restore": 2095.9879925251007, "training_iteration": 64, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f5c0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 2970, "timesteps_total": 2698545, "episode_reward_mean": -463.4568055873395, "episodes_this_iter": 44, "date": "2019-05-23_11-46-25", "time_this_iter_s": 29.700512409210205, "num_metric_batches_dropped": 0, "episode_reward_min": -597.315872887133}
{"iterations_since_restore": 65, "info": {"default": {"kl": 0.0175962932407856, "total_loss": 16.82667350769043, "vf_loss": 16.834096908569336, "vf_explained_var": 0.9055473208427429, "cur_lr": 0.0005000000237487257, "entropy": 1.1140097379684448, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.01039269007742405}, "num_steps_trained": 2739521, "update_time_ms": 9.404, "num_steps_sampled": 2739521, "sample_time_ms": 19688.316, "load_time_ms": 21.42, "grad_time_ms": 11118.048}, "hostname": "flow-main", "episode_reward_max": -95.94721161595041, "timesteps_this_iter": 40976, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 222.2366622873979, "cost1_min": 79.8650383165992, "system_level_velocity_mean": 15.048951123062782, "cost2_mean": -98.40061629960849, "cost2_max": -61.76815585522081, "outflow_rate_max": 1449.336988331009, "cost1_mean": 180.66165091793596, "system_level_velocity_min": 11.39027807538045, "system_level_velocity_max": 18.65166150066427, "outflow_rate_min": 770.9633298144201, "cost2_min": -113.96855691653147, "outflow_rate_mean": 1223.6703588308512}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 2739521, "time_total_s": 2126.651600599289, "timestamp": 1558612016, "time_since_restore": 2126.651600599289, "training_iteration": 65, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501080>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3019, "timesteps_total": 2739521, "episode_reward_mean": -464.9140414378038, "episodes_this_iter": 49, "date": "2019-05-23_11-46-56", "time_this_iter_s": 30.663608074188232, "num_metric_batches_dropped": 0, "episode_reward_min": -622.8831195208334}
{"iterations_since_restore": 66, "info": {"default": {"kl": 0.016283322125673294, "total_loss": 15.813989639282227, "vf_loss": 15.82154369354248, "vf_explained_var": 0.9116830825805664, "cur_lr": 0.0005000000237487257, "entropy": 1.1143250465393066, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.010302537120878696}, "num_steps_trained": 2779963, "update_time_ms": 9.545, "num_steps_sampled": 2779963, "sample_time_ms": 19690.098, "load_time_ms": 20.665, "grad_time_ms": 10983.376}, "hostname": "flow-main", "episode_reward_max": -95.94721161595041, "timesteps_this_iter": 40442, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.9360282537051, "cost1_min": 79.8650383165992, "system_level_velocity_mean": 15.10281276975414, "cost2_mean": -98.65372122244247, "cost2_max": -61.76815585522081, "outflow_rate_max": 1440.119901477832, "cost1_mean": 181.17550274255981, "system_level_velocity_min": 11.39027807538045, "system_level_velocity_max": 18.57751023610516, "outflow_rate_min": 770.9633298144201, "cost2_min": -113.67586546313925, "outflow_rate_mean": 1227.057784825731}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 2779963, "time_total_s": 2156.7746646404266, "timestamp": 1558612046, "time_since_restore": 2156.7746646404266, "training_iteration": 66, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f25f8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3063, "timesteps_total": 2779963, "episode_reward_mean": -468.75233664722384, "episodes_this_iter": 44, "date": "2019-05-23_11-47-26", "time_this_iter_s": 30.123064041137695, "num_metric_batches_dropped": 0, "episode_reward_min": -622.8831195208334}
{"iterations_since_restore": 67, "info": {"default": {"kl": 0.016695572063326836, "total_loss": 12.716632843017578, "vf_loss": 12.724590301513672, "vf_explained_var": 0.9210288524627686, "cur_lr": 0.0005000000237487257, "entropy": 1.121572494506836, "cur_kl_coeff": 0.16875003278255463, "policy_loss": -0.010773705318570137}, "num_steps_trained": 2819259, "update_time_ms": 9.425, "num_steps_sampled": 2819259, "sample_time_ms": 19617.217, "load_time_ms": 18.848, "grad_time_ms": 11011.578}, "hostname": "flow-main", "episode_reward_max": -28.138810886145937, "timesteps_this_iter": 39296, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.24807817662492, "cost1_min": 23.24324652328535, "system_level_velocity_mean": 15.196976889775696, "cost2_mean": -97.25716707470903, "cost2_max": -23.736650606279017, "outflow_rate_max": 1440.119901477832, "cost1_mean": 181.46921665012775, "system_level_velocity_min": 11.811297862270202, "system_level_velocity_max": 18.806453305426498, "outflow_rate_min": 500.0282905092703, "cost2_min": -113.06438073887828, "outflow_rate_mean": 1228.773269533494}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 2819259, "time_total_s": 2187.5158162117004, "timestamp": 1558612077, "time_since_restore": 2187.5158162117004, "training_iteration": 67, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450ffd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f198>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3111, "timesteps_total": 2819259, "episode_reward_mean": -456.83816153545484, "episodes_this_iter": 48, "date": "2019-05-23_11-47-57", "time_this_iter_s": 30.741151571273804, "num_metric_batches_dropped": 0, "episode_reward_min": -628.2533564068166}
{"iterations_since_restore": 68, "info": {"default": {"kl": 0.01547573134303093, "total_loss": 13.786540031433105, "vf_loss": 13.79415225982666, "vf_explained_var": 0.9208781123161316, "cur_lr": 0.0005000000237487257, "entropy": 1.1157363653182983, "cur_kl_coeff": 0.16875003278255463, "policy_loss": -0.010224917903542519}, "num_steps_trained": 2859286, "update_time_ms": 9.326, "num_steps_sampled": 2859286, "sample_time_ms": 19484.919, "load_time_ms": 20.068, "grad_time_ms": 10994.123}, "hostname": "flow-main", "episode_reward_max": -28.138810886145937, "timesteps_this_iter": 40027, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.24807817662492, "cost1_min": 23.24324652328535, "system_level_velocity_mean": 15.235154688088096, "cost2_mean": -96.4656576140873, "cost2_max": -23.736650606279017, "outflow_rate_max": 1442.4845673195366, "cost1_mean": 182.21197848766627, "system_level_velocity_min": 11.811297862270202, "system_level_velocity_max": 18.806453305426498, "outflow_rate_min": 500.0282905092703, "cost2_min": -113.06438073887828, "outflow_rate_mean": 1230.5105617157308}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 2859286, "time_total_s": 2217.9973695278168, "timestamp": 1558612107, "time_since_restore": 2217.9973695278168, "training_iteration": 68, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f320>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3158, "timesteps_total": 2859286, "episode_reward_mean": -448.38903206103345, "episodes_this_iter": 47, "date": "2019-05-23_11-48-27", "time_this_iter_s": 30.481553316116333, "num_metric_batches_dropped": 0, "episode_reward_min": -628.2533564068166}
{"iterations_since_restore": 69, "info": {"default": {"kl": 0.018055351451039314, "total_loss": 13.155891418457031, "vf_loss": 13.163697242736816, "vf_explained_var": 0.9291139841079712, "cur_lr": 0.0005000000237487257, "entropy": 1.1375821828842163, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.010853965766727924}, "num_steps_trained": 2899469, "update_time_ms": 9.167, "num_steps_sampled": 2899469, "sample_time_ms": 19423.16, "load_time_ms": 21.639, "grad_time_ms": 10963.08}, "hostname": "flow-main", "episode_reward_max": -99.15375437756666, "timesteps_this_iter": 40183, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.02027446896503, "cost1_min": 78.67296782238402, "system_level_velocity_mean": 14.85092885159676, "cost2_mean": -95.59747664960041, "cost2_max": -59.50294820880659, "outflow_rate_max": 1442.4845673195366, "cost1_mean": 178.27051249149102, "system_level_velocity_min": 11.8523993143785, "system_level_velocity_max": 18.14092767654208, "outflow_rate_min": 746.131191182419, "cost2_min": -114.3415534372736, "outflow_rate_mean": 1205.3066878290133}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 2899469, "time_total_s": 2249.1940026283264, "timestamp": 1558612138, "time_since_restore": 2249.1940026283264, "training_iteration": 69, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2080>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3204, "timesteps_total": 2899469, "episode_reward_mean": -468.4729894119508, "episodes_this_iter": 46, "date": "2019-05-23_11-48-58", "time_this_iter_s": 31.196633100509644, "num_metric_batches_dropped": 0, "episode_reward_min": -600.8370141374389}
{"iterations_since_restore": 70, "info": {"default": {"kl": 0.016989341005682945, "total_loss": 16.73324203491211, "vf_loss": 16.741178512573242, "vf_explained_var": 0.9149652123451233, "cur_lr": 0.0005000000237487257, "entropy": 1.1157872676849365, "cur_kl_coeff": 0.16875000298023224, "policy_loss": -0.010802577249705791}, "num_steps_trained": 2939038, "update_time_ms": 9.287, "num_steps_sampled": 2939038, "sample_time_ms": 19343.354, "load_time_ms": 21.613, "grad_time_ms": 10951.117}, "hostname": "flow-main", "episode_reward_max": -99.15375437756666, "timesteps_this_iter": 39569, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 219.99247893098425, "cost1_min": 78.67296782238402, "system_level_velocity_mean": 14.972639371140737, "cost2_mean": -96.68751848819242, "cost2_max": -59.50294820880659, "outflow_rate_max": 1443.2359443817552, "cost1_mean": 179.41234609920335, "system_level_velocity_min": 11.817549684103465, "system_level_velocity_max": 18.30702135229809, "outflow_rate_min": 746.131191182419, "cost2_min": -115.02938956866137, "outflow_rate_mean": 1208.1162578761403}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 2939038, "time_total_s": 2280.0304005146027, "timestamp": 1558612169, "time_since_restore": 2280.0304005146027, "training_iteration": 70, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508cf8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3252, "timesteps_total": 2939038, "episode_reward_mean": -465.5050552233807, "episodes_this_iter": 48, "date": "2019-05-23_11-49-29", "time_this_iter_s": 30.836397886276245, "num_metric_batches_dropped": 0, "episode_reward_min": -621.8560179825907}
{"iterations_since_restore": 71, "info": {"default": {"kl": 0.019889140501618385, "total_loss": 14.43709945678711, "vf_loss": 14.445812225341797, "vf_explained_var": 0.9245728254318237, "cur_lr": 0.0005000000237487257, "entropy": 1.0935513973236084, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.012068916112184525}, "num_steps_trained": 2978151, "update_time_ms": 9.475, "num_steps_sampled": 2978151, "sample_time_ms": 19466.149, "load_time_ms": 21.543, "grad_time_ms": 10941.627}, "hostname": "flow-main", "episode_reward_max": -31.344802263597753, "timesteps_this_iter": 39113, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 219.99247893098425, "cost1_min": 24.421558764187015, "system_level_velocity_mean": 14.916115525298137, "cost2_mean": -95.463686546199, "cost2_max": -26.006793541693163, "outflow_rate_max": 1445.5795871608063, "cost1_mean": 178.08919829504495, "system_level_velocity_min": 11.817549684103465, "system_level_velocity_max": 18.62848808995946, "outflow_rate_min": 475.4385119415045, "cost2_min": -115.02938956866137, "outflow_rate_mean": 1197.077133811553}, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 2978151, "time_total_s": 2310.646133184433, "timestamp": 1558612200, "time_since_restore": 2310.646133184433, "training_iteration": 71, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454be48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa198>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3299, "timesteps_total": 2978151, "episode_reward_mean": -460.9498793382954, "episodes_this_iter": 47, "date": "2019-05-23_11-50-00", "time_this_iter_s": 30.615732669830322, "num_metric_batches_dropped": 0, "episode_reward_min": -621.8560179825907}
{"iterations_since_restore": 72, "info": {"default": {"kl": 0.019056295976042747, "total_loss": 14.055445671081543, "vf_loss": 14.061927795410156, "vf_explained_var": 0.9234981536865234, "cur_lr": 0.0005000000237487257, "entropy": 1.0959898233413696, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.00969697441905737}, "num_steps_trained": 3017177, "update_time_ms": 9.546, "num_steps_sampled": 3017177, "sample_time_ms": 19514.296, "load_time_ms": 21.725, "grad_time_ms": 10774.05}, "hostname": "flow-main", "episode_reward_max": -31.344802263597753, "timesteps_this_iter": 39026, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.63552147297918, "cost1_min": 24.421558764187015, "system_level_velocity_mean": 15.04668175959054, "cost2_mean": -95.0213650977108, "cost2_max": -26.006793541693163, "outflow_rate_max": 1455.2916446441159, "cost1_mean": 179.68229979956422, "system_level_velocity_min": 11.961324136507137, "system_level_velocity_max": 18.62848808995946, "outflow_rate_min": 475.4385119415045, "cost2_min": -115.42592041700459, "outflow_rate_mean": 1207.1210587926807}, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 3017177, "time_total_s": 2340.1769049167633, "timestamp": 1558612230, "time_since_restore": 2340.1769049167633, "training_iteration": 72, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fafd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa6a0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3343, "timesteps_total": 3017177, "episode_reward_mean": -449.5469901972225, "episodes_this_iter": 44, "date": "2019-05-23_11-50-30", "time_this_iter_s": 29.530771732330322, "num_metric_batches_dropped": 0, "episode_reward_min": -620.4493100652484}
{"iterations_since_restore": 73, "info": {"default": {"kl": 0.018067874014377594, "total_loss": 15.87524700164795, "vf_loss": 15.883186340332031, "vf_explained_var": 0.9169727563858032, "cur_lr": 0.0005000000237487257, "entropy": 1.095755696296692, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.01098920963704586}, "num_steps_trained": 3056639, "update_time_ms": 9.78, "num_steps_sampled": 3056639, "sample_time_ms": 19557.862, "load_time_ms": 21.74, "grad_time_ms": 10786.944}, "hostname": "flow-main", "episode_reward_max": -274.35852839591405, "timesteps_this_iter": 39462, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.9660827594114, "cost1_min": 144.19940929562864, "system_level_velocity_mean": 15.141701800446196, "cost2_mean": -96.24787558241106, "cost2_max": -72.720280722008, "outflow_rate_max": 1458.4139917062712, "cost1_mean": 182.82635161478302, "system_level_velocity_min": 12.015542740336238, "system_level_velocity_max": 18.718937326388218, "outflow_rate_min": 949.7333333333332, "cost2_min": -117.74317782855526, "outflow_rate_mean": 1220.7697105069042}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3056639, "time_total_s": 2370.9309072494507, "timestamp": 1558612260, "time_since_restore": 2370.9309072494507, "training_iteration": 73, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd898>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3391, "timesteps_total": 3056639, "episode_reward_mean": -455.00958623899305, "episodes_this_iter": 48, "date": "2019-05-23_11-51-00", "time_this_iter_s": 30.754002332687378, "num_metric_batches_dropped": 0, "episode_reward_min": -573.7798849755026}
{"iterations_since_restore": 74, "info": {"default": {"kl": 0.01904056780040264, "total_loss": 13.131495475769043, "vf_loss": 13.13955307006836, "vf_explained_var": 0.9265181422233582, "cur_lr": 0.0005000000237487257, "entropy": 1.0784724950790405, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.011271156370639801}, "num_steps_trained": 3095176, "update_time_ms": 9.627, "num_steps_sampled": 3095176, "sample_time_ms": 19523.58, "load_time_ms": 22.537, "grad_time_ms": 10820.693}, "hostname": "flow-main", "episode_reward_max": -95.51459526002344, "timesteps_this_iter": 38537, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.9660827594114, "cost1_min": 80.25048627835332, "system_level_velocity_mean": 15.332578779506742, "cost2_mean": -95.45071497937035, "cost2_max": -61.70189982763111, "outflow_rate_max": 1458.4139917062712, "cost1_mean": 183.5157267086133, "system_level_velocity_min": 11.969657419493213, "system_level_velocity_max": 18.718937326388218, "outflow_rate_min": 773.5779685398098, "cost2_min": -117.74317782855526, "outflow_rate_mean": 1219.8641625363268}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 3095176, "time_total_s": 2400.6189889907837, "timestamp": 1558612290, "time_since_restore": 2400.6189889907837, "training_iteration": 74, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2b00>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3436, "timesteps_total": 3095176, "episode_reward_mean": -442.03878402535446, "episodes_this_iter": 45, "date": "2019-05-23_11-51-30", "time_this_iter_s": 29.688081741333008, "num_metric_batches_dropped": 0, "episode_reward_min": -563.1035448571303}
{"iterations_since_restore": 75, "info": {"default": {"kl": 0.019110320135951042, "total_loss": 12.63512897491455, "vf_loss": 12.644366264343262, "vf_explained_var": 0.9266603589057922, "cur_lr": 0.0005000000237487257, "entropy": 1.0582181215286255, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.012462983839213848}, "num_steps_trained": 3133823, "update_time_ms": 9.363, "num_steps_sampled": 3133823, "sample_time_ms": 19426.775, "load_time_ms": 23.164, "grad_time_ms": 10887.206}, "hostname": "flow-main", "episode_reward_max": -95.51459526002344, "timesteps_this_iter": 38647, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.46568082050388, "cost1_min": 80.25048627835332, "system_level_velocity_mean": 15.251000307892504, "cost2_mean": -92.92485885541096, "cost2_max": -61.70189982763111, "outflow_rate_max": 1450.7917203230065, "cost1_mean": 182.49185699353802, "system_level_velocity_min": 11.84759699398324, "system_level_velocity_max": 18.634330912274983, "outflow_rate_min": 773.5779685398098, "cost2_min": -113.83374052405058, "outflow_rate_mean": 1213.5872791743898}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 3133823, "time_total_s": 2430.9909603595734, "timestamp": 1558612320, "time_since_restore": 2430.9909603595734, "training_iteration": 75, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501080>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3482, "timesteps_total": 3133823, "episode_reward_mean": -435.0383804014494, "episodes_this_iter": 46, "date": "2019-05-23_11-52-00", "time_this_iter_s": 30.371971368789673, "num_metric_batches_dropped": 0, "episode_reward_min": -562.5603912027227}
{"iterations_since_restore": 76, "info": {"default": {"kl": 0.021581904962658882, "total_loss": 10.361660957336426, "vf_loss": 10.370271682739258, "vf_explained_var": 0.9366270899772644, "cur_lr": 0.0005000000237487257, "entropy": 1.0799566507339478, "cur_kl_coeff": 0.16875001788139343, "policy_loss": -0.012252086773514748}, "num_steps_trained": 3172016, "update_time_ms": 9.106, "num_steps_sampled": 3172016, "sample_time_ms": 19314.292, "load_time_ms": 23.246, "grad_time_ms": 10969.943}, "hostname": "flow-main", "episode_reward_max": -288.46573967664335, "timesteps_this_iter": 38193, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.46568082050388, "cost1_min": 141.16506844840416, "system_level_velocity_mean": 15.233409830722776, "cost2_mean": -92.88070641677048, "cost2_max": -74.9783054929516, "outflow_rate_max": 1450.7917203230065, "cost1_mean": 183.80440781239707, "system_level_velocity_min": 11.84759699398324, "system_level_velocity_max": 18.522170845504814, "outflow_rate_min": 984.6754354479272, "cost2_min": -114.40042639731608, "outflow_rate_mean": 1223.5615657903975}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3172016, "time_total_s": 2460.8169355392456, "timestamp": 1558612350, "time_since_restore": 2460.8169355392456, "training_iteration": 76, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa898>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3529, "timesteps_total": 3172016, "episode_reward_mean": -432.10770060978683, "episodes_this_iter": 47, "date": "2019-05-23_11-52-30", "time_this_iter_s": 29.82597517967224, "num_metric_batches_dropped": 0, "episode_reward_min": -559.0337783168374}
{"iterations_since_restore": 77, "info": {"default": {"kl": 0.015319455415010452, "total_loss": 11.65689754486084, "vf_loss": 11.66281795501709, "vf_explained_var": 0.9359232187271118, "cur_lr": 0.0005000000237487257, "entropy": 1.0721840858459473, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.009798507206141949}, "num_steps_trained": 3210573, "update_time_ms": 9.074, "num_steps_sampled": 3210573, "sample_time_ms": 19228.008, "load_time_ms": 24.574, "grad_time_ms": 10915.976}, "hostname": "flow-main", "episode_reward_max": -104.4223166652459, "timesteps_this_iter": 38557, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.8377509383779, "cost1_min": 85.14850135362155, "system_level_velocity_mean": 15.266936862697445, "cost2_mean": -92.91635687119106, "cost2_max": -63.21986042003975, "outflow_rate_max": 1448.376428571429, "cost1_mean": 181.58949592102047, "system_level_velocity_min": 12.126815195268897, "system_level_velocity_max": 18.722772419571495, "outflow_rate_min": 808.0232702330483, "cost2_min": -114.53332522121451, "outflow_rate_mean": 1212.5570632222789}, "episode_len_mean": 321.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3210573, "time_total_s": 2490.188679933548, "timestamp": 1558612380, "time_since_restore": 2490.188679933548, "training_iteration": 77, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565f98>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3577, "timesteps_total": 3210573, "episode_reward_mean": -430.36850442662217, "episodes_this_iter": 48, "date": "2019-05-23_11-53-00", "time_this_iter_s": 29.371744394302368, "num_metric_batches_dropped": 0, "episode_reward_min": -546.9973311975992}
{"iterations_since_restore": 78, "info": {"default": {"kl": 0.017035262659192085, "total_loss": 13.526979446411133, "vf_loss": 13.534063339233398, "vf_explained_var": 0.9241080284118652, "cur_lr": 0.0005000000237487257, "entropy": 1.092344880104065, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.011395254172384739}, "num_steps_trained": 3248748, "update_time_ms": 9.34, "num_steps_sampled": 3248748, "sample_time_ms": 19186.621, "load_time_ms": 24.045, "grad_time_ms": 10889.383}, "hostname": "flow-main", "episode_reward_max": -104.4223166652459, "timesteps_this_iter": 38175, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.8377509383779, "cost1_min": 85.14850135362155, "system_level_velocity_mean": 15.35374070113209, "cost2_mean": -92.80085030094727, "cost2_max": -63.21986042003975, "outflow_rate_max": 1448.0211338238933, "cost1_mean": 182.50055438515798, "system_level_velocity_min": 11.588220615469135, "system_level_velocity_max": 18.722772419571495, "outflow_rate_min": 808.0232702330483, "cost2_min": -114.53332522121451, "outflow_rate_mean": 1216.7511191542328}, "episode_len_mean": 321.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3248748, "time_total_s": 2520.0066587924957, "timestamp": 1558612410, "time_since_restore": 2520.0066587924957, "training_iteration": 78, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fab00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fadd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3622, "timesteps_total": 3248748, "episode_reward_mean": -425.5082264172981, "episodes_this_iter": 45, "date": "2019-05-23_11-53-30", "time_this_iter_s": 29.817978858947754, "num_metric_batches_dropped": 0, "episode_reward_min": -558.5730808181211}
{"iterations_since_restore": 79, "info": {"default": {"kl": 0.014987640082836151, "total_loss": 14.62511157989502, "vf_loss": 14.630295753479004, "vf_explained_var": 0.9168293476104736, "cur_lr": 0.0005000000237487257, "entropy": 1.0981082916259766, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.00897789467126131}, "num_steps_trained": 3286937, "update_time_ms": 9.196, "num_steps_sampled": 3286937, "sample_time_ms": 19130.533, "load_time_ms": 22.931, "grad_time_ms": 10951.042}, "hostname": "flow-main", "episode_reward_max": -29.97688242087212, "timesteps_this_iter": 38189, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.1044356243517, "cost1_min": 23.033515963971503, "system_level_velocity_mean": 15.226924345326777, "cost2_mean": -90.64727862773448, "cost2_max": -22.091940014654206, "outflow_rate_max": 1450.3303576453382, "cost1_mean": 180.26214792627377, "system_level_velocity_min": 11.588220615469135, "system_level_velocity_max": 18.722772419571495, "outflow_rate_min": 489.3996304716414, "cost2_min": -114.53332522121451, "outflow_rate_mean": 1205.764348770522}, "episode_len_mean": 320.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 3286937, "time_total_s": 2551.2659986019135, "timestamp": 1558612441, "time_since_restore": 2551.2659986019135, "training_iteration": 79, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450ff98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fa58>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3669, "timesteps_total": 3286937, "episode_reward_mean": -423.93610849801405, "episodes_this_iter": 47, "date": "2019-05-23_11-54-01", "time_this_iter_s": 31.259339809417725, "num_metric_batches_dropped": 0, "episode_reward_min": -558.5730808181211}
{"iterations_since_restore": 80, "info": {"default": {"kl": 0.018040211871266365, "total_loss": 13.589821815490723, "vf_loss": 13.599137306213379, "vf_explained_var": 0.9165746569633484, "cur_lr": 0.0005000000237487257, "entropy": 1.0863276720046997, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.013882205821573734}, "num_steps_trained": 3324520, "update_time_ms": 9.241, "num_steps_sampled": 3324520, "sample_time_ms": 19054.583, "load_time_ms": 22.537, "grad_time_ms": 10763.104}, "hostname": "flow-main", "episode_reward_max": -29.97688242087212, "timesteps_this_iter": 37583, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.1044356243517, "cost1_min": 23.033515963971503, "system_level_velocity_mean": 15.28286963491872, "cost2_mean": -90.1314685891281, "cost2_max": -22.091940014654206, "outflow_rate_max": 1451.87997882833, "cost1_mean": 182.15916115038465, "system_level_velocity_min": 11.628969557111986, "system_level_velocity_max": 18.56938709695411, "outflow_rate_min": 489.3996304716414, "cost2_min": -113.91962020976672, "outflow_rate_mean": 1213.237516534321}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 3324520, "time_total_s": 2579.4302389621735, "timestamp": 1558612469, "time_since_restore": 2579.4302389621735, "training_iteration": 80, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845081d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508860>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3716, "timesteps_total": 3324520, "episode_reward_mean": -417.7439565026338, "episodes_this_iter": 47, "date": "2019-05-23_11-54-29", "time_this_iter_s": 28.16424036026001, "num_metric_batches_dropped": 0, "episode_reward_min": -520.1522864819249}
{"iterations_since_restore": 81, "info": {"default": {"kl": 0.01602812297642231, "total_loss": 15.820940971374512, "vf_loss": 15.82699203491211, "vf_explained_var": 0.9122188091278076, "cur_lr": 0.0005000000237487257, "entropy": 1.0941016674041748, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.010107181034982204}, "num_steps_trained": 3362914, "update_time_ms": 9.112, "num_steps_sampled": 3362914, "sample_time_ms": 19123.329, "load_time_ms": 22.476, "grad_time_ms": 10662.619}, "hostname": "flow-main", "episode_reward_max": -23.008869205203364, "timesteps_this_iter": 38394, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.85072986621856, "cost1_min": 17.97250525554693, "system_level_velocity_mean": 15.256273572540191, "cost2_mean": -89.40340328332675, "cost2_max": -20.702527560890495, "outflow_rate_max": 1451.87997882833, "cost1_mean": 181.96068842079995, "system_level_velocity_min": 11.628969557111986, "system_level_velocity_max": 18.456985292021738, "outflow_rate_min": 444.6769763958757, "cost2_min": -113.7362854165689, "outflow_rate_mean": 1208.8530697475296}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 3362914, "time_total_s": 2609.7192645072937, "timestamp": 1558612499, "time_since_restore": 2609.7192645072937, "training_iteration": 81, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565e48>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3763, "timesteps_total": 3362914, "episode_reward_mean": -416.2854092056345, "episodes_this_iter": 47, "date": "2019-05-23_11-54-59", "time_this_iter_s": 30.28902554512024, "num_metric_batches_dropped": 0, "episode_reward_min": -521.7176446359865}
{"iterations_since_restore": 82, "info": {"default": {"kl": 0.014451789669692516, "total_loss": 12.090375900268555, "vf_loss": 12.096193313598633, "vf_explained_var": 0.9294016361236572, "cur_lr": 0.0005000000237487257, "entropy": 1.1162399053573608, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.009475321508944035}, "num_steps_trained": 3401418, "update_time_ms": 8.904, "num_steps_sampled": 3401418, "sample_time_ms": 19148.453, "load_time_ms": 21.213, "grad_time_ms": 10691.066}, "hostname": "flow-main", "episode_reward_max": -23.008869205203364, "timesteps_this_iter": 38504, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.42735926300412, "cost1_min": 17.97250525554693, "system_level_velocity_mean": 14.982938195390593, "cost2_mean": -88.01802339794682, "cost2_max": -20.702527560890495, "outflow_rate_max": 1439.2100533018086, "cost1_mean": 177.53098764955496, "system_level_velocity_min": 12.080708592178613, "system_level_velocity_max": 18.742600643943312, "outflow_rate_min": 444.6769763958757, "cost2_min": -113.317445089845, "outflow_rate_mean": 1185.5207162854645}, "episode_len_mean": 319.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 3401418, "time_total_s": 2639.7830967903137, "timestamp": 1558612530, "time_since_restore": 2639.7830967903137, "training_iteration": 82, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845084e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508978>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3809, "timesteps_total": 3401418, "episode_reward_mean": -429.6039451991378, "episodes_this_iter": 46, "date": "2019-05-23_11-55-30", "time_this_iter_s": 30.06383228302002, "num_metric_batches_dropped": 0, "episode_reward_min": -521.7176446359865}
{"iterations_since_restore": 83, "info": {"default": {"kl": 0.016430361196398735, "total_loss": 11.44449520111084, "vf_loss": 11.451664924621582, "vf_explained_var": 0.9333161115646362, "cur_lr": 0.0005000000237487257, "entropy": 1.0837370157241821, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.011330020613968372}, "num_steps_trained": 3439675, "update_time_ms": 8.626, "num_steps_sampled": 3439675, "sample_time_ms": 19151.505, "load_time_ms": 21.106, "grad_time_ms": 10682.969}, "hostname": "flow-main", "episode_reward_max": -20.926291776274752, "timesteps_this_iter": 38257, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.42735926300412, "cost1_min": 17.94984999858007, "system_level_velocity_mean": 14.957969500334878, "cost2_mean": -88.43812416981402, "cost2_max": -19.051049429206916, "outflow_rate_max": 1448.144241100027, "cost1_mean": 175.94787875056613, "system_level_velocity_min": 11.631326687603108, "system_level_velocity_max": 18.742600643943312, "outflow_rate_min": 494.27405165189856, "cost2_min": -113.77080147669525, "outflow_rate_mean": 1180.605747336779}, "episode_len_mean": 317.86, "node_ip": "10.138.0.2", "timesteps_since_restore": 3439675, "time_total_s": 2670.4804623126984, "timestamp": 1558612560, "time_since_restore": 2670.4804623126984, "training_iteration": 83, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa1d0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3859, "timesteps_total": 3439675, "episode_reward_mean": -430.90465284441933, "episodes_this_iter": 50, "date": "2019-05-23_11-56-00", "time_this_iter_s": 30.697365522384644, "num_metric_batches_dropped": 0, "episode_reward_min": -625.7770746927141}
{"iterations_since_restore": 84, "info": {"default": {"kl": 0.01675734668970108, "total_loss": 10.56714153289795, "vf_loss": 10.57376766204834, "vf_explained_var": 0.9396792650222778, "cur_lr": 0.0005000000237487257, "entropy": 1.0899561643600464, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.010867123492062092}, "num_steps_trained": 3477918, "update_time_ms": 8.807, "num_steps_sampled": 3477918, "sample_time_ms": 19257.331, "load_time_ms": 20.172, "grad_time_ms": 10724.399}, "hostname": "flow-main", "episode_reward_max": -20.926291776274752, "timesteps_this_iter": 38243, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.41976147263503, "cost1_min": 17.94984999858007, "system_level_velocity_mean": 15.047281108953396, "cost2_mean": -88.45357807776887, "cost2_max": -19.051049429206916, "outflow_rate_max": 1448.144241100027, "cost1_mean": 174.98168603725907, "system_level_velocity_min": 11.631326687603108, "system_level_velocity_max": 18.836415613317957, "outflow_rate_min": 494.27405165189856, "cost2_min": -113.77080147669525, "outflow_rate_mean": 1180.1746869427877}, "episode_len_mean": 315.04, "node_ip": "10.138.0.2", "timesteps_since_restore": 3477918, "time_total_s": 2701.6283872127533, "timestamp": 1558612591, "time_since_restore": 2701.6283872127533, "training_iteration": 84, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845089b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3906, "timesteps_total": 3477918, "episode_reward_mean": -421.7148804214802, "episodes_this_iter": 47, "date": "2019-05-23_11-56-31", "time_this_iter_s": 31.14792490005493, "num_metric_batches_dropped": 0, "episode_reward_min": -625.7770746927141}
{"iterations_since_restore": 85, "info": {"default": {"kl": 0.017085110768675804, "total_loss": 12.76878547668457, "vf_loss": 12.775527954101562, "vf_explained_var": 0.9259325861930847, "cur_lr": 0.0005000000237487257, "entropy": 1.083962321281433, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.011066138744354248}, "num_steps_trained": 3516248, "update_time_ms": 8.878, "num_steps_sampled": 3516248, "sample_time_ms": 19178.174, "load_time_ms": 20.52, "grad_time_ms": 10707.602}, "hostname": "flow-main", "episode_reward_max": -21.720477492168783, "timesteps_this_iter": 38330, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.0679353078857, "cost1_min": 18.723429781958014, "system_level_velocity_mean": 15.284802853802098, "cost2_mean": -90.04410339540604, "cost2_max": -19.11726589903975, "outflow_rate_max": 1441.977766622778, "cost1_mean": 178.96311075984033, "system_level_velocity_min": 11.854110464359652, "system_level_velocity_max": 18.836415613317957, "outflow_rate_min": 497.50056700217027, "cost2_min": -112.88186293869916, "outflow_rate_mean": 1198.9977005659039}, "episode_len_mean": 317.13, "node_ip": "10.138.0.2", "timesteps_since_restore": 3516248, "time_total_s": 2731.0374822616577, "timestamp": 1558612621, "time_since_restore": 2731.0374822616577, "training_iteration": 85, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508160>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3950, "timesteps_total": 3516248, "episode_reward_mean": -417.3708021160892, "episodes_this_iter": 44, "date": "2019-05-23_11-57-01", "time_this_iter_s": 29.40909504890442, "num_metric_batches_dropped": 0, "episode_reward_min": -528.8869529868255}
{"iterations_since_restore": 86, "info": {"default": {"kl": 0.015779724344611168, "total_loss": 14.701031684875488, "vf_loss": 14.707620620727539, "vf_explained_var": 0.9129905700683594, "cur_lr": 0.0005000000237487257, "entropy": 1.1052889823913574, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.010583535768091679}, "num_steps_trained": 3554201, "update_time_ms": 9.005, "num_steps_sampled": 3554201, "sample_time_ms": 19101.062, "load_time_ms": 20.39, "grad_time_ms": 10736.155}, "hostname": "flow-main", "episode_reward_max": -21.720477492168783, "timesteps_this_iter": 37953, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.6032108736324, "cost1_min": 18.723429781958014, "system_level_velocity_mean": 15.596560058897696, "cost2_mean": -92.50086505851978, "cost2_max": -19.11726589903975, "outflow_rate_max": 1441.3066450216456, "cost1_mean": 184.78746517308082, "system_level_velocity_min": 12.823730279556777, "system_level_velocity_max": 18.409861693602437, "outflow_rate_min": 497.50056700217027, "cost2_min": -112.88186293869916, "outflow_rate_mean": 1227.8268556023745}, "episode_len_mean": 320.03, "node_ip": "10.138.0.2", "timesteps_since_restore": 3554201, "time_total_s": 2760.3793938159943, "timestamp": 1558612650, "time_since_restore": 2760.3793938159943, "training_iteration": 86, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa358>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 3998, "timesteps_total": 3554201, "episode_reward_mean": -409.9573175473816, "episodes_this_iter": 48, "date": "2019-05-23_11-57-30", "time_this_iter_s": 29.341911554336548, "num_metric_batches_dropped": 0, "episode_reward_min": -528.9132646553961}
{"iterations_since_restore": 87, "info": {"default": {"kl": 0.01593540795147419, "total_loss": 12.503283500671387, "vf_loss": 12.508224487304688, "vf_explained_var": 0.9205789566040039, "cur_lr": 0.0005000000237487257, "entropy": 1.1106516122817993, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.008974320255219936}, "num_steps_trained": 3592011, "update_time_ms": 9.17, "num_steps_sampled": 3592011, "sample_time_ms": 19131.498, "load_time_ms": 20.141, "grad_time_ms": 10706.492}, "hostname": "flow-main", "episode_reward_max": -108.80569574509826, "timesteps_this_iter": 37810, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.6032108736324, "cost1_min": 83.92013681422544, "system_level_velocity_mean": 15.413116787901606, "cost2_mean": -91.40119997335762, "cost2_max": -60.80153988341712, "outflow_rate_max": 1438.362988389668, "cost1_mean": 184.6187360850108, "system_level_velocity_min": 12.27244043197818, "system_level_velocity_max": 18.409861693602437, "outflow_rate_min": 802.5509637249048, "cost2_min": -114.11222701644253, "outflow_rate_mean": 1225.0591046897257}, "episode_len_mean": 322.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 3592011, "time_total_s": 2789.7568073272705, "timestamp": 1558612680, "time_since_restore": 2789.7568073272705, "training_iteration": 87, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514da0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4046, "timesteps_total": 3592011, "episode_reward_mean": -409.491223953709, "episodes_this_iter": 48, "date": "2019-05-23_11-58-00", "time_this_iter_s": 29.377413511276245, "num_metric_batches_dropped": 0, "episode_reward_min": -528.9132646553961}
{"iterations_since_restore": 88, "info": {"default": {"kl": 0.01747395470738411, "total_loss": 14.64913272857666, "vf_loss": 14.655864715576172, "vf_explained_var": 0.9142318367958069, "cur_lr": 0.0005000000237487257, "entropy": 1.1163556575775146, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.011155281215906143}, "num_steps_trained": 3630347, "update_time_ms": 9.099, "num_steps_sampled": 3630347, "sample_time_ms": 19153.791, "load_time_ms": 19.193, "grad_time_ms": 10642.58}, "hostname": "flow-main", "episode_reward_max": -94.60668549198928, "timesteps_this_iter": 38336, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 216.46075954490396, "cost1_min": 78.25572439285811, "system_level_velocity_mean": 15.401919449265739, "cost2_mean": -90.2661954441156, "cost2_max": -57.44411162180561, "outflow_rate_max": 1440.311954022989, "cost1_mean": 179.99739283677548, "system_level_velocity_min": 11.849310877483273, "system_level_velocity_max": 18.67739272276892, "outflow_rate_min": 746.7165687204033, "cost2_min": -114.11222701644253, "outflow_rate_mean": 1205.572293679363}, "episode_len_mean": 316.48, "node_ip": "10.138.0.2", "timesteps_since_restore": 3630347, "time_total_s": 2819.13209939003, "timestamp": 1558612709, "time_since_restore": 2819.13209939003, "training_iteration": 88, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508710>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4092, "timesteps_total": 3630347, "episode_reward_mean": -408.4696733362082, "episodes_this_iter": 46, "date": "2019-05-23_11-58-29", "time_this_iter_s": 29.3752920627594, "num_metric_batches_dropped": 0, "episode_reward_min": -566.038048208658}
{"iterations_since_restore": 89, "info": {"default": {"kl": 0.01580638997256756, "total_loss": 14.890382766723633, "vf_loss": 14.898473739624023, "vf_explained_var": 0.9206291437149048, "cur_lr": 0.0005000000237487257, "entropy": 1.111786127090454, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.012091308832168579}, "num_steps_trained": 3668874, "update_time_ms": 9.557, "num_steps_sampled": 3668874, "sample_time_ms": 19121.729, "load_time_ms": 20.099, "grad_time_ms": 10591.593}, "hostname": "flow-main", "episode_reward_max": -94.60668549198928, "timesteps_this_iter": 38527, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.17549843702312, "cost1_min": 78.25572439285811, "system_level_velocity_mean": 15.521680146193901, "cost2_mean": -92.43051592863321, "cost2_max": -57.44411162180561, "outflow_rate_max": 1443.0246147140383, "cost1_mean": 182.68756662920984, "system_level_velocity_min": 11.849310877483273, "system_level_velocity_max": 18.67739272276892, "outflow_rate_min": 746.7165687204033, "cost2_min": -115.02693479938344, "outflow_rate_mean": 1217.774384116674}, "episode_len_mean": 318.48, "node_ip": "10.138.0.2", "timesteps_since_restore": 3668874, "time_total_s": 2849.5474865436554, "timestamp": 1558612740, "time_since_restore": 2849.5474865436554, "training_iteration": 89, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845149e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845148d0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4139, "timesteps_total": 3668874, "episode_reward_mean": -413.6823470734115, "episodes_this_iter": 47, "date": "2019-05-23_11-59-00", "time_this_iter_s": 30.41538715362549, "num_metric_batches_dropped": 0, "episode_reward_min": -566.038048208658}
{"iterations_since_restore": 90, "info": {"default": {"kl": 0.016805114224553108, "total_loss": 13.332789421081543, "vf_loss": 13.341265678405762, "vf_explained_var": 0.926733136177063, "cur_lr": 0.0005000000237487257, "entropy": 1.1116302013397217, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.01272954698652029}, "num_steps_trained": 3707623, "update_time_ms": 9.61, "num_steps_sampled": 3707623, "sample_time_ms": 19259.494, "load_time_ms": 20.25, "grad_time_ms": 10637.785}, "hostname": "flow-main", "episode_reward_max": -293.6729802411255, "timesteps_this_iter": 38749, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.17549843702312, "cost1_min": 141.80082917220915, "system_level_velocity_mean": 15.224900461523898, "cost2_mean": -93.56798005000817, "cost2_max": -74.17857466450059, "outflow_rate_max": 1443.0246147140383, "cost1_mean": 183.78582166918162, "system_level_velocity_min": 11.849310877483273, "system_level_velocity_max": 18.272744319452418, "outflow_rate_min": 933.4869973954343, "cost2_min": -115.02693479938344, "outflow_rate_mean": 1218.0042221457566}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3707623, "time_total_s": 2879.5580084323883, "timestamp": 1558612770, "time_since_restore": 2879.5580084323883, "training_iteration": 90, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844facc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fae10>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4185, "timesteps_total": 3707623, "episode_reward_mean": -434.57239751986185, "episodes_this_iter": 46, "date": "2019-05-23_11-59-30", "time_this_iter_s": 30.01052188873291, "num_metric_batches_dropped": 0, "episode_reward_min": -566.7102489976012}
{"iterations_since_restore": 91, "info": {"default": {"kl": 0.017026226967573166, "total_loss": 13.300905227661133, "vf_loss": 13.308632850646973, "vf_explained_var": 0.9284096956253052, "cur_lr": 0.0005000000237487257, "entropy": 1.1088980436325073, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.012036735191941261}, "num_steps_trained": 3746226, "update_time_ms": 9.723, "num_steps_sampled": 3746226, "sample_time_ms": 19145.279, "load_time_ms": 20.523, "grad_time_ms": 10655.654}, "hostname": "flow-main", "episode_reward_max": -103.89460443082794, "timesteps_this_iter": 38603, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.69247079521986, "cost1_min": 85.4281659255689, "system_level_velocity_mean": 15.137536801127931, "cost2_mean": -93.82603304234313, "cost2_max": -63.468707897027976, "outflow_rate_max": 1442.4319375921034, "cost1_mean": 180.98546794350807, "system_level_velocity_min": 12.167598199557721, "system_level_velocity_max": 18.922843595473047, "outflow_rate_min": 820.8669760840831, "cost2_min": -116.68418817725579, "outflow_rate_mean": 1207.5634487203104}, "episode_len_mean": 321.9, "node_ip": "10.138.0.2", "timesteps_since_restore": 3746226, "time_total_s": 2908.8855876922607, "timestamp": 1558612799, "time_since_restore": 2908.8855876922607, "training_iteration": 91, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845144e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514240>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4233, "timesteps_total": 3746226, "episode_reward_mean": -437.4093509127337, "episodes_this_iter": 48, "date": "2019-05-23_11-59-59", "time_this_iter_s": 29.327579259872437, "num_metric_batches_dropped": 0, "episode_reward_min": -566.7102489976012}
{"iterations_since_restore": 92, "info": {"default": {"kl": 0.018673080950975418, "total_loss": 15.339908599853516, "vf_loss": 15.347969055175781, "vf_explained_var": 0.9178419709205627, "cur_lr": 0.0005000000237487257, "entropy": 1.1499768495559692, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.012787104584276676}, "num_steps_trained": 3785076, "update_time_ms": 9.822, "num_steps_sampled": 3785076, "sample_time_ms": 19123.007, "load_time_ms": 21.633, "grad_time_ms": 10667.042}, "hostname": "flow-main", "episode_reward_max": -103.89460443082794, "timesteps_this_iter": 38850, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.69247079521986, "cost1_min": 85.4281659255689, "system_level_velocity_mean": 15.194103299478009, "cost2_mean": -94.39159801027175, "cost2_max": -63.468707897027976, "outflow_rate_max": 1447.8708208419403, "cost1_mean": 180.6292068339339, "system_level_velocity_min": 12.11816392605006, "system_level_velocity_max": 18.922843595473047, "outflow_rate_min": 820.8669760840831, "cost2_min": -116.68418817725579, "outflow_rate_mean": 1202.9011462856945}, "episode_len_mean": 320.8, "node_ip": "10.138.0.2", "timesteps_since_restore": 3785076, "time_total_s": 2938.85142827034, "timestamp": 1558612829, "time_since_restore": 2938.85142827034, "training_iteration": 92, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845147b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845145c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514b70>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4277, "timesteps_total": 3785076, "episode_reward_mean": -437.5709785370062, "episodes_this_iter": 44, "date": "2019-05-23_12-00-29", "time_this_iter_s": 29.965840578079224, "num_metric_batches_dropped": 0, "episode_reward_min": -604.9043826575282}
{"iterations_since_restore": 93, "info": {"default": {"kl": 0.01759362407028675, "total_loss": 13.312479972839355, "vf_loss": 13.319489479064941, "vf_explained_var": 0.9247496724128723, "cur_lr": 0.0005000000237487257, "entropy": 1.1403508186340332, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.01146179810166359}, "num_steps_trained": 3823456, "update_time_ms": 9.844, "num_steps_sampled": 3823456, "sample_time_ms": 18979.581, "load_time_ms": 20.742, "grad_time_ms": 10641.047}, "hostname": "flow-main", "episode_reward_max": -242.7357573104818, "timesteps_this_iter": 38380, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.6130696518665, "cost1_min": 129.1263497068265, "system_level_velocity_mean": 15.215942924258515, "cost2_mean": -94.23655420841256, "cost2_max": -71.2000334965892, "outflow_rate_max": 1448.4073418878118, "cost1_mean": 182.24461010994065, "system_level_velocity_min": 12.11816392605006, "system_level_velocity_max": 18.55737389000935, "outflow_rate_min": 988.7822015503873, "cost2_min": -116.37260731636226, "outflow_rate_mean": 1206.3159684478194}, "episode_len_mean": 322.8, "node_ip": "10.138.0.2", "timesteps_since_restore": 3823456, "time_total_s": 2967.8444454669952, "timestamp": 1558612858, "time_since_restore": 2967.8444454669952, "training_iteration": 93, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514a20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4326, "timesteps_total": 3823456, "episode_reward_mean": -437.30537335854655, "episodes_this_iter": 49, "date": "2019-05-23_12-00-58", "time_this_iter_s": 28.993017196655273, "num_metric_batches_dropped": 0, "episode_reward_min": -604.9043826575282}
{"iterations_since_restore": 94, "info": {"default": {"kl": 0.01673402264714241, "total_loss": 14.589301109313965, "vf_loss": 14.598248481750488, "vf_explained_var": 0.9131327867507935, "cur_lr": 0.0005000000237487257, "entropy": 1.1347696781158447, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.013184907846152782}, "num_steps_trained": 3861342, "update_time_ms": 9.691, "num_steps_sampled": 3861342, "sample_time_ms": 18774.5, "load_time_ms": 21.899, "grad_time_ms": 10630.711}, "hostname": "flow-main", "episode_reward_max": -294.7905299659039, "timesteps_this_iter": 37886, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 219.392454588906, "cost1_min": 145.3896062213083, "system_level_velocity_mean": 15.302611156097882, "cost2_mean": -93.75180403812304, "cost2_max": -66.04564244373235, "outflow_rate_max": 1448.4073418878118, "cost1_mean": 184.5967822135781, "system_level_velocity_min": 12.168262459015297, "system_level_velocity_max": 18.159705756460124, "outflow_rate_min": 969.5732322274879, "cost2_min": -116.37260731636226, "outflow_rate_mean": 1219.189512630864}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3861342, "time_total_s": 2996.87086892128, "timestamp": 1558612887, "time_since_restore": 2996.87086892128, "training_iteration": 94, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f23c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845014a8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4374, "timesteps_total": 3861342, "episode_reward_mean": -430.74187494479025, "episodes_this_iter": 48, "date": "2019-05-23_12-01-27", "time_this_iter_s": 29.026423454284668, "num_metric_batches_dropped": 0, "episode_reward_min": -529.8258119819407}
{"iterations_since_restore": 95, "info": {"default": {"kl": 0.018088743090629578, "total_loss": 11.56926155090332, "vf_loss": 11.577279090881348, "vf_explained_var": 0.930866003036499, "cur_lr": 0.0005000000237487257, "entropy": 1.1650193929672241, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.012596107088029385}, "num_steps_trained": 3898822, "update_time_ms": 9.665, "num_steps_sampled": 3898822, "sample_time_ms": 18696.769, "load_time_ms": 20.962, "grad_time_ms": 10645.078}, "hostname": "flow-main", "episode_reward_max": -292.8584265017904, "timesteps_this_iter": 37480, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 219.87847233472922, "cost1_min": 144.81766699094254, "system_level_velocity_mean": 15.295797279323098, "cost2_mean": -91.86405562260208, "cost2_max": -65.69322308184121, "outflow_rate_max": 1443.8303048340551, "cost1_mean": 184.31709350187688, "system_level_velocity_min": 12.168262459015297, "system_level_velocity_max": 18.33294018471984, "outflow_rate_min": 969.5732322274879, "cost2_min": -114.04724105260456, "outflow_rate_mean": 1211.7238207907012}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3898822, "time_total_s": 3025.6344764232635, "timestamp": 1558612916, "time_since_restore": 3025.6344764232635, "training_iteration": 95, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845142b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514a90>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4416, "timesteps_total": 3898822, "episode_reward_mean": -423.63882458895205, "episodes_this_iter": 42, "date": "2019-05-23_12-01-56", "time_this_iter_s": 28.763607501983643, "num_metric_batches_dropped": 0, "episode_reward_min": -527.8535707046291}
{"iterations_since_restore": 96, "info": {"default": {"kl": 0.015998313203454018, "total_loss": 12.148394584655762, "vf_loss": 12.15739917755127, "vf_explained_var": 0.9229234457015991, "cur_lr": 0.0005000000237487257, "entropy": 1.156375527381897, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.013056107796728611}, "num_steps_trained": 3936407, "update_time_ms": 9.771, "num_steps_sampled": 3936407, "sample_time_ms": 18703.045, "load_time_ms": 21.07, "grad_time_ms": 10584.903}, "hostname": "flow-main", "episode_reward_max": -292.8584265017904, "timesteps_this_iter": 37585, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 219.87847233472922, "cost1_min": 144.81766699094254, "system_level_velocity_mean": 15.144930731182122, "cost2_mean": -88.2298551315713, "cost2_max": -65.06085270306338, "outflow_rate_max": 1438.4727740289666, "cost1_mean": 182.5169390158567, "system_level_velocity_min": 12.257434576544048, "system_level_velocity_max": 18.33294018471984, "outflow_rate_min": 975.5941803743615, "cost2_min": -113.35321125777463, "outflow_rate_mean": 1197.896078867852}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3936407, "time_total_s": 3054.4505467414856, "timestamp": 1558612945, "time_since_restore": 3054.4505467414856, "training_iteration": 96, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514908>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4464, "timesteps_total": 3936407, "episode_reward_mean": -422.34083572801393, "episodes_this_iter": 48, "date": "2019-05-23_12-02-25", "time_this_iter_s": 28.816070318222046, "num_metric_batches_dropped": 0, "episode_reward_min": -550.9373082779445}
{"iterations_since_restore": 97, "info": {"default": {"kl": 0.017994511872529984, "total_loss": 11.983114242553711, "vf_loss": 11.99144172668457, "vf_explained_var": 0.9230394959449768, "cur_lr": 0.0005000000237487257, "entropy": 1.1366527080535889, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.012882636860013008}, "num_steps_trained": 3973547, "update_time_ms": 9.677, "num_steps_sampled": 3973547, "sample_time_ms": 18697.585, "load_time_ms": 20.111, "grad_time_ms": 10521.231}, "hostname": "flow-main", "episode_reward_max": -301.6271581761657, "timesteps_this_iter": 37140, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.0829806276583, "cost1_min": 150.8726891857441, "system_level_velocity_mean": 15.199539102421763, "cost2_mean": -87.72330266622943, "cost2_max": -65.06085270306338, "outflow_rate_max": 1439.195602194225, "cost1_mean": 183.00528508419532, "system_level_velocity_min": 12.324535353513218, "system_level_velocity_max": 18.269909236877623, "outflow_rate_min": 975.5941803743615, "cost2_min": -110.98704445562407, "outflow_rate_mean": 1203.7895683901122}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 3973547, "time_total_s": 3083.117524623871, "timestamp": 1558612973, "time_since_restore": 3083.117524623871, "training_iteration": 97, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501668>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4511, "timesteps_total": 3973547, "episode_reward_mean": -416.3059805140734, "episodes_this_iter": 47, "date": "2019-05-23_12-02-53", "time_this_iter_s": 28.666977882385254, "num_metric_batches_dropped": 0, "episode_reward_min": -550.9373082779445}
{"iterations_since_restore": 98, "info": {"default": {"kl": 0.018345637246966362, "total_loss": 10.418206214904785, "vf_loss": 10.426541328430176, "vf_explained_var": 0.9375749826431274, "cur_lr": 0.0005000000237487257, "entropy": 1.1664376258850098, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.012978811748325825}, "num_steps_trained": 4010826, "update_time_ms": 9.618, "num_steps_sampled": 4010826, "sample_time_ms": 18759.374, "load_time_ms": 20.936, "grad_time_ms": 10438.812}, "hostname": "flow-main", "episode_reward_max": -301.6271581761657, "timesteps_this_iter": 37279, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.75295429481974, "cost1_min": 150.82906878932457, "system_level_velocity_mean": 15.222863170642361, "cost2_mean": -87.90178909937543, "cost2_max": -66.651218174734, "outflow_rate_max": 1445.0892154291091, "cost1_mean": 183.31011098377058, "system_level_velocity_min": 12.324535353513218, "system_level_velocity_max": 18.244772022034475, "outflow_rate_min": 984.2667906976745, "cost2_min": -112.77147721751741, "outflow_rate_mean": 1207.4670610806347}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 4010826, "time_total_s": 3112.287544488907, "timestamp": 1558613003, "time_since_restore": 3112.287544488907, "training_iteration": 98, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845148d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845146a0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4555, "timesteps_total": 4010826, "episode_reward_mean": -411.03748712714986, "episodes_this_iter": 44, "date": "2019-05-23_12-03-23", "time_this_iter_s": 29.17001986503601, "num_metric_batches_dropped": 0, "episode_reward_min": -533.2458743963458}
{"iterations_since_restore": 99, "info": {"default": {"kl": 0.018284954130649567, "total_loss": 11.150675773620605, "vf_loss": 11.159989356994629, "vf_explained_var": 0.9348055124282837, "cur_lr": 0.0005000000237487257, "entropy": 1.1725870370864868, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.013941788114607334}, "num_steps_trained": 4047949, "update_time_ms": 9.315, "num_steps_sampled": 4047949, "sample_time_ms": 18820.322, "load_time_ms": 20.89, "grad_time_ms": 10292.418}, "hostname": "flow-main", "episode_reward_max": -302.4247607072667, "timesteps_this_iter": 37123, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.20264022304218, "cost1_min": 135.39983408179444, "system_level_velocity_mean": 15.11978503362754, "cost2_mean": -87.59551692718617, "cost2_max": -66.651218174734, "outflow_rate_max": 1445.0892154291091, "cost1_mean": 182.0463147207084, "system_level_velocity_min": 11.477798317663371, "system_level_velocity_max": 18.12655093403984, "outflow_rate_min": 955.8800187969923, "cost2_min": -112.77147721751741, "outflow_rate_mean": 1197.8973145680554}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4047949, "time_total_s": 3141.863106250763, "timestamp": 1558613032, "time_since_restore": 3141.863106250763, "training_iteration": 99, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845666d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f438>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4602, "timesteps_total": 4047949, "episode_reward_mean": -413.917996407282, "episodes_this_iter": 47, "date": "2019-05-23_12-03-52", "time_this_iter_s": 29.57556176185608, "num_metric_batches_dropped": 0, "episode_reward_min": -512.8770410299844}
{"iterations_since_restore": 100, "info": {"default": {"kl": 0.016079451888799667, "total_loss": 12.376716613769531, "vf_loss": 12.384004592895508, "vf_explained_var": 0.9263326525688171, "cur_lr": 0.0005000000237487257, "entropy": 1.1122459173202515, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.01135739590972662}, "num_steps_trained": 4085737, "update_time_ms": 9.61, "num_steps_sampled": 4085737, "sample_time_ms": 18796.877, "load_time_ms": 19.963, "grad_time_ms": 10329.831}, "hostname": "flow-main", "episode_reward_max": -286.7607645697876, "timesteps_this_iter": 37788, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.45717650735017, "cost1_min": 135.39983408179444, "system_level_velocity_mean": 15.212511236532583, "cost2_mean": -89.08600687533986, "cost2_max": -67.2365688726328, "outflow_rate_max": 1438.5016020984665, "cost1_mean": 182.84655326518416, "system_level_velocity_min": 11.477798317663371, "system_level_velocity_max": 18.171635788849553, "outflow_rate_min": 955.8800187969923, "cost2_min": -112.77147721751741, "outflow_rate_mean": 1206.1355182989564}, "episode_len_mean": 324.52, "node_ip": "10.138.0.2", "timesteps_since_restore": 4085737, "time_total_s": 3172.003494977951, "timestamp": 1558613062, "time_since_restore": 3172.003494977951, "training_iteration": 100, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe0b8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4648, "timesteps_total": 4085737, "episode_reward_mean": -417.54276090550854, "episodes_this_iter": 46, "date": "2019-05-23_12-04-22", "time_this_iter_s": 30.14038872718811, "num_metric_batches_dropped": 0, "episode_reward_min": -547.098829140199}
{"iterations_since_restore": 101, "info": {"default": {"kl": 0.016663292422890663, "total_loss": 14.549422264099121, "vf_loss": 14.556593894958496, "vf_explained_var": 0.920257568359375, "cur_lr": 0.0005000000237487257, "entropy": 1.1277341842651367, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.01138969138264656}, "num_steps_trained": 4123423, "update_time_ms": 9.533, "num_steps_sampled": 4123423, "sample_time_ms": 18786.738, "load_time_ms": 19.686, "grad_time_ms": 10323.546}, "hostname": "flow-main", "episode_reward_max": -21.92598555636999, "timesteps_this_iter": 37686, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.84436613842308, "cost1_min": 17.912156465802504, "system_level_velocity_mean": 15.300662871124674, "cost2_mean": -90.15604090194309, "cost2_max": -18.228886898417827, "outflow_rate_max": 1440.7005566590533, "cost1_mean": 181.99271982989234, "system_level_velocity_min": 11.874159995002179, "system_level_velocity_max": 18.191180296751035, "outflow_rate_min": 468.51797875626045, "cost2_min": -113.8508252855249, "outflow_rate_mean": 1209.0238902189747}, "episode_len_mean": 321.26, "node_ip": "10.138.0.2", "timesteps_since_restore": 4123423, "time_total_s": 3201.1612787246704, "timestamp": 1558613092, "time_since_restore": 3201.1612787246704, "training_iteration": 101, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f4a8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4695, "timesteps_total": 4123423, "episode_reward_mean": -415.41322012094525, "episodes_this_iter": 47, "date": "2019-05-23_12-04-52", "time_this_iter_s": 29.15778374671936, "num_metric_batches_dropped": 0, "episode_reward_min": -547.098829140199}
{"iterations_since_restore": 102, "info": {"default": {"kl": 0.016765184700489044, "total_loss": 13.169418334960938, "vf_loss": 13.178351402282715, "vf_explained_var": 0.932528555393219, "cur_lr": 0.0005000000237487257, "entropy": 1.154044508934021, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.013177113607525826}, "num_steps_trained": 4161188, "update_time_ms": 9.505, "num_steps_sampled": 4161188, "sample_time_ms": 18753.374, "load_time_ms": 19.694, "grad_time_ms": 10336.841}, "hostname": "flow-main", "episode_reward_max": -21.92598555636999, "timesteps_this_iter": 37765, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.84436613842308, "cost1_min": 17.912156465802504, "system_level_velocity_mean": 15.282696313004662, "cost2_mean": -90.53001755292632, "cost2_max": -18.228886898417827, "outflow_rate_max": 1440.7005566590533, "cost1_mean": 181.80098953698854, "system_level_velocity_min": 11.874159995002179, "system_level_velocity_max": 18.191180296751035, "outflow_rate_min": 468.51797875626045, "cost2_min": -113.8508252855249, "outflow_rate_mean": 1207.7254102111356}, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 4161188, "time_total_s": 3230.9188952445984, "timestamp": 1558613121, "time_since_restore": 3230.9188952445984, "training_iteration": 102, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845084e0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4742, "timesteps_total": 4161188, "episode_reward_mean": -415.16054705299854, "episodes_this_iter": 47, "date": "2019-05-23_12-05-21", "time_this_iter_s": 29.75761651992798, "num_metric_batches_dropped": 0, "episode_reward_min": -548.2486600440559}
{"iterations_since_restore": 103, "info": {"default": {"kl": 0.015941297635436058, "total_loss": 13.423524856567383, "vf_loss": 13.430631637573242, "vf_explained_var": 0.932113528251648, "cur_lr": 0.0005000000237487257, "entropy": 1.175551176071167, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.011142858304083347}, "num_steps_trained": 4199143, "update_time_ms": 9.459, "num_steps_sampled": 4199143, "sample_time_ms": 18712.143, "load_time_ms": 20.512, "grad_time_ms": 10386.408}, "hostname": "flow-main", "episode_reward_max": -95.1040945248576, "timesteps_this_iter": 37955, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.36531382850887, "cost1_min": 79.88113053644813, "system_level_velocity_mean": 15.115904984882652, "cost2_mean": -90.23806369668722, "cost2_max": -60.63986433134672, "outflow_rate_max": 1435.9391082603677, "cost1_mean": 180.42261815680195, "system_level_velocity_min": 11.874159995002179, "system_level_velocity_max": 18.6430766218088, "outflow_rate_min": 780.2578029174563, "cost2_min": -113.2503719193327, "outflow_rate_mean": 1195.602485416036}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4199143, "time_total_s": 3260.017209291458, "timestamp": 1558613150, "time_since_restore": 3260.017209291458, "training_iteration": 103, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845080f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508cc0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4788, "timesteps_total": 4199143, "episode_reward_mean": -430.74442711699464, "episodes_this_iter": 46, "date": "2019-05-23_12-05-50", "time_this_iter_s": 29.09831404685974, "num_metric_batches_dropped": 0, "episode_reward_min": -548.2486600440559}
{"iterations_since_restore": 104, "info": {"default": {"kl": 0.016688713803887367, "total_loss": 11.693304061889648, "vf_loss": 11.69981861114502, "vf_explained_var": 0.9375765323638916, "cur_lr": 0.0005000000237487257, "entropy": 1.1475013494491577, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.010738630779087543}, "num_steps_trained": 4236748, "update_time_ms": 9.53, "num_steps_sampled": 4236748, "sample_time_ms": 18712.644, "load_time_ms": 19.982, "grad_time_ms": 10373.419}, "hostname": "flow-main", "episode_reward_max": -95.1040945248576, "timesteps_this_iter": 37605, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 216.9267268601011, "cost1_min": 79.88113053644813, "system_level_velocity_mean": 15.17381070979962, "cost2_mean": -91.63343758448849, "cost2_max": -60.63986433134672, "outflow_rate_max": 1442.609508376526, "cost1_mean": 181.34389277655228, "system_level_velocity_min": 12.115056289345707, "system_level_velocity_max": 18.6430766218088, "outflow_rate_min": 780.2578029174563, "cost2_min": -114.38073850912266, "outflow_rate_mean": 1201.003888876045}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4236748, "time_total_s": 3288.9038331508636, "timestamp": 1558613179, "time_since_restore": 3288.9038331508636, "training_iteration": 104, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844facc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa5c0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4836, "timesteps_total": 4236748, "episode_reward_mean": -430.3198185982531, "episodes_this_iter": 48, "date": "2019-05-23_12-06-19", "time_this_iter_s": 28.886623859405518, "num_metric_batches_dropped": 0, "episode_reward_min": -520.974961526423}
{"iterations_since_restore": 105, "info": {"default": {"kl": 0.017713638022542, "total_loss": 12.250092506408691, "vf_loss": 12.25719928741455, "vf_explained_var": 0.9321276545524597, "cur_lr": 0.0005000000237487257, "entropy": 1.1493698358535767, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.011589707806706429}, "num_steps_trained": 4274546, "update_time_ms": 9.735, "num_steps_sampled": 4274546, "sample_time_ms": 18762.541, "load_time_ms": 20.748, "grad_time_ms": 10342.553}, "hostname": "flow-main", "episode_reward_max": -105.64641559048748, "timesteps_this_iter": 37798, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.70444875899742, "cost1_min": 84.84522778305819, "system_level_velocity_mean": 15.33093051532416, "cost2_mean": -91.5287288861619, "cost2_max": -60.81037392063065, "outflow_rate_max": 1442.609508376526, "cost1_mean": 183.15074791848957, "system_level_velocity_min": 11.782223691842796, "system_level_velocity_max": 18.78929981699722, "outflow_rate_min": 816.0419604742984, "cost2_min": -114.38073850912266, "outflow_rate_mean": 1212.6852513737554}, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4274546, "time_total_s": 3317.8671474456787, "timestamp": 1558613208, "time_since_restore": 3317.8671474456787, "training_iteration": 105, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fad68>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4880, "timesteps_total": 4274546, "episode_reward_mean": -420.5314502194016, "episodes_this_iter": 44, "date": "2019-05-23_12-06-48", "time_this_iter_s": 28.963314294815063, "num_metric_batches_dropped": 0, "episode_reward_min": -597.0541029820126}
{"iterations_since_restore": 106, "info": {"default": {"kl": 0.018283573910593987, "total_loss": 11.77468490600586, "vf_loss": 11.782830238342285, "vf_explained_var": 0.9337708353996277, "cur_lr": 0.0005000000237487257, "entropy": 1.1200549602508545, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.01277309563010931}, "num_steps_trained": 4312184, "update_time_ms": 9.753, "num_steps_sampled": 4312184, "sample_time_ms": 18814.312, "load_time_ms": 20.437, "grad_time_ms": 10313.118}, "hostname": "flow-main", "episode_reward_max": -95.42559508629056, "timesteps_this_iter": 37638, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.70444875899742, "cost1_min": 80.35122456368754, "system_level_velocity_mean": 15.475466342224843, "cost2_mean": -91.01444274785672, "cost2_max": -60.67843234784527, "outflow_rate_max": 1441.9131557989049, "cost1_mean": 183.35149219004754, "system_level_velocity_min": 11.782223691842796, "system_level_velocity_max": 18.78929981699722, "outflow_rate_min": 779.3929292888542, "cost2_min": -114.14999099851148, "outflow_rate_mean": 1214.2406340439825}, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4312184, "time_total_s": 3346.904316186905, "timestamp": 1558613237, "time_since_restore": 3346.904316186905, "training_iteration": 106, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514c18>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4927, "timesteps_total": 4312184, "episode_reward_mean": -410.2431819923898, "episodes_this_iter": 47, "date": "2019-05-23_12-07-17", "time_this_iter_s": 29.037168741226196, "num_metric_batches_dropped": 0, "episode_reward_min": -597.0541029820126}
{"iterations_since_restore": 107, "info": {"default": {"kl": 0.01588888093829155, "total_loss": 10.596949577331543, "vf_loss": 10.60498046875, "vf_explained_var": 0.9370706677436829, "cur_lr": 0.0005000000237487257, "entropy": 1.162087321281433, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.012052333913743496}, "num_steps_trained": 4349224, "update_time_ms": 9.84, "num_steps_sampled": 4349224, "sample_time_ms": 18840.634, "load_time_ms": 20.264, "grad_time_ms": 10276.28}, "hostname": "flow-main", "episode_reward_max": -95.42559508629056, "timesteps_this_iter": 37040, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 217.0702274803688, "cost1_min": 80.35122456368754, "system_level_velocity_mean": 15.199535065067796, "cost2_mean": -89.12150468944427, "cost2_max": -60.67843234784527, "outflow_rate_max": 1441.9131557989049, "cost1_mean": 181.6928706502483, "system_level_velocity_min": 12.229809730562126, "system_level_velocity_max": 18.774784029740186, "outflow_rate_min": 779.3929292888542, "cost2_min": -114.14999099851148, "outflow_rate_mean": 1201.4446417060215}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4349224, "time_total_s": 3375.4493021965027, "timestamp": 1558613266, "time_since_restore": 3375.4493021965027, "training_iteration": 107, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450ffd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514198>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 4977, "timesteps_total": 4349224, "episode_reward_mean": -417.4737776350075, "episodes_this_iter": 50, "date": "2019-05-23_12-07-46", "time_this_iter_s": 28.54498600959778, "num_metric_batches_dropped": 0, "episode_reward_min": -510.3054029013628}
{"iterations_since_restore": 108, "info": {"default": {"kl": 0.01812467724084854, "total_loss": 14.205133438110352, "vf_loss": 14.210927963256836, "vf_explained_var": 0.9197366833686829, "cur_lr": 0.0005000000237487257, "entropy": 1.141789197921753, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.010381474159657955}, "num_steps_trained": 4386790, "update_time_ms": 9.653, "num_steps_sampled": 4386790, "sample_time_ms": 18855.084, "load_time_ms": 20.197, "grad_time_ms": 10277.784}, "hostname": "flow-main", "episode_reward_max": -22.60729780205053, "timesteps_this_iter": 37566, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.33932508588072, "cost1_min": 18.104933871032433, "system_level_velocity_mean": 15.240519775524863, "cost2_mean": -87.58141881044561, "cost2_max": -20.380383542146856, "outflow_rate_max": 1441.9131557989049, "cost1_mean": 178.40097916559367, "system_level_velocity_min": 12.229809730562126, "system_level_velocity_max": 18.33217989898714, "outflow_rate_min": 447.40921683303424, "cost2_min": -114.89798825585372, "outflow_rate_mean": 1184.349948900003}, "episode_len_mean": 317.04, "node_ip": "10.138.0.2", "timesteps_since_restore": 4386790, "time_total_s": 3404.766939163208, "timestamp": 1558613295, "time_since_restore": 3404.766939163208, "training_iteration": 108, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fab00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f198>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5021, "timesteps_total": 4386790, "episode_reward_mean": -407.93745437451685, "episodes_this_iter": 44, "date": "2019-05-23_12-08-15", "time_this_iter_s": 29.317636966705322, "num_metric_batches_dropped": 0, "episode_reward_min": -508.89365719425166}
{"iterations_since_restore": 109, "info": {"default": {"kl": 0.016437295824289322, "total_loss": 11.354992866516113, "vf_loss": 11.363147735595703, "vf_explained_var": 0.9359806180000305, "cur_lr": 0.0005000000237487257, "entropy": 1.1940829753875732, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.012315663509070873}, "num_steps_trained": 4424776, "update_time_ms": 9.612, "num_steps_sampled": 4424776, "sample_time_ms": 18765.517, "load_time_ms": 19.985, "grad_time_ms": 10410.376}, "hostname": "flow-main", "episode_reward_max": -22.60729780205053, "timesteps_this_iter": 37986, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.33932508588072, "cost1_min": 18.104933871032433, "system_level_velocity_mean": 15.401892064140984, "cost2_mean": -89.22239803353115, "cost2_max": -20.380383542146856, "outflow_rate_max": 1438.862858355044, "cost1_mean": 180.3806572232628, "system_level_velocity_min": 12.586485519891742, "system_level_velocity_max": 18.33217989898714, "outflow_rate_min": 447.40921683303424, "cost2_min": -114.89798825585372, "outflow_rate_mean": 1195.7176858639843}, "episode_len_mean": 317.04, "node_ip": "10.138.0.2", "timesteps_since_restore": 4424776, "time_total_s": 3434.7562794685364, "timestamp": 1558613325, "time_since_restore": 3434.7562794685364, "training_iteration": 109, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456af60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501be0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5068, "timesteps_total": 4424776, "episode_reward_mean": -406.75425027046435, "episodes_this_iter": 47, "date": "2019-05-23_12-08-45", "time_this_iter_s": 29.98934030532837, "num_metric_batches_dropped": 0, "episode_reward_min": -528.9476119438358}
{"iterations_since_restore": 110, "info": {"default": {"kl": 0.016035646200180054, "total_loss": 14.139955520629883, "vf_loss": 14.147403717041016, "vf_explained_var": 0.9177886247634888, "cur_lr": 0.0005000000237487257, "entropy": 1.1836973428726196, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.011507083661854267}, "num_steps_trained": 4461687, "update_time_ms": 9.046, "num_steps_sampled": 4461687, "sample_time_ms": 18755.277, "load_time_ms": 21.299, "grad_time_ms": 10385.207}, "hostname": "flow-main", "episode_reward_max": -32.084944749893566, "timesteps_this_iter": 36911, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.33771658115188, "cost1_min": 24.910857019823247, "system_level_velocity_mean": 15.377341065907128, "cost2_mean": -90.5581885698503, "cost2_max": -26.41431636620271, "outflow_rate_max": 1449.0657032250801, "cost1_mean": 183.33885701034848, "system_level_velocity_min": 12.243242164159957, "system_level_velocity_max": 18.47811561337998, "outflow_rate_min": 479.2583523114049, "cost2_min": -113.69089096261288, "outflow_rate_mean": 1209.1064249870064}, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "timesteps_since_restore": 4461687, "time_total_s": 3464.554578065872, "timestamp": 1558613355, "time_since_restore": 3464.554578065872, "training_iteration": 110, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fed30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fee80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe390>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5119, "timesteps_total": 4461687, "episode_reward_mean": -411.98561819196635, "episodes_this_iter": 51, "date": "2019-05-23_12-09-15", "time_this_iter_s": 29.798298597335815, "num_metric_batches_dropped": 0, "episode_reward_min": -528.9476119438358}
{"iterations_since_restore": 111, "info": {"default": {"kl": 0.01763731800019741, "total_loss": 11.858256340026855, "vf_loss": 11.86523151397705, "vf_explained_var": 0.9278749823570251, "cur_lr": 0.0005000000237487257, "entropy": 1.1758006811141968, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.011438685469329357}, "num_steps_trained": 4499224, "update_time_ms": 8.874, "num_steps_sampled": 4499224, "sample_time_ms": 18714.293, "load_time_ms": 21.457, "grad_time_ms": 10494.884}, "hostname": "flow-main", "episode_reward_max": -32.084944749893566, "timesteps_this_iter": 37537, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.33771658115188, "cost1_min": 24.910857019823247, "system_level_velocity_mean": 15.288868681014062, "cost2_mean": -89.80794133820439, "cost2_max": -26.41431636620271, "outflow_rate_max": 1449.0657032250801, "cost1_mean": 182.19583655653284, "system_level_velocity_min": 11.792289646022855, "system_level_velocity_max": 18.47811561337998, "outflow_rate_min": 479.2583523114049, "cost2_min": -113.47926739770678, "outflow_rate_mean": 1203.8364282923492}, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "timesteps_since_restore": 4499224, "time_total_s": 3494.4054532051086, "timestamp": 1558613385, "time_since_restore": 3494.4054532051086, "training_iteration": 111, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fc50>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5162, "timesteps_total": 4499224, "episode_reward_mean": -410.89052139314583, "episodes_this_iter": 43, "date": "2019-05-23_12-09-45", "time_this_iter_s": 29.85087513923645, "num_metric_batches_dropped": 0, "episode_reward_min": -502.35527290129966}
{"iterations_since_restore": 112, "info": {"default": {"kl": 0.01818067952990532, "total_loss": 12.86695671081543, "vf_loss": 12.876365661621094, "vf_explained_var": 0.9231197237968445, "cur_lr": 0.0005000000237487257, "entropy": 1.1832756996154785, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.014009957201778889}, "num_steps_trained": 4536447, "update_time_ms": 8.989, "num_steps_sampled": 4536447, "sample_time_ms": 18686.752, "load_time_ms": 21.594, "grad_time_ms": 10401.893}, "hostname": "flow-main", "episode_reward_max": -32.084944749893566, "timesteps_this_iter": 37223, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.1071737454801, "cost1_min": 24.910857019823247, "system_level_velocity_mean": 15.36545208120005, "cost2_mean": -90.47558559261871, "cost2_max": -26.41431636620271, "outflow_rate_max": 1448.4783573242748, "cost1_mean": 182.87207332746152, "system_level_velocity_min": 11.792289646022855, "system_level_velocity_max": 18.471412261214926, "outflow_rate_min": 479.2583523114049, "cost2_min": -116.88155067470409, "outflow_rate_mean": 1210.4382534387594}, "episode_len_mean": 321.85, "node_ip": "10.138.0.2", "timesteps_since_restore": 4536447, "time_total_s": 3522.9544665813446, "timestamp": 1558613414, "time_since_restore": 3522.9544665813446, "training_iteration": 112, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508630>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5208, "timesteps_total": 4536447, "episode_reward_mean": -407.4023799960815, "episodes_this_iter": 46, "date": "2019-05-23_12-10-14", "time_this_iter_s": 28.549013376235962, "num_metric_batches_dropped": 0, "episode_reward_min": -506.1915000531989}
{"iterations_since_restore": 113, "info": {"default": {"kl": 0.018786802887916565, "total_loss": 9.629098892211914, "vf_loss": 9.637187004089355, "vf_explained_var": 0.941707193851471, "cur_lr": 0.0005000000237487257, "entropy": 1.217752456665039, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.01284402422606945}, "num_steps_trained": 4573301, "update_time_ms": 9.102, "num_steps_sampled": 4573301, "sample_time_ms": 18783.455, "load_time_ms": 21.494, "grad_time_ms": 10259.143}, "hostname": "flow-main", "episode_reward_max": -189.42477397433402, "timesteps_this_iter": 36854, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.48748665049013, "cost1_min": 136.64285151301786, "system_level_velocity_mean": 15.271884171197177, "cost2_mean": -89.49723373902987, "cost2_max": -64.23098939780688, "outflow_rate_max": 1450.1680851167696, "cost1_mean": 182.7317463529532, "system_level_velocity_min": 11.596440911337282, "system_level_velocity_max": 18.537623666470648, "outflow_rate_min": 964.8446293604653, "cost2_min": -116.88155067470409, "outflow_rate_mean": 1201.8856011091277}, "episode_len_mean": 323.42, "node_ip": "10.138.0.2", "timesteps_since_restore": 4573301, "time_total_s": 3551.57346701622, "timestamp": 1558613442, "time_since_restore": 3551.57346701622, "training_iteration": 113, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe630>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5256, "timesteps_total": 4573301, "episode_reward_mean": -411.23574980957767, "episodes_this_iter": 48, "date": "2019-05-23_12-10-42", "time_this_iter_s": 28.61900043487549, "num_metric_batches_dropped": 0, "episode_reward_min": -555.8340362098534}
{"iterations_since_restore": 114, "info": {"default": {"kl": 0.018117517232894897, "total_loss": 10.845563888549805, "vf_loss": 10.853309631347656, "vf_explained_var": 0.9293883442878723, "cur_lr": 0.0005000000237487257, "entropy": 1.1995413303375244, "cur_kl_coeff": 0.2531249523162842, "policy_loss": -0.012331490404903889}, "num_steps_trained": 4609862, "update_time_ms": 9.06, "num_steps_sampled": 4609862, "sample_time_ms": 18833.112, "load_time_ms": 21.689, "grad_time_ms": 10188.302}, "hostname": "flow-main", "episode_reward_max": -189.42477397433402, "timesteps_this_iter": 36561, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 222.3824813177993, "cost1_min": 136.64285151301786, "system_level_velocity_mean": 15.19507606443578, "cost2_mean": -86.78976049268728, "cost2_max": -64.23098939780688, "outflow_rate_max": 1450.1680851167696, "cost1_mean": 182.27468383244886, "system_level_velocity_min": 11.596440911337282, "system_level_velocity_max": 18.569666275049364, "outflow_rate_min": 964.8446293604653, "cost2_min": -119.4165588156546, "outflow_rate_mean": 1194.1040434693796}, "episode_len_mean": 323.7, "node_ip": "10.138.0.2", "timesteps_since_restore": 4609862, "time_total_s": 3580.2382521629333, "timestamp": 1558613471, "time_since_restore": 3580.2382521629333, "training_iteration": 114, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844facc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566470>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5302, "timesteps_total": 4609862, "episode_reward_mean": -404.94816435731644, "episodes_this_iter": 46, "date": "2019-05-23_12-11-11", "time_this_iter_s": 28.664785146713257, "num_metric_batches_dropped": 0, "episode_reward_min": -555.8340362098534}
{"iterations_since_restore": 115, "info": {"default": {"kl": 0.01679486222565174, "total_loss": 11.531475067138672, "vf_loss": 11.540082931518555, "vf_explained_var": 0.9289294481277466, "cur_lr": 0.0005000000237487257, "entropy": 1.2172541618347168, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.012858361937105656}, "num_steps_trained": 4646817, "update_time_ms": 8.832, "num_steps_sampled": 4646817, "sample_time_ms": 18804.104, "load_time_ms": 21.928, "grad_time_ms": 10211.498}, "hostname": "flow-main", "episode_reward_max": -22.57128005079687, "timesteps_this_iter": 36955, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.00244080869626, "cost1_min": 17.799330292298432, "system_level_velocity_mean": 15.244923353996775, "cost2_mean": -86.08113629633338, "cost2_max": -20.79512564140285, "outflow_rate_max": 1453.5496197848659, "cost1_mean": 181.8174371637358, "system_level_velocity_min": 11.784813386991596, "system_level_velocity_max": 18.7335162421886, "outflow_rate_min": 437.2949997643919, "cost2_min": -119.4165588156546, "outflow_rate_mean": 1191.877723397194}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 4646817, "time_total_s": 3609.1583774089813, "timestamp": 1558613500, "time_since_restore": 3609.1583774089813, "training_iteration": 115, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501828>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5348, "timesteps_total": 4646817, "episode_reward_mean": -402.3231990519882, "episodes_this_iter": 46, "date": "2019-05-23_12-11-40", "time_this_iter_s": 28.920125246047974, "num_metric_batches_dropped": 0, "episode_reward_min": -524.9333425855841}
{"iterations_since_restore": 116, "info": {"default": {"kl": 0.020447086542844772, "total_loss": 12.219261169433594, "vf_loss": 12.228682518005371, "vf_explained_var": 0.9251085519790649, "cur_lr": 0.0005000000237487257, "entropy": 1.266327977180481, "cur_kl_coeff": 0.25312498211860657, "policy_loss": -0.014596470631659031}, "num_steps_trained": 4682757, "update_time_ms": 8.758, "num_steps_sampled": 4682757, "sample_time_ms": 18738.602, "load_time_ms": 21.137, "grad_time_ms": 10244.547}, "hostname": "flow-main", "episode_reward_max": -22.57128005079687, "timesteps_this_iter": 35940, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.00244080869626, "cost1_min": 17.799330292298432, "system_level_velocity_mean": 15.260649037605225, "cost2_mean": -84.969384380936, "cost2_max": -20.79512564140285, "outflow_rate_max": 1453.5496197848659, "cost1_mean": 180.22736767537725, "system_level_velocity_min": 11.784813386991596, "system_level_velocity_max": 18.7335162421886, "outflow_rate_min": 437.2949997643919, "cost2_min": -117.21417839235373, "outflow_rate_mean": 1182.0996580229812}, "episode_len_mean": 319.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 4682757, "time_total_s": 3637.8480870723724, "timestamp": 1558613529, "time_since_restore": 3637.8480870723724, "training_iteration": 116, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe7f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5395, "timesteps_total": 4682757, "episode_reward_mean": -398.0063186132068, "episodes_this_iter": 47, "date": "2019-05-23_12-12-09", "time_this_iter_s": 28.689709663391113, "num_metric_batches_dropped": 0, "episode_reward_min": -513.2703095980587}
{"iterations_since_restore": 117, "info": {"default": {"kl": 0.015825340524315834, "total_loss": 10.1686372756958, "vf_loss": 10.17546272277832, "vf_explained_var": 0.9370090961456299, "cur_lr": 0.0005000000237487257, "entropy": 1.2280032634735107, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.012833190150558949}, "num_steps_trained": 4718480, "update_time_ms": 8.788, "num_steps_sampled": 4718480, "sample_time_ms": 18608.955, "load_time_ms": 22.277, "grad_time_ms": 10251.187}, "hostname": "flow-main", "episode_reward_max": -95.91286277860975, "timesteps_this_iter": 35723, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.33438180387577, "cost1_min": 80.04501370790439, "system_level_velocity_mean": 15.083973013042673, "cost2_mean": -82.56122970968501, "cost2_max": -59.82123214451248, "outflow_rate_max": 1447.1048795055715, "cost1_mean": 179.62648369355975, "system_level_velocity_min": 12.239998035542342, "system_level_velocity_max": 18.58772101136072, "outflow_rate_min": 770.3077572511313, "cost2_min": -117.70544724299641, "outflow_rate_mean": 1173.1939911653128}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4718480, "time_total_s": 3665.215412378311, "timestamp": 1558613556, "time_since_restore": 3665.215412378311, "training_iteration": 117, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fea90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844feef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe668>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5443, "timesteps_total": 4718480, "episode_reward_mean": -400.364454687565, "episodes_this_iter": 48, "date": "2019-05-23_12-12-36", "time_this_iter_s": 27.36732530593872, "num_metric_batches_dropped": 0, "episode_reward_min": -513.2703095980587}
{"iterations_since_restore": 118, "info": {"default": {"kl": 0.013513320125639439, "total_loss": 12.951932907104492, "vf_loss": 12.959774017333984, "vf_explained_var": 0.9210876226425171, "cur_lr": 0.0005000000237487257, "entropy": 1.2248053550720215, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.012972051277756691}, "num_steps_trained": 4754554, "update_time_ms": 9.068, "num_steps_sampled": 4754554, "sample_time_ms": 18441.2, "load_time_ms": 22.254, "grad_time_ms": 10174.074}, "hostname": "flow-main", "episode_reward_max": -282.21672633085194, "timesteps_this_iter": 36074, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.76395747634055, "cost1_min": 142.40122490946567, "system_level_velocity_mean": 15.13528158604608, "cost2_mean": -82.96740694971042, "cost2_max": -59.82123214451248, "outflow_rate_max": 1446.442938514934, "cost1_mean": 181.5034993407667, "system_level_velocity_min": 12.239998035542342, "system_level_velocity_max": 18.539154091729873, "outflow_rate_min": 948.3874562211982, "cost2_min": -117.70544724299641, "outflow_rate_mean": 1179.305122096985}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4754554, "time_total_s": 3692.092248916626, "timestamp": 1558613583, "time_since_restore": 3692.092248916626, "training_iteration": 118, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845084e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84698eb8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5487, "timesteps_total": 4754554, "episode_reward_mean": -402.10478814737064, "episodes_this_iter": 44, "date": "2019-05-23_12-13-03", "time_this_iter_s": 26.87683653831482, "num_metric_batches_dropped": 0, "episode_reward_min": -508.2021794308769}
{"iterations_since_restore": 119, "info": {"default": {"kl": 0.014964892528951168, "total_loss": 11.014547348022461, "vf_loss": 11.021726608276367, "vf_explained_var": 0.9330448508262634, "cur_lr": 0.0005000000237487257, "entropy": 1.2681604623794556, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.012861494906246662}, "num_steps_trained": 4790111, "update_time_ms": 9.029, "num_steps_sampled": 4790111, "sample_time_ms": 18451.282, "load_time_ms": 22.048, "grad_time_ms": 9974.313}, "hostname": "flow-main", "episode_reward_max": -105.42411800215773, "timesteps_this_iter": 35557, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.92570387642849, "cost1_min": 85.01189093579623, "system_level_velocity_mean": 15.29325896197738, "cost2_mean": -83.13670763819643, "cost2_max": -62.42967859528908, "outflow_rate_max": 1447.8758010916197, "cost1_mean": 182.06969454262023, "system_level_velocity_min": 12.239998035542342, "system_level_velocity_max": 18.73632216232185, "outflow_rate_min": 811.6543409330869, "cost2_min": -114.46101164751366, "outflow_rate_mean": 1179.9694142703215}, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4790111, "time_total_s": 3720.1750996112823, "timestamp": 1558613611, "time_since_restore": 3720.1750996112823, "training_iteration": 119, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fabe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5532, "timesteps_total": 4790111, "episode_reward_mean": -393.21651247262093, "episodes_this_iter": 45, "date": "2019-05-23_12-13-31", "time_this_iter_s": 28.082850694656372, "num_metric_batches_dropped": 0, "episode_reward_min": -508.2021794308769}
{"iterations_since_restore": 120, "info": {"default": {"kl": 0.013441488146781921, "total_loss": 11.026580810546875, "vf_loss": 11.033123016357422, "vf_explained_var": 0.9344465136528015, "cur_lr": 0.0005000000237487257, "entropy": 1.226745843887329, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.011646243743598461}, "num_steps_trained": 4826230, "update_time_ms": 9.121, "num_steps_sampled": 4826230, "sample_time_ms": 18464.318, "load_time_ms": 21.415, "grad_time_ms": 9877.614}, "hostname": "flow-main", "episode_reward_max": -95.96928921986604, "timesteps_this_iter": 36119, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.92570387642849, "cost1_min": 80.17025475481707, "system_level_velocity_mean": 15.389300143090656, "cost2_mean": -83.15217537155719, "cost2_max": -61.94517661767146, "outflow_rate_max": 1447.8758010916197, "cost1_mean": 181.20383267059117, "system_level_velocity_min": 12.283216435869583, "system_level_velocity_max": 18.73632216232185, "outflow_rate_min": 768.0923406002462, "cost2_min": -114.46101164751366, "outflow_rate_mean": 1179.7545136452247}, "episode_len_mean": 319.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 4826230, "time_total_s": 3749.135828971863, "timestamp": 1558613640, "time_since_restore": 3749.135828971863, "training_iteration": 120, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fea58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe390>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5583, "timesteps_total": 4826230, "episode_reward_mean": -385.59788551436674, "episodes_this_iter": 51, "date": "2019-05-23_12-14-00", "time_this_iter_s": 28.960729360580444, "num_metric_batches_dropped": 0, "episode_reward_min": -511.32873638988923}
{"iterations_since_restore": 121, "info": {"default": {"kl": 0.013095368631184101, "total_loss": 10.709429740905762, "vf_loss": 10.715409278869629, "vf_explained_var": 0.9332385659217834, "cur_lr": 0.0005000000237487257, "entropy": 1.220509648323059, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.010952450335025787}, "num_steps_trained": 4862457, "update_time_ms": 9.184, "num_steps_sampled": 4862457, "sample_time_ms": 18470.816, "load_time_ms": 21.36, "grad_time_ms": 9710.678}, "hostname": "flow-main", "episode_reward_max": -29.7807119438989, "timesteps_this_iter": 36227, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 219.4111561170144, "cost1_min": 23.142757892935087, "system_level_velocity_mean": 15.352521723059462, "cost2_mean": -82.85543749809915, "cost2_max": -22.642076499573697, "outflow_rate_max": 1437.6840701789404, "cost1_mean": 178.76152933065995, "system_level_velocity_min": 11.918041047454926, "system_level_velocity_max": 18.71036322143784, "outflow_rate_min": 484.88522595723686, "cost2_min": -113.62265741507386, "outflow_rate_mean": 1171.9161941594962}, "episode_len_mean": 316.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 4862457, "time_total_s": 3777.3703594207764, "timestamp": 1558613668, "time_since_restore": 3777.3703594207764, "training_iteration": 121, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450ff98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f7f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5629, "timesteps_total": 4862457, "episode_reward_mean": -386.6194290146853, "episodes_this_iter": 46, "date": "2019-05-23_12-14-28", "time_this_iter_s": 28.234530448913574, "num_metric_batches_dropped": 0, "episode_reward_min": -511.32873638988923}
{"iterations_since_restore": 122, "info": {"default": {"kl": 0.014572108164429665, "total_loss": 9.699681282043457, "vf_loss": 9.706453323364258, "vf_explained_var": 0.9384228587150574, "cur_lr": 0.0005000000237487257, "entropy": 1.2082608938217163, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.012304688803851604}, "num_steps_trained": 4898421, "update_time_ms": 8.986, "num_steps_sampled": 4898421, "sample_time_ms": 18458.486, "load_time_ms": 20.077, "grad_time_ms": 9714.705}, "hostname": "flow-main", "episode_reward_max": -29.7807119438989, "timesteps_this_iter": 35964, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.00043809173332, "cost1_min": 23.142757892935087, "system_level_velocity_mean": 15.41076776240486, "cost2_mean": -83.84055365614559, "cost2_max": -22.642076499573697, "outflow_rate_max": 1450.0500354224635, "cost1_mean": 180.36211179858344, "system_level_velocity_min": 11.918041047454926, "system_level_velocity_max": 18.646225382082097, "outflow_rate_min": 484.88522595723686, "cost2_min": -113.13302378359649, "outflow_rate_mean": 1180.514339870657}, "episode_len_mean": 318.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 4898421, "time_total_s": 3805.826162338257, "timestamp": 1558613697, "time_since_restore": 3805.826162338257, "training_iteration": 122, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f438>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5673, "timesteps_total": 4898421, "episode_reward_mean": -385.480675493017, "episodes_this_iter": 44, "date": "2019-05-23_12-14-57", "time_this_iter_s": 28.45580291748047, "num_metric_batches_dropped": 0, "episode_reward_min": -502.5994573654357}
{"iterations_since_restore": 123, "info": {"default": {"kl": 0.01395328901708126, "total_loss": 10.720417022705078, "vf_loss": 10.72720718383789, "vf_explained_var": 0.9349538683891296, "cur_lr": 0.0005000000237487257, "entropy": 1.2248826026916504, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.01208997517824173}, "num_steps_trained": 4934921, "update_time_ms": 8.911, "num_steps_sampled": 4934921, "sample_time_ms": 18351.356, "load_time_ms": 19.111, "grad_time_ms": 9823.519}, "hostname": "flow-main", "episode_reward_max": -271.600939662854, "timesteps_this_iter": 36500, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.00043809173332, "cost1_min": 148.76598709618565, "system_level_velocity_mean": 15.448676555278425, "cost2_mean": -87.33835963784469, "cost2_max": -59.65850199332974, "outflow_rate_max": 1450.0500354224635, "cost1_mean": 185.84291554964835, "system_level_velocity_min": 12.49907445968989, "system_level_velocity_max": 18.44980608115797, "outflow_rate_min": 947.6275942829417, "cost2_min": -113.81492242484138, "outflow_rate_mean": 1208.9034939488322}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4934921, "time_total_s": 3834.4553027153015, "timestamp": 1558613726, "time_since_restore": 3834.4553027153015, "training_iteration": 123, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84566160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845088d0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5724, "timesteps_total": 4934921, "episode_reward_mean": -396.1033962113247, "episodes_this_iter": 51, "date": "2019-05-23_12-15-26", "time_this_iter_s": 28.629140377044678, "num_metric_batches_dropped": 0, "episode_reward_min": -511.1326342203489}
{"iterations_since_restore": 124, "info": {"default": {"kl": 0.01466115191578865, "total_loss": 11.161389350891113, "vf_loss": 11.16818904876709, "vf_explained_var": 0.9358736276626587, "cur_lr": 0.0005000000237487257, "entropy": 1.2324049472808838, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.012365849688649178}, "num_steps_trained": 4971580, "update_time_ms": 9.092, "num_steps_sampled": 4971580, "sample_time_ms": 18281.249, "load_time_ms": 18.813, "grad_time_ms": 9846.82}, "hostname": "flow-main", "episode_reward_max": -96.89169192021951, "timesteps_this_iter": 36659, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.5579112476426, "cost1_min": 80.04962319155166, "system_level_velocity_mean": 15.291935903958322, "cost2_mean": -86.86834933680467, "cost2_max": -61.173372107481015, "outflow_rate_max": 1446.0376769277711, "cost1_mean": 182.36232813820087, "system_level_velocity_min": 11.394855247746024, "system_level_velocity_max": 18.565179259080207, "outflow_rate_min": 766.282231425072, "cost2_min": -115.43469237985232, "outflow_rate_mean": 1192.9775356268083}, "episode_len_mean": 322.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 4971580, "time_total_s": 3862.6445350646973, "timestamp": 1558613754, "time_since_restore": 3862.6445350646973, "training_iteration": 124, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f6d8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5770, "timesteps_total": 4971580, "episode_reward_mean": -403.659077510586, "episodes_this_iter": 46, "date": "2019-05-23_12-15-54", "time_this_iter_s": 28.189232349395752, "num_metric_batches_dropped": 0, "episode_reward_min": -534.1939987050403}
{"iterations_since_restore": 125, "info": {"default": {"kl": 0.014772162772715092, "total_loss": 11.876126289367676, "vf_loss": 11.882508277893066, "vf_explained_var": 0.9261183738708496, "cur_lr": 0.0005000000237487257, "entropy": 1.2432527542114258, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.011990249156951904}, "num_steps_trained": 5007845, "update_time_ms": 9.124, "num_steps_sampled": 5007845, "sample_time_ms": 18254.719, "load_time_ms": 18.877, "grad_time_ms": 9756.593}, "hostname": "flow-main", "episode_reward_max": -95.88025465575845, "timesteps_this_iter": 36265, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 220.5579112476426, "cost1_min": 80.04962319155166, "system_level_velocity_mean": 15.197287034299615, "cost2_mean": -85.18810502035123, "cost2_max": -59.315145058823795, "outflow_rate_max": 1446.0376769277711, "cost1_mean": 179.68210928942452, "system_level_velocity_min": 11.394855247746024, "system_level_velocity_max": 18.592047963035228, "outflow_rate_min": 766.282231425072, "cost2_min": -115.43469237985232, "outflow_rate_mean": 1177.1976543072865}, "episode_len_mean": 320.44, "node_ip": "10.138.0.2", "timesteps_since_restore": 5007845, "time_total_s": 3890.3862442970276, "timestamp": 1558613782, "time_since_restore": 3890.3862442970276, "training_iteration": 125, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f438>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5813, "timesteps_total": 5007845, "episode_reward_mean": -400.7012788025261, "episodes_this_iter": 43, "date": "2019-05-23_12-16-22", "time_this_iter_s": 27.741709232330322, "num_metric_batches_dropped": 0, "episode_reward_min": -534.1939987050403}
{"iterations_since_restore": 126, "info": {"default": {"kl": 0.015647374093532562, "total_loss": 11.629952430725098, "vf_loss": 11.638107299804688, "vf_explained_var": 0.9249997138977051, "cur_lr": 0.0005000000237487257, "entropy": 1.1943963766098022, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.014095203019678593}, "num_steps_trained": 5043951, "update_time_ms": 9.156, "num_steps_sampled": 5043951, "sample_time_ms": 18273.731, "load_time_ms": 19.455, "grad_time_ms": 9739.622}, "hostname": "flow-main", "episode_reward_max": -95.88025465575845, "timesteps_this_iter": 36106, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 218.81621015684624, "cost1_min": 80.18429927545715, "system_level_velocity_mean": 15.552886905022696, "cost2_mean": -87.78390439294174, "cost2_max": -59.315145058823795, "outflow_rate_max": 1437.9507530454039, "cost1_mean": 185.4160414980839, "system_level_velocity_min": 11.394855247746024, "system_level_velocity_max": 18.592047963035228, "outflow_rate_min": 770.2273903382983, "cost2_min": -114.90651054522641, "outflow_rate_mean": 1211.3530597490303}, "episode_len_mean": 322.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 5043951, "time_total_s": 3919.095808982849, "timestamp": 1558613810, "time_since_restore": 3919.095808982849, "training_iteration": 126, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844feb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844feda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5862, "timesteps_total": 5043951, "episode_reward_mean": -388.66733761931323, "episodes_this_iter": 49, "date": "2019-05-23_12-16-50", "time_this_iter_s": 28.709564685821533, "num_metric_batches_dropped": 0, "episode_reward_min": -522.2184033530885}
{"iterations_since_restore": 127, "info": {"default": {"kl": 0.01419330108910799, "total_loss": 10.193022727966309, "vf_loss": 10.200573921203613, "vf_explained_var": 0.9374637603759766, "cur_lr": 0.0005000000237487257, "entropy": 1.2596962451934814, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.01293993555009365}, "num_steps_trained": 5080288, "update_time_ms": 8.97, "num_steps_sampled": 5080288, "sample_time_ms": 18383.286, "load_time_ms": 19.103, "grad_time_ms": 9728.437}, "hostname": "flow-main", "episode_reward_max": -280.7300833328521, "timesteps_this_iter": 36337, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.61958662078166, "cost1_min": 147.9837317215338, "system_level_velocity_mean": 15.663323859345423, "cost2_mean": -89.38822649825683, "cost2_max": -61.65894730497736, "outflow_rate_max": 1442.5323344333558, "cost1_mean": 188.26917254673918, "system_level_velocity_min": 12.513226269113787, "system_level_velocity_max": 18.65005239648418, "outflow_rate_min": 973.996396226415, "cost2_min": -114.90651054522641, "outflow_rate_mean": 1222.4995299839366}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5080288, "time_total_s": 3947.408755540848, "timestamp": 1558613839, "time_since_restore": 3947.408755540848, "training_iteration": 127, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fe48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fcf8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5907, "timesteps_total": 5080288, "episode_reward_mean": -390.4489642407867, "episodes_this_iter": 45, "date": "2019-05-23_12-17-19", "time_this_iter_s": 28.312946557998657, "num_metric_batches_dropped": 0, "episode_reward_min": -537.6073844385473}
{"iterations_since_restore": 128, "info": {"default": {"kl": 0.01388693880289793, "total_loss": 10.817407608032227, "vf_loss": 10.82447338104248, "vf_explained_var": 0.9331566691398621, "cur_lr": 0.0005000000237487257, "entropy": 1.2858688831329346, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.01233881525695324}, "num_steps_trained": 5115728, "update_time_ms": 8.786, "num_steps_sampled": 5115728, "sample_time_ms": 18453.67, "load_time_ms": 18.229, "grad_time_ms": 9757.2}, "hostname": "flow-main", "episode_reward_max": -27.613888809494334, "timesteps_this_iter": 35440, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.61958662078166, "cost1_min": 23.145045649860222, "system_level_velocity_mean": 15.342986705009773, "cost2_mean": -85.06097795904219, "cost2_max": -23.587737890142648, "outflow_rate_max": 1444.5341090305044, "cost1_mean": 182.3729512797342, "system_level_velocity_min": 12.419185842133022, "system_level_velocity_max": 18.76590249012146, "outflow_rate_min": 508.5934821910148, "cost2_min": -115.44467079101632, "outflow_rate_mean": 1183.1164954052404}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 5115728, "time_total_s": 3975.2649807929993, "timestamp": 1558613867, "time_since_restore": 3975.2649807929993, "training_iteration": 128, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fcc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fae10>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 5953, "timesteps_total": 5115728, "episode_reward_mean": -392.30843912179427, "episodes_this_iter": 46, "date": "2019-05-23_12-17-47", "time_this_iter_s": 27.85622525215149, "num_metric_batches_dropped": 0, "episode_reward_min": -537.6073844385473}
{"iterations_since_restore": 129, "info": {"default": {"kl": 0.014708459377288818, "total_loss": 14.359638214111328, "vf_loss": 14.365633964538574, "vf_explained_var": 0.9202584028244019, "cur_lr": 0.0005000000237487257, "entropy": 1.2939355373382568, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.011580739170312881}, "num_steps_trained": 5152348, "update_time_ms": 8.826, "num_steps_sampled": 5152348, "sample_time_ms": 18429.403, "load_time_ms": 17.505, "grad_time_ms": 9818.62}, "hostname": "flow-main", "episode_reward_max": -27.613888809494334, "timesteps_this_iter": 36620, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.545262852088, "cost1_min": 23.145045649860222, "system_level_velocity_mean": 15.225158506740653, "cost2_mean": -84.6302423318574, "cost2_max": -23.587737890142648, "outflow_rate_max": 1449.194286926472, "cost1_mean": 180.18216628512022, "system_level_velocity_min": 11.889687579837407, "system_level_velocity_max": 18.76590249012146, "outflow_rate_min": 508.5934821910148, "cost2_min": -115.44467079101632, "outflow_rate_mean": 1172.5484957960982}, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 5152348, "time_total_s": 4003.7070717811584, "timestamp": 1558613895, "time_since_restore": 4003.7070717811584, "training_iteration": 129, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe470>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6001, "timesteps_total": 5152348, "episode_reward_mean": -399.18873049567424, "episodes_this_iter": 48, "date": "2019-05-23_12-18-15", "time_this_iter_s": 28.44209098815918, "num_metric_batches_dropped": 0, "episode_reward_min": -505.4167422846976}
{"iterations_since_restore": 130, "info": {"default": {"kl": 0.013446878641843796, "total_loss": 13.364336013793945, "vf_loss": 13.36984634399414, "vf_explained_var": 0.9255399703979492, "cur_lr": 0.0005000000237487257, "entropy": 1.263232707977295, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.010616673156619072}, "num_steps_trained": 5189213, "update_time_ms": 8.711, "num_steps_sampled": 5189213, "sample_time_ms": 18305.62, "load_time_ms": 17.747, "grad_time_ms": 9856.16}, "hostname": "flow-main", "episode_reward_max": -207.5526600864348, "timesteps_this_iter": 36865, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.92536419389938, "cost1_min": 133.71277434036574, "system_level_velocity_mean": 15.172132396911124, "cost2_mean": -86.57496095244615, "cost2_max": -59.63478133843051, "outflow_rate_max": 1449.194286926472, "cost1_mean": 181.56937803027355, "system_level_velocity_min": 11.889687579837407, "system_level_velocity_max": 18.589557187611295, "outflow_rate_min": 932.1109756097565, "cost2_min": -115.31651773733418, "outflow_rate_mean": 1181.8235191088636}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 5189213, "time_total_s": 4031.8028225898743, "timestamp": 1558613923, "time_since_restore": 4031.8028225898743, "training_iteration": 130, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508cf8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6048, "timesteps_total": 5189213, "episode_reward_mean": -413.8122078038478, "episodes_this_iter": 47, "date": "2019-05-23_12-18-43", "time_this_iter_s": 28.09575080871582, "num_metric_batches_dropped": 0, "episode_reward_min": -506.15571545699345}
{"iterations_since_restore": 131, "info": {"default": {"kl": 0.013816495425999165, "total_loss": 12.779060363769531, "vf_loss": 12.784730911254883, "vf_explained_var": 0.9266475439071655, "cur_lr": 0.0005000000237487257, "entropy": 1.2629369497299194, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.010916967876255512}, "num_steps_trained": 5226317, "update_time_ms": 9.132, "num_steps_sampled": 5226317, "sample_time_ms": 18317.504, "load_time_ms": 16.547, "grad_time_ms": 9887.02}, "hostname": "flow-main", "episode_reward_max": -277.6606014813213, "timesteps_this_iter": 37104, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.92536419389938, "cost1_min": 138.02233484488914, "system_level_velocity_mean": 15.219829432594828, "cost2_mean": -87.85850415652286, "cost2_max": -62.00574371575425, "outflow_rate_max": 1446.722008174932, "cost1_mean": 183.21913546400276, "system_level_velocity_min": 11.792596657129945, "system_level_velocity_max": 18.589557187611295, "outflow_rate_min": 932.1109756097565, "cost2_min": -115.09481162529212, "outflow_rate_mean": 1190.5573205345222}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5226317, "time_total_s": 4060.4637212753296, "timestamp": 1558613952, "time_since_restore": 4060.4637212753296, "training_iteration": 131, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fcc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fc88>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6093, "timesteps_total": 5226317, "episode_reward_mean": -414.7098247018511, "episodes_this_iter": 45, "date": "2019-05-23_12-19-12", "time_this_iter_s": 28.660898685455322, "num_metric_batches_dropped": 0, "episode_reward_min": -520.9063529019384}
{"iterations_since_restore": 132, "info": {"default": {"kl": 0.014634876511991024, "total_loss": 12.28661060333252, "vf_loss": 12.294404029846191, "vf_explained_var": 0.9253777861595154, "cur_lr": 0.0005000000237487257, "entropy": 1.2767328023910522, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.01335082296282053}, "num_steps_trained": 5262803, "update_time_ms": 8.99, "num_steps_sampled": 5262803, "sample_time_ms": 18325.788, "load_time_ms": 17.525, "grad_time_ms": 9882.869}, "hostname": "flow-main", "episode_reward_max": -97.12787050536733, "timesteps_this_iter": 36486, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 222.25509799692952, "cost1_min": 77.8467475187276, "system_level_velocity_mean": 15.379090392858066, "cost2_mean": -87.97563325405662, "cost2_max": -56.46174162581487, "outflow_rate_max": 1452.0823430245407, "cost1_mean": 182.50160895371116, "system_level_velocity_min": 11.792596657129945, "system_level_velocity_max": 18.71920533750462, "outflow_rate_min": 758.6899957474802, "cost2_min": -115.09481162529212, "outflow_rate_mean": 1190.0643128595925}, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 5262803, "time_total_s": 4088.9760267734528, "timestamp": 1558613980, "time_since_restore": 4088.9760267734528, "training_iteration": 132, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845145f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514b70>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6139, "timesteps_total": 5262803, "episode_reward_mean": -402.4971159899127, "episodes_this_iter": 46, "date": "2019-05-23_12-19-40", "time_this_iter_s": 28.51230549812317, "num_metric_batches_dropped": 0, "episode_reward_min": -520.9063529019384}
{"iterations_since_restore": 133, "info": {"default": {"kl": 0.014277053065598011, "total_loss": 10.095227241516113, "vf_loss": 10.102880477905273, "vf_explained_var": 0.9386716485023499, "cur_lr": 0.0005000000237487257, "entropy": 1.2922405004501343, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.01307435892522335}, "num_steps_trained": 5299465, "update_time_ms": 9.206, "num_steps_sampled": 5299465, "sample_time_ms": 18449.686, "load_time_ms": 18.661, "grad_time_ms": 9839.814}, "hostname": "flow-main", "episode_reward_max": -97.12787050536733, "timesteps_this_iter": 36662, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 222.25509799692952, "cost1_min": 77.8467475187276, "system_level_velocity_mean": 15.423352414301196, "cost2_mean": -86.57348140195796, "cost2_max": -56.46174162581487, "outflow_rate_max": 1452.0823430245407, "cost1_mean": 182.7595484121196, "system_level_velocity_min": 12.122590769061176, "system_level_velocity_max": 18.71920533750462, "outflow_rate_min": 758.6899957474802, "cost2_min": -111.96294871790423, "outflow_rate_mean": 1190.5093371985322}, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 5299465, "time_total_s": 4118.419622421265, "timestamp": 1558614010, "time_since_restore": 4118.419622421265, "training_iteration": 133, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f6d8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6187, "timesteps_total": 5299465, "episode_reward_mean": -400.92181003590696, "episodes_this_iter": 48, "date": "2019-05-23_12-20-10", "time_this_iter_s": 29.44359564781189, "num_metric_batches_dropped": 0, "episode_reward_min": -503.56848970135707}
{"iterations_since_restore": 134, "info": {"default": {"kl": 0.013960707001388073, "total_loss": 12.109990119934082, "vf_loss": 12.116639137268066, "vf_explained_var": 0.9245447516441345, "cur_lr": 0.0005000000237487257, "entropy": 1.2875927686691284, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.011949561536312103}, "num_steps_trained": 5335932, "update_time_ms": 9.056, "num_steps_sampled": 5335932, "sample_time_ms": 18477.005, "load_time_ms": 19.135, "grad_time_ms": 9843.445}, "hostname": "flow-main", "episode_reward_max": -111.31090937455262, "timesteps_this_iter": 36467, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.05931354795962, "cost1_min": 85.19809560848879, "system_level_velocity_mean": 15.414277590331793, "cost2_mean": -86.31298890051026, "cost2_max": -59.002586500759264, "outflow_rate_max": 1450.5236005007619, "cost1_mean": 183.91578190381904, "system_level_velocity_min": 12.122590769061176, "system_level_velocity_max": 18.644185394331128, "outflow_rate_min": 796.0098021609832, "cost2_min": -111.96294871790423, "outflow_rate_mean": 1196.287995372245}, "episode_len_mean": 323.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 5335932, "time_total_s": 4146.919731616974, "timestamp": 1558614038, "time_since_restore": 4146.919731616974, "training_iteration": 134, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844feb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fea20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6235, "timesteps_total": 5335932, "episode_reward_mean": -403.08371404199943, "episodes_this_iter": 48, "date": "2019-05-23_12-20-38", "time_this_iter_s": 28.50010919570923, "num_metric_batches_dropped": 0, "episode_reward_min": -520.329331625312}
{"iterations_since_restore": 135, "info": {"default": {"kl": 0.0146268205717206, "total_loss": 12.524765014648438, "vf_loss": 12.531577110290527, "vf_explained_var": 0.9219381809234619, "cur_lr": 0.0005000000237487257, "entropy": 1.3133163452148438, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.012366737239062786}, "num_steps_trained": 5372032, "update_time_ms": 9.005, "num_steps_sampled": 5372032, "sample_time_ms": 18447.439, "load_time_ms": 17.928, "grad_time_ms": 9901.68}, "hostname": "flow-main", "episode_reward_max": -97.46837115345251, "timesteps_this_iter": 36100, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.05931354795962, "cost1_min": 79.77052004776668, "system_level_velocity_mean": 15.466618331629352, "cost2_mean": -85.54344807220482, "cost2_max": -55.51833952137955, "outflow_rate_max": 1450.8900048276364, "cost1_mean": 183.10365419229248, "system_level_velocity_min": 12.376709279314358, "system_level_velocity_max": 18.720616824902717, "outflow_rate_min": 763.4956967325816, "cost2_min": -114.73302721646797, "outflow_rate_mean": 1190.1500443688997}, "episode_len_mean": 320.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 5372032, "time_total_s": 4174.9305148124695, "timestamp": 1558614067, "time_since_restore": 4174.9305148124695, "training_iteration": 135, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450ff98>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6280, "timesteps_total": 5372032, "episode_reward_mean": -394.0412707547482, "episodes_this_iter": 45, "date": "2019-05-23_12-21-07", "time_this_iter_s": 28.010783195495605, "num_metric_batches_dropped": 0, "episode_reward_min": -520.329331625312}
{"iterations_since_restore": 136, "info": {"default": {"kl": 0.013374252244830132, "total_loss": 12.48857307434082, "vf_loss": 12.495147705078125, "vf_explained_var": 0.9219970703125, "cur_lr": 0.0005000000237487257, "entropy": 1.2876019477844238, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.011652258224785328}, "num_steps_trained": 5408040, "update_time_ms": 8.91, "num_steps_sampled": 5408040, "sample_time_ms": 18501.661, "load_time_ms": 17.235, "grad_time_ms": 9913.935}, "hostname": "flow-main", "episode_reward_max": -22.404487382003826, "timesteps_this_iter": 36008, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.05931354795962, "cost1_min": 18.029020064124154, "system_level_velocity_mean": 15.613157727894865, "cost2_mean": -85.51635127902888, "cost2_max": -19.703766131461762, "outflow_rate_max": 1450.8900048276364, "cost1_mean": 183.60100390437762, "system_level_velocity_min": 12.293443390236233, "system_level_velocity_max": 18.720616824902717, "outflow_rate_min": 460.62677674270975, "cost2_min": -114.73302721646797, "outflow_rate_mean": 1193.0915399058392}, "episode_len_mean": 318.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 5408040, "time_total_s": 4204.323406219482, "timestamp": 1558614096, "time_since_restore": 4204.323406219482, "training_iteration": 136, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845085c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523a20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6329, "timesteps_total": 5408040, "episode_reward_mean": -381.3445995290477, "episodes_this_iter": 49, "date": "2019-05-23_12-21-36", "time_this_iter_s": 29.39289140701294, "num_metric_batches_dropped": 0, "episode_reward_min": -507.64869619767103}
{"iterations_since_restore": 137, "info": {"default": {"kl": 0.014186411164700985, "total_loss": 12.527255058288574, "vf_loss": 12.534331321716309, "vf_explained_var": 0.9210813045501709, "cur_lr": 0.0005000000237487257, "entropy": 1.2911120653152466, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.012461905367672443}, "num_steps_trained": 5444072, "update_time_ms": 9.459, "num_steps_sampled": 5444072, "sample_time_ms": 18449.934, "load_time_ms": 15.817, "grad_time_ms": 9932.497}, "hostname": "flow-main", "episode_reward_max": -22.404487382003826, "timesteps_this_iter": 36032, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.08616271044068, "cost1_min": 18.029020064124154, "system_level_velocity_mean": 15.519495268821867, "cost2_mean": -84.54612862600905, "cost2_max": -19.703766131461762, "outflow_rate_max": 1450.3453749907064, "cost1_mean": 183.88466127332833, "system_level_velocity_min": 12.293443390236233, "system_level_velocity_max": 18.73082182903707, "outflow_rate_min": 460.62677674270975, "cost2_min": -114.94694839876064, "outflow_rate_mean": 1192.6722608521873}, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 5444072, "time_total_s": 4232.300336837769, "timestamp": 1558614124, "time_since_restore": 4232.300336837769, "training_iteration": 137, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f25c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f2748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe748>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6375, "timesteps_total": 5444072, "episode_reward_mean": -386.750727228712, "episodes_this_iter": 46, "date": "2019-05-23_12-22-04", "time_this_iter_s": 27.976930618286133, "num_metric_batches_dropped": 0, "episode_reward_min": -491.186636356503}
{"iterations_since_restore": 138, "info": {"default": {"kl": 0.014426589012145996, "total_loss": 12.93753433227539, "vf_loss": 12.944939613342285, "vf_explained_var": 0.9216740131378174, "cur_lr": 0.0005000000237487257, "entropy": 1.3009377717971802, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.012881883420050144}, "num_steps_trained": 5480359, "update_time_ms": 9.561, "num_steps_sampled": 5480359, "sample_time_ms": 18495.219, "load_time_ms": 17.378, "grad_time_ms": 9898.187}, "hostname": "flow-main", "episode_reward_max": -276.3406953960258, "timesteps_this_iter": 36287, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.08616271044068, "cost1_min": 145.0682324743595, "system_level_velocity_mean": 15.549652660904128, "cost2_mean": -85.38886856405706, "cost2_max": -59.9623190669527, "outflow_rate_max": 1449.0431156308248, "cost1_mean": 186.7454896434134, "system_level_velocity_min": 12.290838021181298, "system_level_velocity_max": 18.73082182903707, "outflow_rate_min": 950.6300000000001, "cost2_min": -114.94694839876064, "outflow_rate_mean": 1204.588361330007}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5480359, "time_total_s": 4260.283471822739, "timestamp": 1558614152, "time_since_restore": 4260.283471822739, "training_iteration": 138, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f470>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6418, "timesteps_total": 5480359, "episode_reward_mean": -392.1151805594981, "episodes_this_iter": 43, "date": "2019-05-23_12-22-32", "time_this_iter_s": 27.983134984970093, "num_metric_batches_dropped": 0, "episode_reward_min": -522.7571001284837}
{"iterations_since_restore": 139, "info": {"default": {"kl": 0.01456453837454319, "total_loss": 13.758005142211914, "vf_loss": 13.765486717224121, "vf_explained_var": 0.9173330068588257, "cur_lr": 0.0005000000237487257, "entropy": 1.2941253185272217, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.013011339120566845}, "num_steps_trained": 5516158, "update_time_ms": 9.669, "num_steps_sampled": 5516158, "sample_time_ms": 18541.35, "load_time_ms": 18.72, "grad_time_ms": 9807.155}, "hostname": "flow-main", "episode_reward_max": -251.63576453831766, "timesteps_this_iter": 35799, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.33155081705664, "cost1_min": 138.84318952591795, "system_level_velocity_mean": 15.361878064095356, "cost2_mean": -84.49080512302837, "cost2_max": -57.90550945820836, "outflow_rate_max": 1449.0431156308248, "cost1_mean": 184.26640789333666, "system_level_velocity_min": 11.804586269839458, "system_level_velocity_max": 18.729116185199857, "outflow_rate_min": 899.4733541855654, "cost2_min": -112.99331941377795, "outflow_rate_mean": 1191.1817109928802}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 5516158, "time_total_s": 4288.320769309998, "timestamp": 1558614180, "time_since_restore": 4288.320769309998, "training_iteration": 139, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523908>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6467, "timesteps_total": 5516158, "episode_reward_mean": -397.2340746321355, "episodes_this_iter": 49, "date": "2019-05-23_12-23-00", "time_this_iter_s": 28.03729748725891, "num_metric_batches_dropped": 0, "episode_reward_min": -522.7571001284837}
{"iterations_since_restore": 140, "info": {"default": {"kl": 0.013515453785657883, "total_loss": 17.785614013671875, "vf_loss": 17.792692184448242, "vf_explained_var": 0.9022223353385925, "cur_lr": 0.0005000000237487257, "entropy": 1.3186149597167969, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.012210752815008163}, "num_steps_trained": 5553087, "update_time_ms": 9.583, "num_steps_sampled": 5553087, "sample_time_ms": 18623.767, "load_time_ms": 18.846, "grad_time_ms": 9833.577}, "hostname": "flow-main", "episode_reward_max": -22.50589726599441, "timesteps_this_iter": 36929, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.33155081705664, "cost1_min": 17.80777764942827, "system_level_velocity_mean": 15.405345716551519, "cost2_mean": -85.22761783272945, "cost2_max": -20.67375937548567, "outflow_rate_max": 1453.111483609539, "cost1_mean": 181.53775274190065, "system_level_velocity_min": 11.804586269839458, "system_level_velocity_max": 18.729116185199857, "outflow_rate_min": 442.8785900830537, "cost2_min": -114.83312333639414, "outflow_rate_mean": 1182.3134778138458}, "episode_len_mean": 319.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 5553087, "time_total_s": 4317.510511398315, "timestamp": 1558614209, "time_since_restore": 4317.510511398315, "training_iteration": 140, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523ba8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6515, "timesteps_total": 5553087, "episode_reward_mean": -396.74008257191764, "episodes_this_iter": 48, "date": "2019-05-23_12-23-29", "time_this_iter_s": 29.18974208831787, "num_metric_batches_dropped": 0, "episode_reward_min": -525.7165809989422}
{"iterations_since_restore": 141, "info": {"default": {"kl": 0.014656687155365944, "total_loss": 16.457307815551758, "vf_loss": 16.464818954467773, "vf_explained_var": 0.9019115567207336, "cur_lr": 0.0005000000237487257, "entropy": 1.2873135805130005, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.01307791005820036}, "num_steps_trained": 5589372, "update_time_ms": 9.429, "num_steps_sampled": 5589372, "sample_time_ms": 18552.912, "load_time_ms": 19.857, "grad_time_ms": 9846.711}, "hostname": "flow-main", "episode_reward_max": -22.50589726599441, "timesteps_this_iter": 36285, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.33155081705664, "cost1_min": 17.80777764942827, "system_level_velocity_mean": 15.380866564229716, "cost2_mean": -86.47604556826664, "cost2_max": -20.67375937548567, "outflow_rate_max": 1453.111483609539, "cost1_mean": 180.37934246385166, "system_level_velocity_min": 12.350198004000449, "system_level_velocity_max": 18.729116185199857, "outflow_rate_min": 442.8785900830537, "cost2_min": -117.55298791886653, "outflow_rate_mean": 1176.6496070999428}, "episode_len_mean": 318.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 5589372, "time_total_s": 4345.607486486435, "timestamp": 1558614237, "time_since_restore": 4345.607486486435, "training_iteration": 141, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845085c0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6560, "timesteps_total": 5589372, "episode_reward_mean": -398.4370817796637, "episodes_this_iter": 45, "date": "2019-05-23_12-23-57", "time_this_iter_s": 28.096975088119507, "num_metric_batches_dropped": 0, "episode_reward_min": -525.7165809989422}
{"iterations_since_restore": 142, "info": {"default": {"kl": 0.015693632885813713, "total_loss": 15.416069984436035, "vf_loss": 15.423998832702637, "vf_explained_var": 0.9105899333953857, "cur_lr": 0.0005000000237487257, "entropy": 1.2601618766784668, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.013887741602957249}, "num_steps_trained": 5626474, "update_time_ms": 9.529, "num_steps_sampled": 5626474, "sample_time_ms": 18526.878, "load_time_ms": 20.063, "grad_time_ms": 9913.202}, "hostname": "flow-main", "episode_reward_max": -105.09533104810454, "timesteps_this_iter": 37102, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.6697679186317, "cost1_min": 84.80942462690196, "system_level_velocity_mean": 15.272452401751185, "cost2_mean": -87.9004566250727, "cost2_max": -59.14796679379238, "outflow_rate_max": 1457.180495593202, "cost1_mean": 179.5948619573844, "system_level_velocity_min": 11.865535064329558, "system_level_velocity_max": 18.752171089637624, "outflow_rate_min": 800.1625890158823, "cost2_min": -117.55298791886653, "outflow_rate_mean": 1172.007199487851}, "episode_len_mean": 319.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5626474, "time_total_s": 4374.5266535282135, "timestamp": 1558614266, "time_since_restore": 4374.5266535282135, "training_iteration": 142, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514b00>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6606, "timesteps_total": 5626474, "episode_reward_mean": -403.12985262564723, "episodes_this_iter": 46, "date": "2019-05-23_12-24-26", "time_this_iter_s": 28.919167041778564, "num_metric_batches_dropped": 0, "episode_reward_min": -627.0568031453249}
{"iterations_since_restore": 143, "info": {"default": {"kl": 0.013647528365254402, "total_loss": 14.48730754852295, "vf_loss": 14.495665550231934, "vf_explained_var": 0.9154362082481384, "cur_lr": 0.0005000000237487257, "entropy": 1.2687790393829346, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.013539028353989124}, "num_steps_trained": 5664127, "update_time_ms": 9.256, "num_steps_sampled": 5664127, "sample_time_ms": 18427.588, "load_time_ms": 20.1, "grad_time_ms": 10159.147}, "hostname": "flow-main", "episode_reward_max": -105.460996897677, "timesteps_this_iter": 37653, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.6697679186317, "cost1_min": 84.80942462690196, "system_level_velocity_mean": 15.241602343321938, "cost2_mean": -91.35922320309712, "cost2_max": -59.14796679379238, "outflow_rate_max": 1457.180495593202, "cost1_mean": 182.141409767361, "system_level_velocity_min": 11.865535064329558, "system_level_velocity_max": 18.752171089637624, "outflow_rate_min": 800.1625890158823, "cost2_min": -117.55298791886653, "outflow_rate_mean": 1189.0807058454259}, "episode_len_mean": 322.85, "node_ip": "10.138.0.2", "timesteps_since_restore": 5664127, "time_total_s": 4405.462076425552, "timestamp": 1558614297, "time_since_restore": 4405.462076425552, "training_iteration": 143, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844feda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe630>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6654, "timesteps_total": 5664127, "episode_reward_mean": -414.1071978688435, "episodes_this_iter": 48, "date": "2019-05-23_12-24-57", "time_this_iter_s": 30.935422897338867, "num_metric_batches_dropped": 0, "episode_reward_min": -627.0568031453249}
{"iterations_since_restore": 144, "info": {"default": {"kl": 0.013678059913218021, "total_loss": 16.008544921875, "vf_loss": 16.01564598083496, "vf_explained_var": 0.9010872840881348, "cur_lr": 0.0005000000237487257, "entropy": 1.2472699880599976, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.012294930405914783}, "num_steps_trained": 5701327, "update_time_ms": 9.829, "num_steps_sampled": 5701327, "sample_time_ms": 18426.773, "load_time_ms": 19.045, "grad_time_ms": 10190.272}, "hostname": "flow-main", "episode_reward_max": -244.80747586276502, "timesteps_this_iter": 37200, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.39183739953694, "cost1_min": 149.3253898926713, "system_level_velocity_mean": 15.482943671199765, "cost2_mean": -94.86473496251625, "cost2_max": -66.70194052958027, "outflow_rate_max": 1451.9465967424458, "cost1_mean": 186.52591812506992, "system_level_velocity_min": 12.463673273792237, "system_level_velocity_max": 18.686279513899898, "outflow_rate_min": 1002.6919087497237, "cost2_min": -119.76052682454713, "outflow_rate_mean": 1214.51295107806}, "episode_len_mean": 324.85, "node_ip": "10.138.0.2", "timesteps_since_restore": 5701327, "time_total_s": 4434.262497425079, "timestamp": 1558614326, "time_since_restore": 4434.262497425079, "training_iteration": 144, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845149e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe5f8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6699, "timesteps_total": 5701327, "episode_reward_mean": -413.22633368792356, "episodes_this_iter": 45, "date": "2019-05-23_12-25-26", "time_this_iter_s": 28.800420999526978, "num_metric_batches_dropped": 0, "episode_reward_min": -539.8178861958936}
{"iterations_since_restore": 145, "info": {"default": {"kl": 0.016649706289172173, "total_loss": 14.735910415649414, "vf_loss": 14.744475364685059, "vf_explained_var": 0.9123032689094543, "cur_lr": 0.0005000000237487257, "entropy": 1.3066447973251343, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.014885948970913887}, "num_steps_trained": 5738320, "update_time_ms": 9.99, "num_steps_sampled": 5738320, "sample_time_ms": 18544.302, "load_time_ms": 20.246, "grad_time_ms": 10158.481}, "hostname": "flow-main", "episode_reward_max": -242.42227831485954, "timesteps_this_iter": 36993, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.52402591262035, "cost1_min": 138.83212933812788, "system_level_velocity_mean": 15.425990594506217, "cost2_mean": -92.61638838304204, "cost2_max": -63.485558901110906, "outflow_rate_max": 1457.5215205188135, "cost1_mean": 185.68189181858168, "system_level_velocity_min": 11.801535205314906, "system_level_velocity_max": 19.130206931744567, "outflow_rate_min": 932.1691016297378, "cost2_min": -119.76052682454713, "outflow_rate_mean": 1206.1737743805152}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5738320, "time_total_s": 4463.151796340942, "timestamp": 1558614355, "time_since_restore": 4463.151796340942, "training_iteration": 145, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514550>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6746, "timesteps_total": 5738320, "episode_reward_mean": -410.9267500800701, "episodes_this_iter": 47, "date": "2019-05-23_12-25-55", "time_this_iter_s": 28.889298915863037, "num_metric_batches_dropped": 0, "episode_reward_min": -592.5857576215642}
{"iterations_since_restore": 146, "info": {"default": {"kl": 0.01517621148377657, "total_loss": 18.57954216003418, "vf_loss": 18.586994171142578, "vf_explained_var": 0.8871777653694153, "cur_lr": 0.0005000000237487257, "entropy": 1.2661670446395874, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.01321608666330576}, "num_steps_trained": 5775882, "update_time_ms": 10.243, "num_steps_sampled": 5775882, "sample_time_ms": 18548.171, "load_time_ms": 21.097, "grad_time_ms": 10128.616}, "hostname": "flow-main", "episode_reward_max": -33.646357816833614, "timesteps_this_iter": 37562, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.2536272370911, "cost1_min": 22.494494797950818, "system_level_velocity_mean": 15.57660570764366, "cost2_mean": -93.64069558047045, "cost2_max": -25.712083407708167, "outflow_rate_max": 1457.5215205188135, "cost1_mean": 184.49886159223908, "system_level_velocity_min": 11.801535205314906, "system_level_velocity_max": 19.130206931744567, "outflow_rate_min": 428.5192681428076, "cost2_min": -119.76052682454713, "outflow_rate_mean": 1206.547464285304}, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 5775882, "time_total_s": 4492.271378040314, "timestamp": 1558614384, "time_since_restore": 4492.271378040314, "training_iteration": 146, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523358>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6794, "timesteps_total": 5775882, "episode_reward_mean": -408.0704355844142, "episodes_this_iter": 48, "date": "2019-05-23_12-26-24", "time_this_iter_s": 29.119581699371338, "num_metric_batches_dropped": 0, "episode_reward_min": -592.5857576215642}
{"iterations_since_restore": 147, "info": {"default": {"kl": 0.013518111780285835, "total_loss": 13.633662223815918, "vf_loss": 13.641182899475098, "vf_explained_var": 0.9179537296295166, "cur_lr": 0.0005000000237487257, "entropy": 1.3433434963226318, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.01265421137213707}, "num_steps_trained": 5812865, "update_time_ms": 9.696, "num_steps_sampled": 5812865, "sample_time_ms": 18636.493, "load_time_ms": 22.639, "grad_time_ms": 10143.707}, "hostname": "flow-main", "episode_reward_max": -33.646357816833614, "timesteps_this_iter": 36983, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.2536272370911, "cost1_min": 22.494494797950818, "system_level_velocity_mean": 15.516100310657011, "cost2_mean": -93.1948894011428, "cost2_max": -25.712083407708167, "outflow_rate_max": 1454.118599774914, "cost1_mean": 183.69405025996647, "system_level_velocity_min": 11.813804737188512, "system_level_velocity_max": 19.130206931744567, "outflow_rate_min": 428.5192681428076, "cost2_min": -118.74003151990085, "outflow_rate_mean": 1199.8629035208244}, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 5812865, "time_total_s": 4521.297292470932, "timestamp": 1558614413, "time_since_restore": 4521.297292470932, "training_iteration": 147, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844febe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe9e8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6839, "timesteps_total": 5812865, "episode_reward_mean": -407.30486365625103, "episodes_this_iter": 45, "date": "2019-05-23_12-26-53", "time_this_iter_s": 29.025914430618286, "num_metric_batches_dropped": 0, "episode_reward_min": -553.1495945441534}
{"iterations_since_restore": 148, "info": {"default": {"kl": 0.013659380376338959, "total_loss": 12.990326881408691, "vf_loss": 12.996443748474121, "vf_explained_var": 0.926762580871582, "cur_lr": 0.0005000000237487257, "entropy": 1.3451282978057861, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.011303010396659374}, "num_steps_trained": 5850770, "update_time_ms": 9.733, "num_steps_sampled": 5850770, "sample_time_ms": 18679.961, "load_time_ms": 22.522, "grad_time_ms": 10243.73}, "hostname": "flow-main", "episode_reward_max": -22.170272898616634, "timesteps_this_iter": 37905, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.68732676444506, "cost1_min": 17.95544831331457, "system_level_velocity_mean": 15.070569640119764, "cost2_mean": -90.82715254364814, "cost2_max": -21.028709198540408, "outflow_rate_max": 1454.118599774914, "cost1_mean": 178.7653510333614, "system_level_velocity_min": 11.813804737188512, "system_level_velocity_max": 18.70920410469465, "outflow_rate_min": 440.0050268646629, "cost2_min": -118.74003151990085, "outflow_rate_mean": 1172.4223453602642}, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 5850770, "time_total_s": 4550.720083236694, "timestamp": 1558614443, "time_since_restore": 4550.720083236694, "training_iteration": 148, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845144e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845143c8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6888, "timesteps_total": 5850770, "episode_reward_mean": -425.86613368759345, "episodes_this_iter": 49, "date": "2019-05-23_12-27-23", "time_this_iter_s": 29.42279076576233, "num_metric_batches_dropped": 0, "episode_reward_min": -564.5039720044654}
{"iterations_since_restore": 149, "info": {"default": {"kl": 0.013178521767258644, "total_loss": 14.299421310424805, "vf_loss": 14.306228637695312, "vf_explained_var": 0.9149459004402161, "cur_lr": 0.0005000000237487257, "entropy": 1.291731357574463, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.011811671778559685}, "num_steps_trained": 5887337, "update_time_ms": 9.539, "num_steps_sampled": 5887337, "sample_time_ms": 18663.667, "load_time_ms": 22.108, "grad_time_ms": 10290.924}, "hostname": "flow-main", "episode_reward_max": -22.170272898616634, "timesteps_this_iter": 36567, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.68732676444506, "cost1_min": 17.95544831331457, "system_level_velocity_mean": 15.129342034626987, "cost2_mean": -87.57582055993272, "cost2_max": -19.983182130191135, "outflow_rate_max": 1454.118599774914, "cost1_mean": 175.60175906293088, "system_level_velocity_min": 11.674019057875384, "system_level_velocity_max": 18.70920410469465, "outflow_rate_min": 440.0050268646629, "cost2_min": -118.28859562505903, "outflow_rate_mean": 1152.937859475761}, "episode_len_mean": 314.96, "node_ip": "10.138.0.2", "timesteps_since_restore": 5887337, "time_total_s": 4579.0288717746735, "timestamp": 1558614471, "time_since_restore": 4579.0288717746735, "training_iteration": 149, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845230f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845234a8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6935, "timesteps_total": 5887337, "episode_reward_mean": -414.3734614941791, "episodes_this_iter": 47, "date": "2019-05-23_12-27-51", "time_this_iter_s": 28.308788537979126, "num_metric_batches_dropped": 0, "episode_reward_min": -572.8021965233047}
{"iterations_since_restore": 150, "info": {"default": {"kl": 0.01538228802382946, "total_loss": 17.339860916137695, "vf_loss": 17.34807014465332, "vf_explained_var": 0.9025624990463257, "cur_lr": 0.0005000000237487257, "entropy": 1.2967268228530884, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.014049837365746498}, "num_steps_trained": 5924812, "update_time_ms": 9.551, "num_steps_sampled": 5924812, "sample_time_ms": 18764.108, "load_time_ms": 22.442, "grad_time_ms": 10276.326}, "hostname": "flow-main", "episode_reward_max": -22.174049760999548, "timesteps_this_iter": 37475, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 222.64899905378542, "cost1_min": 18.010541211311864, "system_level_velocity_mean": 15.556845593075847, "cost2_mean": -89.61681208881129, "cost2_max": -19.983182130191135, "outflow_rate_max": 1444.2207409830723, "cost1_mean": 183.1914862221151, "system_level_velocity_min": 11.674019057875384, "system_level_velocity_max": 18.66773494907142, "outflow_rate_min": 462.55509215489616, "cost2_min": -118.28859562505903, "outflow_rate_mean": 1191.556988105285}, "episode_len_mean": 319.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 5924812, "time_total_s": 4609.094546079636, "timestamp": 1558614501, "time_since_restore": 4609.094546079636, "training_iteration": 150, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845239b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 6981, "timesteps_total": 5924812, "episode_reward_mean": -404.74617807653107, "episodes_this_iter": 46, "date": "2019-05-23_12-28-21", "time_this_iter_s": 30.065674304962158, "num_metric_batches_dropped": 0, "episode_reward_min": -572.8021965233047}
{"iterations_since_restore": 151, "info": {"default": {"kl": 0.014636015519499779, "total_loss": 16.392480850219727, "vf_loss": 16.400955200195312, "vf_explained_var": 0.9036352634429932, "cur_lr": 0.0005000000237487257, "entropy": 1.256156086921692, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.014029758051037788}, "num_steps_trained": 5962150, "update_time_ms": 9.277, "num_steps_sampled": 5962150, "sample_time_ms": 18931.86, "load_time_ms": 23.265, "grad_time_ms": 10301.214}, "hostname": "flow-main", "episode_reward_max": -22.174049760999548, "timesteps_this_iter": 37338, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.8044915692279, "cost1_min": 17.968433674051173, "system_level_velocity_mean": 15.671160566155539, "cost2_mean": -88.40411427529423, "cost2_max": -19.983182130191135, "outflow_rate_max": 1451.2075165869894, "cost1_mean": 179.80839422870903, "system_level_velocity_min": 12.212529817162542, "system_level_velocity_max": 18.94171226369753, "outflow_rate_min": 447.40921683303424, "cost2_min": -113.41846012623859, "outflow_rate_mean": 1179.2888925596596}, "episode_len_mean": 312.08, "node_ip": "10.138.0.2", "timesteps_since_restore": 5962150, "time_total_s": 4639.123819112778, "timestamp": 1558614531, "time_since_restore": 4639.123819112778, "training_iteration": 151, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514860>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7029, "timesteps_total": 5962150, "episode_reward_mean": -393.26936683063315, "episodes_this_iter": 48, "date": "2019-05-23_12-28-51", "time_this_iter_s": 30.02927303314209, "num_metric_batches_dropped": 0, "episode_reward_min": -543.3035202346384}
{"iterations_since_restore": 152, "info": {"default": {"kl": 0.015739448368549347, "total_loss": 16.24661636352539, "vf_loss": 16.254173278808594, "vf_explained_var": 0.8964335322380066, "cur_lr": 0.0005000000237487257, "entropy": 1.2916643619537354, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.013532726094126701}, "num_steps_trained": 5998410, "update_time_ms": 9.37, "num_steps_sampled": 5998410, "sample_time_ms": 18950.306, "load_time_ms": 21.989, "grad_time_ms": 10247.218}, "hostname": "flow-main", "episode_reward_max": -22.99894019486553, "timesteps_this_iter": 36260, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.8044915692279, "cost1_min": 17.968433674051173, "system_level_velocity_mean": 15.651942683173024, "cost2_mean": -86.7262160057305, "cost2_max": -20.822450150090567, "outflow_rate_max": 1451.2075165869894, "cost1_mean": 178.94959807142538, "system_level_velocity_min": 12.079332006084233, "system_level_velocity_max": 18.94171226369753, "outflow_rate_min": 447.40921683303424, "cost2_min": -111.72666917029537, "outflow_rate_mean": 1174.5779891935997}, "episode_len_mean": 311.68, "node_ip": "10.138.0.2", "timesteps_since_restore": 5998410, "time_total_s": 4667.6625282764435, "timestamp": 1558614560, "time_since_restore": 4667.6625282764435, "training_iteration": 152, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f048>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7079, "timesteps_total": 5998410, "episode_reward_mean": -388.5106465018891, "episodes_this_iter": 50, "date": "2019-05-23_12-29-20", "time_this_iter_s": 28.53870916366577, "num_metric_batches_dropped": 0, "episode_reward_min": -538.2314539401675}
{"iterations_since_restore": 153, "info": {"default": {"kl": 0.015349983237683773, "total_loss": 16.137903213500977, "vf_loss": 16.14614486694336, "vf_explained_var": 0.8998863697052002, "cur_lr": 0.0005000000237487257, "entropy": 1.2752206325531006, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.014071909710764885}, "num_steps_trained": 6035257, "update_time_ms": 9.579, "num_steps_sampled": 6035257, "sample_time_ms": 18967.454, "load_time_ms": 21.863, "grad_time_ms": 9982.537}, "hostname": "flow-main", "episode_reward_max": -105.16577900799838, "timesteps_this_iter": 36847, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.23654511766904, "cost1_min": 85.43484718350572, "system_level_velocity_mean": 15.491756969450243, "cost2_mean": -88.14941172016638, "cost2_max": -58.2559327054594, "outflow_rate_max": 1445.5726243381969, "cost1_mean": 183.92414936676684, "system_level_velocity_min": 12.079332006084233, "system_level_velocity_max": 18.79191235114057, "outflow_rate_min": 807.46925954695, "cost2_min": -115.7942461967779, "outflow_rate_mean": 1190.4609815330746}, "episode_len_mean": 321.62, "node_ip": "10.138.0.2", "timesteps_since_restore": 6035257, "time_total_s": 4696.098604440689, "timestamp": 1558614588, "time_since_restore": 4696.098604440689, "training_iteration": 153, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845236d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523ef0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7124, "timesteps_total": 6035257, "episode_reward_mean": -401.1085858773708, "episodes_this_iter": 45, "date": "2019-05-23_12-29-48", "time_this_iter_s": 28.436076164245605, "num_metric_batches_dropped": 0, "episode_reward_min": -526.7332146506219}
{"iterations_since_restore": 154, "info": {"default": {"kl": 0.015443751588463783, "total_loss": 13.606562614440918, "vf_loss": 13.614208221435547, "vf_explained_var": 0.917991578578949, "cur_lr": 0.0005000000237487257, "entropy": 1.2840120792388916, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.01350986398756504}, "num_steps_trained": 6071476, "update_time_ms": 8.864, "num_steps_sampled": 6071476, "sample_time_ms": 19003.612, "load_time_ms": 22.902, "grad_time_ms": 10030.152}, "hostname": "flow-main", "episode_reward_max": -103.57706475947566, "timesteps_this_iter": 36219, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.566605910124, "cost1_min": 84.97816711978784, "system_level_velocity_mean": 15.250880974527334, "cost2_mean": -87.12961628857582, "cost2_max": -58.2559327054594, "outflow_rate_max": 1433.5760388110232, "cost1_mean": 182.30974749564865, "system_level_velocity_min": 11.920902206339985, "system_level_velocity_max": 18.7785454270685, "outflow_rate_min": 815.4559272545453, "cost2_min": -115.7942461967779, "outflow_rate_mean": 1176.1007040543557}, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6071476, "time_total_s": 4725.763559341431, "timestamp": 1558614618, "time_since_restore": 4725.763559341431, "training_iteration": 154, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fea58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe470>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7169, "timesteps_total": 6071476, "episode_reward_mean": -406.0989868289516, "episodes_this_iter": 45, "date": "2019-05-23_12-30-18", "time_this_iter_s": 29.664954900741577, "num_metric_batches_dropped": 0, "episode_reward_min": -526.7332146506219}
{"iterations_since_restore": 155, "info": {"default": {"kl": 0.014548493549227715, "total_loss": 16.97784423828125, "vf_loss": 16.985525131225586, "vf_explained_var": 0.8952034711837769, "cur_lr": 0.0005000000237487257, "entropy": 1.2877981662750244, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.013204806484282017}, "num_steps_trained": 6108456, "update_time_ms": 9.004, "num_steps_sampled": 6108456, "sample_time_ms": 18973.186, "load_time_ms": 21.899, "grad_time_ms": 10040.383}, "hostname": "flow-main", "episode_reward_max": -103.57706475947566, "timesteps_this_iter": 36980, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.566605910124, "cost1_min": 84.97816711978784, "system_level_velocity_mean": 15.508991647079686, "cost2_mean": -88.99434939225874, "cost2_max": -58.411241225146355, "outflow_rate_max": 1444.1625623953216, "cost1_mean": 185.10404013691922, "system_level_velocity_min": 11.920902206339985, "system_level_velocity_max": 18.7785454270685, "outflow_rate_min": 815.4559272545453, "cost2_min": -114.07024965258742, "outflow_rate_mean": 1196.2632470358403}, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6108456, "time_total_s": 4754.437918424606, "timestamp": 1558614647, "time_since_restore": 4754.437918424606, "training_iteration": 155, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844feac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844feba8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7217, "timesteps_total": 6108456, "episode_reward_mean": -406.59318234073214, "episodes_this_iter": 48, "date": "2019-05-23_12-30-47", "time_this_iter_s": 28.67435908317566, "num_metric_batches_dropped": 0, "episode_reward_min": -551.7928455330577}
{"iterations_since_restore": 156, "info": {"default": {"kl": 0.01569664292037487, "total_loss": 15.957491874694824, "vf_loss": 15.96489143371582, "vf_explained_var": 0.8991788029670715, "cur_lr": 0.0005000000237487257, "entropy": 1.2735356092453003, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.013361893594264984}, "num_steps_trained": 6144988, "update_time_ms": 8.883, "num_steps_sampled": 6144988, "sample_time_ms": 18925.697, "load_time_ms": 21.065, "grad_time_ms": 10038.072}, "hostname": "flow-main", "episode_reward_max": -95.44912800025345, "timesteps_this_iter": 36532, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.566605910124, "cost1_min": 80.34754733203624, "system_level_velocity_mean": 15.642630279040713, "cost2_mean": -88.81759807019462, "cost2_max": -57.20644839399492, "outflow_rate_max": 1444.1625623953216, "cost1_mean": 186.29665750549322, "system_level_velocity_min": 12.235365696490579, "system_level_velocity_max": 18.69856428038095, "outflow_rate_min": 773.3492757539399, "cost2_min": -114.47541804582951, "outflow_rate_mean": 1203.7458766513946}, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 6144988, "time_total_s": 4783.070560693741, "timestamp": 1558614675, "time_since_restore": 4783.070560693741, "training_iteration": 156, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f0f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7265, "timesteps_total": 6144988, "episode_reward_mean": -403.6985469100516, "episodes_this_iter": 48, "date": "2019-05-23_12-31-15", "time_this_iter_s": 28.63264226913452, "num_metric_batches_dropped": 0, "episode_reward_min": -551.7928455330577}
{"iterations_since_restore": 157, "info": {"default": {"kl": 0.015710031613707542, "total_loss": 14.101909637451172, "vf_loss": 14.109490394592285, "vf_explained_var": 0.9113648533821106, "cur_lr": 0.0005000000237487257, "entropy": 1.3232556581497192, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.013544232584536076}, "num_steps_trained": 6181928, "update_time_ms": 9.171, "num_steps_sampled": 6181928, "sample_time_ms": 18913.5, "load_time_ms": 20.148, "grad_time_ms": 10048.779}, "hostname": "flow-main", "episode_reward_max": -31.611213464094376, "timesteps_this_iter": 36940, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 222.9711183033952, "cost1_min": 25.16474457107923, "system_level_velocity_mean": 15.554401601807424, "cost2_mean": -86.09934249527834, "cost2_max": -26.29172275263639, "outflow_rate_max": 1449.7803132536344, "cost1_mean": 182.5377498791173, "system_level_velocity_min": 12.001767031457387, "system_level_velocity_max": 18.75617335668095, "outflow_rate_min": 484.9268448022705, "cost2_min": -114.47541804582951, "outflow_rate_mean": 1187.8918176639315}, "episode_len_mean": 318.98, "node_ip": "10.138.0.2", "timesteps_since_restore": 6181928, "time_total_s": 4812.0611691474915, "timestamp": 1558614704, "time_since_restore": 4812.0611691474915, "training_iteration": 157, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514c88>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7311, "timesteps_total": 6181928, "episode_reward_mean": -399.2979787571101, "episodes_this_iter": 46, "date": "2019-05-23_12-31-44", "time_this_iter_s": 28.99060845375061, "num_metric_batches_dropped": 0, "episode_reward_min": -546.6652329154786}
{"iterations_since_restore": 158, "info": {"default": {"kl": 0.016016948968172073, "total_loss": 12.586957931518555, "vf_loss": 12.595993995666504, "vf_explained_var": 0.9213972091674805, "cur_lr": 0.0005000000237487257, "entropy": 1.355684757232666, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.015117522329092026}, "num_steps_trained": 6217663, "update_time_ms": 9.124, "num_steps_sampled": 6217663, "sample_time_ms": 18852.318, "load_time_ms": 19.833, "grad_time_ms": 9969.366}, "hostname": "flow-main", "episode_reward_max": -21.93944036021406, "timesteps_this_iter": 35735, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.16074073415135, "cost1_min": 17.863793217199785, "system_level_velocity_mean": 15.415083405477152, "cost2_mean": -82.63870411208772, "cost2_max": -17.37395714297742, "outflow_rate_max": 1449.7803132536344, "cost1_mean": 175.19534085244788, "system_level_velocity_min": 10.99951972891346, "system_level_velocity_max": 18.75617335668095, "outflow_rate_min": 437.2949997643919, "cost2_min": -110.94491127778821, "outflow_rate_mean": 1157.3338852968263}, "episode_len_mean": 310.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 6217663, "time_total_s": 4840.083305597305, "timestamp": 1558614732, "time_since_restore": 4840.083305597305, "training_iteration": 158, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fb38>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7359, "timesteps_total": 6217663, "episode_reward_mean": -388.3553619687729, "episodes_this_iter": 48, "date": "2019-05-23_12-32-12", "time_this_iter_s": 28.022136449813843, "num_metric_batches_dropped": 0, "episode_reward_min": -567.693914342829}
{"iterations_since_restore": 159, "info": {"default": {"kl": 0.017067162320017815, "total_loss": 15.815443992614746, "vf_loss": 15.822708129882812, "vf_explained_var": 0.9091901183128357, "cur_lr": 0.0005000000237487257, "entropy": 1.3717186450958252, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.013743107207119465}, "num_steps_trained": 6253202, "update_time_ms": 9.185, "num_steps_sampled": 6253202, "sample_time_ms": 18846.399, "load_time_ms": 19.638, "grad_time_ms": 9969.58}, "hostname": "flow-main", "episode_reward_max": -21.93944036021406, "timesteps_this_iter": 35539, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.16074073415135, "cost1_min": 17.863793217199785, "system_level_velocity_mean": 15.275421888073199, "cost2_mean": -82.18914404081191, "cost2_max": -17.37395714297742, "outflow_rate_max": 1445.7695439382771, "cost1_mean": 175.29225448493526, "system_level_velocity_min": 10.021757927755203, "system_level_velocity_max": 18.848074239565968, "outflow_rate_min": 437.2949997643919, "cost2_min": -116.70980783634768, "outflow_rate_mean": 1145.305645562671}, "episode_len_mean": 313.09, "node_ip": "10.138.0.2", "timesteps_since_restore": 6253202, "time_total_s": 4868.341976881027, "timestamp": 1558614761, "time_since_restore": 4868.341976881027, "training_iteration": 159, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fad68>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7407, "timesteps_total": 6253202, "episode_reward_mean": -389.27405625884853, "episodes_this_iter": 48, "date": "2019-05-23_12-32-41", "time_this_iter_s": 28.258671283721924, "num_metric_batches_dropped": 0, "episode_reward_min": -575.9820728217736}
{"iterations_since_restore": 160, "info": {"default": {"kl": 0.01415790431201458, "total_loss": 18.692752838134766, "vf_loss": 18.701690673828125, "vf_explained_var": 0.8987494707107544, "cur_lr": 0.0005000000237487257, "entropy": 1.3261611461639404, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.014313606545329094}, "num_steps_trained": 6290170, "update_time_ms": 9.234, "num_steps_sampled": 6290170, "sample_time_ms": 18760.935, "load_time_ms": 18.122, "grad_time_ms": 9959.24}, "hostname": "flow-main", "episode_reward_max": -104.38635128673249, "timesteps_this_iter": 36968, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.95386665275078, "cost1_min": 85.27350023662605, "system_level_velocity_mean": 15.227365617763603, "cost2_mean": -85.98902357253183, "cost2_max": -59.24036179424236, "outflow_rate_max": 1451.3201065562262, "cost1_mean": 180.02553078106433, "system_level_velocity_min": 10.021757927755203, "system_level_velocity_max": 18.848074239565968, "outflow_rate_min": 814.4150657236586, "cost2_min": -116.70980783634768, "outflow_rate_mean": 1168.2894137214726}, "episode_len_mean": 321.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 6290170, "time_total_s": 4897.410664319992, "timestamp": 1558614790, "time_since_restore": 4897.410664319992, "training_iteration": 160, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514630>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7455, "timesteps_total": 6290170, "episode_reward_mean": -404.7126893870667, "episodes_this_iter": 48, "date": "2019-05-23_12-33-10", "time_this_iter_s": 29.068687438964844, "num_metric_batches_dropped": 0, "episode_reward_min": -575.9820728217736}
{"iterations_since_restore": 161, "info": {"default": {"kl": 0.01616080291569233, "total_loss": 16.8845157623291, "vf_loss": 16.891250610351562, "vf_explained_var": 0.9063060879707336, "cur_lr": 0.0005000000237487257, "entropy": 1.2788524627685547, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.012869571335613728}, "num_steps_trained": 6327968, "update_time_ms": 9.324, "num_steps_sampled": 6327968, "sample_time_ms": 18729.239, "load_time_ms": 17.483, "grad_time_ms": 9971.248}, "hostname": "flow-main", "episode_reward_max": -104.38635128673249, "timesteps_this_iter": 37798, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.91925693201838, "cost1_min": 85.27350023662605, "system_level_velocity_mean": 15.478360203164176, "cost2_mean": -91.50094716119031, "cost2_max": -59.24036179424236, "outflow_rate_max": 1451.3201065562262, "cost1_mean": 183.77069436488614, "system_level_velocity_min": 11.027511349529002, "system_level_velocity_max": 18.818665900496967, "outflow_rate_min": 814.4150657236586, "cost2_min": -121.72807716691429, "outflow_rate_mean": 1197.374709388912}, "episode_len_mean": 321.93, "node_ip": "10.138.0.2", "timesteps_since_restore": 6327968, "time_total_s": 4927.224840641022, "timestamp": 1558614820, "time_since_restore": 4927.224840641022, "training_iteration": 161, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8451df60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8451d710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8451d748>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7500, "timesteps_total": 6327968, "episode_reward_mean": -410.2594329347524, "episodes_this_iter": 45, "date": "2019-05-23_12-33-40", "time_this_iter_s": 29.814176321029663, "num_metric_batches_dropped": 0, "episode_reward_min": -612.2541408572515}
{"iterations_since_restore": 162, "info": {"default": {"kl": 0.01571669429540634, "total_loss": 17.32703399658203, "vf_loss": 17.33859634399414, "vf_explained_var": 0.9004538059234619, "cur_lr": 0.0005000000237487257, "entropy": 1.3136361837387085, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.017527885735034943}, "num_steps_trained": 6364924, "update_time_ms": 9.192, "num_steps_sampled": 6364924, "sample_time_ms": 18824.488, "load_time_ms": 17.359, "grad_time_ms": 10013.158}, "hostname": "flow-main", "episode_reward_max": -105.76102271852011, "timesteps_this_iter": 36956, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.38283340609644, "cost1_min": 86.38920282705418, "system_level_velocity_mean": 15.520678071890375, "cost2_mean": -95.05975655598476, "cost2_max": -56.3907029834709, "outflow_rate_max": 1453.7180359378178, "cost1_mean": 184.61982386643842, "system_level_velocity_min": 11.797277192266272, "system_level_velocity_max": 18.81235091333525, "outflow_rate_min": 816.6505288971927, "cost2_min": -121.72807716691429, "outflow_rate_mean": 1206.170257016705}, "episode_len_mean": 321.95, "node_ip": "10.138.0.2", "timesteps_since_restore": 6364924, "time_total_s": 4957.1569221019745, "timestamp": 1558614850, "time_since_restore": 4957.1569221019745, "training_iteration": 162, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f5f8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7546, "timesteps_total": 6364924, "episode_reward_mean": -418.02588347620616, "episodes_this_iter": 46, "date": "2019-05-23_12-34-10", "time_this_iter_s": 29.93208146095276, "num_metric_batches_dropped": 0, "episode_reward_min": -612.2541408572515}
{"iterations_since_restore": 163, "info": {"default": {"kl": 0.015627339482307434, "total_loss": 19.873119354248047, "vf_loss": 19.878637313842773, "vf_explained_var": 0.8842887282371521, "cur_lr": 0.0005000000237487257, "entropy": 1.3415756225585938, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.01145136822015047}, "num_steps_trained": 6403429, "update_time_ms": 9.081, "num_steps_sampled": 6403429, "sample_time_ms": 18949.188, "load_time_ms": 17.575, "grad_time_ms": 10081.888}, "hostname": "flow-main", "episode_reward_max": -105.76102271852011, "timesteps_this_iter": 38505, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.38283340609644, "cost1_min": 86.38920282705418, "system_level_velocity_mean": 15.452863199433157, "cost2_mean": -95.98708027548614, "cost2_max": -54.2323848103207, "outflow_rate_max": 1453.7180359378178, "cost1_mean": 184.12408395136055, "system_level_velocity_min": 11.797277192266272, "system_level_velocity_max": 18.81235091333525, "outflow_rate_min": 816.6505288971927, "cost2_min": -119.34893742901781, "outflow_rate_mean": 1204.391979372429}, "episode_len_mean": 321.95, "node_ip": "10.138.0.2", "timesteps_since_restore": 6403429, "time_total_s": 4987.557870388031, "timestamp": 1558614880, "time_since_restore": 4987.557870388031, "training_iteration": 163, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fa20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f0f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7595, "timesteps_total": 6403429, "episode_reward_mean": -422.45956886898216, "episodes_this_iter": 49, "date": "2019-05-23_12-34-40", "time_this_iter_s": 30.40094828605652, "num_metric_batches_dropped": 0, "episode_reward_min": -639.6570030909652}
{"iterations_since_restore": 164, "info": {"default": {"kl": 0.014508933760225773, "total_loss": 16.183042526245117, "vf_loss": 16.190990447998047, "vf_explained_var": 0.9064318537712097, "cur_lr": 0.0005000000237487257, "entropy": 1.3436613082885742, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.013456353917717934}, "num_steps_trained": 6441117, "update_time_ms": 9.153, "num_steps_sampled": 6441117, "sample_time_ms": 18838.23, "load_time_ms": 16.265, "grad_time_ms": 10082.021}, "hostname": "flow-main", "episode_reward_max": -105.76102271852011, "timesteps_this_iter": 37688, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.72521241992231, "cost1_min": 86.38920282705418, "system_level_velocity_mean": 15.273930923869711, "cost2_mean": -95.00738114606216, "cost2_max": -54.2323848103207, "outflow_rate_max": 1460.9354267697618, "cost1_mean": 182.5119823223384, "system_level_velocity_min": 11.427875445586396, "system_level_velocity_max": 18.770067592993062, "outflow_rate_min": 816.6505288971927, "cost2_min": -117.25328824539407, "outflow_rate_mean": 1195.1027432656663}, "episode_len_mean": 323.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 6441117, "time_total_s": 5016.081925153732, "timestamp": 1558614909, "time_since_restore": 5016.081925153732, "training_iteration": 164, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844feac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe6a0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7638, "timesteps_total": 6441117, "episode_reward_mean": -433.2382674308704, "episodes_this_iter": 43, "date": "2019-05-23_12-35-09", "time_this_iter_s": 28.524054765701294, "num_metric_batches_dropped": 0, "episode_reward_min": -682.5881417605935}
{"iterations_since_restore": 165, "info": {"default": {"kl": 0.01619664765894413, "total_loss": 19.81548500061035, "vf_loss": 19.821521759033203, "vf_explained_var": 0.8917427659034729, "cur_lr": 0.0005000000237487257, "entropy": 1.336401104927063, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.01218715775758028}, "num_steps_trained": 6479665, "update_time_ms": 9.042, "num_steps_sampled": 6479665, "sample_time_ms": 18955.142, "load_time_ms": 16.224, "grad_time_ms": 10219.092}, "hostname": "flow-main", "episode_reward_max": -250.7838078394336, "timesteps_this_iter": 38548, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.8497139617507, "cost1_min": 126.28975022167768, "system_level_velocity_mean": 15.270321031965798, "cost2_mean": -95.89284866362323, "cost2_max": -54.2323848103207, "outflow_rate_max": 1460.9354267697618, "cost1_mean": 183.53720294158038, "system_level_velocity_min": 10.420054587534594, "system_level_velocity_max": 18.940777708731677, "outflow_rate_min": 904.1022728438013, "cost2_min": -122.46822361748934, "outflow_rate_mean": 1201.1863688170267}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6479665, "time_total_s": 5047.291577100754, "timestamp": 1558614940, "time_since_restore": 5047.291577100754, "training_iteration": 165, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8451d160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8451d588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8451d198>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7684, "timesteps_total": 6479665, "episode_reward_mean": -435.08192202363006, "episodes_this_iter": 46, "date": "2019-05-23_12-35-40", "time_this_iter_s": 31.209651947021484, "num_metric_batches_dropped": 0, "episode_reward_min": -682.5881417605935}
{"iterations_since_restore": 166, "info": {"default": {"kl": 0.015596059150993824, "total_loss": 20.255481719970703, "vf_loss": 20.26214027404785, "vf_explained_var": 0.8901646137237549, "cur_lr": 0.0005000000237487257, "entropy": 1.3385885953903198, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.012579835951328278}, "num_steps_trained": 6516946, "update_time_ms": 8.94, "num_steps_sampled": 6516946, "sample_time_ms": 18965.809, "load_time_ms": 17.389, "grad_time_ms": 10273.264}, "hostname": "flow-main", "episode_reward_max": -106.73174482016441, "timesteps_this_iter": 37281, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.8497139617507, "cost1_min": 87.3268621419085, "system_level_velocity_mean": 15.387637955001345, "cost2_mean": -98.75381985743343, "cost2_max": -60.45469897476684, "outflow_rate_max": 1466.657093632175, "cost1_mean": 183.55087972880582, "system_level_velocity_min": 10.420054587534594, "system_level_velocity_max": 18.940777708731677, "outflow_rate_min": 821.0089678122724, "cost2_min": -122.46822361748934, "outflow_rate_mean": 1203.8808148936944}, "episode_len_mean": 323.03, "node_ip": "10.138.0.2", "timesteps_since_restore": 6516946, "time_total_s": 5076.572086572647, "timestamp": 1558614969, "time_since_restore": 5076.572086572647, "training_iteration": 166, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450f9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8450fcf8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7731, "timesteps_total": 6516946, "episode_reward_mean": -434.5432888859976, "episodes_this_iter": 47, "date": "2019-05-23_12-36-09", "time_this_iter_s": 29.28050947189331, "num_metric_batches_dropped": 0, "episode_reward_min": -682.5881417605935}
{"iterations_since_restore": 167, "info": {"default": {"kl": 0.013964141719043255, "total_loss": 17.291507720947266, "vf_loss": 17.29690170288086, "vf_explained_var": 0.9061393737792969, "cur_lr": 0.0005000000237487257, "entropy": 1.324670672416687, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.010697094723582268}, "num_steps_trained": 6555908, "update_time_ms": 8.801, "num_steps_sampled": 6555908, "sample_time_ms": 19048.128, "load_time_ms": 18.631, "grad_time_ms": 10344.342}, "hostname": "flow-main", "episode_reward_max": -106.73174482016441, "timesteps_this_iter": 38962, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.59303062503773, "cost1_min": 87.3268621419085, "system_level_velocity_mean": 15.266581760193851, "cost2_mean": -98.2400835906785, "cost2_max": -55.43643427754493, "outflow_rate_max": 1466.657093632175, "cost1_mean": 182.33774165443268, "system_level_velocity_min": 11.407803394440803, "system_level_velocity_max": 18.7724002898816, "outflow_rate_min": 821.0089678122724, "cost2_min": -118.99843725562522, "outflow_rate_mean": 1193.493871892245}, "episode_len_mean": 323.03, "node_ip": "10.138.0.2", "timesteps_since_restore": 6555908, "time_total_s": 5107.131423950195, "timestamp": 1558615000, "time_since_restore": 5107.131423950195, "training_iteration": 167, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8467ae10>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7779, "timesteps_total": 6555908, "episode_reward_mean": -439.09828446690926, "episodes_this_iter": 48, "date": "2019-05-23_12-36-40", "time_this_iter_s": 30.559337377548218, "num_metric_batches_dropped": 0, "episode_reward_min": -656.2462178298047}
{"iterations_since_restore": 168, "info": {"default": {"kl": 0.01581018976867199, "total_loss": 20.27996826171875, "vf_loss": 20.287508010864258, "vf_explained_var": 0.8863853812217712, "cur_lr": 0.0005000000237487257, "entropy": 1.2321522235870361, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.013541165739297867}, "num_steps_trained": 6594543, "update_time_ms": 9.052, "num_steps_sampled": 6594543, "sample_time_ms": 19030.074, "load_time_ms": 18.61, "grad_time_ms": 10515.99}, "hostname": "flow-main", "episode_reward_max": -221.22344918826187, "timesteps_this_iter": 38635, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.16169823033587, "cost1_min": 137.00879822774186, "system_level_velocity_mean": 15.236730057135736, "cost2_mean": -100.34082189109051, "cost2_max": -55.43643427754493, "outflow_rate_max": 1463.458448781235, "cost1_mean": 183.6751064715824, "system_level_velocity_min": 11.407803394440803, "system_level_velocity_max": 18.79190465887545, "outflow_rate_min": 916.4558532110091, "cost2_min": -122.93502696112043, "outflow_rate_mean": 1207.3510187763766}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6594543, "time_total_s": 5136.672974348068, "timestamp": 1558615029, "time_since_restore": 5136.672974348068, "training_iteration": 168, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faa90>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7824, "timesteps_total": 6594543, "episode_reward_mean": -446.10262040004704, "episodes_this_iter": 45, "date": "2019-05-23_12-37-09", "time_this_iter_s": 29.541550397872925, "num_metric_batches_dropped": 0, "episode_reward_min": -714.8201601682314}
{"iterations_since_restore": 169, "info": {"default": {"kl": 0.01596708409488201, "total_loss": 19.662845611572266, "vf_loss": 19.669475555419922, "vf_explained_var": 0.884710967540741, "cur_lr": 0.0005000000237487257, "entropy": 1.229089379310608, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.012691070325672626}, "num_steps_trained": 6632581, "update_time_ms": 9.022, "num_steps_sampled": 6632581, "sample_time_ms": 18970.277, "load_time_ms": 18.836, "grad_time_ms": 10610.531}, "hostname": "flow-main", "episode_reward_max": -262.2313725804975, "timesteps_this_iter": 38038, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.4924574106572, "cost1_min": 137.00879822774186, "system_level_velocity_mean": 15.453140845624453, "cost2_mean": -101.71213051423553, "cost2_max": -59.58207730696247, "outflow_rate_max": 1467.383123963341, "cost1_mean": 186.24151558251364, "system_level_velocity_min": 11.407803394440803, "system_level_velocity_max": 19.011106215682673, "outflow_rate_min": 923.9514049586779, "cost2_min": -125.3922991705787, "outflow_rate_mean": 1221.8630953922466}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6632581, "time_total_s": 5165.273316860199, "timestamp": 1558615058, "time_since_restore": 5165.273316860199, "training_iteration": 169, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845236d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8456a8d0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7870, "timesteps_total": 6632581, "episode_reward_mean": -435.00555149190075, "episodes_this_iter": 46, "date": "2019-05-23_12-37-38", "time_this_iter_s": 28.600342512130737, "num_metric_batches_dropped": 0, "episode_reward_min": -714.8201601682314}
{"iterations_since_restore": 170, "info": {"default": {"kl": 0.015324579551815987, "total_loss": 15.832048416137695, "vf_loss": 15.84105396270752, "vf_explained_var": 0.9043466448783875, "cur_lr": 0.0005000000237487257, "entropy": 1.301947832107544, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.014825784601271152}, "num_steps_trained": 6669969, "update_time_ms": 9.096, "num_steps_sampled": 6669969, "sample_time_ms": 18784.181, "load_time_ms": 19.168, "grad_time_ms": 10616.116}, "hostname": "flow-main", "episode_reward_max": -30.590016900132824, "timesteps_this_iter": 37388, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.4924574106572, "cost1_min": 24.587339700982273, "system_level_velocity_mean": 15.61648575097479, "cost2_mean": -99.13430873180023, "cost2_max": -26.357485961942185, "outflow_rate_max": 1467.383123963341, "cost1_mean": 186.1113582426666, "system_level_velocity_min": 11.513669553093305, "system_level_velocity_max": 19.011106215682673, "outflow_rate_min": 480.33720946980384, "cost2_min": -125.3922991705787, "outflow_rate_mean": 1215.2733000934513}, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 6669969, "time_total_s": 5192.544598340988, "timestamp": 1558615085, "time_since_restore": 5192.544598340988, "training_iteration": 170, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514470>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7919, "timesteps_total": 6669969, "episode_reward_mean": -416.11051706901293, "episodes_this_iter": 49, "date": "2019-05-23_12-38-05", "time_this_iter_s": 27.271281480789185, "num_metric_batches_dropped": 0, "episode_reward_min": -631.8597368814346}
{"iterations_since_restore": 171, "info": {"default": {"kl": 0.016598215326666832, "total_loss": 15.297704696655273, "vf_loss": 15.303291320800781, "vf_explained_var": 0.9059876203536987, "cur_lr": 0.0005000000237487257, "entropy": 1.2915788888931274, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.011888595297932625}, "num_steps_trained": 6707567, "update_time_ms": 9.156, "num_steps_sampled": 6707567, "sample_time_ms": 18663.034, "load_time_ms": 18.959, "grad_time_ms": 10368.705}, "hostname": "flow-main", "episode_reward_max": -30.590016900132824, "timesteps_this_iter": 37598, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.2730668741662, "cost1_min": 24.587339700982273, "system_level_velocity_mean": 15.385169730085407, "cost2_mean": -95.67391330950582, "cost2_max": -26.357485961942185, "outflow_rate_max": 1467.0342181951053, "cost1_mean": 183.25093046430092, "system_level_velocity_min": 12.084018988220238, "system_level_velocity_max": 18.933790302986285, "outflow_rate_min": 480.33720946980384, "cost2_min": -123.02534720103759, "outflow_rate_mean": 1196.308682488956}, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 6707567, "time_total_s": 5218.6666967868805, "timestamp": 1558615111, "time_since_restore": 5218.6666967868805, "training_iteration": 171, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501080>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 7963, "timesteps_total": 6707567, "episode_reward_mean": -418.7733026957005, "episodes_this_iter": 44, "date": "2019-05-23_12-38-31", "time_this_iter_s": 26.122098445892334, "num_metric_batches_dropped": 0, "episode_reward_min": -619.3428183900056}
{"iterations_since_restore": 172, "info": {"default": {"kl": 0.015880819410085678, "total_loss": 18.50293731689453, "vf_loss": 18.511215209960938, "vf_explained_var": 0.8909379839897156, "cur_lr": 0.0005000000237487257, "entropy": 1.3527392148971558, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.014307999983429909}, "num_steps_trained": 6745693, "update_time_ms": 9.171, "num_steps_sampled": 6745693, "sample_time_ms": 18548.467, "load_time_ms": 20.352, "grad_time_ms": 10244.1}, "hostname": "flow-main", "episode_reward_max": -30.515185409547872, "timesteps_this_iter": 38126, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.2730668741662, "cost1_min": 24.637704143049937, "system_level_velocity_mean": 15.21557459435243, "cost2_mean": -94.54085996909934, "cost2_max": -26.707222536016193, "outflow_rate_max": 1467.0480987194699, "cost1_mean": 179.03862748042923, "system_level_velocity_min": 11.668962099288413, "system_level_velocity_max": 18.972899569353093, "outflow_rate_min": 477.1055332935651, "cost2_min": -123.02534720103759, "outflow_rate_mean": 1180.9934238888359}, "episode_len_mean": 318.86, "node_ip": "10.138.0.2", "timesteps_since_restore": 6745693, "time_total_s": 5246.1957931518555, "timestamp": 1558615139, "time_since_restore": 5246.1957931518555, "training_iteration": 172, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844feef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faa90>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8011, "timesteps_total": 6745693, "episode_reward_mean": -428.1105987233375, "episodes_this_iter": 48, "date": "2019-05-23_12-38-59", "time_this_iter_s": 27.529096364974976, "num_metric_batches_dropped": 0, "episode_reward_min": -661.2527329498325}
{"iterations_since_restore": 173, "info": {"default": {"kl": 0.016314638778567314, "total_loss": 15.46374225616455, "vf_loss": 15.471983909606934, "vf_explained_var": 0.9105416536331177, "cur_lr": 0.0005000000237487257, "entropy": 1.3544700145721436, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.014436863362789154}, "num_steps_trained": 6782786, "update_time_ms": 9.056, "num_steps_sampled": 6782786, "sample_time_ms": 18341.915, "load_time_ms": 20.711, "grad_time_ms": 10219.056}, "hostname": "flow-main", "episode_reward_max": -30.515185409547872, "timesteps_this_iter": 37093, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.3344562659866, "cost1_min": 24.637704143049937, "system_level_velocity_mean": 15.09123286508803, "cost2_mean": -94.29756261532161, "cost2_max": -26.707222536016193, "outflow_rate_max": 1468.6111796668154, "cost1_mean": 177.58359940810388, "system_level_velocity_min": 11.532257494050636, "system_level_velocity_max": 18.972899569353093, "outflow_rate_min": 477.1055332935651, "cost2_min": -118.80358437522264, "outflow_rate_mean": 1172.2000741077002}, "episode_len_mean": 318.86, "node_ip": "10.138.0.2", "timesteps_since_restore": 6782786, "time_total_s": 5274.256067991257, "timestamp": 1558615167, "time_since_restore": 5274.256067991257, "training_iteration": 173, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845412e8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8059, "timesteps_total": 6782786, "episode_reward_mean": -427.0083033236564, "episodes_this_iter": 48, "date": "2019-05-23_12-39-27", "time_this_iter_s": 28.060274839401245, "num_metric_batches_dropped": 0, "episode_reward_min": -661.2527329498325}
{"iterations_since_restore": 174, "info": {"default": {"kl": 0.014461283572018147, "total_loss": 17.817354202270508, "vf_loss": 17.824939727783203, "vf_explained_var": 0.8973948955535889, "cur_lr": 0.0005000000237487257, "entropy": 1.2941416501998901, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.013075043447315693}, "num_steps_trained": 6820534, "update_time_ms": 9.017, "num_steps_sampled": 6820534, "sample_time_ms": 18211.229, "load_time_ms": 20.813, "grad_time_ms": 10109.966}, "hostname": "flow-main", "episode_reward_max": -265.91221682033733, "timesteps_this_iter": 37748, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.3344562659866, "cost1_min": 138.21858783308645, "system_level_velocity_mean": 15.117466106892069, "cost2_mean": -96.22223656651852, "cost2_max": -61.302978287344196, "outflow_rate_max": 1468.6111796668154, "cost1_mean": 182.0605813425704, "system_level_velocity_min": 11.532257494050636, "system_level_velocity_max": 18.938579023673196, "outflow_rate_min": 902.3707081218273, "cost2_min": -120.97638681016136, "outflow_rate_mean": 1192.3258614229107}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6820534, "time_total_s": 5300.382361650467, "timestamp": 1558615193, "time_since_restore": 5300.382361650467, "training_iteration": 174, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fad68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fab00>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8104, "timesteps_total": 6820534, "episode_reward_mean": -429.81164705754776, "episodes_this_iter": 45, "date": "2019-05-23_12-39-53", "time_this_iter_s": 26.126293659210205, "num_metric_batches_dropped": 0, "episode_reward_min": -661.2527329498325}
{"iterations_since_restore": 175, "info": {"default": {"kl": 0.01564384065568447, "total_loss": 15.625178337097168, "vf_loss": 15.63240909576416, "vf_explained_var": 0.9106621742248535, "cur_lr": 0.0005000000237487257, "entropy": 1.3262194395065308, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.013172361999750137}, "num_steps_trained": 6858725, "update_time_ms": 8.799, "num_steps_sampled": 6858725, "sample_time_ms": 17926.625, "load_time_ms": 22.255, "grad_time_ms": 10122.358}, "hostname": "flow-main", "episode_reward_max": -268.66998827856077, "timesteps_this_iter": 38191, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.36884946846072, "cost1_min": 143.9746459635082, "system_level_velocity_mean": 15.34258113035577, "cost2_mean": -98.52052591999728, "cost2_max": -65.68792956882406, "outflow_rate_max": 1464.4542364893177, "cost1_mean": 184.91533514526054, "system_level_velocity_min": 11.848688565087075, "system_level_velocity_max": 18.860554123224944, "outflow_rate_min": 954.3359999999997, "cost2_min": -120.97638681016136, "outflow_rate_mean": 1215.2563111935344}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6858725, "time_total_s": 5328.881422758102, "timestamp": 1558615222, "time_since_restore": 5328.881422758102, "training_iteration": 175, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faeb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844faa90>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8150, "timesteps_total": 6858725, "episode_reward_mean": -432.8596358834841, "episodes_this_iter": 46, "date": "2019-05-23_12-40-22", "time_this_iter_s": 28.499061107635498, "num_metric_batches_dropped": 0, "episode_reward_min": -626.1641613267291}
{"iterations_since_restore": 176, "info": {"default": {"kl": 0.015901600942015648, "total_loss": 17.20249366760254, "vf_loss": 17.208372116088867, "vf_explained_var": 0.903224527835846, "cur_lr": 0.0005000000237487257, "entropy": 1.354064702987671, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.01191649492830038}, "num_steps_trained": 6896570, "update_time_ms": 8.822, "num_steps_sampled": 6896570, "sample_time_ms": 17824.598, "load_time_ms": 22.579, "grad_time_ms": 10187.752}, "hostname": "flow-main", "episode_reward_max": -268.66998827856077, "timesteps_this_iter": 37845, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.3638640445998, "cost1_min": 142.18116280713653, "system_level_velocity_mean": 15.353191547813278, "cost2_mean": -97.28245827468213, "cost2_max": -67.61592709182521, "outflow_rate_max": 1464.9629592103302, "cost1_mean": 184.9467191830444, "system_level_velocity_min": 11.798578449404797, "system_level_velocity_max": 18.860554123224944, "outflow_rate_min": 1007.5799215686275, "cost2_min": -120.96740923233244, "outflow_rate_mean": 1216.6980141304841}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6896570, "time_total_s": 5357.804173946381, "timestamp": 1558615251, "time_since_restore": 5357.804173946381, "training_iteration": 176, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849066d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906860>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8198, "timesteps_total": 6896570, "episode_reward_mean": -432.6348167091414, "episodes_this_iter": 48, "date": "2019-05-23_12-40-51", "time_this_iter_s": 28.9227511882782, "num_metric_batches_dropped": 0, "episode_reward_min": -623.6181927773293}
{"iterations_since_restore": 177, "info": {"default": {"kl": 0.014464721083641052, "total_loss": 16.571413040161133, "vf_loss": 16.579158782958984, "vf_explained_var": 0.8977648615837097, "cur_lr": 0.0005000000237487257, "entropy": 1.2840722799301147, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.013239813037216663}, "num_steps_trained": 6933888, "update_time_ms": 8.961, "num_steps_sampled": 6933888, "sample_time_ms": 17519.187, "load_time_ms": 22.609, "grad_time_ms": 10135.382}, "hostname": "flow-main", "episode_reward_max": -243.086092510441, "timesteps_this_iter": 37318, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.11416776544942, "cost1_min": 142.18116280713653, "system_level_velocity_mean": 15.482931420471475, "cost2_mean": -96.40661499167344, "cost2_max": -62.11766171109857, "outflow_rate_max": 1464.9629592103302, "cost1_mean": 186.35313949350058, "system_level_velocity_min": 11.798578449404797, "system_level_velocity_max": 18.781818623712464, "outflow_rate_min": 930.6042173931282, "cost2_min": -120.96740923233244, "outflow_rate_mean": 1216.0113546707987}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6933888, "time_total_s": 5384.775456190109, "timestamp": 1558615278, "time_since_restore": 5384.775456190109, "training_iteration": 177, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523940>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8242, "timesteps_total": 6933888, "episode_reward_mean": -421.9126749178873, "episodes_this_iter": 44, "date": "2019-05-23_12-41-18", "time_this_iter_s": 26.971282243728638, "num_metric_batches_dropped": 0, "episode_reward_min": -595.6788109196117}
{"iterations_since_restore": 178, "info": {"default": {"kl": 0.016364190727472305, "total_loss": 18.54848289489746, "vf_loss": 18.55640983581543, "vf_explained_var": 0.8877029418945312, "cur_lr": 0.0005000000237487257, "entropy": 1.384759783744812, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.014137313701212406}, "num_steps_trained": 6971772, "update_time_ms": 8.685, "num_steps_sampled": 6971772, "sample_time_ms": 17473.52, "load_time_ms": 21.492, "grad_time_ms": 9943.016}, "hostname": "flow-main", "episode_reward_max": -179.38466477334833, "timesteps_this_iter": 37884, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 222.9774130945483, "cost1_min": 131.7659076644773, "system_level_velocity_mean": 15.241675573755117, "cost2_mean": -95.0768071440716, "cost2_max": -60.31967855201944, "outflow_rate_max": 1455.6945978831936, "cost1_mean": 182.61839015928285, "system_level_velocity_min": 11.080362141484754, "system_level_velocity_max": 18.8934044907428, "outflow_rate_min": 909.2169871653273, "cost2_min": -120.4407276862271, "outflow_rate_mean": 1192.5977291779388}, "episode_len_mean": 323.7, "node_ip": "10.138.0.2", "timesteps_since_restore": 6971772, "time_total_s": 5411.935268878937, "timestamp": 1558615305, "time_since_restore": 5411.935268878937, "training_iteration": 178, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845087f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508d68>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8287, "timesteps_total": 6971772, "episode_reward_mean": -429.02877281016663, "episodes_this_iter": 45, "date": "2019-05-23_12-41-45", "time_this_iter_s": 27.159812688827515, "num_metric_batches_dropped": 0, "episode_reward_min": -645.3415788159685}
{"iterations_since_restore": 179, "info": {"default": {"kl": 0.016710331663489342, "total_loss": 19.638042449951172, "vf_loss": 19.645551681518555, "vf_explained_var": 0.8794224858283997, "cur_lr": 0.0005000000237487257, "entropy": 1.335196614265442, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.01385472621768713}, "num_steps_trained": 7008853, "update_time_ms": 8.9, "num_steps_sampled": 7008853, "sample_time_ms": 17545.324, "load_time_ms": 21.635, "grad_time_ms": 9803.207}, "hostname": "flow-main", "episode_reward_max": -169.50775322866494, "timesteps_this_iter": 37081, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.2297099960379, "cost1_min": 131.7659076644773, "system_level_velocity_mean": 15.554792402745731, "cost2_mean": -97.41078100300585, "cost2_max": -52.778054894753296, "outflow_rate_max": 1453.6500565300419, "cost1_mean": 185.48209545284897, "system_level_velocity_min": 11.080362141484754, "system_level_velocity_max": 18.8934044907428, "outflow_rate_min": 909.2169871653273, "cost2_min": -118.4667679179806, "outflow_rate_mean": 1211.3702342402526}, "episode_len_mean": 322.52, "node_ip": "10.138.0.2", "timesteps_since_restore": 7008853, "time_total_s": 5439.854609012604, "timestamp": 1558615333, "time_since_restore": 5439.854609012604, "training_iteration": 179, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523a20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8334, "timesteps_total": 7008853, "episode_reward_mean": -422.3656832122187, "episodes_this_iter": 47, "date": "2019-05-23_12-42-13", "time_this_iter_s": 27.919340133666992, "num_metric_batches_dropped": 0, "episode_reward_min": -645.3415788159685}
{"iterations_since_restore": 180, "info": {"default": {"kl": 0.014711343683302402, "total_loss": 18.094839096069336, "vf_loss": 18.102638244628906, "vf_explained_var": 0.892388105392456, "cur_lr": 0.0005000000237487257, "entropy": 1.3766409158706665, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.013383474200963974}, "num_steps_trained": 7045508, "update_time_ms": 8.797, "num_steps_sampled": 7045508, "sample_time_ms": 17631.141, "load_time_ms": 22.545, "grad_time_ms": 9740.889}, "hostname": "flow-main", "episode_reward_max": -169.50775322866494, "timesteps_this_iter": 36655, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.18908563247845, "cost1_min": 139.20994671571015, "system_level_velocity_mean": 15.586853372401333, "cost2_mean": -95.04982118046466, "cost2_max": -52.778054894753296, "outflow_rate_max": 1461.3178483768081, "cost1_mean": 186.62045999876747, "system_level_velocity_min": 11.665053068335563, "system_level_velocity_max": 18.798487988999607, "outflow_rate_min": 899.5605619834708, "cost2_min": -118.4667679179806, "outflow_rate_mean": 1208.362863170511}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 7045508, "time_total_s": 5467.376271486282, "timestamp": 1558615360, "time_since_restore": 5467.376271486282, "training_iteration": 180, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849066a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906588>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8382, "timesteps_total": 7045508, "episode_reward_mean": -411.2020677344974, "episodes_this_iter": 48, "date": "2019-05-23_12-42-40", "time_this_iter_s": 27.52166247367859, "num_metric_batches_dropped": 0, "episode_reward_min": -568.2831121158295}
{"iterations_since_restore": 181, "info": {"default": {"kl": 0.01637308858335018, "total_loss": 17.176834106445312, "vf_loss": 17.183290481567383, "vf_explained_var": 0.8944650292396545, "cur_lr": 0.0005000000237487257, "entropy": 1.2807121276855469, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.012673094868659973}, "num_steps_trained": 7083294, "update_time_ms": 8.753, "num_steps_sampled": 7083294, "sample_time_ms": 17533.704, "load_time_ms": 22.997, "grad_time_ms": 9905.976}, "hostname": "flow-main", "episode_reward_max": -177.1004040818013, "timesteps_this_iter": 37786, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.18908563247845, "cost1_min": 135.05944852344822, "system_level_velocity_mean": 15.647320109324378, "cost2_mean": -95.76867009722218, "cost2_max": -55.14790352284994, "outflow_rate_max": 1461.3178483768081, "cost1_mean": 187.69317078234445, "system_level_velocity_min": 11.183654573248404, "system_level_velocity_max": 18.813927894529737, "outflow_rate_min": 899.5605619834708, "cost2_min": -118.668185011283, "outflow_rate_mean": 1218.151497340689}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 7083294, "time_total_s": 5494.182904243469, "timestamp": 1558615387, "time_since_restore": 5494.182904243469, "training_iteration": 181, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468d908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468db38>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8427, "timesteps_total": 7083294, "episode_reward_mean": -406.9640116490121, "episodes_this_iter": 45, "date": "2019-05-23_12-43-07", "time_this_iter_s": 26.80663275718689, "num_metric_batches_dropped": 0, "episode_reward_min": -622.1209616127136}
{"iterations_since_restore": 182, "info": {"default": {"kl": 0.015579702332615852, "total_loss": 21.12330436706543, "vf_loss": 21.129831314086914, "vf_explained_var": 0.8741176128387451, "cur_lr": 0.0005000000237487257, "entropy": 1.3122344017028809, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.012441685423254967}, "num_steps_trained": 7120884, "update_time_ms": 8.688, "num_steps_sampled": 7120884, "sample_time_ms": 17362.21, "load_time_ms": 23.009, "grad_time_ms": 9993.226}, "hostname": "flow-main", "episode_reward_max": -170.16250347974557, "timesteps_this_iter": 37590, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.78010326300463, "cost1_min": 131.7536386641327, "system_level_velocity_mean": 15.489850522461161, "cost2_mean": -96.41212170755543, "cost2_max": -55.14790352284994, "outflow_rate_max": 1462.6998008849944, "cost1_mean": 184.26125790121344, "system_level_velocity_min": 11.15762761473071, "system_level_velocity_max": 18.88412291016147, "outflow_rate_min": 899.5605619834708, "cost2_min": -118.71205760316687, "outflow_rate_mean": 1207.046481137516}, "episode_len_mean": 321.46, "node_ip": "10.138.0.2", "timesteps_since_restore": 7120884, "time_total_s": 5520.887145042419, "timestamp": 1558615414, "time_since_restore": 5520.887145042419, "training_iteration": 182, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fad68>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8475, "timesteps_total": 7120884, "episode_reward_mean": -415.1801325381385, "episodes_this_iter": 48, "date": "2019-05-23_12-43-34", "time_this_iter_s": 26.704240798950195, "num_metric_batches_dropped": 0, "episode_reward_min": -622.1209616127136}
{"iterations_since_restore": 183, "info": {"default": {"kl": 0.015031570568680763, "total_loss": 17.997703552246094, "vf_loss": 18.005115509033203, "vf_explained_var": 0.8940373063087463, "cur_lr": 0.0005000000237487257, "entropy": 1.3475494384765625, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.013121643103659153}, "num_steps_trained": 7159478, "update_time_ms": 8.824, "num_steps_sampled": 7159478, "sample_time_ms": 17272.822, "load_time_ms": 22.741, "grad_time_ms": 10215.411}, "hostname": "flow-main", "episode_reward_max": -170.16250347974557, "timesteps_this_iter": 38594, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.78010326300463, "cost1_min": 131.7536386641327, "system_level_velocity_mean": 15.40396694709833, "cost2_mean": -98.2300555995126, "cost2_max": -59.927575871677604, "outflow_rate_max": 1462.6998008849944, "cost1_mean": 183.83551498076613, "system_level_velocity_min": 11.15762761473071, "system_level_velocity_max": 18.88412291016147, "outflow_rate_min": 910.4825023696684, "cost2_min": -125.04804124021312, "outflow_rate_mean": 1206.3621762324835}, "episode_len_mean": 322.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 7159478, "time_total_s": 5550.305495738983, "timestamp": 1558615443, "time_since_restore": 5550.305495738983, "training_iteration": 183, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501eb8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8522, "timesteps_total": 7159478, "episode_reward_mean": -428.971636665937, "episodes_this_iter": 47, "date": "2019-05-23_12-44-03", "time_this_iter_s": 29.41835069656372, "num_metric_batches_dropped": 0, "episode_reward_min": -667.9850069459716}
{"iterations_since_restore": 184, "info": {"default": {"kl": 0.017066583037376404, "total_loss": 19.069429397583008, "vf_loss": 19.07628631591797, "vf_explained_var": 0.8846713304519653, "cur_lr": 0.0005000000237487257, "entropy": 1.30455482006073, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.013337907381355762}, "num_steps_trained": 7196244, "update_time_ms": 9.557, "num_steps_sampled": 7196244, "sample_time_ms": 17259.885, "load_time_ms": 23.81, "grad_time_ms": 10428.46}, "hostname": "flow-main", "episode_reward_max": -250.92098658999168, "timesteps_this_iter": 36766, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.78010326300463, "cost1_min": 138.27104467968974, "system_level_velocity_mean": 15.508266131187897, "cost2_mean": -98.02952891681508, "cost2_max": -46.169077920123016, "outflow_rate_max": 1464.6900892727247, "cost1_mean": 186.5667427607466, "system_level_velocity_min": 11.656462894396208, "system_level_velocity_max": 18.93165581458799, "outflow_rate_min": 915.1130253807106, "cost2_min": -125.04804124021312, "outflow_rate_mean": 1213.4218943169553}, "episode_len_mean": 324.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 7196244, "time_total_s": 5578.441672086716, "timestamp": 1558615472, "time_since_restore": 5578.441672086716, "training_iteration": 184, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468d9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468de80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468de48>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8567, "timesteps_total": 7196244, "episode_reward_mean": -422.9938217925757, "episodes_this_iter": 45, "date": "2019-05-23_12-44-32", "time_this_iter_s": 28.136176347732544, "num_metric_batches_dropped": 0, "episode_reward_min": -667.9850069459716}
{"iterations_since_restore": 185, "info": {"default": {"kl": 0.01867932826280594, "total_loss": 17.41168212890625, "vf_loss": 17.42043113708496, "vf_explained_var": 0.8987841010093689, "cur_lr": 0.0005000000237487257, "entropy": 1.4627496004104614, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.01584133505821228}, "num_steps_trained": 7233181, "update_time_ms": 9.621, "num_steps_sampled": 7233181, "sample_time_ms": 17351.89, "load_time_ms": 23.315, "grad_time_ms": 10280.413}, "hostname": "flow-main", "episode_reward_max": -251.91907946770675, "timesteps_this_iter": 36937, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.16369006425896, "cost1_min": 115.80738874260041, "system_level_velocity_mean": 15.178383676464431, "cost2_mean": -93.93779838778406, "cost2_max": -46.169077920123016, "outflow_rate_max": 1464.6900892727247, "cost1_mean": 182.50621517233034, "system_level_velocity_min": 9.819405185106815, "system_level_velocity_max": 18.93165581458799, "outflow_rate_min": 878.685850746269, "cost2_min": -123.2191402457138, "outflow_rate_mean": 1184.654989543547}, "episode_len_mean": 324.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 7233181, "time_total_s": 5606.37588262558, "timestamp": 1558615500, "time_since_restore": 5606.37588262558, "training_iteration": 185, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514d30>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8615, "timesteps_total": 7233181, "episode_reward_mean": -426.29137121880194, "episodes_this_iter": 48, "date": "2019-05-23_12-45-00", "time_this_iter_s": 27.934210538864136, "num_metric_batches_dropped": 0, "episode_reward_min": -667.9850069459716}
{"iterations_since_restore": 186, "info": {"default": {"kl": 0.01663113571703434, "total_loss": 18.700361251831055, "vf_loss": 18.7091121673584, "vf_explained_var": 0.8934369087219238, "cur_lr": 0.0005000000237487257, "entropy": 1.4288854598999023, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.015066439285874367}, "num_steps_trained": 7270374, "update_time_ms": 9.829, "num_steps_sampled": 7270374, "sample_time_ms": 17373.548, "load_time_ms": 22.862, "grad_time_ms": 10024.487}, "hostname": "flow-main", "episode_reward_max": -266.5643506493994, "timesteps_this_iter": 37193, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.16369006425896, "cost1_min": 115.80738874260041, "system_level_velocity_mean": 14.866394746591487, "cost2_mean": -92.92414852984531, "cost2_max": -56.41341025946303, "outflow_rate_max": 1464.5693668963922, "cost1_mean": 178.9393995444713, "system_level_velocity_min": 9.819405185106815, "system_level_velocity_max": 18.864432681331174, "outflow_rate_min": 878.685850746269, "cost2_min": -126.46172119817538, "outflow_rate_mean": 1165.2112708060909}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 7270374, "time_total_s": 5632.946418762207, "timestamp": 1558615526, "time_since_restore": 5632.946418762207, "training_iteration": 186, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845236a0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8660, "timesteps_total": 7270374, "episode_reward_mean": -439.7619760861104, "episodes_this_iter": 45, "date": "2019-05-23_12-45-26", "time_this_iter_s": 26.570536136627197, "num_metric_batches_dropped": 0, "episode_reward_min": -691.0616930531723}
{"iterations_since_restore": 187, "info": {"default": {"kl": 0.014606202952563763, "total_loss": 19.452783584594727, "vf_loss": 19.459741592407227, "vf_explained_var": 0.8919470906257629, "cur_lr": 0.0005000000237487257, "entropy": 1.392938256263733, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.012503022328019142}, "num_steps_trained": 7308909, "update_time_ms": 9.575, "num_steps_sampled": 7308909, "sample_time_ms": 17637.762, "load_time_ms": 22.818, "grad_time_ms": 9816.363}, "hostname": "flow-main", "episode_reward_max": -22.776632015527788, "timesteps_this_iter": 38535, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 225.2124905843808, "cost1_min": 18.07061148982827, "system_level_velocity_mean": 15.345587784614843, "cost2_mean": -94.69595258271912, "cost2_max": -21.063248166773395, "outflow_rate_max": 1464.5693668963922, "cost1_mean": 178.9393055176231, "system_level_velocity_min": 11.600470480804214, "system_level_velocity_max": 18.945760136219814, "outflow_rate_min": 444.6769763958757, "cost2_min": -126.46172119817538, "outflow_rate_mean": 1171.4514419890363}, "episode_len_mean": 316.86, "node_ip": "10.138.0.2", "timesteps_since_restore": 7308909, "time_total_s": 5660.463449478149, "timestamp": 1558615554, "time_since_restore": 5660.463449478149, "training_iteration": 187, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508400>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8707, "timesteps_total": 7308909, "episode_reward_mean": -425.9401147796775, "episodes_this_iter": 47, "date": "2019-05-23_12-45-54", "time_this_iter_s": 27.517030715942383, "num_metric_batches_dropped": 0, "episode_reward_min": -691.0616930531723}
{"iterations_since_restore": 188, "info": {"default": {"kl": 0.015039046294987202, "total_loss": 20.8353271484375, "vf_loss": 20.843156814575195, "vf_explained_var": 0.8790095448493958, "cur_lr": 0.0005000000237487257, "entropy": 1.3725976943969727, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.013537696562707424}, "num_steps_trained": 7348170, "update_time_ms": 9.435, "num_steps_sampled": 7348170, "sample_time_ms": 17698.998, "load_time_ms": 24.488, "grad_time_ms": 9847.798}, "hostname": "flow-main", "episode_reward_max": -22.776632015527788, "timesteps_this_iter": 39261, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.2295152623959, "cost1_min": 18.07061148982827, "system_level_velocity_mean": 15.356473984425895, "cost2_mean": -97.5798433978924, "cost2_max": -21.063248166773395, "outflow_rate_max": 1466.349489439317, "cost1_mean": 179.3514004912614, "system_level_velocity_min": 11.397446596919089, "system_level_velocity_max": 18.945760136219814, "outflow_rate_min": 444.6769763958757, "cost2_min": -129.12927006427822, "outflow_rate_mean": 1188.1006673704817}, "episode_len_mean": 316.86, "node_ip": "10.138.0.2", "timesteps_since_restore": 7348170, "time_total_s": 5688.564205169678, "timestamp": 1558615582, "time_since_restore": 5688.564205169678, "training_iteration": 188, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84501ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565f98>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8757, "timesteps_total": 7348170, "episode_reward_mean": -439.08359454475874, "episodes_this_iter": 50, "date": "2019-05-23_12-46-22", "time_this_iter_s": 28.10075569152832, "num_metric_batches_dropped": 0, "episode_reward_min": -684.9671167766315}
{"iterations_since_restore": 189, "info": {"default": {"kl": 0.01649753376841545, "total_loss": 14.973416328430176, "vf_loss": 14.982192039489746, "vf_explained_var": 0.9150646328926086, "cur_lr": 0.0005000000237487257, "entropy": 1.4571404457092285, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.015040087513625622}, "num_steps_trained": 7385182, "update_time_ms": 9.109, "num_steps_sampled": 7385182, "sample_time_ms": 17522.693, "load_time_ms": 23.603, "grad_time_ms": 9892.715}, "hostname": "flow-main", "episode_reward_max": -250.28156487330364, "timesteps_this_iter": 37012, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.2295152623959, "cost1_min": 136.05869608562656, "system_level_velocity_mean": 15.114696441788334, "cost2_mean": -96.47592462285296, "cost2_max": -60.57053452099055, "outflow_rate_max": 1466.349489439317, "cost1_mean": 182.09345401918137, "system_level_velocity_min": 11.397446596919089, "system_level_velocity_max": 18.920012860183522, "outflow_rate_min": 948.1779456906733, "cost2_min": -129.12927006427822, "outflow_rate_mean": 1191.1985988845968}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 7385182, "time_total_s": 5715.169142484665, "timestamp": 1558615609, "time_since_restore": 5715.169142484665, "training_iteration": 189, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468dd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468de48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468d908>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8802, "timesteps_total": 7385182, "episode_reward_mean": -444.74035477596595, "episodes_this_iter": 45, "date": "2019-05-23_12-46-49", "time_this_iter_s": 26.604937314987183, "num_metric_batches_dropped": 0, "episode_reward_min": -684.9671167766315}
{"iterations_since_restore": 190, "info": {"default": {"kl": 0.015326014719903469, "total_loss": 20.71985626220703, "vf_loss": 20.728418350219727, "vf_explained_var": 0.8802110552787781, "cur_lr": 0.0005000000237487257, "entropy": 1.4570229053497314, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.014378590509295464}, "num_steps_trained": 7422234, "update_time_ms": 9.117, "num_steps_sampled": 7422234, "sample_time_ms": 17397.731, "load_time_ms": 21.68, "grad_time_ms": 10061.132}, "hostname": "flow-main", "episode_reward_max": -28.783632021134682, "timesteps_this_iter": 37052, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 226.2295152623959, "cost1_min": 23.254503128717694, "system_level_velocity_mean": 15.185181201430865, "cost2_mean": -92.75537497510744, "cost2_max": -24.650171791827095, "outflow_rate_max": 1466.349489439317, "cost1_mean": 179.2833851578962, "system_level_velocity_min": 10.858056847947536, "system_level_velocity_max": 18.920012860183522, "outflow_rate_min": 485.44156434617076, "cost2_min": -121.22538710734779, "outflow_rate_mean": 1172.7503171882772}, "episode_len_mean": 320.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 7422234, "time_total_s": 5743.100667476654, "timestamp": 1558615637, "time_since_restore": 5743.100667476654, "training_iteration": 190, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849067f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844f20f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8846, "timesteps_total": 7422234, "episode_reward_mean": -427.93839834546174, "episodes_this_iter": 44, "date": "2019-05-23_12-47-17", "time_this_iter_s": 27.931524991989136, "num_metric_batches_dropped": 0, "episode_reward_min": -674.7493920736032}
{"iterations_since_restore": 191, "info": {"default": {"kl": 0.014845358207821846, "total_loss": 22.843101501464844, "vf_loss": 22.849775314331055, "vf_explained_var": 0.878596305847168, "cur_lr": 0.0005000000237487257, "entropy": 1.5357309579849243, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.01231017429381609}, "num_steps_trained": 7459937, "update_time_ms": 9.173, "num_steps_sampled": 7459937, "sample_time_ms": 17365.597, "load_time_ms": 21.417, "grad_time_ms": 10214.325}, "hostname": "flow-main", "episode_reward_max": -21.993565838111913, "timesteps_this_iter": 37703, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 221.92708690821212, "cost1_min": 17.84670339975078, "system_level_velocity_mean": 15.037359960071985, "cost2_mean": -89.4920046808179, "cost2_max": -17.588555525688545, "outflow_rate_max": 1443.0751440576225, "cost1_mean": 175.43155090310538, "system_level_velocity_min": 10.858056847947536, "system_level_velocity_max": 18.75167849864955, "outflow_rate_min": 477.24354782665716, "cost2_min": -121.01186209344195, "outflow_rate_mean": 1152.5601640154919}, "episode_len_mean": 317.04, "node_ip": "10.138.0.2", "timesteps_since_restore": 7459937, "time_total_s": 5771.118094921112, "timestamp": 1558615665, "time_since_restore": 5771.118094921112, "training_iteration": 191, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514d30>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8895, "timesteps_total": 7459937, "episode_reward_mean": -431.5202829552981, "episodes_this_iter": 49, "date": "2019-05-23_12-47-45", "time_this_iter_s": 28.017427444458008, "num_metric_batches_dropped": 0, "episode_reward_min": -640.8040429663399}
{"iterations_since_restore": 192, "info": {"default": {"kl": 0.015446656383574009, "total_loss": 22.23082733154297, "vf_loss": 22.238304138183594, "vf_explained_var": 0.8820915818214417, "cur_lr": 0.0005000000237487257, "entropy": 1.4159512519836426, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.013342002406716347}, "num_steps_trained": 7497429, "update_time_ms": 9.241, "num_steps_sampled": 7497429, "sample_time_ms": 17440.848, "load_time_ms": 20.093, "grad_time_ms": 10313.586}, "hostname": "flow-main", "episode_reward_max": -21.993565838111913, "timesteps_this_iter": 37492, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.44282155471092, "cost1_min": 17.84670339975078, "system_level_velocity_mean": 15.029412230342116, "cost2_mean": -92.59608063845434, "cost2_max": -17.588555525688545, "outflow_rate_max": 1451.7876392075493, "cost1_mean": 178.80973722765222, "system_level_velocity_min": 11.031352003849792, "system_level_velocity_max": 18.65077581852246, "outflow_rate_min": 477.24354782665716, "cost2_min": -122.4855887701773, "outflow_rate_mean": 1167.0059994437743}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 7497429, "time_total_s": 5799.53790640831, "timestamp": 1558615693, "time_since_restore": 5799.53790640831, "training_iteration": 192, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468d9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468dc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468de80>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8942, "timesteps_total": 7497429, "episode_reward_mean": -439.68496521800466, "episodes_this_iter": 47, "date": "2019-05-23_12-48-13", "time_this_iter_s": 28.419811487197876, "num_metric_batches_dropped": 0, "episode_reward_min": -641.904765275578}
{"iterations_since_restore": 193, "info": {"default": {"kl": 0.014849516563117504, "total_loss": 17.090511322021484, "vf_loss": 17.098573684692383, "vf_explained_var": 0.9051353931427002, "cur_lr": 0.0005000000237487257, "entropy": 1.3813929557800293, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.01370115578174591}, "num_steps_trained": 7535878, "update_time_ms": 9.096, "num_steps_sampled": 7535878, "sample_time_ms": 17540.82, "load_time_ms": 20.021, "grad_time_ms": 10139.391}, "hostname": "flow-main", "episode_reward_max": -232.72517704466023, "timesteps_this_iter": 38449, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.3501862905179, "cost1_min": 130.49493358620046, "system_level_velocity_mean": 15.0722637744144, "cost2_mean": -96.9574672198085, "cost2_max": -59.00095572265055, "outflow_rate_max": 1451.7876392075493, "cost1_mean": 181.58702977337452, "system_level_velocity_min": 11.031352003849792, "system_level_velocity_max": 18.826817815672197, "outflow_rate_min": 859.3887676978766, "cost2_min": -122.4855887701773, "outflow_rate_mean": 1188.989684167794}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 7535878, "time_total_s": 5828.184075832367, "timestamp": 1558615722, "time_since_restore": 5828.184075832367, "training_iteration": 193, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84508400>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 8987, "timesteps_total": 7535878, "episode_reward_mean": -447.2987594107258, "episodes_this_iter": 45, "date": "2019-05-23_12-48-42", "time_this_iter_s": 28.646169424057007, "num_metric_batches_dropped": 0, "episode_reward_min": -641.904765275578}
{"iterations_since_restore": 194, "info": {"default": {"kl": 0.014863096177577972, "total_loss": 18.76763153076172, "vf_loss": 18.773269653320312, "vf_explained_var": 0.8929794430732727, "cur_lr": 0.0005000000237487257, "entropy": 1.3460614681243896, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.011281659826636314}, "num_steps_trained": 7575288, "update_time_ms": 8.496, "num_steps_sampled": 7575288, "sample_time_ms": 17771.943, "load_time_ms": 20.344, "grad_time_ms": 10017.172}, "hostname": "flow-main", "episode_reward_max": -103.98105831590246, "timesteps_this_iter": 39410, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.42096642213627, "cost1_min": 85.46639668699079, "system_level_velocity_mean": 15.29032086311674, "cost2_mean": -98.82266629770706, "cost2_max": -59.00095572265055, "outflow_rate_max": 1455.598920577429, "cost1_mean": 181.4654618642336, "system_level_velocity_min": 11.394675025547757, "system_level_velocity_max": 18.953104603025917, "outflow_rate_min": 813.8616548823151, "cost2_min": -122.4855887701773, "outflow_rate_mean": 1195.9271783908148}, "episode_len_mean": 321.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 7575288, "time_total_s": 5857.4159569740295, "timestamp": 1558615751, "time_since_restore": 5857.4159569740295, "training_iteration": 194, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845232e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845237f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84514128>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 9033, "timesteps_total": 7575288, "episode_reward_mean": -442.0164852797879, "episodes_this_iter": 46, "date": "2019-05-23_12-49-11", "time_this_iter_s": 29.231881141662598, "num_metric_batches_dropped": 0, "episode_reward_min": -634.2250585896138}
{"iterations_since_restore": 195, "info": {"default": {"kl": 0.015646973624825478, "total_loss": 18.371755599975586, "vf_loss": 18.379573822021484, "vf_explained_var": 0.8955156803131104, "cur_lr": 0.0005000000237487257, "entropy": 1.4196697473526, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.013758989050984383}, "num_steps_trained": 7612669, "update_time_ms": 8.617, "num_steps_sampled": 7612669, "sample_time_ms": 17836.366, "load_time_ms": 20.486, "grad_time_ms": 9978.641}, "hostname": "flow-main", "episode_reward_max": -103.98105831590246, "timesteps_this_iter": 37381, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.42096642213627, "cost1_min": 85.46639668699079, "system_level_velocity_mean": 15.565783191496482, "cost2_mean": -98.02945688843803, "cost2_max": -53.73985474171324, "outflow_rate_max": 1455.598920577429, "cost1_mean": 183.70085908113933, "system_level_velocity_min": 11.456531260654808, "system_level_velocity_max": 18.953104603025917, "outflow_rate_min": 813.8616548823151, "cost2_min": -120.18878496156327, "outflow_rate_mean": 1201.2544151224067}, "episode_len_mean": 319.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 7612669, "time_total_s": 5885.623970985413, "timestamp": 1558615779, "time_since_restore": 5885.623970985413, "training_iteration": 195, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849069b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe0f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 9082, "timesteps_total": 7612669, "episode_reward_mean": -427.23148555345125, "episodes_this_iter": 49, "date": "2019-05-23_12-49-39", "time_this_iter_s": 28.208014011383057, "num_metric_batches_dropped": 0, "episode_reward_min": -621.3458985102108}
{"iterations_since_restore": 196, "info": {"default": {"kl": 0.015476641245186329, "total_loss": 16.677648544311523, "vf_loss": 16.686256408691406, "vf_explained_var": 0.9036882519721985, "cur_lr": 0.0005000000237487257, "entropy": 1.3947473764419556, "cur_kl_coeff": 0.3796875476837158, "policy_loss": -0.014483078382909298}, "num_steps_trained": 7650941, "update_time_ms": 8.49, "num_steps_sampled": 7650941, "sample_time_ms": 17892.013, "load_time_ms": 19.644, "grad_time_ms": 10055.288}, "hostname": "flow-main", "episode_reward_max": -97.01823474663136, "timesteps_this_iter": 38272, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.06773511958204, "cost1_min": 79.07272662479866, "system_level_velocity_mean": 15.261583915141697, "cost2_mean": -96.28192672502465, "cost2_max": -53.73985474171324, "outflow_rate_max": 1445.8769045592344, "cost1_mean": 181.5104071557797, "system_level_velocity_min": 11.541273373747211, "system_level_velocity_max": 18.74183817474005, "outflow_rate_min": 759.9152221178001, "cost2_min": -120.18878496156327, "outflow_rate_mean": 1178.9437227849048}, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 7650941, "time_total_s": 5913.518623590469, "timestamp": 1558615807, "time_since_restore": 5913.518623590469, "training_iteration": 196, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845233c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523b38>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 9129, "timesteps_total": 7650941, "episode_reward_mean": -437.28443822206435, "episodes_this_iter": 47, "date": "2019-05-23_12-50-07", "time_this_iter_s": 27.894652605056763, "num_metric_batches_dropped": 0, "episode_reward_min": -641.175650168202}
{"iterations_since_restore": 197, "info": {"default": {"kl": 0.016121314838528633, "total_loss": 17.59922218322754, "vf_loss": 17.608102798461914, "vf_explained_var": 0.8958621025085449, "cur_lr": 0.0005000000237487257, "entropy": 1.4066568613052368, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.015001113526523113}, "num_steps_trained": 7689082, "update_time_ms": 8.539, "num_steps_sampled": 7689082, "sample_time_ms": 17731.639, "load_time_ms": 19.566, "grad_time_ms": 10188.63}, "hostname": "flow-main", "episode_reward_max": -97.01823474663136, "timesteps_this_iter": 38141, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 224.06773511958204, "cost1_min": 79.07272662479866, "system_level_velocity_mean": 15.327844486031193, "cost2_mean": -95.66956122995167, "cost2_max": -58.01372174611502, "outflow_rate_max": 1443.855523484996, "cost1_mean": 181.85028293732833, "system_level_velocity_min": 12.084636977841853, "system_level_velocity_max": 18.84804110580362, "outflow_rate_min": 759.9152221178001, "cost2_min": -117.15170950332309, "outflow_rate_mean": 1185.9035329637572}, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 7689082, "time_total_s": 5940.773144483566, "timestamp": 1558615834, "time_since_restore": 5940.773144483566, "training_iteration": 197, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fef98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fec18>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 9175, "timesteps_total": 7689082, "episode_reward_mean": -429.8154163252327, "episodes_this_iter": 46, "date": "2019-05-23_12-50-34", "time_this_iter_s": 27.254520893096924, "num_metric_batches_dropped": 0, "episode_reward_min": -641.175650168202}
{"iterations_since_restore": 198, "info": {"default": {"kl": 0.01533462293446064, "total_loss": 18.563879013061523, "vf_loss": 18.571691513061523, "vf_explained_var": 0.8930734395980835, "cur_lr": 0.0005000000237487257, "entropy": 1.422756552696228, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.013634650968015194}, "num_steps_trained": 7725905, "update_time_ms": 8.722, "num_steps_sampled": 7725905, "sample_time_ms": 17634.862, "load_time_ms": 19.36, "grad_time_ms": 10288.013}, "hostname": "flow-main", "episode_reward_max": -102.69812018375941, "timesteps_this_iter": 36823, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.65860556339453, "cost1_min": 85.51173142435708, "system_level_velocity_mean": 15.195762414451819, "cost2_mean": -92.30796808505666, "cost2_max": -58.01372174611502, "outflow_rate_max": 1445.8936264472059, "cost1_mean": 180.44850010365383, "system_level_velocity_min": 11.914564356525885, "system_level_velocity_max": 18.84804110580362, "outflow_rate_min": 812.6997138204235, "cost2_min": -119.35472584632939, "outflow_rate_mean": 1175.5170009821588}, "episode_len_mean": 321.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 7725905, "time_total_s": 5968.910033941269, "timestamp": 1558615863, "time_since_restore": 5968.910033941269, "training_iteration": 198, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844feda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa5c0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 9222, "timesteps_total": 7725905, "episode_reward_mean": -422.8030223210333, "episodes_this_iter": 47, "date": "2019-05-23_12-51-03", "time_this_iter_s": 28.136889457702637, "num_metric_batches_dropped": 0, "episode_reward_min": -653.832154404621}
{"iterations_since_restore": 199, "info": {"default": {"kl": 0.017069770023226738, "total_loss": 17.8004150390625, "vf_loss": 17.808412551879883, "vf_explained_var": 0.8912907838821411, "cur_lr": 0.0005000000237487257, "entropy": 1.4318361282348633, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.014476880431175232}, "num_steps_trained": 7765092, "update_time_ms": 8.914, "num_steps_sampled": 7765092, "sample_time_ms": 17660.112, "load_time_ms": 20.174, "grad_time_ms": 10509.926}, "hostname": "flow-main", "episode_reward_max": -104.61496920694037, "timesteps_this_iter": 39187, "pid": 20623, "done": false, "custom_metrics": {"cost1_max": 223.65860556339453, "cost1_min": 86.70268791466088, "system_level_velocity_mean": 15.293890336169566, "cost2_mean": -95.59551047055949, "cost2_max": -52.74574330739274, "outflow_rate_max": 1446.5124589946042, "cost1_mean": 181.55354090618587, "system_level_velocity_min": 11.750268346908253, "system_level_velocity_max": 19.01569204704198, "outflow_rate_min": 813.0139462688043, "cost2_min": -135.12908072300573, "outflow_rate_mean": 1187.446121303628}, "episode_len_mean": 321.05, "node_ip": "10.138.0.2", "timesteps_since_restore": 7765092, "time_total_s": 5997.998694658279, "timestamp": 1558615892, "time_since_restore": 5997.998694658279, "training_iteration": 199, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84523be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fa320>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 9268, "timesteps_total": 7765092, "episode_reward_mean": -433.0043940023251, "episodes_this_iter": 46, "date": "2019-05-23_12-51-32", "time_this_iter_s": 29.088660717010498, "num_metric_batches_dropped": 0, "episode_reward_min": -653.832154404621}
{"iterations_since_restore": 200, "info": {"default": {"kl": 0.016189930960536003, "total_loss": 16.300500869750977, "vf_loss": 16.306894302368164, "vf_explained_var": 0.9011592864990234, "cur_lr": 0.0005000000237487257, "entropy": 1.3916511535644531, "cur_kl_coeff": 0.37968751788139343, "policy_loss": -0.012541764415800571}, "num_steps_trained": 7803983, "update_time_ms": 8.991, "num_steps_sampled": 7803983, "sample_time_ms": 17713.443, "load_time_ms": 22.403, "grad_time_ms": 10596.918}, "hostname": "flow-main", "episode_reward_max": -30.809026589295218, "timesteps_this_iter": 38891, "pid": 20623, "done": true, "custom_metrics": {"cost1_max": 222.448117157854, "cost1_min": 24.48317754144081, "system_level_velocity_mean": 15.242600118569095, "cost2_mean": -97.84645023004006, "cost2_max": -22.976474242346026, "outflow_rate_max": 1446.5124589946042, "cost1_mean": 179.04590996816526, "system_level_velocity_min": 11.750268346908253, "system_level_velocity_max": 19.01569204704198, "outflow_rate_min": 499.32327442849015, "cost2_min": -135.12908072300573, "outflow_rate_mean": 1185.5379814977478}, "episode_len_mean": 318.07, "node_ip": "10.138.0.2", "timesteps_since_restore": 7803983, "time_total_s": 6027.356431245804, "timestamp": 1558615921, "time_since_restore": 6027.356431245804, "training_iteration": 200, "policy_reward_mean": {}, "config": {"clip_param": 0.3, "preprocessor_pref": "deepmind", "sample_async": false, "output": null, "horizon": 750, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fed68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e844fe780>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "optimizer": {}, "simple_optimizer": false, "observation_filter": "NoFilter", "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "use_gae": true, "num_sgd_iter": 10, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 5", "input_evaluation": null, "sgd_minibatch_size": 128, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "clip_actions": false, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "conv_activation": "relu", "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "c9142ae802734d81889389dfa7d9010d", "episodes_total": 9317, "timesteps_total": 7803983, "episode_reward_mean": -444.8020037214247, "episodes_this_iter": 49, "date": "2019-05-23_12-52-01", "time_this_iter_s": 29.357736587524414, "num_metric_batches_dropped": 0, "episode_reward_min": -641.0678882313697}

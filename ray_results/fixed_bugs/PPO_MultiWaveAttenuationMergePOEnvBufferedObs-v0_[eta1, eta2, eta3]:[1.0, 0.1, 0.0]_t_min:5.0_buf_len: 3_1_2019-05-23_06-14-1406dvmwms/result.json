{"time_since_restore": 56.84690880775452, "info": {"default": {"kl": 0.0019542700611054897, "total_loss": 36.806549072265625, "vf_explained_var": -2.6435764084453695e-06, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008988991030491889, "cur_kl_coeff": 0.20000003278255463, "vf_loss": 36.80705642700195, "entropy": 1.4204537868499756}, "num_steps_trained": 41592, "grad_time_ms": 12098.427, "load_time_ms": 69.673, "sample_time_ms": 43282.482, "num_steps_sampled": 41592, "update_time_ms": 1226.927}, "hostname": "flow-main", "episode_reward_max": -507.6928582868147, "timesteps_this_iter": 41592, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 153.7162824326901, "cost1_mean": 122.51399441994542, "system_level_velocity_mean": 10.19113414843439, "cost2_mean": -26.871076890549954, "cost2_max": -15.442463701363554, "outflow_rate_max": 976.0201061033315, "cost1_min": 109.40730842999764, "system_level_velocity_min": 9.151205693625307, "system_level_velocity_max": 12.512558567339434, "outflow_rate_min": 598.5174193548388, "outflow_rate_mean": 750.0380297027002, "cost2_min": -47.38947785253764}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 41592, "time_total_s": 56.84690880775452, "timestamp": 1558592141, "iterations_since_restore": 1, "policy_reward_mean": {}, "training_iteration": 1, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2ef0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2eb8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2978>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 40, "timesteps_total": 41592, "episode_reward_mean": -705.7962374245051, "episodes_this_iter": 40, "date": "2019-05-23_06-15-41", "time_this_iter_s": 56.84690880775452, "num_metric_batches_dropped": 0, "episode_reward_min": -903.8929182470316}
{"time_since_restore": 87.44077682495117, "info": {"default": {"kl": 0.004171408712863922, "total_loss": 59.7557487487793, "vf_explained_var": -3.131494850094896e-07, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0013137838104739785, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 59.75664520263672, "entropy": 1.423744797706604}, "num_steps_trained": 84072, "grad_time_ms": 11261.518, "load_time_ms": 42.225, "sample_time_ms": 31662.053, "num_steps_sampled": 84072, "update_time_ms": 620.139}, "hostname": "flow-main", "episode_reward_max": -496.458248921184, "timesteps_this_iter": 42480, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 162.80297694528122, "cost1_mean": 124.76522003039629, "system_level_velocity_mean": 10.37780212318566, "cost2_mean": -26.933941722121737, "cost2_max": -15.442463701363554, "outflow_rate_max": 1009.9744773223383, "cost1_min": 98.18995572828659, "system_level_velocity_min": 8.105547682318406, "system_level_velocity_max": 13.41329183858622, "outflow_rate_min": 412.5857142857143, "outflow_rate_mean": 763.5880389527706, "cost2_min": -47.38947785253764}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 84072, "time_total_s": 87.44077682495117, "timestamp": 1558592172, "iterations_since_restore": 2, "policy_reward_mean": {}, "training_iteration": 2, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913cf8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913cc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913d30>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 80, "timesteps_total": 84072, "episode_reward_mean": -696.9324024113805, "episodes_this_iter": 40, "date": "2019-05-23_06-16-12", "time_this_iter_s": 30.593868017196655, "num_metric_batches_dropped": 0, "episode_reward_min": -1126.3078055554856}
{"time_since_restore": 118.35378050804138, "info": {"default": {"kl": 0.005941673647612333, "total_loss": 85.60353088378906, "vf_explained_var": -8.64452474047539e-08, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0018934429390355945, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 85.6051254272461, "entropy": 1.4141381978988647}, "num_steps_trained": 125373, "grad_time_ms": 11013.009, "load_time_ms": 33.929, "sample_time_ms": 27869.812, "num_steps_sampled": 125373, "update_time_ms": 416.197}, "hostname": "flow-main", "episode_reward_max": -490.39561228594846, "timesteps_this_iter": 41301, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 162.80297694528122, "cost1_mean": 130.20495100091108, "system_level_velocity_mean": 10.819662074895982, "cost2_mean": -26.44122084878086, "cost2_max": -14.750922140233621, "outflow_rate_max": 1009.9744773223383, "cost1_min": 98.18995572828659, "system_level_velocity_min": 8.105547682318406, "system_level_velocity_max": 13.41329183858622, "outflow_rate_min": 412.5857142857143, "outflow_rate_mean": 793.9660816976689, "cost2_min": -47.38947785253764}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 125373, "time_total_s": 118.35378050804138, "timestamp": 1558592203, "iterations_since_restore": 3, "policy_reward_mean": {}, "training_iteration": 3, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e1d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e198>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e208>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 120, "timesteps_total": 125373, "episode_reward_mean": -661.4613490628628, "episodes_this_iter": 40, "date": "2019-05-23_06-16-43", "time_this_iter_s": 30.91300368309021, "num_metric_batches_dropped": 0, "episode_reward_min": -1126.3078055554856}
{"time_since_restore": 149.99795866012573, "info": {"default": {"kl": 0.007100419141352177, "total_loss": 121.04882049560547, "vf_explained_var": -1.8250281286213976e-08, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0022860215976834297, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 121.0507583618164, "entropy": 1.4135277271270752}, "num_steps_trained": 164750, "grad_time_ms": 10625.743, "load_time_ms": 29.349, "sample_time_ms": 26416.733, "num_steps_sampled": 164750, "update_time_ms": 314.156}, "hostname": "flow-main", "episode_reward_max": -30.58525101315875, "timesteps_this_iter": 39377, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 165.69250732479367, "cost1_mean": 137.87811444385144, "system_level_velocity_mean": 11.606869600992768, "cost2_mean": -25.295969751236306, "cost2_max": -13.253513874984671, "outflow_rate_max": 1060.8589057750762, "cost1_min": 22.448595838530338, "system_level_velocity_min": 9.286921776022407, "system_level_velocity_max": 18.050732789951628, "outflow_rate_min": 502.66918130924233, "outflow_rate_mean": 869.4155024501611, "cost2_min": -38.11557481520056}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 164750, "time_total_s": 149.99795866012573, "timestamp": 1558592235, "iterations_since_restore": 4, "policy_reward_mean": {}, "training_iteration": 4, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913d68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913dd8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84947b70>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 181, "timesteps_total": 164750, "episode_reward_mean": -602.1318536282878, "episodes_this_iter": 61, "date": "2019-05-23_06-17-15", "time_this_iter_s": 31.64417815208435, "num_metric_batches_dropped": 0, "episode_reward_min": -811.3350747108983}
{"time_since_restore": 177.79107928276062, "info": {"default": {"kl": 0.00525776157155633, "total_loss": 109.95148468017578, "vf_explained_var": -7.522916511959465e-09, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0004168367013335228, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 109.95164489746094, "entropy": 1.4037954807281494}, "num_steps_trained": 204316, "grad_time_ms": 10356.374, "load_time_ms": 26.532, "sample_time_ms": 24815.506, "num_steps_sampled": 204316, "update_time_ms": 253.14}, "hostname": "flow-main", "episode_reward_max": -30.58525101315875, "timesteps_this_iter": 39566, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 165.69250732479367, "cost1_mean": 140.51399209425387, "system_level_velocity_mean": 11.835555512523388, "cost2_mean": -24.76251724691691, "cost2_max": -13.253513874984671, "outflow_rate_max": 1060.8589057750762, "cost1_min": 22.448595838530338, "system_level_velocity_min": 9.835848270594795, "system_level_velocity_max": 18.050732789951628, "outflow_rate_min": 502.66918130924233, "outflow_rate_mean": 907.4044195057327, "cost2_min": -37.205756042271524}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 204316, "time_total_s": 177.79107928276062, "timestamp": 1558592263, "iterations_since_restore": 5, "policy_reward_mean": {}, "training_iteration": 5, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491af60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491ae48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e240>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 221, "timesteps_total": 204316, "episode_reward_mean": -582.7490551139397, "episodes_this_iter": 40, "date": "2019-05-23_06-17-43", "time_this_iter_s": 27.793120622634888, "num_metric_batches_dropped": 0, "episode_reward_min": -738.3083619437061}
{"time_since_restore": 205.2337098121643, "info": {"default": {"kl": 0.012773949652910233, "total_loss": 117.19896697998047, "vf_explained_var": -5.638277400521474e-09, "cur_lr": 0.0005000000237487257, "policy_loss": -0.003160711843520403, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 117.20149230957031, "entropy": 1.392975091934204}, "num_steps_trained": 242267, "grad_time_ms": 10166.32, "load_time_ms": 24.582, "sample_time_ms": 23700.324, "num_steps_sampled": 242267, "update_time_ms": 212.155}, "hostname": "flow-main", "episode_reward_max": -404.60798583595323, "timesteps_this_iter": 37951, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 175.39656105490337, "cost1_mean": 146.4075721540574, "system_level_velocity_mean": 12.19764720702405, "cost2_mean": -24.35260530003204, "cost2_max": -15.406056313175904, "outflow_rate_max": 1144.5626508344033, "cost1_min": 118.98419538902354, "system_level_velocity_min": 9.835848270594795, "system_level_velocity_max": 14.485906051353629, "outflow_rate_min": 785.9886599025978, "outflow_rate_mean": 945.4237092090017, "cost2_min": -33.41431688353184}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 242267, "time_total_s": 205.2337098121643, "timestamp": 1558592290, "iterations_since_restore": 6, "policy_reward_mean": {}, "training_iteration": 6, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e5f8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e080>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e2e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 261, "timesteps_total": 242267, "episode_reward_mean": -555.5585910469877, "episodes_this_iter": 40, "date": "2019-05-23_06-18-10", "time_this_iter_s": 27.442630529403687, "num_metric_batches_dropped": 0, "episode_reward_min": -738.3083619437061}
{"time_since_restore": 235.81406497955322, "info": {"default": {"kl": 0.009629631415009499, "total_loss": 47.60272979736328, "vf_explained_var": 0.6155820488929749, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0016832230612635612, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 47.60392761230469, "entropy": 1.3895289897918701}, "num_steps_trained": 281401, "grad_time_ms": 10219.987, "load_time_ms": 23.084, "sample_time_ms": 23162.756, "num_steps_sampled": 281401, "update_time_ms": 182.902}, "hostname": "flow-main", "episode_reward_max": -404.60798583595323, "timesteps_this_iter": 39134, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 182.8606812564144, "cost1_mean": 157.36128101434977, "system_level_velocity_mean": 13.119127624938109, "cost2_mean": -27.79173314045957, "cost2_max": -17.82178382529962, "outflow_rate_max": 1187.4467242186279, "cost1_min": 126.5132595834504, "system_level_velocity_min": 10.348811785331309, "system_level_velocity_max": 14.996937005905504, "outflow_rate_min": 865.1157801506125, "outflow_rate_mean": 1023.3836014586735, "cost2_min": -44.335183845988766}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 281401, "time_total_s": 235.81406497955322, "timestamp": 1558592321, "iterations_since_restore": 7, "policy_reward_mean": {}, "training_iteration": 7, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913438>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913080>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913ef0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 321, "timesteps_total": 281401, "episode_reward_mean": -515.3081657870057, "episodes_this_iter": 60, "date": "2019-05-23_06-18-41", "time_this_iter_s": 30.580355167388916, "num_metric_batches_dropped": 0, "episode_reward_min": -705.517363515537}
{"time_since_restore": 264.0971555709839, "info": {"default": {"kl": 0.01696052961051464, "total_loss": 33.658287048339844, "vf_explained_var": 0.7879143953323364, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004363353829830885, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 33.66180419921875, "entropy": 1.364406704902649}, "num_steps_trained": 319575, "grad_time_ms": 10255.936, "load_time_ms": 22.626, "sample_time_ms": 22475.684, "num_steps_sampled": 319575, "update_time_ms": 161.034}, "hostname": "flow-main", "episode_reward_max": -23.91219913647736, "timesteps_this_iter": 38174, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 182.8606812564144, "cost1_mean": 160.43855171532388, "system_level_velocity_mean": 13.501888987009634, "cost2_mean": -30.35641899743418, "cost2_max": -14.340862658876702, "outflow_rate_max": 1200.9143397917505, "cost1_min": 17.63395361043786, "system_level_velocity_min": 7.676530319163003, "system_level_velocity_max": 16.939552669694994, "outflow_rate_min": 442.8785900830537, "outflow_rate_mean": 1053.383970615245, "cost2_min": -45.56372062650005}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 319575, "time_total_s": 264.0971555709839, "timestamp": 1558592349, "iterations_since_restore": 8, "policy_reward_mean": {}, "training_iteration": 8, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490eba8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e5c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e860>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 362, "timesteps_total": 319575, "episode_reward_mean": -497.10451197718606, "episodes_this_iter": 41, "date": "2019-05-23_06-19-09", "time_this_iter_s": 28.283090591430664, "num_metric_batches_dropped": 0, "episode_reward_min": -705.517363515537}
{"time_since_restore": 292.2247269153595, "info": {"default": {"kl": 0.01303115114569664, "total_loss": 27.952783584594727, "vf_explained_var": 0.8444873094558716, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00348538625985384, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 27.955617904663086, "entropy": 1.346988558769226}, "num_steps_trained": 355857, "grad_time_ms": 10311.883, "load_time_ms": 21.981, "sample_time_ms": 21895.456, "num_steps_sampled": 355857, "update_time_ms": 143.924}, "hostname": "flow-main", "episode_reward_max": -23.91219913647736, "timesteps_this_iter": 36282, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 187.29066659079302, "cost1_mean": 161.83054869825918, "system_level_velocity_mean": 13.641261250609384, "cost2_mean": -30.254910643072385, "cost2_max": -14.340862658876702, "outflow_rate_max": 1200.9143397917505, "cost1_min": 17.63395361043786, "system_level_velocity_min": 7.676530319163003, "system_level_velocity_max": 16.939552669694994, "outflow_rate_min": 442.8785900830537, "outflow_rate_mean": 1050.3934329093113, "cost2_min": -48.758906206648845}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 355857, "time_total_s": 292.2247269153595, "timestamp": 1558592377, "iterations_since_restore": 9, "policy_reward_mean": {}, "training_iteration": 9, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e400>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e080>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e780>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 402, "timesteps_total": 355857, "episode_reward_mean": -478.87876309190887, "episodes_this_iter": 40, "date": "2019-05-23_06-19-37", "time_this_iter_s": 28.12757134437561, "num_metric_batches_dropped": 0, "episode_reward_min": -688.2402948822094}
{"time_since_restore": 321.9882254600525, "info": {"default": {"kl": 0.012703381478786469, "total_loss": 31.0562801361084, "vf_explained_var": 0.8369314670562744, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0037591990549117327, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 31.059404373168945, "entropy": 1.3236404657363892}, "num_steps_trained": 389786, "grad_time_ms": 10253.993, "load_time_ms": 21.239, "sample_time_ms": 21698.19, "num_steps_sampled": 389786, "update_time_ms": 130.308}, "hostname": "flow-main", "episode_reward_max": -304.7920521990149, "timesteps_this_iter": 33929, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 193.38926254886502, "cost1_mean": 167.42698469366067, "system_level_velocity_mean": 14.038937009941556, "cost2_mean": -29.088494677470784, "cost2_max": -15.961234835107362, "outflow_rate_max": 1188.6806751685479, "cost1_min": 121.21371672470315, "system_level_velocity_min": 10.165180848190298, "system_level_velocity_max": 16.228499136831843, "outflow_rate_min": 734.6631061305211, "outflow_rate_mean": 1052.6667321391776, "cost2_min": -48.758906206648845}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 389786, "time_total_s": 321.9882254600525, "timestamp": 1558592407, "iterations_since_restore": 10, "policy_reward_mean": {}, "training_iteration": 10, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e2b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490edd8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490eac8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 460, "timesteps_total": 389786, "episode_reward_mean": -444.38040548749535, "episodes_this_iter": 58, "date": "2019-05-23_06-20-07", "time_this_iter_s": 29.763498544692993, "num_metric_batches_dropped": 0, "episode_reward_min": -631.5629442214693}
{"time_since_restore": 350.2595398426056, "info": {"default": {"kl": 0.01175537146627903, "total_loss": 29.29979133605957, "vf_explained_var": 0.8353990316390991, "cur_lr": 0.0005000000237487257, "policy_loss": -0.003024666104465723, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 29.30222511291504, "entropy": 1.3063976764678955}, "num_steps_trained": 426495, "grad_time_ms": 10107.017, "load_time_ms": 15.701, "sample_time_ms": 19122.6, "num_steps_sampled": 426495, "update_time_ms": 8.35}, "hostname": "flow-main", "episode_reward_max": -304.7920521990149, "timesteps_this_iter": 36709, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 206.51942307332192, "cost1_mean": 174.40039983665764, "system_level_velocity_mean": 14.591002371260169, "cost2_mean": -31.85583034480304, "cost2_max": -15.961234835107362, "outflow_rate_max": 1290.114414051544, "cost1_min": 137.6732297595394, "system_level_velocity_min": 11.50462037520957, "system_level_velocity_max": 17.242815723089482, "outflow_rate_min": 889.9161055796861, "outflow_rate_mean": 1090.254590006394, "cost2_min": -55.78348210105616}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 426495, "time_total_s": 350.2595398426056, "timestamp": 1558592435, "iterations_since_restore": 11, "policy_reward_mean": {}, "training_iteration": 11, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e0b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2f60>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490ed68>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 502, "timesteps_total": 426495, "episode_reward_mean": -425.47757405574237, "episodes_this_iter": 42, "date": "2019-05-23_06-20-35", "time_this_iter_s": 28.2713143825531, "num_metric_batches_dropped": 0, "episode_reward_min": -736.0630821075927}
{"time_since_restore": 380.3153021335602, "info": {"default": {"kl": 0.010913108475506306, "total_loss": 30.009048461914062, "vf_explained_var": 0.8065906167030334, "cur_lr": 0.0005000000237487257, "policy_loss": -0.003217825200408697, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 30.0117244720459, "entropy": 1.304229497909546}, "num_steps_trained": 466035, "grad_time_ms": 10219.397, "load_time_ms": 16.212, "sample_time_ms": 18957.304, "num_steps_sampled": 466035, "update_time_ms": 7.987}, "hostname": "flow-main", "episode_reward_max": -31.649251678438258, "timesteps_this_iter": 39540, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 211.7782250704613, "cost1_mean": 180.23220819651496, "system_level_velocity_mean": 15.150031792747486, "cost2_mean": -37.54977537428885, "cost2_max": -10.56455537784003, "outflow_rate_max": 1345.0935368787223, "cost1_min": 24.00785960574003, "system_level_velocity_min": 11.659605065979347, "system_level_velocity_max": 18.39522501760361, "outflow_rate_min": 499.32327442849015, "outflow_rate_mean": 1140.7497043367548, "cost2_min": -58.31717318776709}, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 466035, "time_total_s": 380.3153021335602, "timestamp": 1558592465, "iterations_since_restore": 12, "policy_reward_mean": {}, "training_iteration": 12, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490eeb8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 543, "timesteps_total": 466035, "episode_reward_mean": -421.791188211235, "episodes_this_iter": 41, "date": "2019-05-23_06-21-05", "time_this_iter_s": 30.05576229095459, "num_metric_batches_dropped": 0, "episode_reward_min": -736.0630821075927}
{"time_since_restore": 412.5638508796692, "info": {"default": {"kl": 0.009738769382238388, "total_loss": 34.91854476928711, "vf_explained_var": 0.756274938583374, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0023162534926086664, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 34.920372009277344, "entropy": 1.306792974472046}, "num_steps_trained": 506553, "grad_time_ms": 10411.061, "load_time_ms": 16.13, "sample_time_ms": 18898.323, "num_steps_sampled": 506553, "update_time_ms": 7.916}, "hostname": "flow-main", "episode_reward_max": -31.649251678438258, "timesteps_this_iter": 40518, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 212.51807442717893, "cost1_mean": 187.49096157976916, "system_level_velocity_mean": 15.632428966854468, "cost2_mean": -46.2224491375692, "cost2_max": -10.56455537784003, "outflow_rate_max": 1367.1123922902498, "cost1_min": 24.00785960574003, "system_level_velocity_min": 11.831923039098456, "system_level_velocity_max": 18.39522501760361, "outflow_rate_min": 499.32327442849015, "outflow_rate_mean": 1206.6926573642202, "cost2_min": -63.72275050364044}, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 506553, "time_total_s": 412.5638508796692, "timestamp": 1558592498, "iterations_since_restore": 13, "policy_reward_mean": {}, "training_iteration": 13, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e8d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e4e0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 600, "timesteps_total": 506553, "episode_reward_mean": -426.76269596284675, "episodes_this_iter": 57, "date": "2019-05-23_06-21-38", "time_this_iter_s": 32.24854874610901, "num_metric_batches_dropped": 0, "episode_reward_min": -717.8611281882897}
{"time_since_restore": 443.2619438171387, "info": {"default": {"kl": 0.008459983393549919, "total_loss": 24.41301918029785, "vf_explained_var": 0.8173708319664001, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0017095592338591814, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 24.414304733276367, "entropy": 1.3098143339157104}, "num_steps_trained": 546337, "grad_time_ms": 10560.774, "load_time_ms": 16.246, "sample_time_ms": 18655.626, "num_steps_sampled": 546337, "update_time_ms": 8.182}, "hostname": "flow-main", "episode_reward_max": -301.4983885028464, "timesteps_this_iter": 39784, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 212.51807442717893, "cost1_mean": 189.40126111429177, "system_level_velocity_mean": 15.60214460058836, "cost2_mean": -47.90630746704428, "cost2_max": -32.99159457316171, "outflow_rate_max": 1367.1123922902498, "cost1_min": 142.77297647977088, "system_level_velocity_min": 11.831923039098456, "system_level_velocity_max": 17.634421836331907, "outflow_rate_min": 984.17228962818, "outflow_rate_mean": 1225.0231515597488, "cost2_min": -63.72275050364044}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 546337, "time_total_s": 443.2619438171387, "timestamp": 1558592528, "iterations_since_restore": 14, "policy_reward_mean": {}, "training_iteration": 14, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490ec88>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490ee10>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 643, "timesteps_total": 546337, "episode_reward_mean": -436.1296077338825, "episodes_this_iter": 43, "date": "2019-05-23_06-22-08", "time_this_iter_s": 30.698092937469482, "num_metric_batches_dropped": 0, "episode_reward_min": -717.8611281882897}
{"time_since_restore": 472.81189370155334, "info": {"default": {"kl": 0.007508349604904652, "total_loss": 23.736297607421875, "vf_explained_var": 0.8270277380943298, "cur_lr": 0.0005000000237487257, "policy_loss": -0.002685923594981432, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 23.738609313964844, "entropy": 1.3073666095733643}, "num_steps_trained": 586406, "grad_time_ms": 10745.316, "load_time_ms": 16.444, "sample_time_ms": 18645.564, "num_steps_sampled": 586406, "update_time_ms": 8.222}, "hostname": "flow-main", "episode_reward_max": -300.31667850301807, "timesteps_this_iter": 40069, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 214.86697192555857, "cost1_mean": 187.62961567125237, "system_level_velocity_mean": 15.465376684248227, "cost2_mean": -46.723387802881426, "cost2_max": -29.821749476773824, "outflow_rate_max": 1380.8333992515888, "cost1_min": 142.77297647977088, "system_level_velocity_min": 11.831923039098456, "system_level_velocity_max": 17.76619159066013, "outflow_rate_min": 984.17228962818, "outflow_rate_mean": 1215.4036620086597, "cost2_min": -62.48262550310486}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 586406, "time_total_s": 472.81189370155334, "timestamp": 1558592558, "iterations_since_restore": 15, "policy_reward_mean": {}, "training_iteration": 15, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906f98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a470>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906c50>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 683, "timesteps_total": 586406, "episode_reward_mean": -444.26119557402984, "episodes_this_iter": 40, "date": "2019-05-23_06-22-38", "time_this_iter_s": 29.549949884414673, "num_metric_batches_dropped": 0, "episode_reward_min": -717.8611281882897}
{"time_since_restore": 503.03263545036316, "info": {"default": {"kl": 0.009064838290214539, "total_loss": 27.97549819946289, "vf_explained_var": 0.8088076710700989, "cur_lr": 0.0005000000237487257, "policy_loss": -0.003171453485265374, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 27.97821617126465, "entropy": 1.2941871881484985}, "num_steps_trained": 628151, "grad_time_ms": 10986.31, "load_time_ms": 16.948, "sample_time_ms": 18681.154, "num_steps_sampled": 628151, "update_time_ms": 8.371}, "hostname": "flow-main", "episode_reward_max": -184.30823728382745, "timesteps_this_iter": 41745, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 214.86697192555857, "cost1_mean": 186.0900334489028, "system_level_velocity_mean": 15.412192047208292, "cost2_mean": -47.79249864407244, "cost2_max": -29.821749476773824, "outflow_rate_max": 1380.8333992515888, "cost1_min": 136.38068230124387, "system_level_velocity_min": 12.209849249396974, "system_level_velocity_max": 17.846126696266893, "outflow_rate_min": 973.2598429647232, "outflow_rate_mean": 1206.447550139889, "cost2_min": -68.611999897511}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 628151, "time_total_s": 503.03263545036316, "timestamp": 1558592588, "iterations_since_restore": 16, "policy_reward_mean": {}, "training_iteration": 16, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492aac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a908>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492ac50>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 724, "timesteps_total": 628151, "episode_reward_mean": -449.65800370240794, "episodes_this_iter": 41, "date": "2019-05-23_06-23-08", "time_this_iter_s": 30.220741748809814, "num_metric_batches_dropped": 0, "episode_reward_min": -697.9555101558507}
{"time_since_restore": 534.6293761730194, "info": {"default": {"kl": 0.009091770276427269, "total_loss": 32.08552169799805, "vf_explained_var": 0.7813442945480347, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0029622609727084637, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 32.08802795410156, "entropy": 1.28228759765625}, "num_steps_trained": 668610, "grad_time_ms": 11036.182, "load_time_ms": 17.03, "sample_time_ms": 18732.762, "num_steps_sampled": 668610, "update_time_ms": 8.523}, "hostname": "flow-main", "episode_reward_max": -184.30823728382745, "timesteps_this_iter": 40459, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.70798704358273, "cost1_mean": 184.85272689748382, "system_level_velocity_mean": 15.306892633397656, "cost2_mean": -51.07515499825327, "cost2_max": -33.55263893399174, "outflow_rate_max": 1401.6385636317975, "cost1_min": 136.38068230124387, "system_level_velocity_min": 11.400648895726107, "system_level_velocity_max": 18.219563132354562, "outflow_rate_min": 973.2598429647232, "outflow_rate_mean": 1200.801674110125, "cost2_min": -73.93841658701676}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 668610, "time_total_s": 534.6293761730194, "timestamp": 1558592620, "iterations_since_restore": 17, "policy_reward_mean": {}, "training_iteration": 17, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849131d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913278>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 783, "timesteps_total": 668610, "episode_reward_mean": -461.95047096216877, "episodes_this_iter": 59, "date": "2019-05-23_06-23-40", "time_this_iter_s": 31.59674072265625, "num_metric_batches_dropped": 0, "episode_reward_min": -718.2374462395821}
{"time_since_restore": 565.3903090953827, "info": {"default": {"kl": 0.007762419059872627, "total_loss": 24.917312622070312, "vf_explained_var": 0.8353167772293091, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0025166200939565897, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 24.9194393157959, "entropy": 1.2857533693313599}, "num_steps_trained": 710127, "grad_time_ms": 11105.971, "load_time_ms": 16.666, "sample_time_ms": 18910.34, "num_steps_sampled": 710127, "update_time_ms": 8.456}, "hostname": "flow-main", "episode_reward_max": -31.217019419476003, "timesteps_this_iter": 41517, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.70798704358273, "cost1_mean": 183.52079015288209, "system_level_velocity_mean": 15.434654463235338, "cost2_mean": -54.221543874451406, "cost2_max": -16.532300044278596, "outflow_rate_max": 1401.6385636317975, "cost1_min": 23.05429866674557, "system_level_velocity_min": 11.400648895726107, "system_level_velocity_max": 18.61138725905804, "outflow_rate_min": 462.8895202122901, "outflow_rate_mean": 1195.1389732680434, "cost2_min": -73.93841658701676}, "episode_len_mean": 320.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 710127, "time_total_s": 565.3903090953827, "timestamp": 1558592651, "iterations_since_restore": 18, "policy_reward_mean": {}, "training_iteration": 18, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492ac18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a588>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 825, "timesteps_total": 710127, "episode_reward_mean": -462.7638573378393, "episodes_this_iter": 42, "date": "2019-05-23_06-24-11", "time_this_iter_s": 30.76093292236328, "num_metric_batches_dropped": 0, "episode_reward_min": -718.2374462395821}
{"time_since_restore": 595.9088127613068, "info": {"default": {"kl": 0.009156514890491962, "total_loss": 23.395328521728516, "vf_explained_var": 0.8230804800987244, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0031083442736417055, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 23.397977828979492, "entropy": 1.2782337665557861}, "num_steps_trained": 750443, "grad_time_ms": 11080.785, "load_time_ms": 17.253, "sample_time_ms": 19175.273, "num_steps_sampled": 750443, "update_time_ms": 8.477}, "hostname": "flow-main", "episode_reward_max": -28.892382643256838, "timesteps_this_iter": 40316, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.70798704358273, "cost1_mean": 181.69513484330324, "system_level_velocity_mean": 15.452590985494208, "cost2_mean": -52.34436008973285, "cost2_max": -15.321651772238749, "outflow_rate_max": 1384.5011939673225, "cost1_min": 23.05429866674557, "system_level_velocity_min": 11.400648895726107, "system_level_velocity_max": 18.872689522821776, "outflow_rate_min": 462.8895202122901, "outflow_rate_mean": 1184.6938355979185, "cost2_min": -70.42652576056247}, "episode_len_mean": 317.2, "node_ip": "10.138.0.2", "timesteps_since_restore": 750443, "time_total_s": 595.9088127613068, "timestamp": 1558592681, "iterations_since_restore": 19, "policy_reward_mean": {}, "training_iteration": 19, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849137f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849130f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913b00>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 867, "timesteps_total": 750443, "episode_reward_mean": -455.4328076773742, "episodes_this_iter": 42, "date": "2019-05-23_06-24-41", "time_this_iter_s": 30.518503665924072, "num_metric_batches_dropped": 0, "episode_reward_min": -718.2374462395821}
{"time_since_restore": 626.660130739212, "info": {"default": {"kl": 0.00993569940328598, "total_loss": 26.12242889404297, "vf_explained_var": 0.7974171042442322, "cur_lr": 0.0005000000237487257, "policy_loss": -0.003614045912399888, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 26.125547409057617, "entropy": 1.2741881608963013}, "num_steps_trained": 789763, "grad_time_ms": 11116.631, "load_time_ms": 17.369, "sample_time_ms": 19238.987, "num_steps_sampled": 789763, "update_time_ms": 8.528}, "hostname": "flow-main", "episode_reward_max": -28.892382643256838, "timesteps_this_iter": 39320, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.51969969259568, "cost1_mean": 186.39614281329636, "system_level_velocity_mean": 15.55740105694981, "cost2_mean": -47.41868995028686, "cost2_max": -15.321651772238749, "outflow_rate_max": 1385.9371908602143, "cost1_min": 23.139020389841235, "system_level_velocity_min": 12.358032818278438, "system_level_velocity_max": 18.872689522821776, "outflow_rate_min": 513.1510694623687, "outflow_rate_mean": 1201.692385598756, "cost2_min": -65.86313324463745}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 789763, "time_total_s": 626.660130739212, "timestamp": 1558592712, "iterations_since_restore": 20, "policy_reward_mean": {}, "training_iteration": 20, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a0b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a320>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a208>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 925, "timesteps_total": 789763, "episode_reward_mean": -435.4103424031418, "episodes_this_iter": 58, "date": "2019-05-23_06-25-12", "time_this_iter_s": 30.751317977905273, "num_metric_batches_dropped": 0, "episode_reward_min": -678.9590266330858}
{"time_since_restore": 655.4615194797516, "info": {"default": {"kl": 0.008423044346272945, "total_loss": 16.303895950317383, "vf_explained_var": 0.8581475019454956, "cur_lr": 0.0005000000237487257, "policy_loss": -0.002773017156869173, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 16.306245803833008, "entropy": 1.2830181121826172}, "num_steps_trained": 828244, "grad_time_ms": 11009.669, "load_time_ms": 17.85, "sample_time_ms": 19399.985, "num_steps_sampled": 828244, "update_time_ms": 8.509}, "hostname": "flow-main", "episode_reward_max": -271.54866849951304, "timesteps_this_iter": 38481, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.7131590836268, "cost1_mean": 188.76693921577692, "system_level_velocity_mean": 15.58666926354741, "cost2_mean": -45.48716109503673, "cost2_max": -29.67932690627914, "outflow_rate_max": 1385.9371908602143, "cost1_min": 153.86095483840182, "system_level_velocity_min": 12.581538313180502, "system_level_velocity_max": 18.309971826526667, "outflow_rate_min": 1046.207456445993, "outflow_rate_mean": 1210.4403735030262, "cost2_min": -65.86313324463745}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 828244, "time_total_s": 655.4615194797516, "timestamp": 1558592741, "iterations_since_restore": 21, "policy_reward_mean": {}, "training_iteration": 21, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913048>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849135c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913e10>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 966, "timesteps_total": 828244, "episode_reward_mean": -424.20455324351707, "episodes_this_iter": 41, "date": "2019-05-23_06-25-41", "time_this_iter_s": 28.80138874053955, "num_metric_batches_dropped": 0, "episode_reward_min": -678.9590266330858}
{"time_since_restore": 684.6980574131012, "info": {"default": {"kl": 0.011071179062128067, "total_loss": 17.505708694458008, "vf_explained_var": 0.8520233631134033, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0039467643946409225, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 17.50910186767578, "entropy": 1.2679859399795532}, "num_steps_trained": 867158, "grad_time_ms": 10816.962, "load_time_ms": 17.82, "sample_time_ms": 19512.471, "num_steps_sampled": 867158, "update_time_ms": 8.263}, "hostname": "flow-main", "episode_reward_max": -271.54866849951304, "timesteps_this_iter": 38914, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.7131590836268, "cost1_mean": 187.27100332018784, "system_level_velocity_mean": 15.44845852087508, "cost2_mean": -44.98728312272127, "cost2_max": -29.67932690627914, "outflow_rate_max": 1370.9261924439204, "cost1_min": 153.86095483840182, "system_level_velocity_min": 12.581538313180502, "system_level_velocity_max": 18.309971826526667, "outflow_rate_min": 1046.207456445993, "outflow_rate_mean": 1201.3702781069924, "cost2_min": -65.86313324463745}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 867158, "time_total_s": 684.6980574131012, "timestamp": 1558592770, "iterations_since_restore": 22, "policy_reward_mean": {}, "training_iteration": 22, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a2e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a588>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1007, "timesteps_total": 867158, "episode_reward_mean": -427.02675382921217, "episodes_this_iter": 41, "date": "2019-05-23_06-26-10", "time_this_iter_s": 29.23653793334961, "num_metric_batches_dropped": 0, "episode_reward_min": -678.9590266330858}
{"time_since_restore": 714.2721652984619, "info": {"default": {"kl": 0.011562695726752281, "total_loss": 15.613870620727539, "vf_explained_var": 0.8544022440910339, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004916276317089796, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 15.618208885192871, "entropy": 1.2424309253692627}, "num_steps_trained": 903741, "grad_time_ms": 10497.169, "load_time_ms": 17.982, "sample_time_ms": 19566.617, "num_steps_sampled": 903741, "update_time_ms": 8.24}, "hostname": "flow-main", "episode_reward_max": -264.6358630346647, "timesteps_this_iter": 36583, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.0088912140523, "cost1_mean": 188.86778430215088, "system_level_velocity_mean": 15.625038852002387, "cost2_mean": -42.231277506081, "cost2_max": -30.800951080036242, "outflow_rate_max": 1357.942767904478, "cost1_min": 149.29624752966822, "system_level_velocity_min": 12.346679848569542, "system_level_velocity_max": 18.250874486685653, "outflow_rate_min": 988.317422884414, "outflow_rate_mean": 1198.898027600355, "cost2_min": -63.61668734156165}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 903741, "time_total_s": 714.2721652984619, "timestamp": 1558592800, "iterations_since_restore": 23, "policy_reward_mean": {}, "training_iteration": 23, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e8d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491aa58>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e2e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1060, "timesteps_total": 903741, "episode_reward_mean": -405.0491655202666, "episodes_this_iter": 53, "date": "2019-05-23_06-26-40", "time_this_iter_s": 29.574107885360718, "num_metric_batches_dropped": 0, "episode_reward_min": -588.0881353297749}
{"time_since_restore": 743.1861345767975, "info": {"default": {"kl": 0.011067837476730347, "total_loss": 12.316106796264648, "vf_explained_var": 0.878287136554718, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006120661273598671, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 12.321673393249512, "entropy": 1.2146871089935303}, "num_steps_trained": 938581, "grad_time_ms": 10319.693, "load_time_ms": 17.914, "sample_time_ms": 19565.365, "num_steps_sampled": 938581, "update_time_ms": 8.416}, "hostname": "flow-main", "episode_reward_max": -264.2877346287689, "timesteps_this_iter": 34840, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.0088912140523, "cost1_mean": 190.59537310659533, "system_level_velocity_mean": 15.829804553009476, "cost2_mean": -38.89327792277779, "cost2_max": -27.069020165214386, "outflow_rate_max": 1357.942767904478, "cost1_min": 149.29624752966822, "system_level_velocity_min": 12.346679848569542, "system_level_velocity_max": 18.302251393138498, "outflow_rate_min": 927.1144793388428, "outflow_rate_mean": 1192.707596954105, "cost2_min": -63.61668734156165}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 938581, "time_total_s": 743.1861345767975, "timestamp": 1558592829, "iterations_since_restore": 24, "policy_reward_mean": {}, "training_iteration": 24, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a080>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492acf8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492af60>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1106, "timesteps_total": 938581, "episode_reward_mean": -377.7089656991824, "episodes_this_iter": 46, "date": "2019-05-23_06-27-09", "time_this_iter_s": 28.91396927833557, "num_metric_batches_dropped": 0, "episode_reward_min": -588.0881353297749}
{"time_since_restore": 770.0738906860352, "info": {"default": {"kl": 0.01246777456253767, "total_loss": 12.926962852478027, "vf_explained_var": 0.8914962410926819, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005796079523861408, "cur_kl_coeff": 0.05000000074505806, "vf_loss": 12.932135581970215, "entropy": 1.2170686721801758}, "num_steps_trained": 974149, "grad_time_ms": 10051.163, "load_time_ms": 17.879, "sample_time_ms": 19569.057, "num_steps_sampled": 974149, "update_time_ms": 8.188}, "hostname": "flow-main", "episode_reward_max": -243.8737286832014, "timesteps_this_iter": 35568, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 217.43439061406016, "cost1_mean": 190.05063608729975, "system_level_velocity_mean": 15.825341737081787, "cost2_mean": -37.214892061557045, "cost2_max": -23.707202419164673, "outflow_rate_max": 1340.3965067478605, "cost1_min": 151.08607437919824, "system_level_velocity_min": 12.67967211006082, "system_level_velocity_max": 18.3886940944347, "outflow_rate_min": 927.1144793388428, "outflow_rate_mean": 1181.9988938770339, "cost2_min": -55.436771122286764}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 974149, "time_total_s": 770.0738906860352, "timestamp": 1558592855, "iterations_since_restore": 25, "policy_reward_mean": {}, "training_iteration": 25, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913dd8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913390>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849138d0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1147, "timesteps_total": 974149, "episode_reward_mean": -369.98638420625554, "episodes_this_iter": 41, "date": "2019-05-23_06-27-35", "time_this_iter_s": 26.88775610923767, "num_metric_batches_dropped": 0, "episode_reward_min": -601.0577772626765}
{"time_since_restore": 798.6312382221222, "info": {"default": {"kl": 0.011652451008558273, "total_loss": 15.192009925842285, "vf_explained_var": 0.8824394941329956, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00556233199313283, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 15.196989059448242, "entropy": 1.2055068016052246}, "num_steps_trained": 1009942, "grad_time_ms": 9806.193, "load_time_ms": 17.452, "sample_time_ms": 19648.103, "num_steps_sampled": 1009942, "update_time_ms": 7.992}, "hostname": "flow-main", "episode_reward_max": -243.8737286832014, "timesteps_this_iter": 35793, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 217.9141995276853, "cost1_mean": 187.043332795596, "system_level_velocity_mean": 15.575483426275401, "cost2_mean": -37.049219769333064, "cost2_max": -23.707202419164673, "outflow_rate_max": 1341.4729667585887, "cost1_min": 150.75690455238822, "system_level_velocity_min": 12.572827251419696, "system_level_velocity_max": 18.3886940944347, "outflow_rate_min": 951.1067689919043, "outflow_rate_mean": 1166.1668565423092, "cost2_min": -55.436771122286764}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 1009942, "time_total_s": 798.6312382221222, "timestamp": 1558592884, "iterations_since_restore": 26, "policy_reward_mean": {}, "training_iteration": 26, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492ae80>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a550>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a7f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1201, "timesteps_total": 1009942, "episode_reward_mean": -378.5417676474846, "episodes_this_iter": 54, "date": "2019-05-23_06-28-04", "time_this_iter_s": 28.557347536087036, "num_metric_batches_dropped": 0, "episode_reward_min": -601.0577772626765}
{"time_since_restore": 825.9789559841156, "info": {"default": {"kl": 0.012766662053763866, "total_loss": 13.62993049621582, "vf_explained_var": 0.8710962533950806, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004382418934255838, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 13.633674621582031, "entropy": 1.1921762228012085}, "num_steps_trained": 1044348, "grad_time_ms": 9620.099, "load_time_ms": 17.378, "sample_time_ms": 19407.945, "num_steps_sampled": 1044348, "update_time_ms": 8.025}, "hostname": "flow-main", "episode_reward_max": -246.27731493594462, "timesteps_this_iter": 34406, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 217.9141995276853, "cost1_mean": 188.85741995579087, "system_level_velocity_mean": 15.75294315869176, "cost2_mean": -35.903675621648425, "cost2_max": -25.428013900699135, "outflow_rate_max": 1341.4729667585887, "cost1_min": 150.75690455238822, "system_level_velocity_min": 12.572827251419696, "system_level_velocity_max": 18.317304693658848, "outflow_rate_min": 951.1067689919043, "outflow_rate_mean": 1168.2723911553178, "cost2_min": -53.936008730917955}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 1044348, "time_total_s": 825.9789559841156, "timestamp": 1558592911, "iterations_since_restore": 27, "policy_reward_mean": {}, "training_iteration": 27, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846afb00>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7048>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1245, "timesteps_total": 1044348, "episode_reward_mean": -370.1619817850022, "episodes_this_iter": 44, "date": "2019-05-23_06-28-31", "time_this_iter_s": 27.347717761993408, "num_metric_batches_dropped": 0, "episode_reward_min": -565.922378932358}
{"time_since_restore": 853.4788627624512, "info": {"default": {"kl": 0.01512108463793993, "total_loss": 15.543046951293945, "vf_explained_var": 0.855808436870575, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007320542354136705, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 15.54961109161377, "entropy": 1.1704204082489014}, "num_steps_trained": 1078666, "grad_time_ms": 9455.24, "load_time_ms": 17.09, "sample_time_ms": 19248.763, "num_steps_sampled": 1078666, "update_time_ms": 8.168}, "hostname": "flow-main", "episode_reward_max": -103.5111109243681, "timesteps_this_iter": 34318, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.28411789145198, "cost1_mean": 190.68052539774982, "system_level_velocity_mean": 16.129580767145068, "cost2_mean": -34.06347321025332, "cost2_max": -24.904048052085553, "outflow_rate_max": 1352.805586627418, "cost1_min": 83.44502392978922, "system_level_velocity_min": 12.520152404739548, "system_level_velocity_max": 18.51504009831777, "outflow_rate_min": 800.1991332985428, "outflow_rate_mean": 1173.4581709491495, "cost2_min": -53.936008730917955}, "episode_len_mean": 321.26, "node_ip": "10.138.0.2", "timesteps_since_restore": 1078666, "time_total_s": 853.4788627624512, "timestamp": 1558592939, "iterations_since_restore": 28, "policy_reward_mean": {}, "training_iteration": 28, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af470>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af5f8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af588>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1287, "timesteps_total": 1078666, "episode_reward_mean": -350.25440991657086, "episodes_this_iter": 42, "date": "2019-05-23_06-28-59", "time_this_iter_s": 27.49990677833557, "num_metric_batches_dropped": 0, "episode_reward_min": -565.922378932358}
{"time_since_restore": 879.967447757721, "info": {"default": {"kl": 0.014085081405937672, "total_loss": 11.846208572387695, "vf_explained_var": 0.8863976001739502, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006101048551499844, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 11.851605415344238, "entropy": 1.1695210933685303}, "num_steps_trained": 1111828, "grad_time_ms": 9322.302, "load_time_ms": 16.56, "sample_time_ms": 18979.687, "num_steps_sampled": 1111828, "update_time_ms": 8.137}, "hostname": "flow-main", "episode_reward_max": -103.5111109243681, "timesteps_this_iter": 33162, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.28411789145198, "cost1_mean": 192.89757068508194, "system_level_velocity_mean": 16.345324460682846, "cost2_mean": -31.51023972568657, "cost2_max": -19.80049564895642, "outflow_rate_max": 1352.805586627418, "cost1_min": 83.44502392978922, "system_level_velocity_min": 12.29074313989636, "system_level_velocity_max": 18.51504009831777, "outflow_rate_min": 800.1991332985428, "outflow_rate_mean": 1172.167297555556, "cost2_min": -44.751172125056335}, "episode_len_mean": 321.26, "node_ip": "10.138.0.2", "timesteps_since_restore": 1111828, "time_total_s": 879.967447757721, "timestamp": 1558592965, "iterations_since_restore": 29, "policy_reward_mean": {}, "training_iteration": 29, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492aef0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a8d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7080>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1331, "timesteps_total": 1111828, "episode_reward_mean": -328.89540323428685, "episodes_this_iter": 44, "date": "2019-05-23_06-29-25", "time_this_iter_s": 26.488584995269775, "num_metric_batches_dropped": 0, "episode_reward_min": -513.2855712179814}
{"time_since_restore": 906.1632966995239, "info": {"default": {"kl": 0.014489867724478245, "total_loss": 12.911243438720703, "vf_explained_var": 0.8666952252388, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004925410263240337, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 12.915443420410156, "entropy": 1.1469124555587769}, "num_steps_trained": 1144826, "grad_time_ms": 9197.925, "load_time_ms": 16.384, "sample_time_ms": 18648.683, "num_steps_sampled": 1144826, "update_time_ms": 8.116}, "hostname": "flow-main", "episode_reward_max": -259.08578585077464, "timesteps_this_iter": 32998, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 216.76211093175186, "cost1_mean": 192.03134407686915, "system_level_velocity_mean": 16.07900295024329, "cost2_mean": -29.291283726083005, "cost2_max": -19.36292058781338, "outflow_rate_max": 1314.899980714586, "cost1_min": 149.27764821186656, "system_level_velocity_min": 12.29074313989636, "system_level_velocity_max": 18.33988298886016, "outflow_rate_min": 980.4696460554374, "outflow_rate_mean": 1152.3444265290084, "cost2_min": -44.751172125056335}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1144826, "time_total_s": 906.1632966995239, "timestamp": 1558592992, "iterations_since_restore": 30, "policy_reward_mean": {}, "training_iteration": 30, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b74a8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7e80>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1385, "timesteps_total": 1144826, "episode_reward_mean": -333.4385091531079, "episodes_this_iter": 54, "date": "2019-05-23_06-29-52", "time_this_iter_s": 26.19584894180298, "num_metric_batches_dropped": 0, "episode_reward_min": -549.473181811914}
{"time_since_restore": 931.8269484043121, "info": {"default": {"kl": 0.01585153490304947, "total_loss": 11.5816011428833, "vf_explained_var": 0.8884143829345703, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007405101787298918, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 11.588212966918945, "entropy": 1.1245847940444946}, "num_steps_trained": 1177694, "grad_time_ms": 9125.174, "load_time_ms": 15.738, "sample_time_ms": 18406.933, "num_steps_sampled": 1177694, "update_time_ms": 8.43}, "hostname": "flow-main", "episode_reward_max": -252.61374723658182, "timesteps_this_iter": 32868, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 215.84573436673588, "cost1_mean": 194.6592889979787, "system_level_velocity_mean": 16.332401495514127, "cost2_mean": -28.325837454709568, "cost2_max": -19.36292058781338, "outflow_rate_max": 1298.6248973274828, "cost1_min": 149.27764821186656, "system_level_velocity_min": 12.550297490325983, "system_level_velocity_max": 18.26241099444345, "outflow_rate_min": 931.4831013723557, "outflow_rate_mean": 1158.6757320620968, "cost2_min": -41.830756615147735}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1177694, "time_total_s": 931.8269484043121, "timestamp": 1558593017, "iterations_since_restore": 31, "policy_reward_mean": {}, "training_iteration": 31, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7048>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7fd0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7358>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1427, "timesteps_total": 1177694, "episode_reward_mean": -323.4069991570183, "episodes_this_iter": 42, "date": "2019-05-23_06-30-17", "time_this_iter_s": 25.663651704788208, "num_metric_batches_dropped": 0, "episode_reward_min": -549.473181811914}
{"time_since_restore": 957.1277868747711, "info": {"default": {"kl": 0.014739385806024075, "total_loss": 10.429095268249512, "vf_explained_var": 0.9005488157272339, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006541658192873001, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 10.434900283813477, "entropy": 1.132476806640625}, "num_steps_trained": 1209494, "grad_time_ms": 8997.077, "load_time_ms": 15.218, "sample_time_ms": 18142.04, "num_steps_sampled": 1209494, "update_time_ms": 8.7}, "hostname": "flow-main", "episode_reward_max": -238.91793936004146, "timesteps_this_iter": 31800, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 217.15676768641993, "cost1_mean": 193.94087721742576, "system_level_velocity_mean": 16.29369860932907, "cost2_mean": -28.18952116427308, "cost2_max": -19.045488095695177, "outflow_rate_max": 1305.7491873229978, "cost1_min": 153.17098045798375, "system_level_velocity_min": 12.9440285622753, "system_level_velocity_max": 18.46960666180042, "outflow_rate_min": 931.4831013723557, "outflow_rate_mean": 1148.209555611591, "cost2_min": -41.055446119511856}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1209494, "time_total_s": 957.1277868747711, "timestamp": 1558593043, "iterations_since_restore": 32, "policy_reward_mean": {}, "training_iteration": 32, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7710>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7d68>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b70f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1469, "timesteps_total": 1209494, "episode_reward_mean": -319.0855782680477, "episodes_this_iter": 42, "date": "2019-05-23_06-30-43", "time_this_iter_s": 25.300838470458984, "num_metric_batches_dropped": 0, "episode_reward_min": -455.58283599970383}
{"time_since_restore": 983.252970457077, "info": {"default": {"kl": 0.01385436113923788, "total_loss": 13.202266693115234, "vf_explained_var": 0.8708952069282532, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005300481338053942, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 13.20687484741211, "entropy": 1.1214746236801147}, "num_steps_trained": 1241182, "grad_time_ms": 8900.827, "load_time_ms": 14.771, "sample_time_ms": 17892.552, "num_steps_sampled": 1241182, "update_time_ms": 8.814}, "hostname": "flow-main", "episode_reward_max": -160.2885409596381, "timesteps_this_iter": 31688, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 217.15676768641993, "cost1_mean": 191.12942694701476, "system_level_velocity_mean": 16.215186052913335, "cost2_mean": -27.603501088795113, "cost2_max": -18.022644546597324, "outflow_rate_max": 1305.7491873229978, "cost1_min": 134.13511528372294, "system_level_velocity_min": 12.52690471271824, "system_level_velocity_max": 18.46960666180042, "outflow_rate_min": 931.4831013723557, "outflow_rate_mean": 1126.6327899252217, "cost2_min": -41.055446119511856}, "episode_len_mean": 322.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 1241182, "time_total_s": 983.252970457077, "timestamp": 1558593069, "iterations_since_restore": 33, "policy_reward_mean": {}, "training_iteration": 33, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490ef98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913978>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491afd0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1525, "timesteps_total": 1241182, "episode_reward_mean": -314.9360873890163, "episodes_this_iter": 56, "date": "2019-05-23_06-31-09", "time_this_iter_s": 26.125183582305908, "num_metric_batches_dropped": 0, "episode_reward_min": -461.82870572284287}
{"time_since_restore": 1008.3242282867432, "info": {"default": {"kl": 0.016259081661701202, "total_loss": 10.169036865234375, "vf_explained_var": 0.8975222110748291, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007417828310281038, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 10.175642013549805, "entropy": 1.1225250959396362}, "num_steps_trained": 1271844, "grad_time_ms": 8798.552, "load_time_ms": 14.572, "sample_time_ms": 17611.803, "num_steps_sampled": 1271844, "update_time_ms": 8.497}, "hostname": "flow-main", "episode_reward_max": -24.14432086577161, "timesteps_this_iter": 30662, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 215.6847948886101, "cost1_mean": 190.9467363762786, "system_level_velocity_mean": 16.512733260472892, "cost2_mean": -26.044219821016085, "cost2_max": -13.722998251185691, "outflow_rate_max": 1290.7158485832354, "cost1_min": 17.819812100837115, "system_level_velocity_min": 12.52690471271824, "system_level_velocity_max": 18.430227656023543, "outflow_rate_min": 447.40921683303424, "outflow_rate_mean": 1103.6906349095352, "cost2_min": -36.575387512048685}, "episode_len_mean": 318.48, "node_ip": "10.138.0.2", "timesteps_since_restore": 1271844, "time_total_s": 1008.3242282867432, "timestamp": 1558593094, "iterations_since_restore": 34, "policy_reward_mean": {}, "training_iteration": 34, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7a20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7128>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1567, "timesteps_total": 1271844, "episode_reward_mean": -295.71183015373833, "episodes_this_iter": 42, "date": "2019-05-23_06-31-34", "time_this_iter_s": 25.071257829666138, "num_metric_batches_dropped": 0, "episode_reward_min": -461.82870572284287}
{"time_since_restore": 1033.4364039897919, "info": {"default": {"kl": 0.017546704038977623, "total_loss": 10.294373512268066, "vf_explained_var": 0.8947702050209045, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008039453998208046, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 10.301535606384277, "entropy": 1.1100246906280518}, "num_steps_trained": 1302030, "grad_time_ms": 8808.923, "load_time_ms": 14.054, "sample_time_ms": 17423.105, "num_steps_sampled": 1302030, "update_time_ms": 8.635}, "hostname": "flow-main", "episode_reward_max": -24.14432086577161, "timesteps_this_iter": 30186, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 216.76042897548768, "cost1_mean": 190.52726706155616, "system_level_velocity_mean": 16.58339833584409, "cost2_mean": -25.786722827796275, "cost2_max": -13.722998251185691, "outflow_rate_max": 1290.6582708246337, "cost1_min": 17.819812100837115, "system_level_velocity_min": 12.91998702522534, "system_level_velocity_max": 18.463269627967517, "outflow_rate_min": 447.40921683303424, "outflow_rate_mean": 1085.473973569449, "cost2_min": -34.930134833554376}, "episode_len_mean": 317.41, "node_ip": "10.138.0.2", "timesteps_since_restore": 1302030, "time_total_s": 1033.4364039897919, "timestamp": 1558593119, "iterations_since_restore": 35, "policy_reward_mean": {}, "training_iteration": 35, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7d68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b79e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7080>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1614, "timesteps_total": 1302030, "episode_reward_mean": -285.5097087597318, "episodes_this_iter": 47, "date": "2019-05-23_06-31-59", "time_this_iter_s": 25.112175703048706, "num_metric_batches_dropped": 0, "episode_reward_min": -445.01255287170966}
{"time_since_restore": 1058.5626120567322, "info": {"default": {"kl": 0.016604289412498474, "total_loss": 11.233211517333984, "vf_explained_var": 0.8812669515609741, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008099122904241085, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 11.240480422973633, "entropy": 1.0919818878173828}, "num_steps_trained": 1332033, "grad_time_ms": 8754.734, "load_time_ms": 14.732, "sample_time_ms": 17134.875, "num_steps_sampled": 1332033, "update_time_ms": 8.804}, "hostname": "flow-main", "episode_reward_max": -160.55457854309307, "timesteps_this_iter": 30003, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 216.76042897548768, "cost1_mean": 191.11801729597934, "system_level_velocity_mean": 16.37216396661643, "cost2_mean": -26.93643303671053, "cost2_max": -17.646734488867054, "outflow_rate_max": 1278.6422727272727, "cost1_min": 135.80940130176026, "system_level_velocity_min": 12.91998702522534, "system_level_velocity_max": 18.463269627967517, "outflow_rate_min": 918.4340584926883, "outflow_rate_mean": 1082.2442838856111, "cost2_min": -34.930134833554376}, "episode_len_mean": 321.57, "node_ip": "10.138.0.2", "timesteps_since_restore": 1332033, "time_total_s": 1058.5626120567322, "timestamp": 1558593144, "iterations_since_restore": 36, "policy_reward_mean": {}, "training_iteration": 36, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7780>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b71d0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1664, "timesteps_total": 1332033, "episode_reward_mean": -291.6651180048113, "episodes_this_iter": 50, "date": "2019-05-23_06-32-24", "time_this_iter_s": 25.126208066940308, "num_metric_batches_dropped": 0, "episode_reward_min": -445.01255287170966}
{"time_since_restore": 1084.1625866889954, "info": {"default": {"kl": 0.0187066737562418, "total_loss": 10.43808364868164, "vf_explained_var": 0.8920451998710632, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009037436917424202, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 10.446184158325195, "entropy": 1.0736520290374756}, "num_steps_trained": 1363526, "grad_time_ms": 8804.08, "load_time_ms": 15.093, "sample_time_ms": 16912.586, "num_steps_sampled": 1363526, "update_time_ms": 8.898}, "hostname": "flow-main", "episode_reward_max": -160.55457854309307, "timesteps_this_iter": 31493, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 216.94518899992664, "cost1_mean": 194.84238795575843, "system_level_velocity_mean": 16.583726352737134, "cost2_mean": -27.037916732577308, "cost2_max": -17.183592034268038, "outflow_rate_max": 1288.1016700089504, "cost1_min": 137.9704005311402, "system_level_velocity_min": 13.273025505867983, "system_level_velocity_max": 18.410566294067365, "outflow_rate_min": 931.9494695121954, "outflow_rate_mean": 1101.4144582183037, "cost2_min": -34.437999613856306}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 1363526, "time_total_s": 1084.1625866889954, "timestamp": 1558593170, "iterations_since_restore": 37, "policy_reward_mean": {}, "training_iteration": 37, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7da0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7470>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1708, "timesteps_total": 1363526, "episode_reward_mean": -289.57714068175267, "episodes_this_iter": 44, "date": "2019-05-23_06-32-50", "time_this_iter_s": 25.599974632263184, "num_metric_batches_dropped": 0, "episode_reward_min": -373.90119824394174}
{"time_since_restore": 1109.3480865955353, "info": {"default": {"kl": 0.01813574507832527, "total_loss": 9.365500450134277, "vf_explained_var": 0.8939908742904663, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008619303815066814, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 9.373212814331055, "entropy": 1.0613504648208618}, "num_steps_trained": 1393851, "grad_time_ms": 8741.929, "load_time_ms": 15.005, "sample_time_ms": 16742.004, "num_steps_sampled": 1393851, "update_time_ms": 8.824}, "hostname": "flow-main", "episode_reward_max": -160.55457854309307, "timesteps_this_iter": 30325, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 216.94518899992664, "cost1_mean": 195.7891841713555, "system_level_velocity_mean": 16.659257540486273, "cost2_mean": -27.151855998655005, "cost2_max": -17.183592034268038, "outflow_rate_max": 1288.1016700089504, "cost1_min": 137.9704005311402, "system_level_velocity_min": 13.77237440227114, "system_level_velocity_max": 18.394522668026692, "outflow_rate_min": 938.1206930308446, "outflow_rate_mean": 1116.4115329098904, "cost2_min": -34.437999613856306}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 1393851, "time_total_s": 1109.3480865955353, "timestamp": 1558593195, "iterations_since_restore": 38, "policy_reward_mean": {}, "training_iteration": 38, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b70f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7e10>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1754, "timesteps_total": 1393851, "episode_reward_mean": -289.2016909842018, "episodes_this_iter": 46, "date": "2019-05-23_06-33-15", "time_this_iter_s": 25.185499906539917, "num_metric_batches_dropped": 0, "episode_reward_min": -373.90119824394174}
{"time_since_restore": 1136.0409045219421, "info": {"default": {"kl": 0.0180938933044672, "total_loss": 11.386589050292969, "vf_explained_var": 0.8895275592803955, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006741016637533903, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 11.392424583435059, "entropy": 1.0462218523025513}, "num_steps_trained": 1425702, "grad_time_ms": 8712.5, "load_time_ms": 14.428, "sample_time_ms": 16789.996, "num_steps_sampled": 1425702, "update_time_ms": 9.148}, "hostname": "flow-main", "episode_reward_max": -31.509180036268102, "timesteps_this_iter": 31851, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 215.22085544955115, "cost1_mean": 193.69315771575978, "system_level_velocity_mean": 16.559213146322758, "cost2_mean": -27.532802219034437, "cost2_max": -14.760516580794652, "outflow_rate_max": 1264.0882330648444, "cost1_min": 24.325162203474218, "system_level_velocity_min": 13.109340969908343, "system_level_velocity_max": 18.651633490989962, "outflow_rate_min": 480.33720946980384, "outflow_rate_mean": 1121.2209408302706, "cost2_min": -37.551230011671876}, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 1425702, "time_total_s": 1136.0409045219421, "timestamp": 1558593222, "iterations_since_restore": 39, "policy_reward_mean": {}, "training_iteration": 39, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b74e0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7e80>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1804, "timesteps_total": 1425702, "episode_reward_mean": -297.41738244001465, "episodes_this_iter": 50, "date": "2019-05-23_06-33-42", "time_this_iter_s": 26.69281792640686, "num_metric_batches_dropped": 0, "episode_reward_min": -442.5317364988768}
{"time_since_restore": 1162.5248653888702, "info": {"default": {"kl": 0.019791830331087112, "total_loss": 11.615962028503418, "vf_explained_var": 0.8644774556159973, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006360271945595741, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 11.621331214904785, "entropy": 1.0120890140533447}, "num_steps_trained": 1458373, "grad_time_ms": 8648.238, "load_time_ms": 14.371, "sample_time_ms": 16882.886, "num_steps_sampled": 1458373, "update_time_ms": 9.458}, "hostname": "flow-main", "episode_reward_max": -23.429338589060205, "timesteps_this_iter": 32671, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.3982763545403, "cost1_mean": 193.34779072672833, "system_level_velocity_mean": 16.811325922616774, "cost2_mean": -27.215618726624665, "cost2_max": -10.950168757051909, "outflow_rate_max": 1315.5818831168829, "cost1_min": 17.488801004383287, "system_level_velocity_min": 13.109340969908343, "system_level_velocity_max": 18.67148079570665, "outflow_rate_min": 459.9158090748286, "outflow_rate_mean": 1138.7808245161168, "cost2_min": -37.551230011671876}, "episode_len_mean": 316.24, "node_ip": "10.138.0.2", "timesteps_since_restore": 1458373, "time_total_s": 1162.5248653888702, "timestamp": 1558593248, "iterations_since_restore": 40, "policy_reward_mean": {}, "training_iteration": 40, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7da0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7a90>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7c50>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1850, "timesteps_total": 1458373, "episode_reward_mean": -293.4298374442227, "episodes_this_iter": 46, "date": "2019-05-23_06-34-08", "time_this_iter_s": 26.4839608669281, "num_metric_batches_dropped": 0, "episode_reward_min": -442.5317364988768}
{"time_since_restore": 1189.2318229675293, "info": {"default": {"kl": 0.0222368985414505, "total_loss": 11.622236251831055, "vf_explained_var": 0.8898193836212158, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008859438821673393, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 11.629982948303223, "entropy": 1.030976414680481}, "num_steps_trained": 1492376, "grad_time_ms": 8600.941, "load_time_ms": 14.318, "sample_time_ms": 17034.503, "num_steps_sampled": 1492376, "update_time_ms": 9.267}, "hostname": "flow-main", "episode_reward_max": -23.155392921152924, "timesteps_this_iter": 34003, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.2839776415957, "cost1_mean": 191.53200544136286, "system_level_velocity_mean": 16.74069601220015, "cost2_mean": -27.688673615985373, "cost2_max": -10.950168757051909, "outflow_rate_max": 1331.275886803874, "cost1_min": 17.488801004383287, "system_level_velocity_min": 12.627745413200865, "system_level_velocity_max": 18.67148079570665, "outflow_rate_min": 451.264202181489, "outflow_rate_mean": 1150.274495248471, "cost2_min": -37.551230011671876}, "episode_len_mean": 313.24, "node_ip": "10.138.0.2", "timesteps_since_restore": 1492376, "time_total_s": 1189.2318229675293, "timestamp": 1558593275, "iterations_since_restore": 41, "policy_reward_mean": {}, "training_iteration": 41, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492af28>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a2b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492add8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1894, "timesteps_total": 1492376, "episode_reward_mean": -301.1963533832344, "episodes_this_iter": 44, "date": "2019-05-23_06-34-35", "time_this_iter_s": 26.706957578659058, "num_metric_batches_dropped": 0, "episode_reward_min": -504.5528967393679}
{"time_since_restore": 1216.430964231491, "info": {"default": {"kl": 0.015426714904606342, "total_loss": 13.553703308105469, "vf_explained_var": 0.8683777451515198, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006360147148370743, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 13.558906555175781, "entropy": 1.0295512676239014}, "num_steps_trained": 1526267, "grad_time_ms": 8663.771, "load_time_ms": 14.345, "sample_time_ms": 17161.064, "num_steps_sampled": 1526267, "update_time_ms": 9.088}, "hostname": "flow-main", "episode_reward_max": -23.155392921152924, "timesteps_this_iter": 33891, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.2839776415957, "cost1_mean": 193.62120492909892, "system_level_velocity_mean": 16.544962613462435, "cost2_mean": -28.410134838169625, "cost2_max": -11.947617968929007, "outflow_rate_max": 1331.275886803874, "cost1_min": 17.688604317841943, "system_level_velocity_min": 10.840303283128835, "system_level_velocity_max": 18.64864819887639, "outflow_rate_min": 451.264202181489, "outflow_rate_mean": 1171.9554971302912, "cost2_min": -36.64954321926653}, "episode_len_mean": 319.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 1526267, "time_total_s": 1216.430964231491, "timestamp": 1558593302, "iterations_since_restore": 42, "policy_reward_mean": {}, "training_iteration": 42, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7c18>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b77f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1941, "timesteps_total": 1526267, "episode_reward_mean": -316.3474930052257, "episodes_this_iter": 47, "date": "2019-05-23_06-35-02", "time_this_iter_s": 27.199141263961792, "num_metric_batches_dropped": 0, "episode_reward_min": -513.7188709449466}
{"time_since_restore": 1244.4869782924652, "info": {"default": {"kl": 0.017407508566975594, "total_loss": 11.753060340881348, "vf_explained_var": 0.8855080604553223, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006401590071618557, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 11.758156776428223, "entropy": 1.036643385887146}, "num_steps_trained": 1559529, "grad_time_ms": 8756.056, "load_time_ms": 14.44, "sample_time_ms": 17262.427, "num_steps_sampled": 1559529, "update_time_ms": 9.151}, "hostname": "flow-main", "episode_reward_max": -237.81259048441885, "timesteps_this_iter": 33262, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.3214827467848, "cost1_mean": 195.73559132070685, "system_level_velocity_mean": 16.36705091224041, "cost2_mean": -29.43216542141797, "cost2_max": -19.776894755552817, "outflow_rate_max": 1329.165683724988, "cost1_min": 131.18271726597612, "system_level_velocity_min": 10.840303283128835, "system_level_velocity_max": 18.64864819887639, "outflow_rate_min": 922.3097827665896, "outflow_rate_mean": 1180.4755241334167, "cost2_min": -42.489438928585066}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1559529, "time_total_s": 1244.4869782924652, "timestamp": 1558593331, "iterations_since_restore": 43, "policy_reward_mean": {}, "training_iteration": 43, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7b38>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7048>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b72e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 1991, "timesteps_total": 1559529, "episode_reward_mean": -325.89401609973584, "episodes_this_iter": 50, "date": "2019-05-23_06-35-31", "time_this_iter_s": 28.05601406097412, "num_metric_batches_dropped": 0, "episode_reward_min": -513.7188709449466}
{"time_since_restore": 1271.086772441864, "info": {"default": {"kl": 0.01676207408308983, "total_loss": 11.411293029785156, "vf_explained_var": 0.8813272714614868, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008709962479770184, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 11.418745994567871, "entropy": 1.0175409317016602}, "num_steps_trained": 1592621, "grad_time_ms": 8858.487, "load_time_ms": 14.498, "sample_time_ms": 17311.899, "num_steps_sampled": 1592621, "update_time_ms": 9.008}, "hostname": "flow-main", "episode_reward_max": -30.61022655021959, "timesteps_this_iter": 33092, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.52034330255557, "cost1_mean": 196.9877887529426, "system_level_velocity_mean": 16.674932829045225, "cost2_mean": -29.220063215368885, "cost2_max": -14.066085804494445, "outflow_rate_max": 1329.165683724988, "cost1_min": 24.565722656022302, "system_level_velocity_min": 12.8919434723334, "system_level_velocity_max": 18.826677045389083, "outflow_rate_min": 492.1711703675176, "outflow_rate_mean": 1184.2606507063958, "cost2_min": -42.489438928585066}, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 1592621, "time_total_s": 1271.086772441864, "timestamp": 1558593357, "iterations_since_restore": 44, "policy_reward_mean": {}, "training_iteration": 44, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7860>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7780>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b70f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2035, "timesteps_total": 1592621, "episode_reward_mean": -310.98780553618775, "episodes_this_iter": 44, "date": "2019-05-23_06-35-57", "time_this_iter_s": 26.599794149398804, "num_metric_batches_dropped": 0, "episode_reward_min": -513.5301426141026}
{"time_since_restore": 1297.8288617134094, "info": {"default": {"kl": 0.017696380615234375, "total_loss": 13.544471740722656, "vf_explained_var": 0.8741323351860046, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007802881766110659, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 13.550948143005371, "entropy": 1.0427764654159546}, "num_steps_trained": 1626811, "grad_time_ms": 8953.058, "load_time_ms": 15.482, "sample_time_ms": 17379.964, "num_steps_sampled": 1626811, "update_time_ms": 9.047}, "hostname": "flow-main", "episode_reward_max": -30.61022655021959, "timesteps_this_iter": 34190, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.52034330255557, "cost1_mean": 195.8552922450338, "system_level_velocity_mean": 16.574018270470106, "cost2_mean": -30.101158287798118, "cost2_max": -14.066085804494445, "outflow_rate_max": 1329.165683724988, "cost1_min": 24.565722656022302, "system_level_velocity_min": 12.8919434723334, "system_level_velocity_max": 18.826677045389083, "outflow_rate_min": 492.1711703675176, "outflow_rate_mean": 1177.0935128067247, "cost2_min": -42.69434762054912}, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 1626811, "time_total_s": 1297.8288617134094, "timestamp": 1558593384, "iterations_since_restore": 45, "policy_reward_mean": {}, "training_iteration": 45, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492add8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492ae80>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a240>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2080, "timesteps_total": 1626811, "episode_reward_mean": -318.4480679361622, "episodes_this_iter": 45, "date": "2019-05-23_06-36-24", "time_this_iter_s": 26.74208927154541, "num_metric_batches_dropped": 0, "episode_reward_min": -513.5301426141026}
{"time_since_restore": 1326.5089058876038, "info": {"default": {"kl": 0.019156010821461678, "total_loss": 13.759900093078613, "vf_explained_var": 0.8699057102203369, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008116615936160088, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 13.766580581665039, "entropy": 1.030335545539856}, "num_steps_trained": 1660264, "grad_time_ms": 9125.857, "load_time_ms": 14.785, "sample_time_ms": 17561.819, "num_steps_sampled": 1660264, "update_time_ms": 9.211}, "hostname": "flow-main", "episode_reward_max": -228.94025144372765, "timesteps_this_iter": 33453, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.53911648730053, "cost1_mean": 193.81434510291004, "system_level_velocity_mean": 16.206514056097845, "cost2_mean": -31.275403113484444, "cost2_max": -20.948719239023976, "outflow_rate_max": 1321.6129184281763, "cost1_min": 157.55585950799932, "system_level_velocity_min": 13.166780365919196, "system_level_velocity_max": 18.64709499584263, "outflow_rate_min": 997.6319190101235, "outflow_rate_mean": 1165.623167848093, "cost2_min": -45.80940761527749}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 1660264, "time_total_s": 1326.5089058876038, "timestamp": 1558593413, "iterations_since_restore": 46, "policy_reward_mean": {}, "training_iteration": 46, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd710>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bda90>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2132, "timesteps_total": 1660264, "episode_reward_mean": -336.7339927447485, "episodes_this_iter": 52, "date": "2019-05-23_06-36-53", "time_this_iter_s": 28.680044174194336, "num_metric_batches_dropped": 0, "episode_reward_min": -520.6622155702651}
{"time_since_restore": 1355.8580536842346, "info": {"default": {"kl": 0.0197089035063982, "total_loss": 10.6652193069458, "vf_explained_var": 0.8710901141166687, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009476442821323872, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 10.673218727111816, "entropy": 1.0340393781661987}, "num_steps_trained": 1691861, "grad_time_ms": 9214.958, "load_time_ms": 14.523, "sample_time_ms": 17844.696, "num_steps_sampled": 1691861, "update_time_ms": 9.262}, "hostname": "flow-main", "episode_reward_max": -23.189966670051945, "timesteps_this_iter": 31597, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.53911648730053, "cost1_mean": 192.37139590227397, "system_level_velocity_mean": 16.39996835154652, "cost2_mean": -29.248993924645216, "cost2_max": -11.905196758139017, "outflow_rate_max": 1321.6129184281763, "cost1_min": 17.670069906503223, "system_level_velocity_min": 13.166780365919196, "system_level_velocity_max": 18.64709499584263, "outflow_rate_min": 454.1881787896761, "outflow_rate_mean": 1142.1969971121166, "cost2_min": -45.80940761527749}, "episode_len_mean": 320.56, "node_ip": "10.138.0.2", "timesteps_since_restore": 1691861, "time_total_s": 1355.8580536842346, "timestamp": 1558593442, "iterations_since_restore": 47, "policy_reward_mean": {}, "training_iteration": 47, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af2e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846aff28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af940>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2175, "timesteps_total": 1691861, "episode_reward_mean": -318.8938164719517, "episodes_this_iter": 43, "date": "2019-05-23_06-37-22", "time_this_iter_s": 29.34914779663086, "num_metric_batches_dropped": 0, "episode_reward_min": -520.6622155702651}
{"time_since_restore": 1381.3880305290222, "info": {"default": {"kl": 0.02339262329041958, "total_loss": 10.94832706451416, "vf_explained_var": 0.8868573307991028, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009214972145855427, "cur_kl_coeff": 0.07499998807907104, "vf_loss": 10.955787658691406, "entropy": 1.0250977277755737}, "num_steps_trained": 1723509, "grad_time_ms": 9137.811, "load_time_ms": 14.756, "sample_time_ms": 17955.985, "num_steps_sampled": 1723509, "update_time_ms": 9.846}, "hostname": "flow-main", "episode_reward_max": -23.189966670051945, "timesteps_this_iter": 31648, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 217.86684773162807, "cost1_mean": 191.07035629032438, "system_level_velocity_mean": 16.483310793753652, "cost2_mean": -27.646392977943982, "cost2_max": -11.905196758139017, "outflow_rate_max": 1283.5245092612304, "cost1_min": 17.670069906503223, "system_level_velocity_min": 13.166780365919196, "system_level_velocity_max": 18.52731282000321, "outflow_rate_min": 454.1881787896761, "outflow_rate_mean": 1120.7005332550168, "cost2_min": -45.80940761527749}, "episode_len_mean": 318.56, "node_ip": "10.138.0.2", "timesteps_since_restore": 1723509, "time_total_s": 1381.3880305290222, "timestamp": 1558593468, "iterations_since_restore": 48, "policy_reward_mean": {}, "training_iteration": 48, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7cc0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7eb8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b71d0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2222, "timesteps_total": 1723509, "episode_reward_mean": -304.92433669981585, "episodes_this_iter": 47, "date": "2019-05-23_06-37-48", "time_this_iter_s": 25.529976844787598, "num_metric_batches_dropped": 0, "episode_reward_min": -520.6622155702651}
{"time_since_restore": 1406.7004408836365, "info": {"default": {"kl": 0.017042798921465874, "total_loss": 11.60713005065918, "vf_explained_var": 0.8814868330955505, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010318412445485592, "cur_kl_coeff": 0.11249998211860657, "vf_loss": 11.615530014038086, "entropy": 1.0467790365219116}, "num_steps_trained": 1754440, "grad_time_ms": 9038.557, "load_time_ms": 14.744, "sample_time_ms": 17919.474, "num_steps_sampled": 1754440, "update_time_ms": 9.6}, "hostname": "flow-main", "episode_reward_max": -155.52417973273757, "timesteps_this_iter": 30931, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 217.0659780276422, "cost1_mean": 193.8605378046811, "system_level_velocity_mean": 16.539593094203312, "cost2_mean": -27.066415645869935, "cost2_max": -15.022230863256041, "outflow_rate_max": 1295.0459708584099, "cost1_min": 138.6647216243019, "system_level_velocity_min": 12.997392411699302, "system_level_velocity_max": 18.500630815792988, "outflow_rate_min": 949.7598123167157, "outflow_rate_mean": 1122.23555338786, "cost2_min": -42.00911520187295}, "episode_len_mean": 322.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 1754440, "time_total_s": 1406.7004408836365, "timestamp": 1558593493, "iterations_since_restore": 49, "policy_reward_mean": {}, "training_iteration": 49, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a7b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a8d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a358>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2271, "timesteps_total": 1754440, "episode_reward_mean": -300.44268286647764, "episodes_this_iter": 49, "date": "2019-05-23_06-38-13", "time_this_iter_s": 25.312410354614258, "num_metric_batches_dropped": 0, "episode_reward_min": -501.9038889026798}
{"time_since_restore": 1431.453232049942, "info": {"default": {"kl": 0.021086404100060463, "total_loss": 11.494603157043457, "vf_explained_var": 0.8820440173149109, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010034313425421715, "cur_kl_coeff": 0.11249998956918716, "vf_loss": 11.502264976501465, "entropy": 1.0234472751617432}, "num_steps_trained": 1785778, "grad_time_ms": 8970.304, "load_time_ms": 14.635, "sample_time_ms": 17816.19, "num_steps_sampled": 1785778, "update_time_ms": 9.277}, "hostname": "flow-main", "episode_reward_max": -223.8008795919612, "timesteps_this_iter": 31338, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.0916014234549, "cost1_mean": 194.68581785116316, "system_level_velocity_mean": 16.595774699858435, "cost2_mean": -27.02494800143424, "cost2_max": -15.022230863256041, "outflow_rate_max": 1301.867096213236, "cost1_min": 121.11834558953808, "system_level_velocity_min": 12.43494717142564, "system_level_velocity_max": 18.695473870087216, "outflow_rate_min": 894.8714094501012, "outflow_rate_mean": 1115.0832229563403, "cost2_min": -42.00911520187295}, "episode_len_mean": 323.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 1785778, "time_total_s": 1431.453232049942, "timestamp": 1558593518, "iterations_since_restore": 50, "policy_reward_mean": {}, "training_iteration": 50, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846afb00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846afd30>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846afa58>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2316, "timesteps_total": 1785778, "episode_reward_mean": -299.90964568510304, "episodes_this_iter": 45, "date": "2019-05-23_06-38-38", "time_this_iter_s": 24.752791166305542, "num_metric_batches_dropped": 0, "episode_reward_min": -511.1827826811922}
{"time_since_restore": 1457.6529479026794, "info": {"default": {"kl": 0.016160326078534126, "total_loss": 11.793530464172363, "vf_explained_var": 0.8771280646324158, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009174562990665436, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 11.79997730255127, "entropy": 1.0078442096710205}, "num_steps_trained": 1817688, "grad_time_ms": 8960.836, "load_time_ms": 14.991, "sample_time_ms": 17777.344, "num_steps_sampled": 1817688, "update_time_ms": 9.125}, "hostname": "flow-main", "episode_reward_max": -30.89517207944399, "timesteps_this_iter": 31910, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.70801689980996, "cost1_mean": 194.3532803960868, "system_level_velocity_mean": 16.764620156054992, "cost2_mean": -26.735375869881945, "cost2_max": -11.951084292466602, "outflow_rate_max": 1301.867096213236, "cost1_min": 22.58415090314469, "system_level_velocity_min": 12.43494717142564, "system_level_velocity_max": 18.695473870087216, "outflow_rate_min": 473.20973104725, "outflow_rate_mean": 1119.9298675126427, "cost2_min": -38.63526378591626}, "episode_len_mean": 319.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 1817688, "time_total_s": 1457.6529479026794, "timestamp": 1558593544, "iterations_since_restore": 51, "policy_reward_mean": {}, "training_iteration": 51, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7438>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7d30>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2361, "timesteps_total": 1817688, "episode_reward_mean": -293.5419051486817, "episodes_this_iter": 45, "date": "2019-05-23_06-39-04", "time_this_iter_s": 26.199715852737427, "num_metric_batches_dropped": 0, "episode_reward_min": -511.1827826811922}
{"time_since_restore": 1483.798796415329, "info": {"default": {"kl": 0.01869315840303898, "total_loss": 12.260394096374512, "vf_explained_var": 0.87484210729599, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009629534557461739, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 12.266868591308594, "entropy": 0.9990484118461609}, "num_steps_trained": 1850220, "grad_time_ms": 8949.374, "load_time_ms": 15.147, "sample_time_ms": 17682.598, "num_steps_sampled": 1850220, "update_time_ms": 8.997}, "hostname": "flow-main", "episode_reward_max": -30.89517207944399, "timesteps_this_iter": 32532, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.15919753402318, "cost1_mean": 195.25591065444883, "system_level_velocity_mean": 16.75949561986118, "cost2_mean": -26.965531965322175, "cost2_max": -11.951084292466602, "outflow_rate_max": 1307.9730023050306, "cost1_min": 22.58415090314469, "system_level_velocity_min": 12.920329430608934, "system_level_velocity_max": 18.6226998871466, "outflow_rate_min": 473.20973104725, "outflow_rate_mean": 1141.2244848181078, "cost2_min": -35.14503489371751}, "episode_len_mean": 319.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 1850220, "time_total_s": 1483.798796415329, "timestamp": 1558593570, "iterations_since_restore": 52, "policy_reward_mean": {}, "training_iteration": 52, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a7f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a7b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a2b0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2411, "timesteps_total": 1850220, "episode_reward_mean": -295.6378182148175, "episodes_this_iter": 50, "date": "2019-05-23_06-39-30", "time_this_iter_s": 26.145848512649536, "num_metric_batches_dropped": 0, "episode_reward_min": -484.5549540392537}
{"time_since_restore": 1510.802336215973, "info": {"default": {"kl": 0.017982402816414833, "total_loss": 12.611677169799805, "vf_explained_var": 0.8789541721343994, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010634361766278744, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 12.619277000427246, "entropy": 0.9908942580223083}, "num_steps_trained": 1883920, "grad_time_ms": 8967.906, "load_time_ms": 15.007, "sample_time_ms": 17560.024, "num_steps_sampled": 1883920, "update_time_ms": 8.916}, "hostname": "flow-main", "episode_reward_max": -222.59108685716194, "timesteps_this_iter": 33700, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.15919753402318, "cost1_mean": 196.6127656951011, "system_level_velocity_mean": 16.546902506248035, "cost2_mean": -28.01763765341877, "cost2_max": -19.96371712760184, "outflow_rate_max": 1330.3296684363659, "cost1_min": 121.40041010962196, "system_level_velocity_min": 12.920329430608934, "system_level_velocity_max": 18.6226998871466, "outflow_rate_min": 896.4005137577583, "outflow_rate_mean": 1161.4578781758764, "cost2_min": -45.07928597558808}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 1883920, "time_total_s": 1510.802336215973, "timestamp": 1558593597, "iterations_since_restore": 53, "policy_reward_mean": {}, "training_iteration": 53, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd7b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdeb8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd9b0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2455, "timesteps_total": 1883920, "episode_reward_mean": -311.99950102661194, "episodes_this_iter": 44, "date": "2019-05-23_06-39-57", "time_this_iter_s": 27.00353980064392, "num_metric_batches_dropped": 0, "episode_reward_min": -537.7055765794122}
{"time_since_restore": 1537.8213636875153, "info": {"default": {"kl": 0.016720682382583618, "total_loss": 12.397831916809082, "vf_explained_var": 0.8805892467498779, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0090241190046072, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 12.404034614562988, "entropy": 0.9899037480354309}, "num_steps_trained": 1918639, "grad_time_ms": 9029.505, "load_time_ms": 15.056, "sample_time_ms": 17541.0, "num_steps_sampled": 1918639, "update_time_ms": 9.019}, "hostname": "flow-main", "episode_reward_max": -233.97346995285633, "timesteps_this_iter": 34719, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.45597656353465, "cost1_mean": 196.53274525764755, "system_level_velocity_mean": 16.421804601604542, "cost2_mean": -28.734383172293374, "cost2_max": -18.78726747667965, "outflow_rate_max": 1330.3296684363659, "cost1_min": 149.89936506630093, "system_level_velocity_min": 12.453563596346397, "system_level_velocity_max": 18.63784018180281, "outflow_rate_min": 981.7350536948649, "outflow_rate_mean": 1176.6988343965763, "cost2_min": -45.07928597558808}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1918639, "time_total_s": 1537.8213636875153, "timestamp": 1558593624, "iterations_since_restore": 54, "policy_reward_mean": {}, "training_iteration": 54, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdbe0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd2e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdb38>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2501, "timesteps_total": 1918639, "episode_reward_mean": -326.3916724048361, "episodes_this_iter": 46, "date": "2019-05-23_06-40-24", "time_this_iter_s": 27.01902747154236, "num_metric_batches_dropped": 0, "episode_reward_min": -565.7413194799915}
{"time_since_restore": 1564.6751925945282, "info": {"default": {"kl": 0.015585945919156075, "total_loss": 12.273548126220703, "vf_explained_var": 0.8702932596206665, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008123597130179405, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 12.27904224395752, "entropy": 0.9820325374603271}, "num_steps_trained": 1953017, "grad_time_ms": 9038.641, "load_time_ms": 14.516, "sample_time_ms": 17544.302, "num_steps_sampled": 1953017, "update_time_ms": 8.989}, "hostname": "flow-main", "episode_reward_max": -157.86887770988207, "timesteps_this_iter": 34378, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.45597656353465, "cost1_mean": 196.68348730899157, "system_level_velocity_mean": 16.48064262161635, "cost2_mean": -28.654699646025925, "cost2_max": -18.78726747667965, "outflow_rate_max": 1313.1138652720965, "cost1_min": 139.46075365438065, "system_level_velocity_min": 12.44744583812171, "system_level_velocity_max": 18.65790345464912, "outflow_rate_min": 981.7350536948649, "outflow_rate_mean": 1191.186560385731, "cost2_min": -45.07928597558808}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 1953017, "time_total_s": 1564.6751925945282, "timestamp": 1558593651, "iterations_since_restore": 55, "policy_reward_mean": {}, "training_iteration": 55, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a390>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a4a8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2547, "timesteps_total": 1953017, "episode_reward_mean": -331.50687845256414, "episodes_this_iter": 46, "date": "2019-05-23_06-40-51", "time_this_iter_s": 26.85382890701294, "num_metric_batches_dropped": 0, "episode_reward_min": -565.7413194799915}
{"time_since_restore": 1593.4463140964508, "info": {"default": {"kl": 0.01575472019612789, "total_loss": 12.673117637634277, "vf_explained_var": 0.8672760725021362, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008123829960823059, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 12.678582191467285, "entropy": 1.0080194473266602}, "num_steps_trained": 1987576, "grad_time_ms": 8982.001, "load_time_ms": 15.033, "sample_time_ms": 17610.557, "num_steps_sampled": 1987576, "update_time_ms": 8.865}, "hostname": "flow-main", "episode_reward_max": -31.066440300120398, "timesteps_this_iter": 34559, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.08911786672215, "cost1_mean": 194.36407103220665, "system_level_velocity_mean": 16.64340877683778, "cost2_mean": -28.041342639424016, "cost2_max": -13.965471653069715, "outflow_rate_max": 1327.3360970077943, "cost1_min": 22.841883655009884, "system_level_velocity_min": 12.44744583812171, "system_level_velocity_max": 18.65790345464912, "outflow_rate_min": 460.7989278777953, "outflow_rate_mean": 1189.9290891970443, "cost2_min": -37.39175747819723}, "episode_len_mean": 317.58, "node_ip": "10.138.0.2", "timesteps_since_restore": 1987576, "time_total_s": 1593.4463140964508, "timestamp": 1558593680, "iterations_since_restore": 56, "policy_reward_mean": {}, "training_iteration": 56, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdc18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd2b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd860>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2599, "timesteps_total": 1987576, "episode_reward_mean": -320.27789301250436, "episodes_this_iter": 52, "date": "2019-05-23_06-41-20", "time_this_iter_s": 28.771121501922607, "num_metric_batches_dropped": 0, "episode_reward_min": -542.7142415667415}
{"time_since_restore": 1620.6115093231201, "info": {"default": {"kl": 0.01566755212843418, "total_loss": 12.380552291870117, "vf_explained_var": 0.8847911953926086, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00844429712742567, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 12.3863525390625, "entropy": 1.0171337127685547}, "num_steps_trained": 2022636, "grad_time_ms": 8893.445, "load_time_ms": 14.869, "sample_time_ms": 17483.658, "num_steps_sampled": 2022636, "update_time_ms": 8.704}, "hostname": "flow-main", "episode_reward_max": -29.226583903885146, "timesteps_this_iter": 35060, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.7516223603912, "cost1_mean": 190.9055454604737, "system_level_velocity_mean": 16.496809523968462, "cost2_mean": -28.253621323842452, "cost2_max": -10.942182764360375, "outflow_rate_max": 1332.9691551607716, "cost1_min": 22.755776835807563, "system_level_velocity_min": 12.44744583812171, "system_level_velocity_max": 18.682737370551656, "outflow_rate_min": 460.7989278777953, "outflow_rate_mean": 1179.0523511820827, "cost2_min": -34.91139500285604}, "episode_len_mean": 314.76, "node_ip": "10.138.0.2", "timesteps_since_restore": 2022636, "time_total_s": 1620.6115093231201, "timestamp": 1558593707, "iterations_since_restore": 57, "policy_reward_mean": {}, "training_iteration": 57, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846afac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdf98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af828>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2643, "timesteps_total": 2022636, "episode_reward_mean": -321.410827885726, "episodes_this_iter": 44, "date": "2019-05-23_06-41-47", "time_this_iter_s": 27.16519522666931, "num_metric_batches_dropped": 0, "episode_reward_min": -542.7142415667415}
{"time_since_restore": 1648.2134325504303, "info": {"default": {"kl": 0.015895850956439972, "total_loss": 12.8211669921875, "vf_explained_var": 0.8673040866851807, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008669293485581875, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 12.827154159545898, "entropy": 1.0259391069412231}, "num_steps_trained": 2057582, "grad_time_ms": 9039.228, "load_time_ms": 14.564, "sample_time_ms": 17543.0, "num_steps_sampled": 2057582, "update_time_ms": 8.334}, "hostname": "flow-main", "episode_reward_max": -29.226583903885146, "timesteps_this_iter": 34946, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.7516223603912, "cost1_mean": 192.71646837184005, "system_level_velocity_mean": 16.411117647933708, "cost2_mean": -28.764342160445377, "cost2_max": -10.942182764360375, "outflow_rate_max": 1332.9691551607716, "cost1_min": 22.755776835807563, "system_level_velocity_min": 12.603652526709979, "system_level_velocity_max": 18.682737370551656, "outflow_rate_min": 507.9240826301831, "outflow_rate_mean": 1188.3196027324218, "cost2_min": -37.968051113971995}, "episode_len_mean": 318.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 2057582, "time_total_s": 1648.2134325504303, "timestamp": 1558593735, "iterations_since_restore": 58, "policy_reward_mean": {}, "training_iteration": 58, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492ad68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a9b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906e10>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2688, "timesteps_total": 2057582, "episode_reward_mean": -331.9757670653393, "episodes_this_iter": 45, "date": "2019-05-23_06-42-15", "time_this_iter_s": 27.60192322731018, "num_metric_batches_dropped": 0, "episode_reward_min": -549.7452075490793}
{"time_since_restore": 1678.865369796753, "info": {"default": {"kl": 0.016955072060227394, "total_loss": 14.162650108337402, "vf_explained_var": 0.8556811213493347, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008399881422519684, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 14.16818904876709, "entropy": 1.0246180295944214}, "num_steps_trained": 2092412, "grad_time_ms": 9226.099, "load_time_ms": 15.229, "sample_time_ms": 17888.003, "num_steps_sampled": 2092412, "update_time_ms": 8.731}, "hostname": "flow-main", "episode_reward_max": -28.987620695301658, "timesteps_this_iter": 34830, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.7411377083832, "cost1_mean": 192.63806271497728, "system_level_velocity_mean": 16.45587379003167, "cost2_mean": -28.938533107151574, "cost2_max": -12.159803181867611, "outflow_rate_max": 1333.7934010588715, "cost1_min": 22.774392257332295, "system_level_velocity_min": 12.418853330437434, "system_level_velocity_max": 18.700160245246146, "outflow_rate_min": 466.74083028559994, "outflow_rate_mean": 1188.9739540127573, "cost2_min": -37.968051113971995}, "episode_len_mean": 317.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 2092412, "time_total_s": 1678.865369796753, "timestamp": 1558593765, "iterations_since_restore": 59, "policy_reward_mean": {}, "training_iteration": 59, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7d30>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490ee80>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7128>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2741, "timesteps_total": 2092412, "episode_reward_mean": -332.60174625711966, "episodes_this_iter": 53, "date": "2019-05-23_06-42-45", "time_this_iter_s": 30.651937246322632, "num_metric_batches_dropped": 0, "episode_reward_min": -549.7452075490793}
{"time_since_restore": 1705.9566276073456, "info": {"default": {"kl": 0.015103152953088284, "total_loss": 11.718856811523438, "vf_explained_var": 0.8638834357261658, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007044245954602957, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 11.72335147857666, "entropy": 1.0056853294372559}, "num_steps_trained": 2127690, "grad_time_ms": 9428.867, "load_time_ms": 15.643, "sample_time_ms": 17916.12, "num_steps_sampled": 2127690, "update_time_ms": 8.97}, "hostname": "flow-main", "episode_reward_max": -28.987620695301658, "timesteps_this_iter": 35278, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.7411377083832, "cost1_mean": 195.55398063731678, "system_level_velocity_mean": 16.62684861647426, "cost2_mean": -29.052303967181523, "cost2_max": -12.159803181867611, "outflow_rate_max": 1334.4278750247706, "cost1_min": 22.774392257332295, "system_level_velocity_min": 12.418853330437434, "system_level_velocity_max": 18.78296569445636, "outflow_rate_min": 466.74083028559994, "outflow_rate_mean": 1209.8782072107947, "cost2_min": -35.869438677653356}, "episode_len_mean": 318.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 2127690, "time_total_s": 1705.9566276073456, "timestamp": 1558593793, "iterations_since_restore": 60, "policy_reward_mean": {}, "training_iteration": 60, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913cf8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdb70>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913940>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2784, "timesteps_total": 2127690, "episode_reward_mean": -324.77895216661864, "episodes_this_iter": 43, "date": "2019-05-23_06-43-13", "time_this_iter_s": 27.09125781059265, "num_metric_batches_dropped": 0, "episode_reward_min": -547.1626056854457}
{"time_since_restore": 1734.4251437187195, "info": {"default": {"kl": 0.015976792201399803, "total_loss": 13.79973316192627, "vf_explained_var": 0.8495481014251709, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00911699328571558, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 13.806154251098633, "entropy": 1.0382248163223267}, "num_steps_trained": 2163512, "grad_time_ms": 9571.426, "load_time_ms": 15.672, "sample_time_ms": 17998.231, "num_steps_sampled": 2163512, "update_time_ms": 9.419}, "hostname": "flow-main", "episode_reward_max": -28.9313877752265, "timesteps_this_iter": 35822, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.94048895223375, "cost1_mean": 197.57694916985008, "system_level_velocity_mean": 16.70568639364589, "cost2_mean": -29.269745526777616, "cost2_max": -12.666539470160036, "outflow_rate_max": 1334.4278750247706, "cost1_min": 22.77583097885755, "system_level_velocity_min": 12.669735492292793, "system_level_velocity_max": 18.78296569445636, "outflow_rate_min": 514.5009007334598, "outflow_rate_mean": 1222.240470320246, "cost2_min": -39.1822303479056}, "episode_len_mean": 320.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 2163512, "time_total_s": 1734.4251437187195, "timestamp": 1558593821, "iterations_since_restore": 61, "policy_reward_mean": {}, "training_iteration": 61, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e128>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdb38>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490ebe0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2832, "timesteps_total": 2163512, "episode_reward_mean": -327.5629307340385, "episodes_this_iter": 48, "date": "2019-05-23_06-43-41", "time_this_iter_s": 28.4685161113739, "num_metric_batches_dropped": 0, "episode_reward_min": -517.309597218828}
{"time_since_restore": 1763.2641401290894, "info": {"default": {"kl": 0.01675087958574295, "total_loss": 14.314351081848145, "vf_explained_var": 0.8565028309822083, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007901410572230816, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 14.319426536560059, "entropy": 1.050552487373352}, "num_steps_trained": 2200094, "grad_time_ms": 9672.755, "load_time_ms": 15.357, "sample_time_ms": 18167.409, "num_steps_sampled": 2200094, "update_time_ms": 9.571}, "hostname": "flow-main", "episode_reward_max": -28.9313877752265, "timesteps_this_iter": 36582, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.94048895223375, "cost1_mean": 192.36078854842305, "system_level_velocity_mean": 16.463141301713204, "cost2_mean": -30.118931926949095, "cost2_max": -12.666539470160036, "outflow_rate_max": 1334.2543035961994, "cost1_min": 22.77583097885755, "system_level_velocity_min": 12.669735492292793, "system_level_velocity_max": 18.775571777321893, "outflow_rate_min": 472.1492185913593, "outflow_rate_mean": 1202.4809481000364, "cost2_min": -45.79754172632777}, "episode_len_mean": 316.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 2200094, "time_total_s": 1763.2641401290894, "timestamp": 1558593850, "iterations_since_restore": 62, "policy_reward_mean": {}, "training_iteration": 62, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7d68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7d30>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b74e0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2881, "timesteps_total": 2200094, "episode_reward_mean": -340.30921586993594, "episodes_this_iter": 49, "date": "2019-05-23_06-44-10", "time_this_iter_s": 28.838996410369873, "num_metric_batches_dropped": 0, "episode_reward_min": -589.4288120688814}
{"time_since_restore": 1791.6152610778809, "info": {"default": {"kl": 0.01801077276468277, "total_loss": 14.954806327819824, "vf_explained_var": 0.8580147624015808, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008567451499402523, "cur_kl_coeff": 0.16875000298023224, "vf_loss": 14.960333824157715, "entropy": 1.0410453081130981}, "num_steps_trained": 2236839, "grad_time_ms": 9714.908, "load_time_ms": 15.721, "sample_time_ms": 18257.594, "num_steps_sampled": 2236839, "update_time_ms": 9.635}, "hostname": "flow-main", "episode_reward_max": -32.32409557159312, "timesteps_this_iter": 36745, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.84302249281924, "cost1_mean": 191.72397696359258, "system_level_velocity_mean": 16.14407959897347, "cost2_mean": -31.328151355241754, "cost2_max": -13.492285419877604, "outflow_rate_max": 1336.191228604345, "cost1_min": 23.982655499735642, "system_level_velocity_min": 12.86264747137041, "system_level_velocity_max": 18.698685410960753, "outflow_rate_min": 472.1492185913593, "outflow_rate_mean": 1198.197741978763, "cost2_min": -45.79754172632777}, "episode_len_mean": 320.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 2236839, "time_total_s": 1791.6152610778809, "timestamp": 1558593878, "iterations_since_restore": 63, "policy_reward_mean": {}, "training_iteration": 63, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7710>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7048>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2926, "timesteps_total": 2236839, "episode_reward_mean": -361.2933106427133, "episodes_this_iter": 45, "date": "2019-05-23_06-44-38", "time_this_iter_s": 28.351120948791504, "num_metric_batches_dropped": 0, "episode_reward_min": -589.4288120688814}
{"time_since_restore": 1819.9577550888062, "info": {"default": {"kl": 0.01790420524775982, "total_loss": 14.661355018615723, "vf_explained_var": 0.8547636866569519, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008450113236904144, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 14.666784286499023, "entropy": 1.038844347000122}, "num_steps_trained": 2273461, "grad_time_ms": 9700.154, "load_time_ms": 15.78, "sample_time_ms": 18403.818, "num_steps_sampled": 2273461, "update_time_ms": 9.547}, "hostname": "flow-main", "episode_reward_max": -239.63247760842668, "timesteps_this_iter": 36622, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.84302249281924, "cost1_mean": 192.4079078105494, "system_level_velocity_mean": 15.937033356331924, "cost2_mean": -31.776972730619764, "cost2_max": -20.709868008090066, "outflow_rate_max": 1336.191228604345, "cost1_min": 153.60245113659207, "system_level_velocity_min": 12.86264747137041, "system_level_velocity_max": 18.65392937848064, "outflow_rate_min": 999.4708920187791, "outflow_rate_mean": 1200.1098726454445, "cost2_min": -45.79754172632777}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2273461, "time_total_s": 1819.9577550888062, "timestamp": 1558593907, "iterations_since_restore": 64, "policy_reward_mean": {}, "training_iteration": 64, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b71d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7b70>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b77f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 2971, "timesteps_total": 2273461, "episode_reward_mean": -373.38656037013857, "episodes_this_iter": 45, "date": "2019-05-23_06-45-07", "time_this_iter_s": 28.342494010925293, "num_metric_batches_dropped": 0, "episode_reward_min": -589.4288120688814}
{"time_since_restore": 1848.287338733673, "info": {"default": {"kl": 0.01549814734607935, "total_loss": 11.698322296142578, "vf_explained_var": 0.8873098492622375, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007348021492362022, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 11.703056335449219, "entropy": 1.0280872583389282}, "num_steps_trained": 2309247, "grad_time_ms": 9756.602, "load_time_ms": 16.069, "sample_time_ms": 18492.649, "num_steps_sampled": 2309247, "update_time_ms": 9.485}, "hostname": "flow-main", "episode_reward_max": -237.22734515054924, "timesteps_this_iter": 35786, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.1746838857513, "cost1_mean": 192.95878936007622, "system_level_velocity_mean": 16.005258807660724, "cost2_mean": -31.201819353861925, "cost2_max": -20.709868008090066, "outflow_rate_max": 1338.1308530642518, "cost1_min": 148.70235889256384, "system_level_velocity_min": 12.40755961376947, "system_level_velocity_max": 18.929413975424062, "outflow_rate_min": 960.0298167921776, "outflow_rate_mean": 1198.7763252806824, "cost2_min": -43.23043146055205}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2309247, "time_total_s": 1848.287338733673, "timestamp": 1558593935, "iterations_since_restore": 65, "policy_reward_mean": {}, "training_iteration": 65, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846afe10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846aff98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af860>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3017, "timesteps_total": 2309247, "episode_reward_mean": -366.14142389008737, "episodes_this_iter": 46, "date": "2019-05-23_06-45-35", "time_this_iter_s": 28.329583644866943, "num_metric_batches_dropped": 0, "episode_reward_min": -578.2281250533485}
{"time_since_restore": 1876.364338874817, "info": {"default": {"kl": 0.01874186284840107, "total_loss": 14.434762001037598, "vf_explained_var": 0.8624064922332764, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009871832095086575, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 14.4414701461792, "entropy": 1.031312108039856}, "num_steps_trained": 2345332, "grad_time_ms": 9779.391, "load_time_ms": 15.386, "sample_time_ms": 18399.097, "num_steps_sampled": 2345332, "update_time_ms": 9.663}, "hostname": "flow-main", "episode_reward_max": -22.573810692085427, "timesteps_this_iter": 36085, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.1746838857513, "cost1_mean": 191.1206852035374, "system_level_velocity_mean": 16.038688336996103, "cost2_mean": -30.67990069320112, "cost2_max": -12.265057085038885, "outflow_rate_max": 1338.1308530642518, "cost1_min": 18.604445067670024, "system_level_velocity_min": 12.40755961376947, "system_level_velocity_max": 18.929413975424062, "outflow_rate_min": 497.50056700217027, "outflow_rate_mean": 1188.4487036270275, "cost2_min": -43.23043146055205}, "episode_len_mean": 322.03, "node_ip": "10.138.0.2", "timesteps_since_restore": 2345332, "time_total_s": 1876.364338874817, "timestamp": 1558593963, "iterations_since_restore": 66, "policy_reward_mean": {}, "training_iteration": 66, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd320>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdc18>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdef0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3065, "timesteps_total": 2345332, "episode_reward_mean": -358.81279543954844, "episodes_this_iter": 48, "date": "2019-05-23_06-46-03", "time_this_iter_s": 28.0770001411438, "num_metric_batches_dropped": 0, "episode_reward_min": -578.2281250533485}
{"time_since_restore": 1903.9465866088867, "info": {"default": {"kl": 0.015494763851165771, "total_loss": 13.293310165405273, "vf_explained_var": 0.8715896606445312, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00638537248596549, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 13.297080039978027, "entropy": 1.006888747215271}, "num_steps_trained": 2381073, "grad_time_ms": 9818.333, "load_time_ms": 15.458, "sample_time_ms": 18399.522, "num_steps_sampled": 2381073, "update_time_ms": 9.676}, "hostname": "flow-main", "episode_reward_max": -22.573810692085427, "timesteps_this_iter": 35741, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.3471511849398, "cost1_mean": 193.42327123888762, "system_level_velocity_mean": 16.235982461680535, "cost2_mean": -29.881079058510913, "cost2_max": -12.265057085038885, "outflow_rate_max": 1330.7883493152112, "cost1_min": 18.604445067670024, "system_level_velocity_min": 12.53824467117385, "system_level_velocity_max": 18.705859783112967, "outflow_rate_min": 497.50056700217027, "outflow_rate_mean": 1198.0976374369775, "cost2_min": -36.814985226889306}, "episode_len_mean": 322.03, "node_ip": "10.138.0.2", "timesteps_since_restore": 2381073, "time_total_s": 1903.9465866088867, "timestamp": 1558593991, "iterations_since_restore": 67, "policy_reward_mean": {}, "training_iteration": 67, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdba8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492ada0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd358>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3109, "timesteps_total": 2381073, "episode_reward_mean": -348.441274518432, "episodes_this_iter": 44, "date": "2019-05-23_06-46-31", "time_this_iter_s": 27.582247734069824, "num_metric_batches_dropped": 0, "episode_reward_min": -519.5560002616278}
{"time_since_restore": 1931.7066419124603, "info": {"default": {"kl": 0.016260972246527672, "total_loss": 11.1912841796875, "vf_explained_var": 0.8983688354492188, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00901321042329073, "cur_kl_coeff": 0.16875000298023224, "vf_loss": 11.197551727294922, "entropy": 1.0059243440628052}, "num_steps_trained": 2416637, "grad_time_ms": 9849.622, "load_time_ms": 16.009, "sample_time_ms": 18385.313, "num_steps_sampled": 2416637, "update_time_ms": 9.435}, "hostname": "flow-main", "episode_reward_max": -21.82103484032199, "timesteps_this_iter": 35564, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.3471511849398, "cost1_mean": 191.15108510997436, "system_level_velocity_mean": 16.125557650723337, "cost2_mean": -29.743784485406614, "cost2_max": -11.903080501769733, "outflow_rate_max": 1328.346415738035, "cost1_min": 17.780748665210666, "system_level_velocity_min": 12.161028955591542, "system_level_velocity_max": 18.70684543188266, "outflow_rate_min": 494.27405165189856, "outflow_rate_mean": 1188.6241487435298, "cost2_min": -38.62644446026872}, "episode_len_mean": 320.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 2416637, "time_total_s": 1931.7066419124603, "timestamp": 1558594019, "iterations_since_restore": 68, "policy_reward_mean": {}, "training_iteration": 68, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492abe0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492af98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7358>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3157, "timesteps_total": 2416637, "episode_reward_mean": -350.60017238343113, "episodes_this_iter": 48, "date": "2019-05-23_06-46-59", "time_this_iter_s": 27.76005530357361, "num_metric_batches_dropped": 0, "episode_reward_min": -572.0891872187283}
{"time_since_restore": 1959.6459422111511, "info": {"default": {"kl": 0.01818213053047657, "total_loss": 12.163021087646484, "vf_explained_var": 0.8805192708969116, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009944403544068336, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 12.169897079467773, "entropy": 0.9902334809303284}, "num_steps_trained": 2451525, "grad_time_ms": 9848.999, "load_time_ms": 16.338, "sample_time_ms": 18114.036, "num_steps_sampled": 2451525, "update_time_ms": 9.28}, "hostname": "flow-main", "episode_reward_max": -21.82103484032199, "timesteps_this_iter": 34888, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.85812168894182, "cost1_mean": 192.11741282693697, "system_level_velocity_mean": 16.269182078712507, "cost2_mean": -29.048884967191885, "cost2_max": -11.903080501769733, "outflow_rate_max": 1328.346415738035, "cost1_min": 17.780748665210666, "system_level_velocity_min": 12.161028955591542, "system_level_velocity_max": 18.70684543188266, "outflow_rate_min": 494.27405165189856, "outflow_rate_mean": 1187.7312056019794, "cost2_min": -38.62644446026872}, "episode_len_mean": 320.44, "node_ip": "10.138.0.2", "timesteps_since_restore": 2451525, "time_total_s": 1959.6459422111511, "timestamp": 1558594047, "iterations_since_restore": 69, "policy_reward_mean": {}, "training_iteration": 69, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b73c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7a20>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3205, "timesteps_total": 2451525, "episode_reward_mean": -341.6741375486758, "episodes_this_iter": 48, "date": "2019-05-23_06-47-27", "time_this_iter_s": 27.939300298690796, "num_metric_batches_dropped": 0, "episode_reward_min": -572.0891872187283}
{"time_since_restore": 1987.967874288559, "info": {"default": {"kl": 0.018426990136504173, "total_loss": 12.238320350646973, "vf_explained_var": 0.8775831460952759, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009264306165277958, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 12.244474411010742, "entropy": 1.0039154291152954}, "num_steps_trained": 2486346, "grad_time_ms": 9947.581, "load_time_ms": 15.675, "sample_time_ms": 18139.923, "num_steps_sampled": 2486346, "update_time_ms": 9.112}, "hostname": "flow-main", "episode_reward_max": -216.52360540487481, "timesteps_this_iter": 34821, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.85812168894182, "cost1_mean": 195.27260664208458, "system_level_velocity_mean": 16.33221352602586, "cost2_mean": -29.05831867538288, "cost2_max": -18.44906023216337, "outflow_rate_max": 1328.346415738035, "cost1_min": 145.83811886860082, "system_level_velocity_min": 12.161028955591542, "system_level_velocity_max": 18.70684543188266, "outflow_rate_min": 973.0686199903427, "outflow_rate_mean": 1193.878725872225, "cost2_min": -38.62644446026872}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 2486346, "time_total_s": 1987.967874288559, "timestamp": 1558594075, "iterations_since_restore": 70, "policy_reward_mean": {}, "training_iteration": 70, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b74e0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7f98>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3250, "timesteps_total": 2486346, "episode_reward_mean": -339.3562819637056, "episodes_this_iter": 45, "date": "2019-05-23_06-47-55", "time_this_iter_s": 28.321932077407837, "num_metric_batches_dropped": 0, "episode_reward_min": -571.5019255464645}
{"time_since_restore": 2015.070424079895, "info": {"default": {"kl": 0.0185844823718071, "total_loss": 10.479901313781738, "vf_explained_var": 0.9025471806526184, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011663731187582016, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 10.488429069519043, "entropy": 1.0197511911392212}, "num_steps_trained": 2520521, "grad_time_ms": 9948.491, "load_time_ms": 15.267, "sample_time_ms": 18003.589, "num_steps_sampled": 2520521, "update_time_ms": 8.905}, "hostname": "flow-main", "episode_reward_max": -230.63810820531353, "timesteps_this_iter": 34175, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.6230266527976, "cost1_mean": 193.9467126273297, "system_level_velocity_mean": 16.22504985340712, "cost2_mean": -28.810647005040938, "cost2_max": -18.44906023216337, "outflow_rate_max": 1309.7490746373066, "cost1_min": 153.49540682063457, "system_level_velocity_min": 12.900650743347766, "system_level_velocity_max": 18.672152797065742, "outflow_rate_min": 978.4490494834935, "outflow_rate_mean": 1184.6347451028978, "cost2_min": -35.210851452754504}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2520521, "time_total_s": 2015.070424079895, "timestamp": 1558594102, "iterations_since_restore": 71, "policy_reward_mean": {}, "training_iteration": 71, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a128>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492ada0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492aeb8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3296, "timesteps_total": 2520521, "episode_reward_mean": -338.95955190015394, "episodes_this_iter": 46, "date": "2019-05-23_06-48-22", "time_this_iter_s": 27.10254979133606, "num_metric_batches_dropped": 0, "episode_reward_min": -490.5832315817712}
{"time_since_restore": 2041.8306367397308, "info": {"default": {"kl": 0.017266318202018738, "total_loss": 10.61475658416748, "vf_explained_var": 0.8967143893241882, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009787420742213726, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 10.621628761291504, "entropy": 0.9922639727592468}, "num_steps_trained": 2553997, "grad_time_ms": 9892.503, "load_time_ms": 15.254, "sample_time_ms": 17850.384, "num_steps_sampled": 2553997, "update_time_ms": 9.154}, "hostname": "flow-main", "episode_reward_max": -158.18248003489416, "timesteps_this_iter": 33476, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.49927914143092, "cost1_mean": 193.1678592953479, "system_level_velocity_mean": 16.271220267190767, "cost2_mean": -28.1459671044684, "cost2_max": -20.31302491121615, "outflow_rate_max": 1300.6218329183673, "cost1_min": 144.80087328893353, "system_level_velocity_min": 12.53563429786111, "system_level_velocity_max": 18.667361612432998, "outflow_rate_min": 925.0547884802073, "outflow_rate_mean": 1175.203478761858, "cost2_min": -34.8422484531265}, "episode_len_mean": 323.9, "node_ip": "10.138.0.2", "timesteps_since_restore": 2553997, "time_total_s": 2041.8306367397308, "timestamp": 1558594129, "iterations_since_restore": 72, "policy_reward_mean": {}, "training_iteration": 72, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7320>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7978>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3346, "timesteps_total": 2553997, "episode_reward_mean": -331.39278760147414, "episodes_this_iter": 50, "date": "2019-05-23_06-48-49", "time_this_iter_s": 26.760212659835815, "num_metric_batches_dropped": 0, "episode_reward_min": -515.7666875310852}
{"time_since_restore": 2068.0911107063293, "info": {"default": {"kl": 0.01910715363919735, "total_loss": 9.710620880126953, "vf_explained_var": 0.9027701616287231, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01069997064769268, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 9.718096733093262, "entropy": 0.9846574068069458}, "num_steps_trained": 2587393, "grad_time_ms": 9805.446, "load_time_ms": 15.065, "sample_time_ms": 17730.059, "num_steps_sampled": 2587393, "update_time_ms": 9.333}, "hostname": "flow-main", "episode_reward_max": -150.89514395153006, "timesteps_this_iter": 33396, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.385142061059, "cost1_mean": 193.8299255978254, "system_level_velocity_mean": 16.51118040818512, "cost2_mean": -27.62667841739746, "cost2_max": -20.31302491121615, "outflow_rate_max": 1305.2126633850019, "cost1_min": 138.23733570978342, "system_level_velocity_min": 12.53563429786111, "system_level_velocity_max": 18.809245852122483, "outflow_rate_min": 925.0547884802073, "outflow_rate_mean": 1172.2251928935757, "cost2_min": -34.70194080729216}, "episode_len_mean": 321.26, "node_ip": "10.138.0.2", "timesteps_since_restore": 2587393, "time_total_s": 2068.0911107063293, "timestamp": 1558594155, "iterations_since_restore": 73, "policy_reward_mean": {}, "training_iteration": 73, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492aeb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492ada0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7b70>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3391, "timesteps_total": 2587393, "episode_reward_mean": -315.8209875715224, "episodes_this_iter": 45, "date": "2019-05-23_06-49-15", "time_this_iter_s": 26.26047396659851, "num_metric_batches_dropped": 0, "episode_reward_min": -515.7666875310852}
{"time_since_restore": 2094.911098241806, "info": {"default": {"kl": 0.017844267189502716, "total_loss": 10.698760986328125, "vf_explained_var": 0.8957281112670898, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009209706448018551, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 10.704959869384766, "entropy": 0.9887440204620361}, "num_steps_trained": 2620846, "grad_time_ms": 9719.982, "load_time_ms": 14.705, "sample_time_ms": 17665.071, "num_steps_sampled": 2620846, "update_time_ms": 9.401}, "hostname": "flow-main", "episode_reward_max": -24.118559272853624, "timesteps_this_iter": 33453, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.77827221194087, "cost1_mean": 192.9057884132608, "system_level_velocity_mean": 16.577629715853742, "cost2_mean": -27.22102728320338, "cost2_max": -12.696115787048443, "outflow_rate_max": 1314.8594661155598, "cost1_min": 17.730436274753494, "system_level_velocity_min": 12.877995483523065, "system_level_velocity_max": 18.809245852122483, "outflow_rate_min": 444.6769763958757, "outflow_rate_mean": 1170.9152817789547, "cost2_min": -33.632560701565254}, "episode_len_mean": 318.2, "node_ip": "10.138.0.2", "timesteps_since_restore": 2620846, "time_total_s": 2094.911098241806, "timestamp": 1558594182, "iterations_since_restore": 74, "policy_reward_mean": {}, "training_iteration": 74, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7be0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7940>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1e48>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3438, "timesteps_total": 2620846, "episode_reward_mean": -310.58326953469987, "episodes_this_iter": 47, "date": "2019-05-23_06-49-42", "time_this_iter_s": 26.819987535476685, "num_metric_batches_dropped": 0, "episode_reward_min": -503.64535155091244}
{"time_since_restore": 2122.0957777500153, "info": {"default": {"kl": 0.015851926058530807, "total_loss": 10.813316345214844, "vf_explained_var": 0.8957430720329285, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008520501665771008, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 10.819162368774414, "entropy": 0.968614399433136}, "num_steps_trained": 2654736, "grad_time_ms": 9605.69, "load_time_ms": 14.508, "sample_time_ms": 17667.1, "num_steps_sampled": 2654736, "update_time_ms": 9.378}, "hostname": "flow-main", "episode_reward_max": -24.118559272853624, "timesteps_this_iter": 33890, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.77827221194087, "cost1_mean": 195.81249965077564, "system_level_velocity_mean": 16.733160188171684, "cost2_mean": -26.911796951209535, "cost2_max": -12.696115787048443, "outflow_rate_max": 1314.8594661155598, "cost1_min": 17.730436274753494, "system_level_velocity_min": 12.866472435678675, "system_level_velocity_max": 18.657896911648603, "outflow_rate_min": 444.6769763958757, "outflow_rate_mean": 1182.1702901980052, "cost2_min": -34.478536041022906}, "episode_len_mean": 319.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 2654736, "time_total_s": 2122.0957777500153, "timestamp": 1558594209, "iterations_since_restore": 75, "policy_reward_mean": {}, "training_iteration": 75, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd2b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1d30>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3487, "timesteps_total": 2654736, "episode_reward_mean": -309.24715458140963, "episodes_this_iter": 49, "date": "2019-05-23_06-50-09", "time_this_iter_s": 27.18467950820923, "num_metric_batches_dropped": 0, "episode_reward_min": -492.6196705811651}
{"time_since_restore": 2150.018232345581, "info": {"default": {"kl": 0.015566297806799412, "total_loss": 9.52386474609375, "vf_explained_var": 0.9022416472434998, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008494272828102112, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 9.529732704162598, "entropy": 0.9714270234107971}, "num_steps_trained": 2689229, "grad_time_ms": 9572.594, "load_time_ms": 14.355, "sample_time_ms": 17687.291, "num_steps_sampled": 2689229, "update_time_ms": 9.117}, "hostname": "flow-main", "episode_reward_max": -232.61737004169558, "timesteps_this_iter": 34493, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.14893245317398, "cost1_mean": 196.34350050857708, "system_level_velocity_mean": 16.51042547505599, "cost2_mean": -27.95021828347312, "cost2_max": -20.46183681124634, "outflow_rate_max": 1310.0500078421503, "cost1_min": 125.83974013750296, "system_level_velocity_min": 12.866472435678675, "system_level_velocity_max": 18.75703816797233, "outflow_rate_min": 927.9390086301554, "outflow_rate_mean": 1191.6538141038384, "cost2_min": -34.478536041022906}, "episode_len_mean": 323.62, "node_ip": "10.138.0.2", "timesteps_since_restore": 2689229, "time_total_s": 2150.018232345581, "timestamp": 1558594237, "iterations_since_restore": 76, "policy_reward_mean": {}, "training_iteration": 76, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846afe10>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af048>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3531, "timesteps_total": 2689229, "episode_reward_mean": -322.5848673637831, "episodes_this_iter": 44, "date": "2019-05-23_06-50-37", "time_this_iter_s": 27.922454595565796, "num_metric_batches_dropped": 0, "episode_reward_min": -492.6196705811651}
{"time_since_restore": 2177.032924890518, "info": {"default": {"kl": 0.0171200018376112, "total_loss": 10.168829917907715, "vf_explained_var": 0.8997287154197693, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00806031096726656, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 10.174001693725586, "entropy": 0.964656412601471}, "num_steps_trained": 2723519, "grad_time_ms": 9473.234, "load_time_ms": 14.214, "sample_time_ms": 17732.038, "num_steps_sampled": 2723519, "update_time_ms": 9.205}, "hostname": "flow-main", "episode_reward_max": -234.1193920316211, "timesteps_this_iter": 34290, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.14893245317398, "cost1_mean": 196.75740686566772, "system_level_velocity_mean": 16.47075497910985, "cost2_mean": -28.313362060681044, "cost2_max": -19.107678984685393, "outflow_rate_max": 1310.0500078421503, "cost1_min": 162.34614043406793, "system_level_velocity_min": 13.551793380486384, "system_level_velocity_max": 18.75703816797233, "outflow_rate_min": 988.1160729767658, "outflow_rate_mean": 1198.5690288799308, "cost2_min": -35.199289909013274}, "episode_len_mean": 324.44, "node_ip": "10.138.0.2", "timesteps_since_restore": 2723519, "time_total_s": 2177.032924890518, "timestamp": 1558594264, "iterations_since_restore": 77, "policy_reward_mean": {}, "training_iteration": 77, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdd30>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd5f8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3578, "timesteps_total": 2723519, "episode_reward_mean": -324.7224626533613, "episodes_this_iter": 47, "date": "2019-05-23_06-51-04", "time_this_iter_s": 27.014692544937134, "num_metric_batches_dropped": 0, "episode_reward_min": -450.1471939267975}
{"time_since_restore": 2204.588203191757, "info": {"default": {"kl": 0.019846109673380852, "total_loss": 9.897247314453125, "vf_explained_var": 0.9097854495048523, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011498010717332363, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 9.9053955078125, "entropy": 0.9834190607070923}, "num_steps_trained": 2757541, "grad_time_ms": 9456.197, "load_time_ms": 14.466, "sample_time_ms": 17726.619, "num_steps_sampled": 2757541, "update_time_ms": 9.261}, "hostname": "flow-main", "episode_reward_max": -234.01095802894108, "timesteps_this_iter": 34022, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.95714007716634, "cost1_mean": 195.79217197477374, "system_level_velocity_mean": 16.38301340892555, "cost2_mean": -28.34430096734336, "cost2_max": -19.107678984685393, "outflow_rate_max": 1319.123724211074, "cost1_min": 148.8296861436915, "system_level_velocity_min": 12.466993345891774, "system_level_velocity_max": 18.699787021868236, "outflow_rate_min": 968.1858364485978, "outflow_rate_mean": 1194.0065393456757, "cost2_min": -35.199289909013274}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 2757541, "time_total_s": 2204.588203191757, "timestamp": 1558594292, "iterations_since_restore": 78, "policy_reward_mean": {}, "training_iteration": 78, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b75c0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7ac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7160>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3621, "timesteps_total": 2757541, "episode_reward_mean": -325.9565657871592, "episodes_this_iter": 43, "date": "2019-05-23_06-51-32", "time_this_iter_s": 27.555278301239014, "num_metric_batches_dropped": 0, "episode_reward_min": -489.3948522744415}
{"time_since_restore": 2232.5184388160706, "info": {"default": {"kl": 0.018414968624711037, "total_loss": 10.564648628234863, "vf_explained_var": 0.8905305862426758, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01016734167933464, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 10.571709632873535, "entropy": 0.9621202349662781}, "num_steps_trained": 2791768, "grad_time_ms": 9465.955, "load_time_ms": 14.395, "sample_time_ms": 17716.652, "num_steps_sampled": 2791768, "update_time_ms": 9.332}, "hostname": "flow-main", "episode_reward_max": -234.01095802894108, "timesteps_this_iter": 34227, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.95714007716634, "cost1_mean": 194.58093402971718, "system_level_velocity_mean": 16.271390025079246, "cost2_mean": -28.37782530749556, "cost2_max": -21.106001467869454, "outflow_rate_max": 1319.123724211074, "cost1_min": 148.8296861436915, "system_level_velocity_min": 12.466993345891774, "system_level_velocity_max": 18.699787021868236, "outflow_rate_min": 968.1858364485978, "outflow_rate_mean": 1186.8259884290153, "cost2_min": -33.78303910033464}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2791768, "time_total_s": 2232.5184388160706, "timestamp": 1558594320, "iterations_since_restore": 79, "policy_reward_mean": {}, "training_iteration": 79, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913978>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a668>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913cf8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3669, "timesteps_total": 2791768, "episode_reward_mean": -330.33297604323946, "episodes_this_iter": 48, "date": "2019-05-23_06-52-00", "time_this_iter_s": 27.930235624313354, "num_metric_batches_dropped": 0, "episode_reward_min": -489.3948522744415}
{"time_since_restore": 2259.5686185359955, "info": {"default": {"kl": 0.016045399010181427, "total_loss": 9.088744163513184, "vf_explained_var": 0.8998479843139648, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008782045915722847, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 9.094819068908691, "entropy": 0.9637309908866882}, "num_steps_trained": 2825761, "grad_time_ms": 9292.556, "load_time_ms": 14.55, "sample_time_ms": 17763.49, "num_steps_sampled": 2825761, "update_time_ms": 9.394}, "hostname": "flow-main", "episode_reward_max": -233.3586116930708, "timesteps_this_iter": 33993, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.32251329980238, "cost1_mean": 194.8330426641096, "system_level_velocity_mean": 16.3779188188525, "cost2_mean": -28.17789610388276, "cost2_max": -21.106001467869454, "outflow_rate_max": 1309.3317068645642, "cost1_min": 120.78486185503391, "system_level_velocity_min": 12.717860684046274, "system_level_velocity_max": 18.73291583569414, "outflow_rate_min": 906.9605344132343, "outflow_rate_mean": 1186.3455891673864, "cost2_min": -33.35896553130531}, "episode_len_mean": 323.26, "node_ip": "10.138.0.2", "timesteps_since_restore": 2825761, "time_total_s": 2259.5686185359955, "timestamp": 1558594347, "iterations_since_restore": 80, "policy_reward_mean": {}, "training_iteration": 80, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491acf8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a7f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a518>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3715, "timesteps_total": 2825761, "episode_reward_mean": -325.85298264072526, "episodes_this_iter": 46, "date": "2019-05-23_06-52-27", "time_this_iter_s": 27.050179719924927, "num_metric_batches_dropped": 0, "episode_reward_min": -463.222322504829}
{"time_since_restore": 2287.270465373993, "info": {"default": {"kl": 0.01803717389702797, "total_loss": 8.838997840881348, "vf_explained_var": 0.9079709053039551, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008333364501595497, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 8.844286918640137, "entropy": 0.9644895195960999}, "num_steps_trained": 2860325, "grad_time_ms": 9364.139, "load_time_ms": 14.64, "sample_time_ms": 17751.514, "num_steps_sampled": 2860325, "update_time_ms": 9.351}, "hostname": "flow-main", "episode_reward_max": -218.30525334569802, "timesteps_this_iter": 34564, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.78289179484045, "cost1_mean": 195.55988595064224, "system_level_velocity_mean": 16.449001353693703, "cost2_mean": -28.28114674338769, "cost2_max": -21.315441454788147, "outflow_rate_max": 1309.3317068645642, "cost1_min": 120.78486185503391, "system_level_velocity_min": 13.099902684061258, "system_level_velocity_max": 18.73291583569414, "outflow_rate_min": 906.9605344132343, "outflow_rate_mean": 1195.7483489162419, "cost2_min": -34.80439829504268}, "episode_len_mean": 322.98, "node_ip": "10.138.0.2", "timesteps_since_restore": 2860325, "time_total_s": 2287.270465373993, "timestamp": 1558594375, "iterations_since_restore": 81, "policy_reward_mean": {}, "training_iteration": 81, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7048>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7e48>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3759, "timesteps_total": 2860325, "episode_reward_mean": -322.7488053649354, "episodes_this_iter": 44, "date": "2019-05-23_06-52-55", "time_this_iter_s": 27.701846837997437, "num_metric_batches_dropped": 0, "episode_reward_min": -463.222322504829}
{"time_since_restore": 2315.1865696907043, "info": {"default": {"kl": 0.017301486805081367, "total_loss": 11.008990287780762, "vf_explained_var": 0.899817705154419, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010194653645157814, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 11.016264915466309, "entropy": 0.9901136755943298}, "num_steps_trained": 2895353, "grad_time_ms": 9419.771, "load_time_ms": 15.164, "sample_time_ms": 17812.137, "num_steps_sampled": 2895353, "update_time_ms": 9.186}, "hostname": "flow-main", "episode_reward_max": -153.52088670565908, "timesteps_this_iter": 35028, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.74289979542445, "cost1_mean": 195.69183953857794, "system_level_velocity_mean": 16.451658470178756, "cost2_mean": -28.230998377524212, "cost2_max": -21.578095180180146, "outflow_rate_max": 1323.9000587507733, "cost1_min": 139.2346455376399, "system_level_velocity_min": 11.729746791593845, "system_level_velocity_max": 18.794712617705578, "outflow_rate_min": 893.4782387592383, "outflow_rate_mean": 1203.700084567744, "cost2_min": -34.80439829504268}, "episode_len_mean": 323.34, "node_ip": "10.138.0.2", "timesteps_since_restore": 2895353, "time_total_s": 2315.1865696907043, "timestamp": 1558594403, "iterations_since_restore": 82, "policy_reward_mean": {}, "training_iteration": 82, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b73c8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b71d0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3810, "timesteps_total": 2895353, "episode_reward_mean": -328.2147552160029, "episodes_this_iter": 51, "date": "2019-05-23_06-53-23", "time_this_iter_s": 27.916104316711426, "num_metric_batches_dropped": 0, "episode_reward_min": -527.8874042465661}
{"time_since_restore": 2342.7801349163055, "info": {"default": {"kl": 0.017302382737398148, "total_loss": 13.738333702087402, "vf_explained_var": 0.8860482573509216, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007899136282503605, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 13.743313789367676, "entropy": 0.9943919777870178}, "num_steps_trained": 2930141, "grad_time_ms": 9474.847, "load_time_ms": 14.905, "sample_time_ms": 17890.445, "num_steps_sampled": 2930141, "update_time_ms": 9.064}, "hostname": "flow-main", "episode_reward_max": -153.52088670565908, "timesteps_this_iter": 34788, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.74289979542445, "cost1_mean": 196.6647411339248, "system_level_velocity_mean": 16.524699934730176, "cost2_mean": -27.7714124587887, "cost2_max": -21.565429249191112, "outflow_rate_max": 1323.9000587507733, "cost1_min": 139.2346455376399, "system_level_velocity_min": 11.729746791593845, "system_level_velocity_max": 18.794712617705578, "outflow_rate_min": 893.4782387592383, "outflow_rate_mean": 1204.1887766307364, "cost2_min": -34.80439829504268}, "episode_len_mean": 323.62, "node_ip": "10.138.0.2", "timesteps_since_restore": 2930141, "time_total_s": 2342.7801349163055, "timestamp": 1558594430, "iterations_since_restore": 83, "policy_reward_mean": {}, "training_iteration": 83, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a3c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492ab70>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a0b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3855, "timesteps_total": 2930141, "episode_reward_mean": -329.93551924858883, "episodes_this_iter": 45, "date": "2019-05-23_06-53-50", "time_this_iter_s": 27.593565225601196, "num_metric_batches_dropped": 0, "episode_reward_min": -537.7083885493696}
{"time_since_restore": 2369.8548741340637, "info": {"default": {"kl": 0.01766088977456093, "total_loss": 11.374608993530273, "vf_explained_var": 0.8914473652839661, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009863754734396935, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 11.381492614746094, "entropy": 0.9615249633789062}, "num_steps_trained": 2964917, "grad_time_ms": 9552.514, "load_time_ms": 14.914, "sample_time_ms": 17835.28, "num_steps_sampled": 2964917, "update_time_ms": 8.939}, "hostname": "flow-main", "episode_reward_max": -167.34262610513093, "timesteps_this_iter": 34776, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.4289065617544, "cost1_mean": 195.57612942302316, "system_level_velocity_mean": 16.40197708602158, "cost2_mean": -27.848746803793528, "cost2_max": -21.565429249191112, "outflow_rate_max": 1317.421463511494, "cost1_min": 143.88618557474086, "system_level_velocity_min": 12.492850076395664, "system_level_velocity_max": 18.705498946509984, "outflow_rate_min": 989.1587209302327, "outflow_rate_mean": 1199.4937119656956, "cost2_min": -34.49458444083096}, "episode_len_mean": 323.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 2964917, "time_total_s": 2369.8548741340637, "timestamp": 1558594457, "iterations_since_restore": 84, "policy_reward_mean": {}, "training_iteration": 84, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c17f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f27b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3900, "timesteps_total": 2964917, "episode_reward_mean": -333.9375935034518, "episodes_this_iter": 45, "date": "2019-05-23_06-54-17", "time_this_iter_s": 27.07473921775818, "num_metric_batches_dropped": 0, "episode_reward_min": -537.7083885493696}
{"time_since_restore": 2397.570033311844, "info": {"default": {"kl": 0.018733235076069832, "total_loss": 12.629131317138672, "vf_explained_var": 0.8880100846290588, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010068506002426147, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 12.636037826538086, "entropy": 0.9668387770652771}, "num_steps_trained": 2999636, "grad_time_ms": 9604.657, "load_time_ms": 14.29, "sample_time_ms": 17837.02, "num_steps_sampled": 2999636, "update_time_ms": 9.147}, "hostname": "flow-main", "episode_reward_max": -166.71203985313835, "timesteps_this_iter": 34719, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.4289065617544, "cost1_mean": 192.66969776758089, "system_level_velocity_mean": 16.224190603106294, "cost2_mean": -27.705140639372345, "cost2_max": -19.418531238623746, "outflow_rate_max": 1317.421463511494, "cost1_min": 143.88618557474086, "system_level_velocity_min": 12.13765373774134, "system_level_velocity_max": 18.705498946509984, "outflow_rate_min": 980.3470804327022, "outflow_rate_mean": 1189.2439695731991, "cost2_min": -35.78393565152529}, "episode_len_mean": 322.65, "node_ip": "10.138.0.2", "timesteps_since_restore": 2999636, "time_total_s": 2397.570033311844, "timestamp": 1558594485, "iterations_since_restore": 85, "policy_reward_mean": {}, "training_iteration": 85, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491aef0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491ae48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a160>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3950, "timesteps_total": 2999636, "episode_reward_mean": -337.376625933041, "episodes_this_iter": 50, "date": "2019-05-23_06-54-45", "time_this_iter_s": 27.71515917778015, "num_metric_batches_dropped": 0, "episode_reward_min": -548.8375013567976}
{"time_since_restore": 2424.4893820285797, "info": {"default": {"kl": 0.017096195369958878, "total_loss": 10.266493797302246, "vf_explained_var": 0.8997418880462646, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008369959890842438, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 10.271978378295898, "entropy": 0.9631707668304443}, "num_steps_trained": 3034045, "grad_time_ms": 9576.084, "load_time_ms": 14.503, "sample_time_ms": 17764.162, "num_steps_sampled": 3034045, "update_time_ms": 9.332}, "hostname": "flow-main", "episode_reward_max": -166.71203985313835, "timesteps_this_iter": 34409, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.94106065270847, "cost1_mean": 194.50057077052136, "system_level_velocity_mean": 16.419158328687395, "cost2_mean": -26.925735264471392, "cost2_max": -18.09868199905463, "outflow_rate_max": 1309.867863223672, "cost1_min": 143.88618557474086, "system_level_velocity_min": 12.13765373774134, "system_level_velocity_max": 18.649629769440192, "outflow_rate_min": 980.3470804327022, "outflow_rate_mean": 1192.781196969253, "cost2_min": -35.78393565152529}, "episode_len_mean": 322.65, "node_ip": "10.138.0.2", "timesteps_since_restore": 3034045, "time_total_s": 2424.4893820285797, "timestamp": 1558594512, "iterations_since_restore": 86, "policy_reward_mean": {}, "training_iteration": 86, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e128>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e0b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913b70>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 3993, "timesteps_total": 3034045, "episode_reward_mean": -329.82646568273316, "episodes_this_iter": 43, "date": "2019-05-23_06-55-12", "time_this_iter_s": 26.91934871673584, "num_metric_batches_dropped": 0, "episode_reward_min": -548.8375013567976}
{"time_since_restore": 2451.711307287216, "info": {"default": {"kl": 0.017829030752182007, "total_loss": 10.696935653686523, "vf_explained_var": 0.8820103406906128, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008058014325797558, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 10.701985359191895, "entropy": 0.9385324716567993}, "num_steps_trained": 3068823, "grad_time_ms": 9626.321, "load_time_ms": 14.51, "sample_time_ms": 17734.292, "num_steps_sampled": 3068823, "update_time_ms": 9.204}, "hostname": "flow-main", "episode_reward_max": -227.28739212227586, "timesteps_this_iter": 34778, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.96769486039767, "cost1_mean": 197.1878929177048, "system_level_velocity_mean": 16.52889115340479, "cost2_mean": -26.60830121890417, "cost2_max": -18.09868199905463, "outflow_rate_max": 1314.5364403778042, "cost1_min": 151.60123619210717, "system_level_velocity_min": 12.57822740636522, "system_level_velocity_max": 18.6657178580376, "outflow_rate_min": 987.6984905660375, "outflow_rate_mean": 1204.4882288212625, "cost2_min": -35.28161809946982}, "episode_len_mean": 324.6, "node_ip": "10.138.0.2", "timesteps_since_restore": 3068823, "time_total_s": 2451.711307287216, "timestamp": 1558594539, "iterations_since_restore": 87, "policy_reward_mean": {}, "training_iteration": 87, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1a58>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c17f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1358>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4039, "timesteps_total": 3068823, "episode_reward_mean": -326.8922064955509, "episodes_this_iter": 46, "date": "2019-05-23_06-55-39", "time_this_iter_s": 27.221925258636475, "num_metric_batches_dropped": 0, "episode_reward_min": -548.8375013567976}
{"time_since_restore": 2480.304984331131, "info": {"default": {"kl": 0.01885867491364479, "total_loss": 12.266911506652832, "vf_explained_var": 0.8726921081542969, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008626011200249195, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 12.272355079650879, "entropy": 0.9520947933197021}, "num_steps_trained": 3104248, "grad_time_ms": 9649.925, "load_time_ms": 13.965, "sample_time_ms": 17816.602, "num_steps_sampled": 3104248, "update_time_ms": 9.466}, "hostname": "flow-main", "episode_reward_max": -227.28739212227586, "timesteps_this_iter": 35425, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.96769486039767, "cost1_mean": 196.28595500215076, "system_level_velocity_mean": 16.390320961462773, "cost2_mean": -27.188330276582537, "cost2_max": -19.96778785655373, "outflow_rate_max": 1314.5364403778042, "cost1_min": 152.84174195894877, "system_level_velocity_min": 12.688465180809407, "system_level_velocity_max": 18.6657178580376, "outflow_rate_min": 995.3168595041321, "outflow_rate_mean": 1206.3250103257035, "cost2_min": -34.202582169585554}, "episode_len_mean": 324.8, "node_ip": "10.138.0.2", "timesteps_since_restore": 3104248, "time_total_s": 2480.304984331131, "timestamp": 1558594568, "iterations_since_restore": 88, "policy_reward_mean": {}, "training_iteration": 88, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7ac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a1d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7588>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4089, "timesteps_total": 3104248, "episode_reward_mean": -334.11859856153046, "episodes_this_iter": 50, "date": "2019-05-23_06-56-08", "time_this_iter_s": 28.593677043914795, "num_metric_batches_dropped": 0, "episode_reward_min": -516.5963659104373}
{"time_since_restore": 2507.2540290355682, "info": {"default": {"kl": 0.01898069679737091, "total_loss": 9.563549041748047, "vf_explained_var": 0.901996374130249, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009651443921029568, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 9.569998741149902, "entropy": 0.9331643581390381}, "num_steps_trained": 3139121, "grad_time_ms": 9564.825, "load_time_ms": 13.477, "sample_time_ms": 17804.277, "num_steps_sampled": 3139121, "update_time_ms": 9.566}, "hostname": "flow-main", "episode_reward_max": -238.529056490107, "timesteps_this_iter": 34873, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.92826407400722, "cost1_mean": 195.2196421094745, "system_level_velocity_mean": 16.272559262827635, "cost2_mean": -27.39090392902194, "cost2_max": -19.64703832137138, "outflow_rate_max": 1310.754828785447, "cost1_min": 145.77077802116108, "system_level_velocity_min": 12.193051065055414, "system_level_velocity_max": 18.55181455722989, "outflow_rate_min": 987.2571653543306, "outflow_rate_mean": 1204.0973881596244, "cost2_min": -34.202582169585554}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3139121, "time_total_s": 2507.2540290355682, "timestamp": 1558594595, "iterations_since_restore": 89, "policy_reward_mean": {}, "training_iteration": 89, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e5c0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490ec88>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a3c8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4133, "timesteps_total": 3139121, "episode_reward_mean": -338.45161225278343, "episodes_this_iter": 44, "date": "2019-05-23_06-56-35", "time_this_iter_s": 26.949044704437256, "num_metric_batches_dropped": 0, "episode_reward_min": -557.1874860054983}
{"time_since_restore": 2534.8985888957977, "info": {"default": {"kl": 0.017297133803367615, "total_loss": 9.800236701965332, "vf_explained_var": 0.8941185474395752, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008506866171956062, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 9.805824279785156, "entropy": 0.9242549538612366}, "num_steps_trained": 3174056, "grad_time_ms": 9594.564, "load_time_ms": 13.701, "sample_time_ms": 17833.106, "num_steps_sampled": 3174056, "update_time_ms": 9.951}, "hostname": "flow-main", "episode_reward_max": -238.529056490107, "timesteps_this_iter": 34935, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.0489555885058, "cost1_mean": 197.39526647885614, "system_level_velocity_mean": 16.48721718421034, "cost2_mean": -26.761868037333315, "cost2_max": -17.10361308668614, "outflow_rate_max": 1317.8688407494142, "cost1_min": 145.77077802116108, "system_level_velocity_min": 12.193051065055414, "system_level_velocity_max": 18.53088865654684, "outflow_rate_min": 987.2571653543306, "outflow_rate_mean": 1213.057651860954, "cost2_min": -36.41923265427413}, "episode_len_mean": 324.83, "node_ip": "10.138.0.2", "timesteps_since_restore": 3174056, "time_total_s": 2534.8985888957977, "timestamp": 1558594623, "iterations_since_restore": 90, "policy_reward_mean": {}, "training_iteration": 90, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1ba8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c15f8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a9e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4179, "timesteps_total": 3174056, "episode_reward_mean": -330.547222779938, "episodes_this_iter": 46, "date": "2019-05-23_06-57-03", "time_this_iter_s": 27.644559860229492, "num_metric_batches_dropped": 0, "episode_reward_min": -557.1874860054983}
{"time_since_restore": 2562.007717370987, "info": {"default": {"kl": 0.018347203731536865, "total_loss": 9.552716255187988, "vf_explained_var": 0.8940073847770691, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009945201687514782, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 9.559565544128418, "entropy": 0.9321123957633972}, "num_steps_trained": 3208276, "grad_time_ms": 9433.001, "load_time_ms": 16.215, "sample_time_ms": 17933.52, "num_steps_sampled": 3208276, "update_time_ms": 9.978}, "hostname": "flow-main", "episode_reward_max": -30.57885374244225, "timesteps_this_iter": 34220, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.0489555885058, "cost1_mean": 197.3605901274233, "system_level_velocity_mean": 16.684800011318845, "cost2_mean": -26.125486087353792, "cost2_max": -10.631626718928327, "outflow_rate_max": 1317.8688407494142, "cost1_min": 23.879201576305256, "system_level_velocity_min": 12.96441742475096, "system_level_velocity_max": 18.550224205219365, "outflow_rate_min": 510.4088222968832, "outflow_rate_mean": 1210.4714321227705, "cost2_min": -36.41923265427413}, "episode_len_mean": 321.67, "node_ip": "10.138.0.2", "timesteps_since_restore": 3208276, "time_total_s": 2562.007717370987, "timestamp": 1558594650, "iterations_since_restore": 91, "policy_reward_mean": {}, "training_iteration": 91, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a7f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e278>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4225, "timesteps_total": 3208276, "episode_reward_mean": -320.3250042868821, "episodes_this_iter": 46, "date": "2019-05-23_06-57-30", "time_this_iter_s": 27.10912847518921, "num_metric_batches_dropped": 0, "episode_reward_min": -506.64220947937133}
{"time_since_restore": 2590.854194879532, "info": {"default": {"kl": 0.01778610609471798, "total_loss": 9.499176979064941, "vf_explained_var": 0.8837393522262573, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008110960945487022, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 9.50428581237793, "entropy": 0.9159712195396423}, "num_steps_trained": 3242837, "grad_time_ms": 9372.892, "load_time_ms": 16.356, "sample_time_ms": 18085.383, "num_steps_sampled": 3242837, "update_time_ms": 10.008}, "hostname": "flow-main", "episode_reward_max": -22.66099093370726, "timesteps_this_iter": 34561, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.92164902854046, "cost1_mean": 197.62755997458746, "system_level_velocity_mean": 16.896041901746266, "cost2_mean": -25.656444205560412, "cost2_max": -9.76900824345322, "outflow_rate_max": 1316.8409308062069, "cost1_min": 17.639005667765822, "system_level_velocity_min": 12.96441742475096, "system_level_velocity_max": 18.58600026245044, "outflow_rate_min": 487.8590816741719, "outflow_rate_mean": 1212.485105854202, "cost2_min": -35.935202869320506}, "episode_len_mean": 318.41, "node_ip": "10.138.0.2", "timesteps_since_restore": 3242837, "time_total_s": 2590.854194879532, "timestamp": 1558594679, "iterations_since_restore": 92, "policy_reward_mean": {}, "training_iteration": 92, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491aa20>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4273, "timesteps_total": 3242837, "episode_reward_mean": -310.7190121993731, "episodes_this_iter": 48, "date": "2019-05-23_06-57-59", "time_this_iter_s": 28.846477508544922, "num_metric_batches_dropped": 0, "episode_reward_min": -506.64220947937133}
{"time_since_restore": 2618.8600249290466, "info": {"default": {"kl": 0.01839471608400345, "total_loss": 9.24549674987793, "vf_explained_var": 0.8966436386108398, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008137360215187073, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 9.250530242919922, "entropy": 0.9228731989860535}, "num_steps_trained": 3277962, "grad_time_ms": 9311.085, "load_time_ms": 17.048, "sample_time_ms": 18185.911, "num_steps_sampled": 3277962, "update_time_ms": 9.982}, "hostname": "flow-main", "episode_reward_max": -22.66099093370726, "timesteps_this_iter": 35125, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.4008277088434, "cost1_mean": 199.91758021582726, "system_level_velocity_mean": 16.896488152703355, "cost2_mean": -25.496463322295664, "cost2_max": -9.76900824345322, "outflow_rate_max": 1316.8409308062069, "cost1_min": 17.639005667765822, "system_level_velocity_min": 13.88608924366351, "system_level_velocity_max": 18.624037470753407, "outflow_rate_min": 487.8590816741719, "outflow_rate_mean": 1222.9677256962204, "cost2_min": -35.822339894668644}, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 3277962, "time_total_s": 2618.8600249290466, "timestamp": 1558594707, "iterations_since_restore": 93, "policy_reward_mean": {}, "training_iteration": 93, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7438>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7710>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4318, "timesteps_total": 3277962, "episode_reward_mean": -313.61267055859, "episodes_this_iter": 45, "date": "2019-05-23_06-58-27", "time_this_iter_s": 28.00583004951477, "num_metric_batches_dropped": 0, "episode_reward_min": -443.02890490339945}
{"time_since_restore": 2647.457627773285, "info": {"default": {"kl": 0.017633317038416862, "total_loss": 11.055204391479492, "vf_explained_var": 0.890074610710144, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009883481077849865, "cur_kl_coeff": 0.16875000298023224, "vf_loss": 11.062111854553223, "entropy": 0.9327225089073181}, "num_steps_trained": 3313454, "grad_time_ms": 9300.032, "load_time_ms": 18.51, "sample_time_ms": 18350.066, "num_steps_sampled": 3313454, "update_time_ms": 10.058}, "hostname": "flow-main", "episode_reward_max": -23.752119226387467, "timesteps_this_iter": 35492, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.4008277088434, "cost1_mean": 196.7622554978998, "system_level_velocity_mean": 16.610724613524326, "cost2_mean": -26.07313843437272, "cost2_max": -11.98246375964354, "outflow_rate_max": 1316.8409308062069, "cost1_min": 17.806266251804416, "system_level_velocity_min": 11.928206365394681, "system_level_velocity_max": 18.658343341516872, "outflow_rate_min": 447.40921683303424, "outflow_rate_mean": 1212.007235861572, "cost2_min": -40.38545809751389}, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 3313454, "time_total_s": 2647.457627773285, "timestamp": 1558594735, "iterations_since_restore": 94, "policy_reward_mean": {}, "training_iteration": 94, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a518>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a6d8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a390>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4365, "timesteps_total": 3313454, "episode_reward_mean": -325.5440950945049, "episodes_this_iter": 47, "date": "2019-05-23_06-58-55", "time_this_iter_s": 28.59760284423828, "num_metric_batches_dropped": 0, "episode_reward_min": -553.285341161427}
{"time_since_restore": 2675.099091053009, "info": {"default": {"kl": 0.017896175384521484, "total_loss": 9.280369758605957, "vf_explained_var": 0.8974120020866394, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006972660776227713, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 9.284322738647461, "entropy": 0.8982192873954773}, "num_steps_trained": 3348274, "grad_time_ms": 9299.39, "load_time_ms": 20.256, "sample_time_ms": 18340.666, "num_steps_sampled": 3348274, "update_time_ms": 9.953}, "hostname": "flow-main", "episode_reward_max": -23.752119226387467, "timesteps_this_iter": 34820, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.4008277088434, "cost1_mean": 194.8023328876555, "system_level_velocity_mean": 16.47979458541581, "cost2_mean": -26.768790757719835, "cost2_max": -11.98246375964354, "outflow_rate_max": 1313.8748255057735, "cost1_min": 17.806266251804416, "system_level_velocity_min": 11.928206365394681, "system_level_velocity_max": 18.658343341516872, "outflow_rate_min": 447.40921683303424, "outflow_rate_mean": 1202.9819990490337, "cost2_min": -40.38545809751389}, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 3348274, "time_total_s": 2675.099091053009, "timestamp": 1558594763, "iterations_since_restore": 95, "policy_reward_mean": {}, "training_iteration": 95, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1358>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1fd0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1978>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4414, "timesteps_total": 3348274, "episode_reward_mean": -330.7694127339679, "episodes_this_iter": 49, "date": "2019-05-23_06-59-23", "time_this_iter_s": 27.64146327972412, "num_metric_batches_dropped": 0, "episode_reward_min": -553.285341161427}
{"time_since_restore": 2702.3200528621674, "info": {"default": {"kl": 0.01771995797753334, "total_loss": 8.314470291137695, "vf_explained_var": 0.8910154700279236, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005539370700716972, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 8.31701946258545, "entropy": 0.8883851766586304}, "num_steps_trained": 3382489, "grad_time_ms": 9257.685, "load_time_ms": 20.998, "sample_time_ms": 18412.05, "num_steps_sampled": 3382489, "update_time_ms": 10.067}, "hostname": "flow-main", "episode_reward_max": -157.4332711077115, "timesteps_this_iter": 34215, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.17942954220746, "cost1_mean": 199.41272667563126, "system_level_velocity_mean": 16.79166408217899, "cost2_mean": -26.269548381147683, "cost2_max": -17.35389093066553, "outflow_rate_max": 1313.8748255057735, "cost1_min": 133.31594349240828, "system_level_velocity_min": 13.662248541289122, "system_level_velocity_max": 18.53056110470855, "outflow_rate_min": 990.1183309552382, "outflow_rate_mean": 1220.8472214543199, "cost2_min": -35.4164528138131}, "episode_len_mean": 322.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 3382489, "time_total_s": 2702.3200528621674, "timestamp": 1558594790, "iterations_since_restore": 96, "policy_reward_mean": {}, "training_iteration": 96, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd9e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd320>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd358>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4459, "timesteps_total": 3382489, "episode_reward_mean": -317.31180077261615, "episodes_this_iter": 45, "date": "2019-05-23_06-59-50", "time_this_iter_s": 27.220961809158325, "num_metric_batches_dropped": 0, "episode_reward_min": -452.73769446103864}
{"time_since_restore": 2729.5471947193146, "info": {"default": {"kl": 0.018022209405899048, "total_loss": 8.24837875366211, "vf_explained_var": 0.8999295830726624, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008670097216963768, "cur_kl_coeff": 0.16875003278255463, "vf_loss": 8.254007339477539, "entropy": 0.8858206272125244}, "num_steps_trained": 3417090, "grad_time_ms": 9231.857, "load_time_ms": 21.249, "sample_time_ms": 18438.596, "num_steps_sampled": 3417090, "update_time_ms": 9.904}, "hostname": "flow-main", "episode_reward_max": -197.07424923258466, "timesteps_this_iter": 34601, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.17942954220746, "cost1_mean": 201.76283729638965, "system_level_velocity_mean": 16.939526646407586, "cost2_mean": -25.763079987645533, "cost2_max": -17.35389093066553, "outflow_rate_max": 1313.8748255057735, "cost1_min": 133.31594349240828, "system_level_velocity_min": 14.804471895188533, "system_level_velocity_max": 18.569304500517024, "outflow_rate_min": 990.1183309552382, "outflow_rate_mean": 1228.0633014273546, "cost2_min": -33.5296137714643}, "episode_len_mean": 323.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 3417090, "time_total_s": 2729.5471947193146, "timestamp": 1558594817, "iterations_since_restore": 97, "policy_reward_mean": {}, "training_iteration": 97, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913fd0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849131d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913f60>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4503, "timesteps_total": 3417090, "episode_reward_mean": -312.50541355275874, "episodes_this_iter": 44, "date": "2019-05-23_07-00-17", "time_this_iter_s": 27.227141857147217, "num_metric_batches_dropped": 0, "episode_reward_min": -421.1811364314784}
{"time_since_restore": 2757.3991918563843, "info": {"default": {"kl": 0.01928192935883999, "total_loss": 10.170618057250977, "vf_explained_var": 0.8940349817276001, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009523839689791203, "cur_kl_coeff": 0.16875000298023224, "vf_loss": 10.176888465881348, "entropy": 0.9036693572998047}, "num_steps_trained": 3452577, "grad_time_ms": 9178.831, "load_time_ms": 22.546, "sample_time_ms": 18418.193, "num_steps_sampled": 3452577, "update_time_ms": 9.651}, "hostname": "flow-main", "episode_reward_max": -22.04858092832765, "timesteps_this_iter": 35487, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.76059898417233, "cost1_mean": 194.61705999548306, "system_level_velocity_mean": 16.57502942724666, "cost2_mean": -26.17956628885555, "cost2_max": -10.777860551574491, "outflow_rate_max": 1309.0522220462458, "cost1_min": 17.718939591614824, "system_level_velocity_min": 12.606837629476292, "system_level_velocity_max": 18.587461795053862, "outflow_rate_min": 487.27071284982367, "outflow_rate_mean": 1199.5367714515905, "cost2_min": -34.34829390394432}, "episode_len_mean": 319.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 3452577, "time_total_s": 2757.3991918563843, "timestamp": 1558594845, "iterations_since_restore": 98, "policy_reward_mean": {}, "training_iteration": 98, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6eb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913e10>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6a90>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4555, "timesteps_total": 3452577, "episode_reward_mean": -323.74674161780274, "episodes_this_iter": 52, "date": "2019-05-23_07-00-45", "time_this_iter_s": 27.851997137069702, "num_metric_batches_dropped": 0, "episode_reward_min": -541.9739317854292}
{"time_since_restore": 2785.190100669861, "info": {"default": {"kl": 0.02112150937318802, "total_loss": 9.62239933013916, "vf_explained_var": 0.8965715765953064, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009495451115071774, "cur_kl_coeff": 0.16875001788139343, "vf_loss": 9.628331184387207, "entropy": 0.894634485244751}, "num_steps_trained": 3488031, "grad_time_ms": 9218.772, "load_time_ms": 22.222, "sample_time_ms": 18463.485, "num_steps_sampled": 3488031, "update_time_ms": 9.329}, "hostname": "flow-main", "episode_reward_max": -22.04858092832765, "timesteps_this_iter": 35454, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.76059898417233, "cost1_mean": 188.55026217684244, "system_level_velocity_mean": 16.215264451164277, "cost2_mean": -26.45712932121082, "cost2_max": -10.619249352334318, "outflow_rate_max": 1311.4603246753247, "cost1_min": 17.718939591614824, "system_level_velocity_min": 12.606837629476292, "system_level_velocity_max": 19.26652783760888, "outflow_rate_min": 487.27071284982367, "outflow_rate_mean": 1178.2476013123182, "cost2_min": -39.03672617881492}, "episode_len_mean": 315.95, "node_ip": "10.138.0.2", "timesteps_since_restore": 3488031, "time_total_s": 2785.190100669861, "timestamp": 1558594873, "iterations_since_restore": 99, "policy_reward_mean": {}, "training_iteration": 99, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b79b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a9e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7128>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4601, "timesteps_total": 3488031, "episode_reward_mean": -334.5270711667519, "episodes_this_iter": 46, "date": "2019-05-23_07-01-13", "time_this_iter_s": 27.790908813476562, "num_metric_batches_dropped": 0, "episode_reward_min": -541.9739317854292}
{"time_since_restore": 2813.174695253372, "info": {"default": {"kl": 0.01493342686444521, "total_loss": 9.302978515625, "vf_explained_var": 0.8947415351867676, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00950125977396965, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 9.308699607849121, "entropy": 0.8708880543708801}, "num_steps_trained": 3523039, "grad_time_ms": 9290.682, "load_time_ms": 22.245, "sample_time_ms": 18424.792, "num_steps_sampled": 3523039, "update_time_ms": 8.868}, "hostname": "flow-main", "episode_reward_max": -22.70425127845024, "timesteps_this_iter": 35008, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.43405064775277, "cost1_mean": 193.47950711820755, "system_level_velocity_mean": 16.48572070095058, "cost2_mean": -26.294423000366898, "cost2_max": -10.619249352334318, "outflow_rate_max": 1313.645525815648, "cost1_min": 18.36894925405786, "system_level_velocity_min": 11.683326466430469, "system_level_velocity_max": 19.26652783760888, "outflow_rate_min": 487.27071284982367, "outflow_rate_mean": 1199.0059643655761, "cost2_min": -40.807276454397154}, "episode_len_mean": 318.93, "node_ip": "10.138.0.2", "timesteps_since_restore": 3523039, "time_total_s": 2813.174695253372, "timestamp": 1558594901, "iterations_since_restore": 100, "policy_reward_mean": {}, "training_iteration": 100, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913e10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdb00>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1198>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4645, "timesteps_total": 3523039, "episode_reward_mean": -327.72216041009796, "episodes_this_iter": 44, "date": "2019-05-23_07-01-41", "time_this_iter_s": 27.984594583511353, "num_metric_batches_dropped": 0, "episode_reward_min": -524.5566590560209}
{"time_since_restore": 2841.0352523326874, "info": {"default": {"kl": 0.015895549207925797, "total_loss": 9.409087181091309, "vf_explained_var": 0.8893532156944275, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010170964524149895, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 9.415233612060547, "entropy": 0.8897144198417664}, "num_steps_trained": 3558054, "grad_time_ms": 9356.799, "load_time_ms": 19.373, "sample_time_ms": 18436.286, "num_steps_sampled": 3558054, "update_time_ms": 8.889}, "hostname": "flow-main", "episode_reward_max": -235.0691822160229, "timesteps_this_iter": 35015, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.43405064775277, "cost1_mean": 200.12288225126017, "system_level_velocity_mean": 16.712262820967524, "cost2_mean": -26.233463065322084, "cost2_max": -14.65521958800544, "outflow_rate_max": 1314.461631809749, "cost1_min": 146.65521181912604, "system_level_velocity_min": 11.683326466430469, "system_level_velocity_max": 18.59447080026369, "outflow_rate_min": 1031.4526780279973, "outflow_rate_mean": 1225.6246189231667, "cost2_min": -40.807276454397154}, "episode_len_mean": 324.8, "node_ip": "10.138.0.2", "timesteps_since_restore": 3558054, "time_total_s": 2841.0352523326874, "timestamp": 1558594929, "iterations_since_restore": 101, "policy_reward_mean": {}, "training_iteration": 101, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a0b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a3c8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492add8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4692, "timesteps_total": 3558054, "episode_reward_mean": -324.9647282572057, "episodes_this_iter": 47, "date": "2019-05-23_07-02-09", "time_this_iter_s": 27.860557079315186, "num_metric_batches_dropped": 0, "episode_reward_min": -535.464555587768}
{"time_since_restore": 2868.8777952194214, "info": {"default": {"kl": 0.012632301077246666, "total_loss": 10.810972213745117, "vf_explained_var": 0.8828743100166321, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008076547645032406, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 10.815851211547852, "entropy": 0.9016726016998291}, "num_steps_trained": 3593507, "grad_time_ms": 9368.621, "load_time_ms": 19.546, "sample_time_ms": 18323.308, "num_steps_sampled": 3593507, "update_time_ms": 8.679}, "hostname": "flow-main", "episode_reward_max": -23.54810327172274, "timesteps_this_iter": 35453, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.6103388681502, "cost1_mean": 194.47176453730324, "system_level_velocity_mean": 16.524554911584584, "cost2_mean": -26.410640515210407, "cost2_max": -9.176470123068125, "outflow_rate_max": 1315.455865238658, "cost1_min": 17.563705385798983, "system_level_velocity_min": 13.322694122308027, "system_level_velocity_max": 18.589197670142777, "outflow_rate_min": 468.3060651104501, "outflow_rate_mean": 1203.972955651562, "cost2_min": -37.17284848966358}, "episode_len_mean": 319.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 3593507, "time_total_s": 2868.8777952194214, "timestamp": 1558594957, "iterations_since_restore": 102, "policy_reward_mean": {}, "training_iteration": 102, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490eb00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd2e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6c18>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4741, "timesteps_total": 3593507, "episode_reward_mean": -325.6237796029275, "episodes_this_iter": 49, "date": "2019-05-23_07-02-37", "time_this_iter_s": 27.84254288673401, "num_metric_batches_dropped": 0, "episode_reward_min": -535.464555587768}
{"time_since_restore": 2897.2115728855133, "info": {"default": {"kl": 0.015980318188667297, "total_loss": 10.486562728881836, "vf_explained_var": 0.8848379850387573, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009549824520945549, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 10.492067337036133, "entropy": 0.9040471315383911}, "num_steps_trained": 3628502, "grad_time_ms": 9480.522, "load_time_ms": 18.901, "sample_time_ms": 18246.616, "num_steps_sampled": 3628502, "update_time_ms": 9.033}, "hostname": "flow-main", "episode_reward_max": -23.54810327172274, "timesteps_this_iter": 34995, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.32347724731193, "cost1_mean": 189.94135993285752, "system_level_velocity_mean": 16.353802592620944, "cost2_mean": -26.517900723143867, "cost2_max": -9.176470123068125, "outflow_rate_max": 1315.455865238658, "cost1_min": 17.563705385798983, "system_level_velocity_min": 13.944305956405275, "system_level_velocity_max": 18.536329105259906, "outflow_rate_min": 468.3060651104501, "outflow_rate_mean": 1186.9053126164704, "cost2_min": -35.327993735882586}, "episode_len_mean": 314.66, "node_ip": "10.138.0.2", "timesteps_since_restore": 3628502, "time_total_s": 2897.2115728855133, "timestamp": 1558594985, "iterations_since_restore": 103, "policy_reward_mean": {}, "training_iteration": 103, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492acc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492acf8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4788, "timesteps_total": 3628502, "episode_reward_mean": -324.1336027476667, "episodes_this_iter": 47, "date": "2019-05-23_07-03-05", "time_this_iter_s": 28.33377766609192, "num_metric_batches_dropped": 0, "episode_reward_min": -456.35544809995577}
{"time_since_restore": 2925.256469488144, "info": {"default": {"kl": 0.015842996537685394, "total_loss": 9.341402053833008, "vf_explained_var": 0.896842896938324, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0101093091070652, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 9.347501754760742, "entropy": 0.8966208100318909}, "num_steps_trained": 3663129, "grad_time_ms": 9502.602, "load_time_ms": 17.501, "sample_time_ms": 18169.942, "num_steps_sampled": 3663129, "update_time_ms": 9.195}, "hostname": "flow-main", "episode_reward_max": -29.615776918539655, "timesteps_this_iter": 34627, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.3463486604585, "cost1_mean": 193.07278529244846, "system_level_velocity_mean": 16.49002568813766, "cost2_mean": -26.350444671300092, "cost2_max": -9.176470123068125, "outflow_rate_max": 1315.455865238658, "cost1_min": 22.706649506142757, "system_level_velocity_min": 13.642590924303374, "system_level_velocity_max": 18.536329105259906, "outflow_rate_min": 499.0173885701168, "outflow_rate_mean": 1198.2281025165319, "cost2_min": -34.13690592328481}, "episode_len_mean": 317.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 3663129, "time_total_s": 2925.256469488144, "timestamp": 1558595013, "iterations_since_restore": 104, "policy_reward_mean": {}, "training_iteration": 104, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1860>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a1d0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4832, "timesteps_total": 3663129, "episode_reward_mean": -320.4871474534495, "episodes_this_iter": 44, "date": "2019-05-23_07-03-33", "time_this_iter_s": 28.044896602630615, "num_metric_batches_dropped": 0, "episode_reward_min": -456.35544809995577}
{"time_since_restore": 2953.0403957366943, "info": {"default": {"kl": 0.016582589596509933, "total_loss": 9.783368110656738, "vf_explained_var": 0.8968851566314697, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009211980737745762, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 9.788382530212402, "entropy": 0.8800505995750427}, "num_steps_trained": 3698147, "grad_time_ms": 9538.21, "load_time_ms": 15.941, "sample_time_ms": 18150.053, "num_steps_sampled": 3698147, "update_time_ms": 9.333}, "hostname": "flow-main", "episode_reward_max": -172.15628887417304, "timesteps_this_iter": 35018, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.3463486604585, "cost1_mean": 195.5630318675091, "system_level_velocity_mean": 16.528599807743248, "cost2_mean": -26.761659946211818, "cost2_max": -18.82075670348296, "outflow_rate_max": 1315.9281000168664, "cost1_min": 124.20302507673713, "system_level_velocity_min": 12.889859112134593, "system_level_velocity_max": 18.559355385159435, "outflow_rate_min": 932.7406192086086, "outflow_rate_mean": 1209.3891455988214, "cost2_min": -38.72506494659469}, "episode_len_mean": 320.71, "node_ip": "10.138.0.2", "timesteps_since_restore": 3698147, "time_total_s": 2953.0403957366943, "timestamp": 1558595041, "iterations_since_restore": 105, "policy_reward_mean": {}, "training_iteration": 105, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6320>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6d30>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4882, "timesteps_total": 3698147, "episode_reward_mean": -323.2023001749643, "episodes_this_iter": 50, "date": "2019-05-23_07-04-01", "time_this_iter_s": 27.783926248550415, "num_metric_batches_dropped": 0, "episode_reward_min": -524.5790171317984}
{"time_since_restore": 2979.937500476837, "info": {"default": {"kl": 0.015222442336380482, "total_loss": 10.699793815612793, "vf_explained_var": 0.8918865323066711, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008187742903828621, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 10.704129219055176, "entropy": 0.8782289028167725}, "num_steps_trained": 3733417, "grad_time_ms": 9585.513, "load_time_ms": 15.665, "sample_time_ms": 18070.045, "num_steps_sampled": 3733417, "update_time_ms": 9.388}, "hostname": "flow-main", "episode_reward_max": -172.15628887417304, "timesteps_this_iter": 35270, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.3463486604585, "cost1_mean": 197.09634670006307, "system_level_velocity_mean": 16.49589500460587, "cost2_mean": -27.351977077715755, "cost2_max": -19.966368362348135, "outflow_rate_max": 1326.4435300509122, "cost1_min": 144.46845353236864, "system_level_velocity_min": 12.160801436141043, "system_level_velocity_max": 18.56197865317599, "outflow_rate_min": 983.981128487971, "outflow_rate_mean": 1217.8501409433782, "cost2_min": -43.41179417527795}, "episode_len_mean": 323.93, "node_ip": "10.138.0.2", "timesteps_since_restore": 3733417, "time_total_s": 2979.937500476837, "timestamp": 1558595068, "iterations_since_restore": 106, "policy_reward_mean": {}, "training_iteration": 106, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd7f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd908>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd160>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4928, "timesteps_total": 3733417, "episode_reward_mean": -332.67927685683395, "episodes_this_iter": 46, "date": "2019-05-23_07-04-28", "time_this_iter_s": 26.897104740142822, "num_metric_batches_dropped": 0, "episode_reward_min": -576.6804998316402}
{"time_since_restore": 3008.2951905727386, "info": {"default": {"kl": 0.017704099416732788, "total_loss": 9.636571884155273, "vf_explained_var": 0.9097928404808044, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01286500133574009, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 9.644956588745117, "entropy": 0.9177263379096985}, "num_steps_trained": 3769208, "grad_time_ms": 9693.892, "load_time_ms": 16.162, "sample_time_ms": 18071.173, "num_steps_sampled": 3769208, "update_time_ms": 9.667}, "hostname": "flow-main", "episode_reward_max": -242.01347388971595, "timesteps_this_iter": 35791, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.03825014254784, "cost1_mean": 195.27534981180287, "system_level_velocity_mean": 16.27408020633204, "cost2_mean": -28.09375086855541, "cost2_max": -20.073547515213136, "outflow_rate_max": 1326.4435300509122, "cost1_min": 146.87110703972888, "system_level_velocity_min": 12.160801436141043, "system_level_velocity_max": 18.56197865317599, "outflow_rate_min": 960.8768595041322, "outflow_rate_mean": 1206.5058478235562, "cost2_min": -43.41179417527795}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3769208, "time_total_s": 3008.2951905727386, "timestamp": 1558595097, "iterations_since_restore": 107, "policy_reward_mean": {}, "training_iteration": 107, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af2e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af780>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492ada0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 4971, "timesteps_total": 3769208, "episode_reward_mean": -346.09777630644646, "episodes_this_iter": 43, "date": "2019-05-23_07-04-57", "time_this_iter_s": 28.35769009590149, "num_metric_batches_dropped": 0, "episode_reward_min": -576.6804998316402}
{"time_since_restore": 3038.1647045612335, "info": {"default": {"kl": 0.015537122264504433, "total_loss": 11.251931190490723, "vf_explained_var": 0.8899250030517578, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01085264328867197, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 11.25885009765625, "entropy": 0.9018730521202087}, "num_steps_trained": 3804260, "grad_time_ms": 9812.117, "load_time_ms": 15.892, "sample_time_ms": 18154.409, "num_steps_sampled": 3804260, "update_time_ms": 9.833}, "hostname": "flow-main", "episode_reward_max": -29.22133311419997, "timesteps_this_iter": 35052, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.3252704540112, "cost1_mean": 191.42728310372232, "system_level_velocity_mean": 16.151396999194574, "cost2_mean": -28.033861484119853, "cost2_max": -11.720137502364716, "outflow_rate_max": 1321.840510204082, "cost1_min": 22.533862474899724, "system_level_velocity_min": 12.402617618343786, "system_level_velocity_max": 18.510790112753128, "outflow_rate_min": 514.5009007334598, "outflow_rate_mean": 1189.2166388949443, "cost2_min": -41.45407755679736}, "episode_len_mean": 321.08, "node_ip": "10.138.0.2", "timesteps_since_restore": 3804260, "time_total_s": 3038.1647045612335, "timestamp": 1558595126, "iterations_since_restore": 108, "policy_reward_mean": {}, "training_iteration": 108, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6d68>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6ba8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5022, "timesteps_total": 3804260, "episode_reward_mean": -346.1473351569247, "episodes_this_iter": 51, "date": "2019-05-23_07-05-26", "time_this_iter_s": 29.869513988494873, "num_metric_batches_dropped": 0, "episode_reward_min": -560.0926713063443}
{"time_since_restore": 3065.1965095996857, "info": {"default": {"kl": 0.015998007729649544, "total_loss": 9.440771102905273, "vf_explained_var": 0.909196138381958, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009310238994657993, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 9.44603157043457, "entropy": 0.9034091830253601}, "num_steps_trained": 3839363, "grad_time_ms": 9825.501, "load_time_ms": 17.119, "sample_time_ms": 18063.554, "num_steps_sampled": 3839363, "update_time_ms": 10.056}, "hostname": "flow-main", "episode_reward_max": -29.22133311419997, "timesteps_this_iter": 35103, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.3252704540112, "cost1_mean": 192.69483255457718, "system_level_velocity_mean": 16.339068423942393, "cost2_mean": -27.477684429677392, "cost2_max": -11.720137502364716, "outflow_rate_max": 1324.9768606739174, "cost1_min": 22.533862474899724, "system_level_velocity_min": 12.402617618343786, "system_level_velocity_max": 18.510790112753128, "outflow_rate_min": 514.5009007334598, "outflow_rate_mean": 1196.9441997282481, "cost2_min": -35.02823327655547}, "episode_len_mean": 319.9, "node_ip": "10.138.0.2", "timesteps_since_restore": 3839363, "time_total_s": 3065.1965095996857, "timestamp": 1558595154, "iterations_since_restore": 109, "policy_reward_mean": {}, "training_iteration": 109, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1b38>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1cf8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bda58>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5067, "timesteps_total": 3839363, "episode_reward_mean": -333.29183245721, "episodes_this_iter": 45, "date": "2019-05-23_07-05-54", "time_this_iter_s": 27.03180503845215, "num_metric_batches_dropped": 0, "episode_reward_min": -556.2941682605112}
{"time_since_restore": 3092.864830970764, "info": {"default": {"kl": 0.01607413776218891, "total_loss": 11.254044532775879, "vf_explained_var": 0.8912919163703918, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010927218943834305, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 11.260902404785156, "entropy": 0.9192330837249756}, "num_steps_trained": 3874690, "grad_time_ms": 9831.119, "load_time_ms": 16.958, "sample_time_ms": 18027.653, "num_steps_sampled": 3874690, "update_time_ms": 10.165}, "hostname": "flow-main", "episode_reward_max": -157.6779203825764, "timesteps_this_iter": 35327, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.1639533683793, "cost1_mean": 193.82108815683495, "system_level_velocity_mean": 16.293971682728614, "cost2_mean": -27.776357157917747, "cost2_max": -19.465268761763824, "outflow_rate_max": 1330.8613987623874, "cost1_min": 139.00816739872857, "system_level_velocity_min": 11.917046447373668, "system_level_velocity_max": 18.451546105195728, "outflow_rate_min": 973.1640489296637, "outflow_rate_mean": 1202.1472393992524, "cost2_min": -40.40221108997421}, "episode_len_mean": 322.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 3874690, "time_total_s": 3092.864830970764, "timestamp": 1558595181, "iterations_since_restore": 110, "policy_reward_mean": {}, "training_iteration": 110, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6ef0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c66a0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5113, "timesteps_total": 3874690, "episode_reward_mean": -341.7373491024671, "episodes_this_iter": 46, "date": "2019-05-23_07-06-21", "time_this_iter_s": 27.66832137107849, "num_metric_batches_dropped": 0, "episode_reward_min": -535.284444765772}
{"time_since_restore": 3120.572851419449, "info": {"default": {"kl": 0.016944294795393944, "total_loss": 9.164566040039062, "vf_explained_var": 0.9053924083709717, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011691473424434662, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 9.171969413757324, "entropy": 0.87168949842453}, "num_steps_trained": 3910313, "grad_time_ms": 9841.176, "load_time_ms": 17.309, "sample_time_ms": 18002.484, "num_steps_sampled": 3910313, "update_time_ms": 10.229}, "hostname": "flow-main", "episode_reward_max": -159.43791883381442, "timesteps_this_iter": 35623, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.80658697577232, "cost1_mean": 195.917123827843, "system_level_velocity_mean": 16.405826924328245, "cost2_mean": -27.619716095996882, "cost2_max": -20.469042884795307, "outflow_rate_max": 1330.8613987623874, "cost1_min": 139.34836464179494, "system_level_velocity_min": 11.917046447373668, "system_level_velocity_max": 18.451546105195728, "outflow_rate_min": 973.1640489296637, "outflow_rate_mean": 1212.4419839361713, "cost2_min": -40.40221108997421}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 3910313, "time_total_s": 3120.572851419449, "timestamp": 1558595209, "iterations_since_restore": 111, "policy_reward_mean": {}, "training_iteration": 111, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6080>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c62e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5158, "timesteps_total": 3910313, "episode_reward_mean": -340.8260007654377, "episodes_this_iter": 45, "date": "2019-05-23_07-06-49", "time_this_iter_s": 27.708020448684692, "num_metric_batches_dropped": 0, "episode_reward_min": -530.8364697937094}
{"time_since_restore": 3149.1331264972687, "info": {"default": {"kl": 0.017643757164478302, "total_loss": 10.035529136657715, "vf_explained_var": 0.916397750377655, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0109895970672369, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 10.042052268981934, "entropy": 0.9199128150939941}, "num_steps_trained": 3946232, "grad_time_ms": 9894.516, "load_time_ms": 16.456, "sample_time_ms": 18020.015, "num_steps_sampled": 3946232, "update_time_ms": 10.541}, "hostname": "flow-main", "episode_reward_max": -159.43791883381442, "timesteps_this_iter": 35919, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.80658697577232, "cost1_mean": 195.08101788248007, "system_level_velocity_mean": 16.404146417080447, "cost2_mean": -27.546754209487254, "cost2_max": -15.940587883324389, "outflow_rate_max": 1327.2282064944125, "cost1_min": 136.61200784182836, "system_level_velocity_min": 11.67660550062855, "system_level_velocity_max": 18.514876684279482, "outflow_rate_min": 954.2458827648994, "outflow_rate_mean": 1211.2689585268051, "cost2_min": -39.9701199194465}, "episode_len_mean": 322.37, "node_ip": "10.138.0.2", "timesteps_since_restore": 3946232, "time_total_s": 3149.1331264972687, "timestamp": 1558595238, "iterations_since_restore": 112, "policy_reward_mean": {}, "training_iteration": 112, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6d68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6128>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6a90>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5207, "timesteps_total": 3946232, "episode_reward_mean": -341.8515860669853, "episodes_this_iter": 49, "date": "2019-05-23_07-07-18", "time_this_iter_s": 28.560275077819824, "num_metric_batches_dropped": 0, "episode_reward_min": -592.021972628922}
{"time_since_restore": 3178.680336713791, "info": {"default": {"kl": 0.018024802207946777, "total_loss": 10.111458778381348, "vf_explained_var": 0.9107996225357056, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012304789386689663, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 10.11920166015625, "entropy": 0.9150245785713196}, "num_steps_trained": 3982430, "grad_time_ms": 9870.82, "load_time_ms": 16.755, "sample_time_ms": 18164.178, "num_steps_sampled": 3982430, "update_time_ms": 10.271}, "hostname": "flow-main", "episode_reward_max": -171.661933004606, "timesteps_this_iter": 36198, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.35750822507185, "cost1_mean": 191.34919015093624, "system_level_velocity_mean": 16.047756211724433, "cost2_mean": -28.419666155887402, "cost2_max": -15.940587883324389, "outflow_rate_max": 1331.1751664648202, "cost1_min": 125.10740503383118, "system_level_velocity_min": 11.67660550062855, "system_level_velocity_max": 18.58912862618571, "outflow_rate_min": 944.9572130694895, "outflow_rate_mean": 1196.1167431696472, "cost2_min": -43.3949474272012}, "episode_len_mean": 322.48, "node_ip": "10.138.0.2", "timesteps_since_restore": 3982430, "time_total_s": 3178.680336713791, "timestamp": 1558595267, "iterations_since_restore": 113, "policy_reward_mean": {}, "training_iteration": 113, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c64e0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c67b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6c88>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5253, "timesteps_total": 3982430, "episode_reward_mean": -355.77321844770427, "episodes_this_iter": 46, "date": "2019-05-23_07-07-47", "time_this_iter_s": 29.547210216522217, "num_metric_batches_dropped": 0, "episode_reward_min": -592.021972628922}
{"time_since_restore": 3206.6089346408844, "info": {"default": {"kl": 0.018115246668457985, "total_loss": 11.132095336914062, "vf_explained_var": 0.889718770980835, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012316077016294003, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 11.139824867248535, "entropy": 0.8792515397071838}, "num_steps_trained": 4018208, "grad_time_ms": 9843.295, "load_time_ms": 16.869, "sample_time_ms": 18179.23, "num_steps_sampled": 4018208, "update_time_ms": 10.03}, "hostname": "flow-main", "episode_reward_max": -165.08394917344762, "timesteps_this_iter": 35778, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.35750822507185, "cost1_mean": 191.02126641106076, "system_level_velocity_mean": 16.062718958838648, "cost2_mean": -28.569824776335466, "cost2_max": -19.96855407575662, "outflow_rate_max": 1331.1751664648202, "cost1_min": 125.10740503383118, "system_level_velocity_min": 12.044424405965273, "system_level_velocity_max": 18.58912862618571, "outflow_rate_min": 944.9572130694895, "outflow_rate_mean": 1198.3899644837416, "cost2_min": -43.3949474272012}, "episode_len_mean": 321.76, "node_ip": "10.138.0.2", "timesteps_since_restore": 4018208, "time_total_s": 3206.6089346408844, "timestamp": 1558595295, "iterations_since_restore": 114, "policy_reward_mean": {}, "training_iteration": 114, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6978>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6be0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5299, "timesteps_total": 4018208, "episode_reward_mean": -353.88676228545415, "episodes_this_iter": 46, "date": "2019-05-23_07-08-15", "time_this_iter_s": 27.928597927093506, "num_metric_batches_dropped": 0, "episode_reward_min": -589.6839246772543}
{"time_since_restore": 3235.3087179660797, "info": {"default": {"kl": 0.017394397407770157, "total_loss": 10.679101943969727, "vf_explained_var": 0.8962438106536865, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011711201630532742, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 10.686408996582031, "entropy": 0.9166101813316345}, "num_steps_trained": 4054169, "grad_time_ms": 9803.007, "load_time_ms": 17.346, "sample_time_ms": 18310.607, "num_steps_sampled": 4054169, "update_time_ms": 10.081}, "hostname": "flow-main", "episode_reward_max": -165.08394917344762, "timesteps_this_iter": 35961, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.39863689772318, "cost1_mean": 191.85682695697867, "system_level_velocity_mean": 16.18816258788813, "cost2_mean": -28.165569086524975, "cost2_max": -19.96855407575662, "outflow_rate_max": 1326.0034680814672, "cost1_min": 125.10740503383118, "system_level_velocity_min": 12.372117309414927, "system_level_velocity_max": 18.47646183865264, "outflow_rate_min": 911.0849074612968, "outflow_rate_mean": 1201.0285848221256, "cost2_min": -39.98685554999138}, "episode_len_mean": 320.69, "node_ip": "10.138.0.2", "timesteps_since_restore": 4054169, "time_total_s": 3235.3087179660797, "timestamp": 1558595324, "iterations_since_restore": 115, "policy_reward_mean": {}, "training_iteration": 115, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c62e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c64a8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6668>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5345, "timesteps_total": 4054169, "episode_reward_mean": -346.61640873736775, "episodes_this_iter": 46, "date": "2019-05-23_07-08-44", "time_this_iter_s": 28.699783325195312, "num_metric_batches_dropped": 0, "episode_reward_min": -529.8370411477492}
{"time_since_restore": 3263.5839359760284, "info": {"default": {"kl": 0.015576984733343124, "total_loss": 8.897183418273926, "vf_explained_var": 0.9013838768005371, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009494051337242126, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 8.902734756469727, "entropy": 0.86510169506073}, "num_steps_trained": 4089593, "grad_time_ms": 9793.29, "load_time_ms": 16.829, "sample_time_ms": 18459.762, "num_steps_sampled": 4089593, "update_time_ms": 9.706}, "hostname": "flow-main", "episode_reward_max": -23.856726039864615, "timesteps_this_iter": 35424, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.40623562240938, "cost1_mean": 194.01404008801796, "system_level_velocity_mean": 16.41760191503768, "cost2_mean": -27.619741292937473, "cost2_max": -13.470173572906141, "outflow_rate_max": 1326.1935459183678, "cost1_min": 17.56232832751106, "system_level_velocity_min": 12.372117309414927, "system_level_velocity_max": 18.505822052756194, "outflow_rate_min": 437.2949997643919, "outflow_rate_mean": 1208.6339691529452, "cost2_min": -40.37838072660156}, "episode_len_mean": 319.88, "node_ip": "10.138.0.2", "timesteps_since_restore": 4089593, "time_total_s": 3263.5839359760284, "timestamp": 1558595352, "iterations_since_restore": 116, "policy_reward_mean": {}, "training_iteration": 116, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd2e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bde10>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdd68>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5392, "timesteps_total": 4089593, "episode_reward_mean": -338.0449264267329, "episodes_this_iter": 47, "date": "2019-05-23_07-09-12", "time_this_iter_s": 28.27521800994873, "num_metric_batches_dropped": 0, "episode_reward_min": -529.8370411477492}
{"time_since_restore": 3291.8937878608704, "info": {"default": {"kl": 0.016932234168052673, "total_loss": 9.623455047607422, "vf_explained_var": 0.8988162279129028, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01167447678744793, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 9.630842208862305, "entropy": 0.9226988554000854}, "num_steps_trained": 4125365, "grad_time_ms": 9706.871, "load_time_ms": 16.018, "sample_time_ms": 18545.24, "num_steps_sampled": 4125365, "update_time_ms": 9.633}, "hostname": "flow-main", "episode_reward_max": -23.856726039864615, "timesteps_this_iter": 35772, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.3195892465222, "cost1_mean": 195.0545187431374, "system_level_velocity_mean": 16.51726632391001, "cost2_mean": -27.42254147406586, "cost2_max": -13.470173572906141, "outflow_rate_max": 1326.1935459183678, "cost1_min": 17.56232832751106, "system_level_velocity_min": 13.808889622583, "system_level_velocity_max": 18.505822052756194, "outflow_rate_min": 437.2949997643919, "outflow_rate_mean": 1208.1035505780806, "cost2_min": -40.37838072660156}, "episode_len_mean": 319.88, "node_ip": "10.138.0.2", "timesteps_since_restore": 4125365, "time_total_s": 3291.8937878608704, "timestamp": 1558595381, "iterations_since_restore": 117, "policy_reward_mean": {}, "training_iteration": 117, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6438>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6c88>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6630>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5440, "timesteps_total": 4125365, "episode_reward_mean": -332.8438794441134, "episodes_this_iter": 48, "date": "2019-05-23_07-09-41", "time_this_iter_s": 28.30985188484192, "num_metric_batches_dropped": 0, "episode_reward_min": -490.7212172849615}
{"time_since_restore": 3319.050232887268, "info": {"default": {"kl": 0.017379550263285637, "total_loss": 9.32338809967041, "vf_explained_var": 0.9048863053321838, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013563047163188457, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 9.332551956176758, "entropy": 0.9232867360115051}, "num_steps_trained": 4160167, "grad_time_ms": 9537.093, "load_time_ms": 16.09, "sample_time_ms": 18442.895, "num_steps_sampled": 4160167, "update_time_ms": 9.535}, "hostname": "flow-main", "episode_reward_max": -152.9913844785802, "timesteps_this_iter": 34802, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.3195892465222, "cost1_mean": 195.03934841417006, "system_level_velocity_mean": 16.329782757964935, "cost2_mean": -27.69898464111982, "cost2_max": -19.82541527679489, "outflow_rate_max": 1321.3091100702577, "cost1_min": 137.51906198813228, "system_level_velocity_min": 11.69848980338873, "system_level_velocity_max": 18.61003848741526, "outflow_rate_min": 909.4264200842039, "outflow_rate_mean": 1204.410833291647, "cost2_min": -36.80177624356424}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 4160167, "time_total_s": 3319.050232887268, "timestamp": 1558595408, "iterations_since_restore": 118, "policy_reward_mean": {}, "training_iteration": 118, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c16d8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1978>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5486, "timesteps_total": 4160167, "episode_reward_mean": -338.06028546048447, "episodes_this_iter": 46, "date": "2019-05-23_07-10-08", "time_this_iter_s": 27.156445026397705, "num_metric_batches_dropped": 0, "episode_reward_min": -502.0548980176285}
{"time_since_restore": 3348.0544171333313, "info": {"default": {"kl": 0.015946460887789726, "total_loss": 8.30909538269043, "vf_explained_var": 0.908469021320343, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010234174318611622, "cur_kl_coeff": 0.25312501192092896, "vf_loss": 8.315293312072754, "entropy": 0.9212880730628967}, "num_steps_trained": 4194152, "grad_time_ms": 9495.481, "load_time_ms": 14.805, "sample_time_ms": 18683.24, "num_steps_sampled": 4194152, "update_time_ms": 9.38}, "hostname": "flow-main", "episode_reward_max": -30.481128905825386, "timesteps_this_iter": 33985, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.12248050720143, "cost1_mean": 192.71745658028837, "system_level_velocity_mean": 16.40442417601865, "cost2_mean": -27.037835297626472, "cost2_max": -12.85336186392734, "outflow_rate_max": 1321.1083065270382, "cost1_min": 22.86003995948107, "system_level_velocity_min": 11.69848980338873, "system_level_velocity_max": 18.61003848741526, "outflow_rate_min": 474.89702013611384, "outflow_rate_mean": 1192.405273021808, "cost2_min": -36.80177624356424}, "episode_len_mean": 319.57, "node_ip": "10.138.0.2", "timesteps_since_restore": 4194152, "time_total_s": 3348.0544171333313, "timestamp": 1558595437, "iterations_since_restore": 119, "policy_reward_mean": {}, "training_iteration": 119, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1f98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1b70>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5533, "timesteps_total": 4194152, "episode_reward_mean": -326.7554865096677, "episodes_this_iter": 47, "date": "2019-05-23_07-10-37", "time_this_iter_s": 29.004184246063232, "num_metric_batches_dropped": 0, "episode_reward_min": -502.0548980176285}
{"time_since_restore": 3375.682557821274, "info": {"default": {"kl": 0.018294109031558037, "total_loss": 9.721955299377441, "vf_explained_var": 0.9031774401664734, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012526223435997963, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 9.729850769042969, "entropy": 0.943524181842804}, "num_steps_trained": 4228335, "grad_time_ms": 9390.033, "load_time_ms": 16.11, "sample_time_ms": 18782.621, "num_steps_sampled": 4228335, "update_time_ms": 9.393}, "hostname": "flow-main", "episode_reward_max": -30.481128905825386, "timesteps_this_iter": 34183, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.12248050720143, "cost1_mean": 195.93370881233582, "system_level_velocity_mean": 16.67680051510114, "cost2_mean": -26.000700169459964, "cost2_max": -12.85336186392734, "outflow_rate_max": 1319.4397920965466, "cost1_min": 22.86003995948107, "system_level_velocity_min": 11.696352546640245, "system_level_velocity_max": 18.68168416568171, "outflow_rate_min": 474.89702013611384, "outflow_rate_mean": 1200.41595897944, "cost2_min": -36.000791228879315}, "episode_len_mean": 320.27, "node_ip": "10.138.0.2", "timesteps_since_restore": 4228335, "time_total_s": 3375.682557821274, "timestamp": 1558595464, "iterations_since_restore": 120, "policy_reward_mean": {}, "training_iteration": 120, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6ac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c68d0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5580, "timesteps_total": 4228335, "episode_reward_mean": -316.0081795461406, "episodes_this_iter": 47, "date": "2019-05-23_07-11-04", "time_this_iter_s": 27.628140687942505, "num_metric_batches_dropped": 0, "episode_reward_min": -545.5865588517682}
{"time_since_restore": 3403.691160917282, "info": {"default": {"kl": 0.015636108815670013, "total_loss": 10.40477466583252, "vf_explained_var": 0.8903368711471558, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007836843840777874, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 10.408652305603027, "entropy": 0.9157212376594543}, "num_steps_trained": 4262971, "grad_time_ms": 9362.158, "load_time_ms": 18.973, "sample_time_ms": 18837.412, "num_steps_sampled": 4262971, "update_time_ms": 9.307}, "hostname": "flow-main", "episode_reward_max": -30.481128905825386, "timesteps_this_iter": 34636, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.50419314093264, "cost1_mean": 196.0494293311105, "system_level_velocity_mean": 16.669501971703472, "cost2_mean": -26.266187090805076, "cost2_max": -12.85336186392734, "outflow_rate_max": 1313.1567152976897, "cost1_min": 22.86003995948107, "system_level_velocity_min": 11.696352546640245, "system_level_velocity_max": 18.68168416568171, "outflow_rate_min": 474.89702013611384, "outflow_rate_mean": 1203.5907917596885, "cost2_min": -36.58198708728697}, "episode_len_mean": 320.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 4262971, "time_total_s": 3403.691160917282, "timestamp": 1558595492, "iterations_since_restore": 121, "policy_reward_mean": {}, "training_iteration": 121, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a470>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6320>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492afd0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5626, "timesteps_total": 4262971, "episode_reward_mean": -320.3187321773481, "episodes_this_iter": 46, "date": "2019-05-23_07-11-32", "time_this_iter_s": 28.0086030960083, "num_metric_batches_dropped": 0, "episode_reward_min": -545.5865588517682}
{"time_since_restore": 3431.9803829193115, "info": {"default": {"kl": 0.016079122200608253, "total_loss": 12.764366149902344, "vf_explained_var": 0.8974336981773376, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012397320941090584, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 12.772695541381836, "entropy": 0.9743016958236694}, "num_steps_trained": 4297615, "grad_time_ms": 9328.507, "load_time_ms": 18.546, "sample_time_ms": 18847.4, "num_steps_sampled": 4297615, "update_time_ms": 9.286}, "hostname": "flow-main", "episode_reward_max": -166.0623004588741, "timesteps_this_iter": 34644, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 218.44987118392507, "cost1_mean": 195.53227660278898, "system_level_velocity_mean": 16.42157061129927, "cost2_mean": -26.920851073181876, "cost2_max": -17.136622854371673, "outflow_rate_max": 1316.015470582788, "cost1_min": 135.88430966685797, "system_level_velocity_min": 11.497615559597163, "system_level_velocity_max": 18.601335850798584, "outflow_rate_min": 856.1377358490565, "outflow_rate_mean": 1200.5912519412277, "cost2_min": -38.70610664392326}, "episode_len_mean": 323.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4297615, "time_total_s": 3431.9803829193115, "timestamp": 1558595521, "iterations_since_restore": 122, "policy_reward_mean": {}, "training_iteration": 122, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af2e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af0b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af630>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5674, "timesteps_total": 4297615, "episode_reward_mean": -335.5575462669679, "episodes_this_iter": 48, "date": "2019-05-23_07-12-01", "time_this_iter_s": 28.28922200202942, "num_metric_batches_dropped": 0, "episode_reward_min": -609.498075240992}
{"time_since_restore": 3459.833334684372, "info": {"default": {"kl": 0.017541734501719475, "total_loss": 11.773188591003418, "vf_explained_var": 0.8966358304023743, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012579046189785004, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 11.781327247619629, "entropy": 0.9449465274810791}, "num_steps_trained": 4332659, "grad_time_ms": 9317.733, "load_time_ms": 18.333, "sample_time_ms": 18687.573, "num_steps_sampled": 4332659, "update_time_ms": 9.336}, "hostname": "flow-main", "episode_reward_max": -22.55272049733516, "timesteps_this_iter": 35044, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.14468328269857, "cost1_mean": 194.1374203989516, "system_level_velocity_mean": 16.466699275342236, "cost2_mean": -26.822562921684515, "cost2_max": -10.42564676474779, "outflow_rate_max": 1322.0561222327458, "cost1_min": 17.75149726301647, "system_level_velocity_min": 11.447955864253265, "system_level_velocity_max": 18.601335850798584, "outflow_rate_min": 487.8590816741719, "outflow_rate_mean": 1194.8147585323618, "cost2_min": -38.70610664392326}, "episode_len_mean": 320.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 4332659, "time_total_s": 3459.833334684372, "timestamp": 1558595549, "iterations_since_restore": 123, "policy_reward_mean": {}, "training_iteration": 123, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd6a0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2710>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5719, "timesteps_total": 4332659, "episode_reward_mean": -333.78849432328525, "episodes_this_iter": 45, "date": "2019-05-23_07-12-29", "time_this_iter_s": 27.852951765060425, "num_metric_batches_dropped": 0, "episode_reward_min": -609.498075240992}
{"time_since_restore": 3489.0899283885956, "info": {"default": {"kl": 0.015979645773768425, "total_loss": 10.304409980773926, "vf_explained_var": 0.889138400554657, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010938618332147598, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 10.311304092407227, "entropy": 0.8802213668823242}, "num_steps_trained": 4367921, "grad_time_ms": 9391.614, "load_time_ms": 18.454, "sample_time_ms": 18744.948, "num_steps_sampled": 4367921, "update_time_ms": 9.694}, "hostname": "flow-main", "episode_reward_max": -22.55272049733516, "timesteps_this_iter": 35262, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.3463922422796, "cost1_mean": 194.40018404233123, "system_level_velocity_mean": 16.449329755361788, "cost2_mean": -27.717367815570196, "cost2_max": -10.42564676474779, "outflow_rate_max": 1322.0561222327458, "cost1_min": 17.75149726301647, "system_level_velocity_min": 11.447955864253265, "system_level_velocity_max": 18.592427959836435, "outflow_rate_min": 487.8590816741719, "outflow_rate_mean": 1204.1653242810505, "cost2_min": -39.35100717451096}, "episode_len_mean": 320.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 4367921, "time_total_s": 3489.0899283885956, "timestamp": 1558595578, "iterations_since_restore": 124, "policy_reward_mean": {}, "training_iteration": 124, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2c88>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2208>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2c50>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5767, "timesteps_total": 4367921, "episode_reward_mean": -335.74904531798234, "episodes_this_iter": 48, "date": "2019-05-23_07-12-58", "time_this_iter_s": 29.256593704223633, "num_metric_batches_dropped": 0, "episode_reward_min": -609.498075240992}
{"time_since_restore": 3518.021149635315, "info": {"default": {"kl": 0.016174977645277977, "total_loss": 13.215596199035645, "vf_explained_var": 0.8751351833343506, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012620666064321995, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 13.224122047424316, "entropy": 0.924278199672699}, "num_steps_trained": 4403501, "grad_time_ms": 9500.337, "load_time_ms": 19.683, "sample_time_ms": 18657.767, "num_steps_sampled": 4403501, "update_time_ms": 9.727}, "hostname": "flow-main", "episode_reward_max": -237.6929578440328, "timesteps_this_iter": 35580, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.3463922422796, "cost1_mean": 198.76294648935814, "system_level_velocity_mean": 16.598343337871192, "cost2_mean": -28.053130285433785, "cost2_max": -20.029415277217925, "outflow_rate_max": 1321.9596526644088, "cost1_min": 133.2032986287929, "system_level_velocity_min": 11.447955864253265, "system_level_velocity_max": 18.61128515688328, "outflow_rate_min": 847.2249871653277, "outflow_rate_mean": 1224.1341382521837, "cost2_min": -39.40533669199668}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4403501, "time_total_s": 3518.021149635315, "timestamp": 1558595607, "iterations_since_restore": 125, "policy_reward_mean": {}, "training_iteration": 125, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6a90>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c65c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846af2e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5814, "timesteps_total": 4403501, "episode_reward_mean": -334.9077678425003, "episodes_this_iter": 47, "date": "2019-05-23_07-13-27", "time_this_iter_s": 28.93122124671936, "num_metric_batches_dropped": 0, "episode_reward_min": -579.4458922420757}
{"time_since_restore": 3548.0709738731384, "info": {"default": {"kl": 0.019753292202949524, "total_loss": 11.465571403503418, "vf_explained_var": 0.8942877054214478, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01430162601172924, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 11.474873542785645, "entropy": 0.9227267503738403}, "num_steps_trained": 4439238, "grad_time_ms": 9574.657, "load_time_ms": 19.634, "sample_time_ms": 18758.183, "num_steps_sampled": 4439238, "update_time_ms": 9.93}, "hostname": "flow-main", "episode_reward_max": -238.44036772875185, "timesteps_this_iter": 35737, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.19511373567832, "cost1_mean": 197.41569909236387, "system_level_velocity_mean": 16.47948564753429, "cost2_mean": -28.976527564749272, "cost2_max": -20.39461542496111, "outflow_rate_max": 1321.9596526644088, "cost1_min": 133.0719108288103, "system_level_velocity_min": 10.766759271885698, "system_level_velocity_max": 18.61128515688328, "outflow_rate_min": 847.2249871653277, "outflow_rate_mean": 1217.90793851559, "cost2_min": -71.71593994156152}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4439238, "time_total_s": 3548.0709738731384, "timestamp": 1558595637, "iterations_since_restore": 126, "policy_reward_mean": {}, "training_iteration": 126, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c16d8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b77b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5856, "timesteps_total": 4439238, "episode_reward_mean": -341.57954623240687, "episodes_this_iter": 42, "date": "2019-05-23_07-13-57", "time_this_iter_s": 30.049824237823486, "num_metric_batches_dropped": 0, "episode_reward_min": -708.9201705203993}
{"time_since_restore": 3576.3056452274323, "info": {"default": {"kl": 0.01479769591242075, "total_loss": 9.592290878295898, "vf_explained_var": 0.9059324264526367, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009678865782916546, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 9.598223686218262, "entropy": 0.9075284004211426}, "num_steps_trained": 4474283, "grad_time_ms": 9627.387, "load_time_ms": 20.322, "sample_time_ms": 18696.265, "num_steps_sampled": 4474283, "update_time_ms": 9.8}, "hostname": "flow-main", "episode_reward_max": -222.1891805325868, "timesteps_this_iter": 35045, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.19511373567832, "cost1_mean": 196.10700845196325, "system_level_velocity_mean": 16.368394485730544, "cost2_mean": -29.221652857962553, "cost2_max": -17.479440739223318, "outflow_rate_max": 1320.6212755102044, "cost1_min": 133.0719108288103, "system_level_velocity_min": 10.766759271885698, "system_level_velocity_max": 18.5737372314657, "outflow_rate_min": 912.4200846159677, "outflow_rate_mean": 1210.9562928138525, "cost2_min": -71.71593994156152}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 4474283, "time_total_s": 3576.3056452274323, "timestamp": 1558595665, "iterations_since_restore": 127, "policy_reward_mean": {}, "training_iteration": 127, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bda58>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd6a0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846afc88>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5905, "timesteps_total": 4474283, "episode_reward_mean": -341.9387916301873, "episodes_this_iter": 49, "date": "2019-05-23_07-14-25", "time_this_iter_s": 28.234671354293823, "num_metric_batches_dropped": 0, "episode_reward_min": -708.9201705203993}
{"time_since_restore": 3603.7511761188507, "info": {"default": {"kl": 0.017147043719887733, "total_loss": 10.670536041259766, "vf_explained_var": 0.8924898505210876, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012147195637226105, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 10.678342819213867, "entropy": 0.9148373603820801}, "num_steps_trained": 4509218, "grad_time_ms": 9718.369, "load_time_ms": 21.053, "sample_time_ms": 18634.273, "num_steps_sampled": 4509218, "update_time_ms": 9.974}, "hostname": "flow-main", "episode_reward_max": -222.1891805325868, "timesteps_this_iter": 34935, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.19511373567832, "cost1_mean": 198.6301332394327, "system_level_velocity_mean": 16.668543565500723, "cost2_mean": -27.552484536161614, "cost2_max": -17.479440739223318, "outflow_rate_max": 1320.6212755102044, "cost1_min": 129.9271118052376, "system_level_velocity_min": 11.596673709977953, "system_level_velocity_max": 18.727169680137433, "outflow_rate_min": 896.9441083384055, "outflow_rate_mean": 1215.3990633966364, "cost2_min": -43.88450715816081}, "episode_len_mean": 323.67, "node_ip": "10.138.0.2", "timesteps_since_restore": 4509218, "time_total_s": 3603.7511761188507, "timestamp": 1558595693, "iterations_since_restore": 128, "policy_reward_mean": {}, "training_iteration": 128, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd358>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdd68>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5950, "timesteps_total": 4509218, "episode_reward_mean": -326.75634923780103, "episodes_this_iter": 45, "date": "2019-05-23_07-14-53", "time_this_iter_s": 27.445530891418457, "num_metric_batches_dropped": 0, "episode_reward_min": -512.5353879811793}
{"time_since_restore": 3631.696275472641, "info": {"default": {"kl": 0.01683257706463337, "total_loss": 11.844547271728516, "vf_explained_var": 0.8807913661003113, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01151309534907341, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 11.851799011230469, "entropy": 0.9016479849815369}, "num_steps_trained": 4544533, "grad_time_ms": 9828.477, "load_time_ms": 22.78, "sample_time_ms": 18416.027, "num_steps_sampled": 4544533, "update_time_ms": 10.474}, "hostname": "flow-main", "episode_reward_max": -235.01939625770288, "timesteps_this_iter": 35315, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.68405706880236, "cost1_mean": 197.90868008932514, "system_level_velocity_mean": 16.590096815602838, "cost2_mean": -27.49373332973088, "cost2_max": -18.16575037569486, "outflow_rate_max": 1316.7596815281495, "cost1_min": 129.9271118052376, "system_level_velocity_min": 12.868115605939607, "system_level_velocity_max": 18.727169680137433, "outflow_rate_min": 896.9441083384055, "outflow_rate_mean": 1210.6466629660038, "cost2_min": -38.52625295503354}, "episode_len_mean": 323.95, "node_ip": "10.138.0.2", "timesteps_since_restore": 4544533, "time_total_s": 3631.696275472641, "timestamp": 1558595721, "iterations_since_restore": 129, "policy_reward_mean": {}, "training_iteration": 129, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bda58>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd978>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd198>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 5997, "timesteps_total": 4544533, "episode_reward_mean": -331.76386485711225, "episodes_this_iter": 47, "date": "2019-05-23_07-15-21", "time_this_iter_s": 27.945099353790283, "num_metric_batches_dropped": 0, "episode_reward_min": -568.9050833118447}
{"time_since_restore": 3659.3736946582794, "info": {"default": {"kl": 0.01610523648560047, "total_loss": 11.396805763244629, "vf_explained_var": 0.8913129568099976, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01059998944401741, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 11.403328895568848, "entropy": 0.9337806105613708}, "num_steps_trained": 4579676, "grad_time_ms": 9942.701, "load_time_ms": 22.541, "sample_time_ms": 18307.575, "num_steps_sampled": 4579676, "update_time_ms": 10.529}, "hostname": "flow-main", "episode_reward_max": -30.32026332044561, "timesteps_this_iter": 35143, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.68405706880236, "cost1_mean": 196.176936146419, "system_level_velocity_mean": 16.547529357824537, "cost2_mean": -27.347427285036794, "cost2_max": -13.03220963006895, "outflow_rate_max": 1316.7596815281495, "cost1_min": 22.620627079141407, "system_level_velocity_min": 12.121945913203328, "system_level_velocity_max": 18.727169680137433, "outflow_rate_min": 481.99009215424053, "outflow_rate_mean": 1204.7216788304754, "cost2_min": -38.52625295503354}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 4579676, "time_total_s": 3659.3736946582794, "timestamp": 1558595748, "iterations_since_restore": 130, "policy_reward_mean": {}, "training_iteration": 130, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6e10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6940>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6b38>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6044, "timesteps_total": 4579676, "episode_reward_mean": -330.02191932153767, "episodes_this_iter": 47, "date": "2019-05-23_07-15-48", "time_this_iter_s": 27.677419185638428, "num_metric_batches_dropped": 0, "episode_reward_min": -569.7049975689332}
{"time_since_restore": 3686.7249150276184, "info": {"default": {"kl": 0.01695483922958374, "total_loss": 11.555782318115234, "vf_explained_var": 0.8883920907974243, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010820725001394749, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 11.562311172485352, "entropy": 0.9294270873069763}, "num_steps_trained": 4615067, "grad_time_ms": 10012.187, "load_time_ms": 20.586, "sample_time_ms": 18174.783, "num_steps_sampled": 4615067, "update_time_ms": 10.554}, "hostname": "flow-main", "episode_reward_max": -30.32026332044561, "timesteps_this_iter": 35391, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.20449693061465, "cost1_mean": 193.6508105852315, "system_level_velocity_mean": 16.3086281833975, "cost2_mean": -27.952931988175, "cost2_max": -13.03220963006895, "outflow_rate_max": 1317.401702190812, "cost1_min": 22.620627079141407, "system_level_velocity_min": 11.483913823282904, "system_level_velocity_max": 18.584608596237373, "outflow_rate_min": 481.99009215424053, "outflow_rate_mean": 1194.4407517995173, "cost2_min": -43.55997411296998}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 4615067, "time_total_s": 3686.7249150276184, "timestamp": 1558595776, "iterations_since_restore": 131, "policy_reward_mean": {}, "training_iteration": 131, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b27f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2a58>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2588>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6090, "timesteps_total": 4615067, "episode_reward_mean": -340.01633413737886, "episodes_this_iter": 46, "date": "2019-05-23_07-16-16", "time_this_iter_s": 27.35122036933899, "num_metric_batches_dropped": 0, "episode_reward_min": -569.7049975689332}
{"time_since_restore": 3714.598645210266, "info": {"default": {"kl": 0.017680929973721504, "total_loss": 12.305350303649902, "vf_explained_var": 0.8745647072792053, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009573100134730339, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 12.310447692871094, "entropy": 0.9194769263267517}, "num_steps_trained": 4650549, "grad_time_ms": 10048.394, "load_time_ms": 21.251, "sample_time_ms": 18095.635, "num_steps_sampled": 4650549, "update_time_ms": 10.412}, "hostname": "flow-main", "episode_reward_max": -235.4175080956519, "timesteps_this_iter": 35482, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.50841507007047, "cost1_mean": 196.93708365461183, "system_level_velocity_mean": 16.43274489291369, "cost2_mean": -28.244663485668088, "cost2_max": -16.455057677407233, "outflow_rate_max": 1317.401702190812, "cost1_min": 135.07070071726974, "system_level_velocity_min": 11.483913823282904, "system_level_velocity_max": 18.649204779465165, "outflow_rate_min": 878.9028776012532, "outflow_rate_mean": 1211.4127714291747, "cost2_min": -43.55997411296998}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4650549, "time_total_s": 3714.598645210266, "timestamp": 1558595804, "iterations_since_restore": 132, "policy_reward_mean": {}, "training_iteration": 132, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b78d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b77b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7d68>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6138, "timesteps_total": 4650549, "episode_reward_mean": -340.7505491564467, "episodes_this_iter": 48, "date": "2019-05-23_07-16-44", "time_this_iter_s": 27.873730182647705, "num_metric_batches_dropped": 0, "episode_reward_min": -525.7418549874858}
{"time_since_restore": 3742.241475343704, "info": {"default": {"kl": 0.018215501680970192, "total_loss": 11.629437446594238, "vf_explained_var": 0.8797767758369446, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012160670012235641, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 11.636988639831543, "entropy": 0.9183944463729858}, "num_steps_trained": 4685686, "grad_time_ms": 10076.178, "load_time_ms": 21.193, "sample_time_ms": 18048.63, "num_steps_sampled": 4685686, "update_time_ms": 10.172}, "hostname": "flow-main", "episode_reward_max": -33.962179210209555, "timesteps_this_iter": 35137, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.7932987668532, "cost1_mean": 195.276356955782, "system_level_velocity_mean": 16.570971542677484, "cost2_mean": -28.279159011220415, "cost2_max": -6.894135989538013, "outflow_rate_max": 1330.750311743326, "cost1_min": 23.632623721054532, "system_level_velocity_min": 12.947209228036316, "system_level_velocity_max": 18.649564183762504, "outflow_rate_min": 475.2296523390581, "outflow_rate_mean": 1207.2201875476096, "cost2_min": -44.22672811845105}, "episode_len_mean": 319.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4685686, "time_total_s": 3742.241475343704, "timestamp": 1558595831, "iterations_since_restore": 133, "policy_reward_mean": {}, "training_iteration": 133, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd0b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd908>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6183, "timesteps_total": 4685686, "episode_reward_mean": -328.9950411356468, "episodes_this_iter": 45, "date": "2019-05-23_07-17-11", "time_this_iter_s": 27.64283013343811, "num_metric_batches_dropped": 0, "episode_reward_min": -546.0931355926222}
{"time_since_restore": 3770.7005519866943, "info": {"default": {"kl": 0.01786344312131405, "total_loss": 12.11097526550293, "vf_explained_var": 0.8906105160713196, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010842274874448776, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 12.117295265197754, "entropy": 0.9417638778686523}, "num_steps_trained": 4720378, "grad_time_ms": 10082.445, "load_time_ms": 22.17, "sample_time_ms": 17964.382, "num_steps_sampled": 4720378, "update_time_ms": 9.997}, "hostname": "flow-main", "episode_reward_max": -33.962179210209555, "timesteps_this_iter": 34692, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.7932987668532, "cost1_mean": 192.78736377308968, "system_level_velocity_mean": 16.509000456398073, "cost2_mean": -28.1075692158158, "cost2_max": -6.894135989538013, "outflow_rate_max": 1330.750311743326, "cost1_min": 23.632623721054532, "system_level_velocity_min": 12.197436423543085, "system_level_velocity_max": 18.71717184875929, "outflow_rate_min": 475.2296523390581, "outflow_rate_mean": 1198.3732178011219, "cost2_min": -44.22672811845105}, "episode_len_mean": 317.56, "node_ip": "10.138.0.2", "timesteps_since_restore": 4720378, "time_total_s": 3770.7005519866943, "timestamp": 1558595860, "iterations_since_restore": 134, "policy_reward_mean": {}, "training_iteration": 134, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1828>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1518>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6231, "timesteps_total": 4720378, "episode_reward_mean": -326.32507046635385, "episodes_this_iter": 48, "date": "2019-05-23_07-17-40", "time_this_iter_s": 28.459076642990112, "num_metric_batches_dropped": 0, "episode_reward_min": -546.0931355926222}
{"time_since_restore": 3798.309064388275, "info": {"default": {"kl": 0.017961371690034866, "total_loss": 11.470325469970703, "vf_explained_var": 0.8905025720596313, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009713436476886272, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 11.475492477416992, "entropy": 0.9178953766822815}, "num_steps_trained": 4754853, "grad_time_ms": 9975.056, "load_time_ms": 22.663, "sample_time_ms": 17939.713, "num_steps_sampled": 4754853, "update_time_ms": 9.84}, "hostname": "flow-main", "episode_reward_max": -153.88156554773354, "timesteps_this_iter": 34475, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.09481969184353, "cost1_mean": 195.90997798235142, "system_level_velocity_mean": 16.512447056345586, "cost2_mean": -27.974026278866447, "cost2_max": -17.257036486398096, "outflow_rate_max": 1326.711950776496, "cost1_min": 138.63086269735965, "system_level_velocity_min": 12.197436423543085, "system_level_velocity_max": 18.71717184875929, "outflow_rate_min": 865.3477989497374, "outflow_rate_mean": 1207.7379090744455, "cost2_min": -41.44227463796883}, "episode_len_mean": 322.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 4754853, "time_total_s": 3798.309064388275, "timestamp": 1558595888, "iterations_since_restore": 135, "policy_reward_mean": {}, "training_iteration": 135, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1780>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1080>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6278, "timesteps_total": 4754853, "episode_reward_mean": -327.9280542457367, "episodes_this_iter": 47, "date": "2019-05-23_07-18-08", "time_this_iter_s": 27.60851240158081, "num_metric_batches_dropped": 0, "episode_reward_min": -515.5787280711535}
{"time_since_restore": 3825.843946456909, "info": {"default": {"kl": 0.016408026218414307, "total_loss": 12.154322624206543, "vf_explained_var": 0.8776434063911438, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010400247760117054, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 12.160568237304688, "entropy": 0.9282607436180115}, "num_steps_trained": 4789420, "grad_time_ms": 9871.326, "load_time_ms": 22.84, "sample_time_ms": 17794.029, "num_steps_sampled": 4789420, "update_time_ms": 9.714}, "hostname": "flow-main", "episode_reward_max": -30.76018776710037, "timesteps_this_iter": 34567, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.3022869255751, "cost1_mean": 193.88057319767134, "system_level_velocity_mean": 16.36037225357421, "cost2_mean": -28.519613751284982, "cost2_max": -12.335103770403013, "outflow_rate_max": 1322.5133881010029, "cost1_min": 22.665412076255855, "system_level_velocity_min": 12.283210724101357, "system_level_velocity_max": 18.668074399125942, "outflow_rate_min": 471.084583467557, "outflow_rate_mean": 1192.7184811633292, "cost2_min": -53.04120978490489}, "episode_len_mean": 321.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4789420, "time_total_s": 3825.843946456909, "timestamp": 1558595915, "iterations_since_restore": 136, "policy_reward_mean": {}, "training_iteration": 136, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c12e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913e10>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1be0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6324, "timesteps_total": 4789420, "episode_reward_mean": -331.94690159940745, "episodes_this_iter": 46, "date": "2019-05-23_07-18-35", "time_this_iter_s": 27.534882068634033, "num_metric_batches_dropped": 0, "episode_reward_min": -542.2965454853239}
{"time_since_restore": 3854.865405321121, "info": {"default": {"kl": 0.017048263922333717, "total_loss": 9.904741287231445, "vf_explained_var": 0.8932024240493774, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00862928107380867, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 9.90905475616455, "entropy": 0.8753029108047485}, "num_steps_trained": 4825540, "grad_time_ms": 9834.68, "load_time_ms": 22.785, "sample_time_ms": 17908.265, "num_steps_sampled": 4825540, "update_time_ms": 9.915}, "hostname": "flow-main", "episode_reward_max": -29.80177288238469, "timesteps_this_iter": 36120, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.3022869255751, "cost1_mean": 192.26157751061507, "system_level_velocity_mean": 16.376479046010644, "cost2_mean": -28.656591836970154, "cost2_max": -9.210351447454826, "outflow_rate_max": 1322.5133881010029, "cost1_min": 22.665412076255855, "system_level_velocity_min": 12.283210724101357, "system_level_velocity_max": 18.668074399125942, "outflow_rate_min": 471.084583467557, "outflow_rate_mean": 1186.7193843947032, "cost2_min": -53.04120978490489}, "episode_len_mean": 319.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 4825540, "time_total_s": 3854.865405321121, "timestamp": 1558595944, "iterations_since_restore": 137, "policy_reward_mean": {}, "training_iteration": 137, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1438>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1ac8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6372, "timesteps_total": 4825540, "episode_reward_mean": -332.0759065818319, "episodes_this_iter": 48, "date": "2019-05-23_07-19-04", "time_this_iter_s": 29.021458864212036, "num_metric_batches_dropped": 0, "episode_reward_min": -542.2965454853239}
{"time_since_restore": 3883.706756591797, "info": {"default": {"kl": 0.01581098698079586, "total_loss": 12.293932914733887, "vf_explained_var": 0.867600679397583, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011080212891101837, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 12.301011085510254, "entropy": 0.8978502154350281}, "num_steps_trained": 4861249, "grad_time_ms": 9830.973, "load_time_ms": 22.834, "sample_time_ms": 18051.161, "num_steps_sampled": 4861249, "update_time_ms": 9.894}, "hostname": "flow-main", "episode_reward_max": -29.80177288238469, "timesteps_this_iter": 35709, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.95962717086672, "cost1_mean": 197.61539383118674, "system_level_velocity_mean": 16.667629577324917, "cost2_mean": -28.632077818074706, "cost2_max": -9.210351447454826, "outflow_rate_max": 1322.5133881010029, "cost1_min": 22.788098561243483, "system_level_velocity_min": 12.549663246673857, "system_level_velocity_max": 18.6867298419561, "outflow_rate_min": 494.93822963381507, "outflow_rate_mean": 1217.7563738137985, "cost2_min": -48.36102875330279}, "episode_len_mean": 321.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4861249, "time_total_s": 3883.706756591797, "timestamp": 1558595973, "iterations_since_restore": 138, "policy_reward_mean": {}, "training_iteration": 138, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1dd8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b20b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1898>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6418, "timesteps_total": 4861249, "episode_reward_mean": -331.34058585967034, "episodes_this_iter": 46, "date": "2019-05-23_07-19-33", "time_this_iter_s": 28.84135127067566, "num_metric_batches_dropped": 0, "episode_reward_min": -500.10992653738043}
{"time_since_restore": 3911.842605829239, "info": {"default": {"kl": 0.017477573826909065, "total_loss": 11.430344581604004, "vf_explained_var": 0.8856350779533386, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010219205170869827, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 11.436139106750488, "entropy": 0.9135987758636475}, "num_steps_trained": 4897223, "grad_time_ms": 9823.858, "load_time_ms": 24.479, "sample_time_ms": 18075.943, "num_steps_sampled": 4897223, "update_time_ms": 9.354}, "hostname": "flow-main", "episode_reward_max": -29.80177288238469, "timesteps_this_iter": 35974, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.95962717086672, "cost1_mean": 194.18326964702499, "system_level_velocity_mean": 16.342873733130077, "cost2_mean": -29.670764073747787, "cost2_max": -9.210351447454826, "outflow_rate_max": 1322.1311133380723, "cost1_min": 22.788098561243483, "system_level_velocity_min": 12.203476730514295, "system_level_velocity_max": 18.6867298419561, "outflow_rate_min": 494.93822963381507, "outflow_rate_mean": 1200.7787344087121, "cost2_min": -48.36102875330279}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 4897223, "time_total_s": 3911.842605829239, "timestamp": 1558596001, "iterations_since_restore": 139, "policy_reward_mean": {}, "training_iteration": 139, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c14a8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c15c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1908>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6463, "timesteps_total": 4897223, "episode_reward_mean": -345.12021027869457, "episodes_this_iter": 45, "date": "2019-05-23_07-20-01", "time_this_iter_s": 28.135849237442017, "num_metric_batches_dropped": 0, "episode_reward_min": -525.0840507150087}
{"time_since_restore": 3940.0847702026367, "info": {"default": {"kl": 0.016574768349528313, "total_loss": 12.51014232635498, "vf_explained_var": 0.8743482828140259, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011240250431001186, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 12.517187118530273, "entropy": 0.8887568116188049}, "num_steps_trained": 4933258, "grad_time_ms": 9850.283, "load_time_ms": 24.192, "sample_time_ms": 18106.138, "num_steps_sampled": 4933258, "update_time_ms": 9.358}, "hostname": "flow-main", "episode_reward_max": -236.49579330167802, "timesteps_this_iter": 36035, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.95962717086672, "cost1_mean": 195.31900128415123, "system_level_velocity_mean": 16.272608164873887, "cost2_mean": -30.529160050897705, "cost2_max": -20.515359461079434, "outflow_rate_max": 1315.809384749732, "cost1_min": 141.87531579150894, "system_level_velocity_min": 12.203476730514295, "system_level_velocity_max": 18.6867298419561, "outflow_rate_min": 856.3696250226786, "outflow_rate_mean": 1208.3785250457393, "cost2_min": -49.129876253921324}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 4933258, "time_total_s": 3940.0847702026367, "timestamp": 1558596030, "iterations_since_restore": 140, "policy_reward_mean": {}, "training_iteration": 140, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1ac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1518>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b20f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6511, "timesteps_total": 4933258, "episode_reward_mean": -351.1078456056202, "episodes_this_iter": 48, "date": "2019-05-23_07-20-30", "time_this_iter_s": 28.242164373397827, "num_metric_batches_dropped": 0, "episode_reward_min": -538.9861449670374}
{"time_since_restore": 3967.1278364658356, "info": {"default": {"kl": 0.01703622378408909, "total_loss": 10.518355369567871, "vf_explained_var": 0.8993001580238342, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011579767800867558, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 10.525623321533203, "entropy": 0.9010918140411377}, "num_steps_trained": 4968209, "grad_time_ms": 9849.526, "load_time_ms": 25.206, "sample_time_ms": 18074.521, "num_steps_sampled": 4968209, "update_time_ms": 9.451}, "hostname": "flow-main", "episode_reward_max": -238.53947367169053, "timesteps_this_iter": 34951, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.00725865362227, "cost1_mean": 198.11164329045062, "system_level_velocity_mean": 16.5249552161855, "cost2_mean": -29.563580343546338, "cost2_max": -19.535697760029173, "outflow_rate_max": 1315.1916633366634, "cost1_min": 150.64738146867455, "system_level_velocity_min": 12.63690407793203, "system_level_velocity_max": 18.67010412996342, "outflow_rate_min": 918.5275394456293, "outflow_rate_mean": 1219.0335223101733, "cost2_min": -49.129876253921324}, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 4968209, "time_total_s": 3967.1278364658356, "timestamp": 1558596057, "iterations_since_restore": 141, "policy_reward_mean": {}, "training_iteration": 141, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2208>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2ba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b28d0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6555, "timesteps_total": 4968209, "episode_reward_mean": -336.7215218140381, "episodes_this_iter": 44, "date": "2019-05-23_07-20-57", "time_this_iter_s": 27.043066263198853, "num_metric_batches_dropped": 0, "episode_reward_min": -538.9861449670374}
{"time_since_restore": 3995.521429538727, "info": {"default": {"kl": 0.018810737878084183, "total_loss": 12.351905822753906, "vf_explained_var": 0.8862186670303345, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012281319126486778, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 12.359424591064453, "entropy": 0.9270402193069458}, "num_steps_trained": 5003965, "grad_time_ms": 9897.623, "load_time_ms": 25.083, "sample_time_ms": 18078.292, "num_steps_sampled": 5003965, "update_time_ms": 9.428}, "hostname": "flow-main", "episode_reward_max": -236.94678773802852, "timesteps_this_iter": 35756, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.04253093682865, "cost1_mean": 196.62921545903336, "system_level_velocity_mean": 16.413645196654763, "cost2_mean": -29.618075894445138, "cost2_max": -19.535697760029173, "outflow_rate_max": 1314.85754189359, "cost1_min": 135.0941195306633, "system_level_velocity_min": 10.932715460207843, "system_level_velocity_max": 18.68457044632066, "outflow_rate_min": 903.241658986175, "outflow_rate_mean": 1208.5301670104905, "cost2_min": -49.129876253921324}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5003965, "time_total_s": 3995.521429538727, "timestamp": 1558596085, "iterations_since_restore": 142, "policy_reward_mean": {}, "training_iteration": 142, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c68d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6ac8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6602, "timesteps_total": 5003965, "episode_reward_mean": -339.20982618470333, "episodes_this_iter": 47, "date": "2019-05-23_07-21-25", "time_this_iter_s": 28.393593072891235, "num_metric_batches_dropped": 0, "episode_reward_min": -582.8800490827526}
{"time_since_restore": 4024.590922355652, "info": {"default": {"kl": 0.017232181504368782, "total_loss": 13.613316535949707, "vf_explained_var": 0.8699057698249817, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008955199271440506, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 13.617910385131836, "entropy": 0.88815838098526}, "num_steps_trained": 5039490, "grad_time_ms": 9892.678, "load_time_ms": 25.153, "sample_time_ms": 18226.768, "num_steps_sampled": 5039490, "update_time_ms": 9.402}, "hostname": "flow-main", "episode_reward_max": -23.932307169338003, "timesteps_this_iter": 35525, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.28883198276992, "cost1_mean": 193.59828057672084, "system_level_velocity_mean": 16.30985587282088, "cost2_mean": -30.293085519550708, "cost2_max": -13.177762794663217, "outflow_rate_max": 1319.4360756984952, "cost1_min": 17.50724528225201, "system_level_velocity_min": 10.932715460207843, "system_level_velocity_max": 18.737492466920845, "outflow_rate_min": 431.75782487237836, "outflow_rate_mean": 1198.1192279071513, "cost2_min": -45.68450234698359}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 5039490, "time_total_s": 4024.590922355652, "timestamp": 1558596114, "iterations_since_restore": 143, "policy_reward_mean": {}, "training_iteration": 143, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bdd68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a3c8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6650, "timesteps_total": 5039490, "episode_reward_mean": -343.8928091512539, "episodes_this_iter": 48, "date": "2019-05-23_07-21-54", "time_this_iter_s": 29.06949281692505, "num_metric_batches_dropped": 0, "episode_reward_min": -582.8800490827526}
{"time_since_restore": 4052.451867580414, "info": {"default": {"kl": 0.018191400915384293, "total_loss": 12.30997085571289, "vf_explained_var": 0.8668254613876343, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00871650967746973, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 12.314082145690918, "entropy": 0.8597357273101807}, "num_steps_trained": 5074683, "grad_time_ms": 9833.089, "load_time_ms": 24.934, "sample_time_ms": 18226.565, "num_steps_sampled": 5074683, "update_time_ms": 9.289}, "hostname": "flow-main", "episode_reward_max": -23.932307169338003, "timesteps_this_iter": 35193, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.28883198276992, "cost1_mean": 190.9452276086258, "system_level_velocity_mean": 16.468606251245106, "cost2_mean": -29.8154670938229, "cost2_max": -13.177762794663217, "outflow_rate_max": 1321.8534477900293, "cost1_min": 17.50724528225201, "system_level_velocity_min": 12.189232928031391, "system_level_velocity_max": 18.737492466920845, "outflow_rate_min": 431.75782487237836, "outflow_rate_mean": 1187.4186380843123, "cost2_min": -46.65434387328543}, "episode_len_mean": 315.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 5074683, "time_total_s": 4052.451867580414, "timestamp": 1558596142, "iterations_since_restore": 144, "policy_reward_mean": {}, "training_iteration": 144, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6c18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1eb8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913400>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6696, "timesteps_total": 5074683, "episode_reward_mean": -330.4154368294959, "episodes_this_iter": 46, "date": "2019-05-23_07-22-22", "time_this_iter_s": 27.860945224761963, "num_metric_batches_dropped": 0, "episode_reward_min": -504.3180939145268}
{"time_since_restore": 4081.357141971588, "info": {"default": {"kl": 0.017999140545725822, "total_loss": 12.238014221191406, "vf_explained_var": 0.8769481182098389, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010238480754196644, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 12.243696212768555, "entropy": 0.8973199725151062}, "num_steps_trained": 5110765, "grad_time_ms": 9921.817, "load_time_ms": 22.862, "sample_time_ms": 18270.6, "num_steps_sampled": 5110765, "update_time_ms": 9.059}, "hostname": "flow-main", "episode_reward_max": -30.962358138170963, "timesteps_this_iter": 36082, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.28883198276992, "cost1_mean": 194.22593161460927, "system_level_velocity_mean": 16.592671919082225, "cost2_mean": -30.911949361413644, "cost2_max": -13.387439652496179, "outflow_rate_max": 1321.8534477900293, "cost1_min": 22.638397958990055, "system_level_velocity_min": 12.428094243885562, "system_level_velocity_max": 18.7161286202537, "outflow_rate_min": 460.7989278777953, "outflow_rate_mean": 1202.4028011181288, "cost2_min": -46.65434387328543}, "episode_len_mean": 318.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 5110765, "time_total_s": 4081.357141971588, "timestamp": 1558596171, "iterations_since_restore": 145, "policy_reward_mean": {}, "training_iteration": 145, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0978>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0c50>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6743, "timesteps_total": 5110765, "episode_reward_mean": -331.552147209845, "episodes_this_iter": 47, "date": "2019-05-23_07-22-51", "time_this_iter_s": 28.905274391174316, "num_metric_batches_dropped": 0, "episode_reward_min": -502.0501238021895}
{"time_since_restore": 4109.806240320206, "info": {"default": {"kl": 0.017010634765028954, "total_loss": 11.454803466796875, "vf_explained_var": 0.8830739259719849, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009526045061647892, "cur_kl_coeff": 0.2531249523162842, "vf_loss": 11.460023880004883, "entropy": 0.8838695883750916}, "num_steps_trained": 5146778, "grad_time_ms": 10003.149, "load_time_ms": 22.307, "sample_time_ms": 18281.411, "num_steps_sampled": 5146778, "update_time_ms": 8.944}, "hostname": "flow-main", "episode_reward_max": -151.6366788298614, "timesteps_this_iter": 36013, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.01996181909792, "cost1_mean": 197.32154885579973, "system_level_velocity_mean": 16.624030944985964, "cost2_mean": -32.01014666694894, "cost2_max": -20.81164271017969, "outflow_rate_max": 1327.8906362090293, "cost1_min": 139.51415473288353, "system_level_velocity_min": 12.428094243885562, "system_level_velocity_max": 18.7161286202537, "outflow_rate_min": 897.9353834398877, "outflow_rate_mean": 1214.796022238014, "cost2_min": -45.5718660690108}, "episode_len_mean": 322.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 5146778, "time_total_s": 4109.806240320206, "timestamp": 1558596199, "iterations_since_restore": 146, "policy_reward_mean": {}, "training_iteration": 146, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6128>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c65f8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6789, "timesteps_total": 5146778, "episode_reward_mean": -339.67497693765756, "episodes_this_iter": 46, "date": "2019-05-23_07-23-19", "time_this_iter_s": 28.449098348617554, "num_metric_batches_dropped": 0, "episode_reward_min": -495.9399613829114}
{"time_since_restore": 4138.215524435043, "info": {"default": {"kl": 0.020945126190781593, "total_loss": 11.588305473327637, "vf_explained_var": 0.8817275762557983, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013018340803682804, "cur_kl_coeff": 0.25312498211860657, "vf_loss": 11.596022605895996, "entropy": 0.9098976850509644}, "num_steps_trained": 5182737, "grad_time_ms": 9954.871, "load_time_ms": 21.92, "sample_time_ms": 18270.731, "num_steps_sampled": 5182737, "update_time_ms": 8.636}, "hostname": "flow-main", "episode_reward_max": -151.6366788298614, "timesteps_this_iter": 35959, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.73213604925036, "cost1_mean": 195.33972276026762, "system_level_velocity_mean": 16.352922726056498, "cost2_mean": -32.74693201943214, "cost2_max": -21.28285854853875, "outflow_rate_max": 1327.8906362090293, "cost1_min": 139.51415473288353, "system_level_velocity_min": 12.683760835691187, "system_level_velocity_max": 18.676008550654046, "outflow_rate_min": 866.6561955694783, "outflow_rate_mean": 1204.8769987492897, "cost2_min": -44.348314175440535}, "episode_len_mean": 323.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 5182737, "time_total_s": 4138.215524435043, "timestamp": 1558596228, "iterations_since_restore": 147, "policy_reward_mean": {}, "training_iteration": 147, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490eda0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846afdd8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e0b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6837, "timesteps_total": 5182737, "episode_reward_mean": -352.10891900346877, "episodes_this_iter": 48, "date": "2019-05-23_07-23-48", "time_this_iter_s": 28.409284114837646, "num_metric_batches_dropped": 0, "episode_reward_min": -487.4255844073183}
{"time_since_restore": 4167.056867599487, "info": {"default": {"kl": 0.01476085651665926, "total_loss": 12.662312507629395, "vf_explained_var": 0.8736362457275391, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010189714841544628, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 12.66689682006836, "entropy": 0.9127918481826782}, "num_steps_trained": 5219058, "grad_time_ms": 9812.73, "load_time_ms": 22.407, "sample_time_ms": 18413.122, "num_steps_sampled": 5219058, "update_time_ms": 8.317}, "hostname": "flow-main", "episode_reward_max": -28.9486069506872, "timesteps_this_iter": 36321, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.64948399213003, "cost1_mean": 192.6476474900861, "system_level_velocity_mean": 16.190576396810492, "cost2_mean": -33.03900722888556, "cost2_max": -12.575847805588426, "outflow_rate_max": 1324.5123297324144, "cost1_min": 22.70580206555568, "system_level_velocity_min": 12.683760835691187, "system_level_velocity_max": 18.676008550654046, "outflow_rate_min": 506.5568824271422, "outflow_rate_mean": 1193.6387443774868, "cost2_min": -53.11874571281453}, "episode_len_mean": 321.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 5219058, "time_total_s": 4167.056867599487, "timestamp": 1558596257, "iterations_since_restore": 148, "policy_reward_mean": {}, "training_iteration": 148, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0ba8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0198>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d07f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6884, "timesteps_total": 5219058, "episode_reward_mean": -359.4481139754555, "episodes_this_iter": 47, "date": "2019-05-23_07-24-17", "time_this_iter_s": 28.84134316444397, "num_metric_batches_dropped": 0, "episode_reward_min": -545.559412886342}
{"time_since_restore": 4194.390334606171, "info": {"default": {"kl": 0.014372776262462139, "total_loss": 13.29971981048584, "vf_explained_var": 0.8775505423545837, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011867638677358627, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 13.306130409240723, "entropy": 0.9487479329109192}, "num_steps_trained": 5254059, "grad_time_ms": 9583.04, "load_time_ms": 21.405, "sample_time_ms": 18564.427, "num_steps_sampled": 5254059, "update_time_ms": 8.453}, "hostname": "flow-main", "episode_reward_max": -28.9486069506872, "timesteps_this_iter": 35001, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.95190247109338, "cost1_mean": 192.3064861857773, "system_level_velocity_mean": 16.293091454151824, "cost2_mean": -32.079529368500886, "cost2_max": -12.575847805588426, "outflow_rate_max": 1323.7518738404456, "cost1_min": 22.70580206555568, "system_level_velocity_min": 11.529478249601047, "system_level_velocity_max": 18.67994097738737, "outflow_rate_min": 506.5568824271422, "outflow_rate_mean": 1187.912384652872, "cost2_min": -53.11874571281453}, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 5254059, "time_total_s": 4194.390334606171, "timestamp": 1558596284, "iterations_since_restore": 149, "policy_reward_mean": {}, "training_iteration": 149, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0b70>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1b00>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d09e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6929, "timesteps_total": 5254059, "episode_reward_mean": -349.5013931578636, "episodes_this_iter": 45, "date": "2019-05-23_07-24-44", "time_this_iter_s": 27.33346700668335, "num_metric_batches_dropped": 0, "episode_reward_min": -545.559412886342}
{"time_since_restore": 4222.487847328186, "info": {"default": {"kl": 0.014880218543112278, "total_loss": 14.010937690734863, "vf_explained_var": 0.8795070052146912, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010199052281677723, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 14.015486717224121, "entropy": 0.9478301405906677}, "num_steps_trained": 5289535, "grad_time_ms": 9401.764, "load_time_ms": 23.109, "sample_time_ms": 18729.12, "num_steps_sampled": 5289535, "update_time_ms": 8.228}, "hostname": "flow-main", "episode_reward_max": -28.9486069506872, "timesteps_this_iter": 35476, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 219.95190247109338, "cost1_mean": 191.07938090386503, "system_level_velocity_mean": 16.27704630037309, "cost2_mean": -31.142226850963, "cost2_max": -12.575847805588426, "outflow_rate_max": 1328.1646310435053, "cost1_min": 22.70580206555568, "system_level_velocity_min": 11.529478249601047, "system_level_velocity_max": 18.773434378137424, "outflow_rate_min": 506.5568824271422, "outflow_rate_mean": 1177.8817211214496, "cost2_min": -47.16708966842427}, "episode_len_mean": 319.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 5289535, "time_total_s": 4222.487847328186, "timestamp": 1558596312, "iterations_since_restore": 150, "policy_reward_mean": {}, "training_iteration": 150, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0208>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0320>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 6977, "timesteps_total": 5289535, "episode_reward_mean": -343.4246216326351, "episodes_this_iter": 48, "date": "2019-05-23_07-25-12", "time_this_iter_s": 28.09751272201538, "num_metric_batches_dropped": 0, "episode_reward_min": -501.384819037388}
{"time_since_restore": 4251.790568351746, "info": {"default": {"kl": 0.014426796697080135, "total_loss": 14.445296287536621, "vf_explained_var": 0.880268394947052, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011639412492513657, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 14.451457023620605, "entropy": 0.955506443977356}, "num_steps_trained": 5325274, "grad_time_ms": 9285.079, "load_time_ms": 21.331, "sample_time_ms": 19072.795, "num_steps_sampled": 5325274, "update_time_ms": 7.838}, "hostname": "flow-main", "episode_reward_max": -158.58479063486664, "timesteps_this_iter": 35739, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.8927615714117, "cost1_mean": 190.9170352460966, "system_level_velocity_mean": 15.999265329589957, "cost2_mean": -32.73053847287211, "cost2_max": -16.60940827031848, "outflow_rate_max": 1328.1646310435053, "cost1_min": 133.36978003193258, "system_level_velocity_min": 11.529478249601047, "system_level_velocity_max": 18.773434378137424, "outflow_rate_min": 868.8754536845217, "outflow_rate_mean": 1179.4193110570789, "cost2_min": -48.33953991959123}, "episode_len_mean": 323.9, "node_ip": "10.138.0.2", "timesteps_since_restore": 5325274, "time_total_s": 4251.790568351746, "timestamp": 1558596342, "iterations_since_restore": 151, "policy_reward_mean": {}, "training_iteration": 151, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0b38>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d04a8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0eb8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7023, "timesteps_total": 5325274, "episode_reward_mean": -360.32677203592124, "episodes_this_iter": 46, "date": "2019-05-23_07-25-42", "time_this_iter_s": 29.30272102355957, "num_metric_batches_dropped": 0, "episode_reward_min": -541.491398369474}
{"time_since_restore": 4281.05578994751, "info": {"default": {"kl": 0.01479153148829937, "total_loss": 14.569552421569824, "vf_explained_var": 0.8808375000953674, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010187190026044846, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 14.574124336242676, "entropy": 0.9546260833740234}, "num_steps_trained": 5360926, "grad_time_ms": 9163.562, "load_time_ms": 21.887, "sample_time_ms": 19282.352, "num_steps_sampled": 5360926, "update_time_ms": 7.861}, "hostname": "flow-main", "episode_reward_max": -231.3795308713042, "timesteps_this_iter": 35652, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.8927615714117, "cost1_mean": 193.5337194720154, "system_level_velocity_mean": 16.145528310864616, "cost2_mean": -33.6819861199509, "cost2_max": -21.921967703633765, "outflow_rate_max": 1329.8136000182487, "cost1_min": 140.35413176428648, "system_level_velocity_min": 11.723066267282038, "system_level_velocity_max": 18.746715146030674, "outflow_rate_min": 880.5977419354837, "outflow_rate_mean": 1197.685681527806, "cost2_min": -56.650053691635094}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5360926, "time_total_s": 4281.05578994751, "timestamp": 1558596371, "iterations_since_restore": 152, "policy_reward_mean": {}, "training_iteration": 152, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b26a0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2080>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2320>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7070, "timesteps_total": 5360926, "episode_reward_mean": -362.35853704994037, "episodes_this_iter": 47, "date": "2019-05-23_07-26-11", "time_this_iter_s": 29.26522159576416, "num_metric_batches_dropped": 0, "episode_reward_min": -568.5328651644608}
{"time_since_restore": 4309.801740884781, "info": {"default": {"kl": 0.015894725918769836, "total_loss": 11.857382774353027, "vf_explained_var": 0.8905952572822571, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012473411858081818, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 11.863821029663086, "entropy": 0.9454309940338135}, "num_steps_trained": 5396009, "grad_time_ms": 9134.127, "load_time_ms": 21.85, "sample_time_ms": 19278.259, "num_steps_sampled": 5396009, "update_time_ms": 8.206}, "hostname": "flow-main", "episode_reward_max": -231.3795308713042, "timesteps_this_iter": 35083, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.7254008191702, "cost1_mean": 195.28769517503133, "system_level_velocity_mean": 16.321466993957646, "cost2_mean": -32.581507701155914, "cost2_max": -20.38837062305183, "outflow_rate_max": 1332.2685598723308, "cost1_min": 132.8451158220197, "system_level_velocity_min": 10.952195666252734, "system_level_velocity_max": 18.769749839171006, "outflow_rate_min": 861.833047238372, "outflow_rate_mean": 1203.1911312982625, "cost2_min": -56.650053691635094}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5396009, "time_total_s": 4309.801740884781, "timestamp": 1558596400, "iterations_since_restore": 153, "policy_reward_mean": {}, "training_iteration": 153, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0e80>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0f28>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7116, "timesteps_total": 5396009, "episode_reward_mean": -351.32149962922574, "episodes_this_iter": 46, "date": "2019-05-23_07-26-40", "time_this_iter_s": 28.745950937271118, "num_metric_batches_dropped": 0, "episode_reward_min": -568.5328651644608}
{"time_since_restore": 4339.153072834015, "info": {"default": {"kl": 0.013720642775297165, "total_loss": 12.475040435791016, "vf_explained_var": 0.874184787273407, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010151450522243977, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 12.479982376098633, "entropy": 0.9042233824729919}, "num_steps_trained": 5431172, "grad_time_ms": 9123.171, "load_time_ms": 20.458, "sample_time_ms": 19439.697, "num_steps_sampled": 5431172, "update_time_ms": 8.372}, "hostname": "flow-main", "episode_reward_max": -23.443318518351226, "timesteps_this_iter": 35163, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.60996255236333, "cost1_mean": 196.57788817594394, "system_level_velocity_mean": 16.61705189381731, "cost2_mean": -30.92858497451014, "cost2_max": -12.934885121178706, "outflow_rate_max": 1332.2685598723308, "cost1_min": 17.674813258008115, "system_level_velocity_min": 10.952195666252734, "system_level_velocity_max": 18.769749839171006, "outflow_rate_min": 437.2949997643919, "outflow_rate_mean": 1208.8934315357067, "cost2_min": -46.03683228287987}, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 5431172, "time_total_s": 4339.153072834015, "timestamp": 1558596429, "iterations_since_restore": 154, "policy_reward_mean": {}, "training_iteration": 154, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d09b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7128>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d07f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7160, "timesteps_total": 5431172, "episode_reward_mean": -330.4219255954359, "episodes_this_iter": 44, "date": "2019-05-23_07-27-09", "time_this_iter_s": 29.35133194923401, "num_metric_batches_dropped": 0, "episode_reward_min": -517.9515530438833}
{"time_since_restore": 4368.615014076233, "info": {"default": {"kl": 0.015575885772705078, "total_loss": 14.033617973327637, "vf_explained_var": 0.8749656081199646, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011935410089790821, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 14.039639472961426, "entropy": 0.9605533480644226}, "num_steps_trained": 5467199, "grad_time_ms": 9178.334, "load_time_ms": 20.466, "sample_time_ms": 19439.151, "num_steps_sampled": 5467199, "update_time_ms": 8.763}, "hostname": "flow-main", "episode_reward_max": -23.443318518351226, "timesteps_this_iter": 36027, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.24259831307904, "cost1_mean": 196.49914232772178, "system_level_velocity_mean": 16.59165659928208, "cost2_mean": -31.44231874635469, "cost2_max": -12.934885121178706, "outflow_rate_max": 1336.460756662169, "cost1_min": 17.674813258008115, "system_level_velocity_min": 12.081062517027387, "system_level_velocity_max": 18.766477057083588, "outflow_rate_min": 437.2949997643919, "outflow_rate_mean": 1211.8540490598386, "cost2_min": -50.549368292432774}, "episode_len_mean": 321.46, "node_ip": "10.138.0.2", "timesteps_since_restore": 5467199, "time_total_s": 4368.615014076233, "timestamp": 1558596459, "iterations_since_restore": 155, "policy_reward_mean": {}, "training_iteration": 155, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2940>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6c88>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7210, "timesteps_total": 5467199, "episode_reward_mean": -338.7572263221739, "episodes_this_iter": 50, "date": "2019-05-23_07-27-39", "time_this_iter_s": 29.461941242218018, "num_metric_batches_dropped": 0, "episode_reward_min": -604.7993786928743}
{"time_since_restore": 4398.038604259491, "info": {"default": {"kl": 0.015656299889087677, "total_loss": 13.54345703125, "vf_explained_var": 0.8785279989242554, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01346733421087265, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 13.550979614257812, "entropy": 0.9525092840194702}, "num_steps_trained": 5503456, "grad_time_ms": 9276.371, "load_time_ms": 21.15, "sample_time_ms": 19435.59, "num_steps_sampled": 5503456, "update_time_ms": 9.133}, "hostname": "flow-main", "episode_reward_max": -158.22473458128746, "timesteps_this_iter": 36257, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.24259831307904, "cost1_mean": 195.43930626489404, "system_level_velocity_mean": 16.449606493745513, "cost2_mean": -32.26260894733858, "cost2_max": -20.980206715791653, "outflow_rate_max": 1340.1870909608479, "cost1_min": 145.5880142624863, "system_level_velocity_min": 12.435960826936148, "system_level_velocity_max": 18.741876478933733, "outflow_rate_min": 941.5438576051782, "outflow_rate_mean": 1207.1175393795793, "cost2_min": -50.549368292432774}, "episode_len_mean": 322.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 5503456, "time_total_s": 4398.038604259491, "timestamp": 1558596488, "iterations_since_restore": 156, "policy_reward_mean": {}, "training_iteration": 156, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0128>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0588>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0f28>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7255, "timesteps_total": 5503456, "episode_reward_mean": -352.4737057770285, "episodes_this_iter": 45, "date": "2019-05-23_07-28-08", "time_this_iter_s": 29.423590183258057, "num_metric_batches_dropped": 0, "episode_reward_min": -604.7993786928743}
{"time_since_restore": 4426.806943655014, "info": {"default": {"kl": 0.014208972454071045, "total_loss": 12.04901123046875, "vf_explained_var": 0.8913699388504028, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009922008030116558, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 12.05353832244873, "entropy": 0.9244325160980225}, "num_steps_trained": 5540093, "grad_time_ms": 9409.533, "load_time_ms": 21.729, "sample_time_ms": 19335.022, "num_steps_sampled": 5540093, "update_time_ms": 9.411}, "hostname": "flow-main", "episode_reward_max": -158.22473458128746, "timesteps_this_iter": 36637, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.38276261069663, "cost1_mean": 192.24811171988742, "system_level_velocity_mean": 16.15799253869362, "cost2_mean": -33.98682383993568, "cost2_max": -20.667594815731146, "outflow_rate_max": 1340.1870909608479, "cost1_min": 145.5880142624863, "system_level_velocity_min": 12.435960826936148, "system_level_velocity_max": 18.74033007503605, "outflow_rate_min": 941.5438576051782, "outflow_rate_mean": 1193.8856229653566, "cost2_min": -46.25222242006504}, "episode_len_mean": 322.66, "node_ip": "10.138.0.2", "timesteps_since_restore": 5540093, "time_total_s": 4426.806943655014, "timestamp": 1558596517, "iterations_since_restore": 157, "policy_reward_mean": {}, "training_iteration": 157, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a358>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6b00>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7128>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7301, "timesteps_total": 5540093, "episode_reward_mean": -369.80023572634445, "episodes_this_iter": 46, "date": "2019-05-23_07-28-37", "time_this_iter_s": 28.76833939552307, "num_metric_batches_dropped": 0, "episode_reward_min": -575.0232571773913}
{"time_since_restore": 4455.348216533661, "info": {"default": {"kl": 0.015312607400119305, "total_loss": 12.725525856018066, "vf_explained_var": 0.8866969347000122, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011147107928991318, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 12.73085880279541, "entropy": 0.9383644461631775}, "num_steps_trained": 5576227, "grad_time_ms": 9601.035, "load_time_ms": 19.363, "sample_time_ms": 19113.452, "num_steps_sampled": 5576227, "update_time_ms": 9.542}, "hostname": "flow-main", "episode_reward_max": -234.4872740262166, "timesteps_this_iter": 36134, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.14510511124197, "cost1_mean": 192.8204420828955, "system_level_velocity_mean": 16.069655470391773, "cost2_mean": -34.40482453997677, "cost2_max": -18.760459412222772, "outflow_rate_max": 1340.1870909608479, "cost1_min": 141.9715643085295, "system_level_velocity_min": 12.025971239549154, "system_level_velocity_max": 18.812349840290125, "outflow_rate_min": 882.0155204326464, "outflow_rate_mean": 1196.6847124887377, "cost2_min": -47.35991658826246}, "episode_len_mean": 324.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 5576227, "time_total_s": 4455.348216533661, "timestamp": 1558596545, "iterations_since_restore": 158, "policy_reward_mean": {}, "training_iteration": 158, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d07f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0080>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0470>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7349, "timesteps_total": 5576227, "episode_reward_mean": -371.1257431810627, "episodes_this_iter": 48, "date": "2019-05-23_07-29-05", "time_this_iter_s": 28.54127287864685, "num_metric_batches_dropped": 0, "episode_reward_min": -569.5815891461832}
{"time_since_restore": 4485.236456155777, "info": {"default": {"kl": 0.015817150473594666, "total_loss": 14.004605293273926, "vf_explained_var": 0.8758424520492554, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010679524391889572, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 14.009279251098633, "entropy": 0.9124647378921509}, "num_steps_trained": 5613729, "grad_time_ms": 9873.796, "load_time_ms": 18.32, "sample_time_ms": 19096.343, "num_steps_sampled": 5613729, "update_time_ms": 9.518}, "hostname": "flow-main", "episode_reward_max": -158.93549479743214, "timesteps_this_iter": 37502, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.14510511124197, "cost1_mean": 191.8384555102016, "system_level_velocity_mean": 16.035251535096357, "cost2_mean": -34.23135925978978, "cost2_max": -18.760459412222772, "outflow_rate_max": 1330.7328293135436, "cost1_min": 139.2465258095183, "system_level_velocity_min": 11.959656573519673, "system_level_velocity_max": 18.812349840290125, "outflow_rate_min": 882.0155204326464, "outflow_rate_mean": 1194.326747359475, "cost2_min": -52.68749989840378}, "episode_len_mean": 323.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 5613729, "time_total_s": 4485.236456155777, "timestamp": 1558596575, "iterations_since_restore": 159, "policy_reward_mean": {}, "training_iteration": 159, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d08d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d00b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7392, "timesteps_total": 5613729, "episode_reward_mean": -372.46763193724365, "episodes_this_iter": 43, "date": "2019-05-23_07-29-35", "time_this_iter_s": 29.88823962211609, "num_metric_batches_dropped": 0, "episode_reward_min": -584.6074725333248}
{"time_since_restore": 4513.455226898193, "info": {"default": {"kl": 0.016876643523573875, "total_loss": 12.446770668029785, "vf_explained_var": 0.8814539313316345, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013506785035133362, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 12.453869819641113, "entropy": 0.902272641658783}, "num_steps_trained": 5649394, "grad_time_ms": 10002.609, "load_time_ms": 16.825, "sample_time_ms": 18980.322, "num_steps_sampled": 5649394, "update_time_ms": 10.155}, "hostname": "flow-main", "episode_reward_max": -158.93549479743214, "timesteps_this_iter": 35665, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.17387120261608, "cost1_mean": 192.54351110149673, "system_level_velocity_mean": 16.127742583447567, "cost2_mean": -34.211010305399775, "cost2_max": -19.44044321671161, "outflow_rate_max": 1330.3066228919445, "cost1_min": 139.2465258095183, "system_level_velocity_min": 11.959656573519673, "system_level_velocity_max": 18.75084869260813, "outflow_rate_min": 897.6133399390244, "outflow_rate_mean": 1197.408521979725, "cost2_min": -52.68749989840378}, "episode_len_mean": 323.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 5649394, "time_total_s": 4513.455226898193, "timestamp": 1558596604, "iterations_since_restore": 160, "policy_reward_mean": {}, "training_iteration": 160, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0b70>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d04e0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7441, "timesteps_total": 5649394, "episode_reward_mean": -370.8897655613193, "episodes_this_iter": 49, "date": "2019-05-23_07-30-04", "time_this_iter_s": 28.218770742416382, "num_metric_batches_dropped": 0, "episode_reward_min": -584.6074725333248}
{"time_since_restore": 4542.044618844986, "info": {"default": {"kl": 0.014187730848789215, "total_loss": 12.846033096313477, "vf_explained_var": 0.8800386786460876, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01010469626635313, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 12.850749969482422, "entropy": 0.9265231490135193}, "num_steps_trained": 5686034, "grad_time_ms": 10076.589, "load_time_ms": 17.557, "sample_time_ms": 18834.913, "num_steps_sampled": 5686034, "update_time_ms": 10.302}, "hostname": "flow-main", "episode_reward_max": -235.4302979122998, "timesteps_this_iter": 36640, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.17387120261608, "cost1_mean": 193.47190279448787, "system_level_velocity_mean": 16.150572057083753, "cost2_mean": -34.014026586469775, "cost2_max": -19.44044321671161, "outflow_rate_max": 1330.3066228919445, "cost1_min": 145.0671221350944, "system_level_velocity_min": 11.959656573519673, "system_level_velocity_max": 18.75084869260813, "outflow_rate_min": 922.8841278369617, "outflow_rate_mean": 1196.8130044052803, "cost2_min": -50.80147384023695}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5686034, "time_total_s": 4542.044618844986, "timestamp": 1558596632, "iterations_since_restore": 161, "policy_reward_mean": {}, "training_iteration": 161, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6a90>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c61d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6c88>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7487, "timesteps_total": 5686034, "episode_reward_mean": -368.00088542646307, "episodes_this_iter": 46, "date": "2019-05-23_07-30-32", "time_this_iter_s": 28.589391946792603, "num_metric_batches_dropped": 0, "episode_reward_min": -584.6074725333248}
{"time_since_restore": 4570.718106269836, "info": {"default": {"kl": 0.017059165984392166, "total_loss": 13.452692985534668, "vf_explained_var": 0.8859680891036987, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01066261064261198, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 13.456877708435059, "entropy": 0.9935933351516724}, "num_steps_trained": 5722853, "grad_time_ms": 10054.468, "load_time_ms": 18.162, "sample_time_ms": 18796.57, "num_steps_sampled": 5722853, "update_time_ms": 10.352}, "hostname": "flow-main", "episode_reward_max": -23.699793871890456, "timesteps_this_iter": 36819, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 220.91647681857427, "cost1_mean": 188.90666043819866, "system_level_velocity_mean": 15.897118962897316, "cost2_mean": -34.17750977569279, "cost2_max": -12.929311509252642, "outflow_rate_max": 1326.1611286553814, "cost1_min": 17.57896817354877, "system_level_velocity_min": 12.3010819690442, "system_level_velocity_max": 18.7575556904735, "outflow_rate_min": 431.75782487237836, "outflow_rate_mean": 1171.717677742622, "cost2_min": -48.25892836210421}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 5722853, "time_total_s": 4570.718106269836, "timestamp": 1558596661, "iterations_since_restore": 162, "policy_reward_mean": {}, "training_iteration": 162, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b20f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2e80>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2b38>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7532, "timesteps_total": 5722853, "episode_reward_mean": -375.25961352512167, "episodes_this_iter": 45, "date": "2019-05-23_07-31-01", "time_this_iter_s": 28.673487424850464, "num_metric_batches_dropped": 0, "episode_reward_min": -548.6424207914115}
{"time_since_restore": 4600.338325977325, "info": {"default": {"kl": 0.015943728387355804, "total_loss": 15.018157005310059, "vf_explained_var": 0.8686703443527222, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011123253032565117, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 15.023228645324707, "entropy": 0.9480394721031189}, "num_steps_trained": 5758720, "grad_time_ms": 10054.437, "load_time_ms": 21.967, "sample_time_ms": 18879.793, "num_steps_sampled": 5758720, "update_time_ms": 10.016}, "hostname": "flow-main", "episode_reward_max": -23.699793871890456, "timesteps_this_iter": 35867, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.16463485700206, "cost1_mean": 188.75629480310002, "system_level_velocity_mean": 15.88517470548701, "cost2_mean": -34.03978364814828, "cost2_max": -12.929311509252642, "outflow_rate_max": 1326.1611286553814, "cost1_min": 17.57896817354877, "system_level_velocity_min": 11.84314176579912, "system_level_velocity_max": 18.79447745892691, "outflow_rate_min": 431.75782487237836, "outflow_rate_mean": 1171.4545584074212, "cost2_min": -48.25892836210421}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 5758720, "time_total_s": 4600.338325977325, "timestamp": 1558596691, "iterations_since_restore": 163, "policy_reward_mean": {}, "training_iteration": 163, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84913278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2668>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7582, "timesteps_total": 5758720, "episode_reward_mean": -375.64069721430263, "episodes_this_iter": 50, "date": "2019-05-23_07-31-31", "time_this_iter_s": 29.620219707489014, "num_metric_batches_dropped": 0, "episode_reward_min": -609.0002496679484}
{"time_since_restore": 4628.933563709259, "info": {"default": {"kl": 0.01637854240834713, "total_loss": 11.755993843078613, "vf_explained_var": 0.9024827480316162, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015331177972257137, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 11.765107154846191, "entropy": 0.9652301073074341}, "num_steps_trained": 5795266, "grad_time_ms": 9934.828, "load_time_ms": 25.41, "sample_time_ms": 18919.352, "num_steps_sampled": 5795266, "update_time_ms": 9.911}, "hostname": "flow-main", "episode_reward_max": -23.699793871890456, "timesteps_this_iter": 36546, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.3465437240414, "cost1_mean": 191.00771911198518, "system_level_velocity_mean": 16.09744773596999, "cost2_mean": -33.14961094342087, "cost2_max": -12.929311509252642, "outflow_rate_max": 1349.1559600442342, "cost1_min": 17.57896817354877, "system_level_velocity_min": 11.84314176579912, "system_level_velocity_max": 18.89138149598405, "outflow_rate_min": 431.75782487237836, "outflow_rate_mean": 1183.560330298999, "cost2_min": -45.83431707832625}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 5795266, "time_total_s": 4628.933563709259, "timestamp": 1558596719, "iterations_since_restore": 164, "policy_reward_mean": {}, "training_iteration": 164, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de438>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dea90>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7626, "timesteps_total": 5795266, "episode_reward_mean": -368.21077081991285, "episodes_this_iter": 44, "date": "2019-05-23_07-31-59", "time_this_iter_s": 28.595237731933594, "num_metric_batches_dropped": 0, "episode_reward_min": -609.0002496679484}
{"time_since_restore": 4659.0143830776215, "info": {"default": {"kl": 0.01566079817712307, "total_loss": 15.245697021484375, "vf_explained_var": 0.8704009056091309, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008458849042654037, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 15.248208045959473, "entropy": 0.9436352252960205}, "num_steps_trained": 5832063, "grad_time_ms": 9819.435, "load_time_ms": 28.928, "sample_time_ms": 19091.614, "num_steps_sampled": 5832063, "update_time_ms": 9.646}, "hostname": "flow-main", "episode_reward_max": -22.342125057327006, "timesteps_this_iter": 36797, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.43888798877126, "cost1_mean": 190.80629279983106, "system_level_velocity_mean": 16.080917835589602, "cost2_mean": -34.71313127823793, "cost2_max": -10.456791513546136, "outflow_rate_max": 1349.1559600442342, "cost1_min": 17.840276400985374, "system_level_velocity_min": 11.867653449092801, "system_level_velocity_max": 18.89138149598405, "outflow_rate_min": 487.8590816741719, "outflow_rate_mean": 1187.1412328357815, "cost2_min": -46.57515240676793}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 5832063, "time_total_s": 4659.0143830776215, "timestamp": 1558596749, "iterations_since_restore": 165, "policy_reward_mean": {}, "training_iteration": 165, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846deac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de3c8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dec88>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7673, "timesteps_total": 5832063, "episode_reward_mean": -372.69754973644797, "episodes_this_iter": 47, "date": "2019-05-23_07-32-29", "time_this_iter_s": 30.080819368362427, "num_metric_batches_dropped": 0, "episode_reward_min": -509.4257988177771}
{"time_since_restore": 4688.525984048843, "info": {"default": {"kl": 0.016726432368159294, "total_loss": 12.811406135559082, "vf_explained_var": 0.8900970816612244, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009956913068890572, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 12.815011978149414, "entropy": 0.9819257259368896}, "num_steps_trained": 5868948, "grad_time_ms": 9783.095, "load_time_ms": 31.284, "sample_time_ms": 19136.12, "num_steps_sampled": 5868948, "update_time_ms": 9.448}, "hostname": "flow-main", "episode_reward_max": -22.342125057327006, "timesteps_this_iter": 36885, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.43888798877126, "cost1_mean": 187.89735189251954, "system_level_velocity_mean": 16.020527516160104, "cost2_mean": -35.850093087662124, "cost2_max": -10.456791513546136, "outflow_rate_max": 1339.861523526789, "cost1_min": 17.840276400985374, "system_level_velocity_min": 12.298773822049549, "system_level_velocity_max": 18.786155195341053, "outflow_rate_min": 487.8590816741719, "outflow_rate_mean": 1176.0999340165915, "cost2_min": -54.780699788526135}, "episode_len_mean": 318.86, "node_ip": "10.138.0.2", "timesteps_since_restore": 5868948, "time_total_s": 4688.525984048843, "timestamp": 1558596779, "iterations_since_restore": 166, "policy_reward_mean": {}, "training_iteration": 166, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b24a8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b29e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2438>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7720, "timesteps_total": 5868948, "episode_reward_mean": -375.98088938134026, "episodes_this_iter": 47, "date": "2019-05-23_07-32-59", "time_this_iter_s": 29.511600971221924, "num_metric_batches_dropped": 0, "episode_reward_min": -580.1827217405811}
{"time_since_restore": 4720.6917905807495, "info": {"default": {"kl": 0.016033349558711052, "total_loss": 15.30505657196045, "vf_explained_var": 0.8745884299278259, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01129438541829586, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 15.310262680053711, "entropy": 0.9679425358772278}, "num_steps_trained": 5906934, "grad_time_ms": 9881.597, "load_time_ms": 30.833, "sample_time_ms": 19378.055, "num_steps_sampled": 5906934, "update_time_ms": 9.65}, "hostname": "flow-main", "episode_reward_max": -23.704316351502616, "timesteps_this_iter": 37986, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.78001230128905, "cost1_mean": 185.7948093167171, "system_level_velocity_mean": 15.825757176919945, "cost2_mean": -37.24025613397907, "cost2_max": -13.474587556362797, "outflow_rate_max": 1350.3832549664867, "cost1_min": 17.6239960061808, "system_level_velocity_min": 11.975652601604093, "system_level_velocity_max": 18.87613032428756, "outflow_rate_min": 431.75782487237836, "outflow_rate_mean": 1167.0102193747127, "cost2_min": -54.780699788526135}, "episode_len_mean": 318.86, "node_ip": "10.138.0.2", "timesteps_since_restore": 5906934, "time_total_s": 4720.6917905807495, "timestamp": 1558596811, "iterations_since_restore": 167, "policy_reward_mean": {}, "training_iteration": 167, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0390>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0198>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7765, "timesteps_total": 5906934, "episode_reward_mean": -391.362650316587, "episodes_this_iter": 45, "date": "2019-05-23_07-33-31", "time_this_iter_s": 32.16580653190613, "num_metric_batches_dropped": 0, "episode_reward_min": -627.4562861403886}
{"time_since_restore": 4748.815374851227, "info": {"default": {"kl": 0.01598433218896389, "total_loss": 14.220015525817871, "vf_explained_var": 0.8801530003547668, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009463705122470856, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 14.223410606384277, "entropy": 0.9417896270751953}, "num_steps_trained": 5943325, "grad_time_ms": 9892.07, "load_time_ms": 32.832, "sample_time_ms": 19324.157, "num_steps_sampled": 5943325, "update_time_ms": 9.719}, "hostname": "flow-main", "episode_reward_max": -23.704316351502616, "timesteps_this_iter": 36391, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.72370003143735, "cost1_mean": 188.5311608634582, "system_level_velocity_mean": 16.00718324262582, "cost2_mean": -36.09461922895943, "cost2_max": -13.474587556362797, "outflow_rate_max": 1359.152816252735, "cost1_min": 17.6239960061808, "system_level_velocity_min": 11.975652601604093, "system_level_velocity_max": 19.14453506417041, "outflow_rate_min": 431.75782487237836, "outflow_rate_mean": 1176.4926969942042, "cost2_min": -52.80156108760852}, "episode_len_mean": 319.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 5943325, "time_total_s": 4748.815374851227, "timestamp": 1558596839, "iterations_since_restore": 168, "policy_reward_mean": {}, "training_iteration": 168, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0860>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0ac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b22e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7815, "timesteps_total": 5943325, "episode_reward_mean": -382.67179994145476, "episodes_this_iter": 50, "date": "2019-05-23_07-33-59", "time_this_iter_s": 28.123584270477295, "num_metric_batches_dropped": 0, "episode_reward_min": -627.4562861403886}
{"time_since_restore": 4778.279709339142, "info": {"default": {"kl": 0.016655031591653824, "total_loss": 13.337662696838379, "vf_explained_var": 0.8862293362617493, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013036792166531086, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 13.344375610351562, "entropy": 0.9912412166595459}, "num_steps_trained": 5979688, "grad_time_ms": 9998.915, "load_time_ms": 31.16, "sample_time_ms": 19176.863, "num_steps_sampled": 5979688, "update_time_ms": 9.583}, "hostname": "flow-main", "episode_reward_max": -23.704316351502616, "timesteps_this_iter": 36363, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.72370003143735, "cost1_mean": 189.7084830211046, "system_level_velocity_mean": 16.103939918236037, "cost2_mean": -34.74400134117206, "cost2_max": -13.474587556362797, "outflow_rate_max": 1359.152816252735, "cost1_min": 17.6239960061808, "system_level_velocity_min": 12.036568335945748, "system_level_velocity_max": 19.14453506417041, "outflow_rate_min": 431.75782487237836, "outflow_rate_mean": 1181.8772485703116, "cost2_min": -50.1892785537364}, "episode_len_mean": 319.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 5979688, "time_total_s": 4778.279709339142, "timestamp": 1558596869, "iterations_since_restore": 169, "policy_reward_mean": {}, "training_iteration": 169, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491aef0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8490e5c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846def28>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7860, "timesteps_total": 5979688, "episode_reward_mean": -370.5085492758866, "episodes_this_iter": 45, "date": "2019-05-23_07-34-29", "time_this_iter_s": 29.46433448791504, "num_metric_batches_dropped": 0, "episode_reward_min": -544.8594411999404}
{"time_since_restore": 4806.373260736465, "info": {"default": {"kl": 0.014012984931468964, "total_loss": 15.974781036376953, "vf_explained_var": 0.8777446150779724, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010573465377092361, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 15.980032920837402, "entropy": 1.0118945837020874}, "num_steps_trained": 6015430, "grad_time_ms": 9958.752, "load_time_ms": 31.713, "sample_time_ms": 19204.855, "num_steps_sampled": 6015430, "update_time_ms": 8.956}, "hostname": "flow-main", "episode_reward_max": -240.95019614003652, "timesteps_this_iter": 35742, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.0314496915405, "cost1_mean": 190.99021132332007, "system_level_velocity_mean": 15.92448725950327, "cost2_mean": -34.28659520221432, "cost2_max": -18.48039410808282, "outflow_rate_max": 1338.3667869792541, "cost1_min": 138.80102799627105, "system_level_velocity_min": 11.633836895409011, "system_level_velocity_max": 18.706499888995715, "outflow_rate_min": 883.3699118106451, "outflow_rate_mean": 1184.6520309712216, "cost2_min": -50.1892785537364}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6015430, "time_total_s": 4806.373260736465, "timestamp": 1558596897, "iterations_since_restore": 170, "policy_reward_mean": {}, "training_iteration": 170, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846ded30>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de9b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de6d8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7906, "timesteps_total": 6015430, "episode_reward_mean": -375.6817027360349, "episodes_this_iter": 46, "date": "2019-05-23_07-34-57", "time_this_iter_s": 28.09355139732361, "num_metric_batches_dropped": 0, "episode_reward_min": -544.8594411999404}
{"time_since_restore": 4834.7360055446625, "info": {"default": {"kl": 0.016011621803045273, "total_loss": 15.730876922607422, "vf_explained_var": 0.8845681548118591, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012212558649480343, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 15.737009048461914, "entropy": 1.0476137399673462}, "num_steps_trained": 6051422, "grad_time_ms": 9928.131, "load_time_ms": 31.021, "sample_time_ms": 19214.155, "num_steps_sampled": 6051422, "update_time_ms": 8.938}, "hostname": "flow-main", "episode_reward_max": -240.95019614003652, "timesteps_this_iter": 35992, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.0314496915405, "cost1_mean": 192.01068426444763, "system_level_velocity_mean": 16.03733688059627, "cost2_mean": -33.6482840932063, "cost2_max": -21.27039804074694, "outflow_rate_max": 1338.3667869792541, "cost1_min": 138.80102799627105, "system_level_velocity_min": 11.633836895409011, "system_level_velocity_max": 18.706499888995715, "outflow_rate_min": 883.3699118106451, "outflow_rate_mean": 1188.8246231553874, "cost2_min": -47.70425183209586}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6051422, "time_total_s": 4834.7360055446625, "timestamp": 1558596925, "iterations_since_restore": 171, "policy_reward_mean": {}, "training_iteration": 171, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b22b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2908>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b20f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7954, "timesteps_total": 6051422, "episode_reward_mean": -372.34796545879317, "episodes_this_iter": 48, "date": "2019-05-23_07-35-25", "time_this_iter_s": 28.36274480819702, "num_metric_batches_dropped": 0, "episode_reward_min": -528.9448001967934}
{"time_since_restore": 4863.794827461243, "info": {"default": {"kl": 0.015293397009372711, "total_loss": 13.529097557067871, "vf_explained_var": 0.891535758972168, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011125153861939907, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 13.534415245056152, "entropy": 1.0189443826675415}, "num_steps_trained": 6087372, "grad_time_ms": 9957.867, "load_time_ms": 31.723, "sample_time_ms": 19220.662, "num_steps_sampled": 6087372, "update_time_ms": 9.576}, "hostname": "flow-main", "episode_reward_max": -233.533790426261, "timesteps_this_iter": 35950, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.214311756058, "cost1_mean": 190.43812834298632, "system_level_velocity_mean": 15.92155207697914, "cost2_mean": -33.387266213679844, "cost2_max": -19.774682142498513, "outflow_rate_max": 1342.8270334434349, "cost1_min": 151.73583858501672, "system_level_velocity_min": 12.897002037268578, "system_level_velocity_max": 18.8974042301696, "outflow_rate_min": 883.3699118106451, "outflow_rate_mean": 1179.0202839892956, "cost2_min": -47.00846398234631}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6087372, "time_total_s": 4863.794827461243, "timestamp": 1558596954, "iterations_since_restore": 172, "policy_reward_mean": {}, "training_iteration": 172, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6da0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de9b0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 7998, "timesteps_total": 6087372, "episode_reward_mean": -376.953726382898, "episodes_this_iter": 44, "date": "2019-05-23_07-35-54", "time_this_iter_s": 29.0588219165802, "num_metric_batches_dropped": 0, "episode_reward_min": -528.9448001967934}
{"time_since_restore": 4892.7695915699005, "info": {"default": {"kl": 0.01587105542421341, "total_loss": 15.823412895202637, "vf_explained_var": 0.8796467185020447, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010850531049072742, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 15.828237533569336, "entropy": 1.0827349424362183}, "num_steps_trained": 6122484, "grad_time_ms": 9940.602, "load_time_ms": 28.954, "sample_time_ms": 19174.465, "num_steps_sampled": 6122484, "update_time_ms": 9.906}, "hostname": "flow-main", "episode_reward_max": -93.31028252761305, "timesteps_this_iter": 35112, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.4750585533971, "cost1_mean": 189.15773366480053, "system_level_velocity_mean": 15.92499515557703, "cost2_mean": -33.3247223059768, "cost2_max": -19.774682142498513, "outflow_rate_max": 1359.3082242409157, "cost1_min": 84.58360083312694, "system_level_velocity_min": 12.727917677420564, "system_level_velocity_max": 18.8974042301696, "outflow_rate_min": 799.5316000675141, "outflow_rate_mean": 1169.2487994123926, "cost2_min": -46.00317293369351}, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6122484, "time_total_s": 4892.7695915699005, "timestamp": 1558596983, "iterations_since_restore": 173, "policy_reward_mean": {}, "training_iteration": 173, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dea58>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de518>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dec50>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8045, "timesteps_total": 6122484, "episode_reward_mean": -369.28144940540983, "episodes_this_iter": 47, "date": "2019-05-23_07-36-23", "time_this_iter_s": 28.974764108657837, "num_metric_batches_dropped": 0, "episode_reward_min": -528.9448001967934}
{"time_since_restore": 4920.351051568985, "info": {"default": {"kl": 0.01603255420923233, "total_loss": 16.97381591796875, "vf_explained_var": 0.8719581365585327, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011022833175957203, "cur_kl_coeff": 0.37968748807907104, "vf_loss": 16.97875213623047, "entropy": 1.0428944826126099}, "num_steps_trained": 6157274, "grad_time_ms": 10004.125, "load_time_ms": 29.159, "sample_time_ms": 19010.949, "num_steps_sampled": 6157274, "update_time_ms": 9.969}, "hostname": "flow-main", "episode_reward_max": -93.31028252761305, "timesteps_this_iter": 34790, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.46783005388863, "cost1_mean": 188.38605088238256, "system_level_velocity_mean": 15.875196624638395, "cost2_mean": -34.09391772465947, "cost2_max": -20.427697754288584, "outflow_rate_max": 1359.3082242409157, "cost1_min": 84.58360083312694, "system_level_velocity_min": 10.797367524053742, "system_level_velocity_max": 18.964989990392972, "outflow_rate_min": 799.5316000675141, "outflow_rate_mean": 1159.9051289434494, "cost2_min": -46.00317293369351}, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6157274, "time_total_s": 4920.351051568985, "timestamp": 1558597011, "iterations_since_restore": 174, "policy_reward_mean": {}, "training_iteration": 174, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de860>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de1d0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8092, "timesteps_total": 6157274, "episode_reward_mean": -367.1326618046337, "episodes_this_iter": 47, "date": "2019-05-23_07-36-51", "time_this_iter_s": 27.581459999084473, "num_metric_batches_dropped": 0, "episode_reward_min": -529.536345370228}
{"time_since_restore": 4949.146083831787, "info": {"default": {"kl": 0.015458637848496437, "total_loss": 16.660295486450195, "vf_explained_var": 0.8810833692550659, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011172342114150524, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 16.66559600830078, "entropy": 1.078108310699463}, "num_steps_trained": 6193379, "grad_time_ms": 10013.868, "load_time_ms": 27.941, "sample_time_ms": 18874.711, "num_steps_sampled": 6193379, "update_time_ms": 10.11}, "hostname": "flow-main", "episode_reward_max": -29.327280683030978, "timesteps_this_iter": 36105, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.46783005388863, "cost1_mean": 187.30020840672725, "system_level_velocity_mean": 15.83869218500344, "cost2_mean": -34.730388939777434, "cost2_max": -12.668141948077524, "outflow_rate_max": 1347.3586487744803, "cost1_min": 22.88362953630662, "system_level_velocity_min": 10.797367524053742, "system_level_velocity_max": 18.964989990392972, "outflow_rate_min": 492.71989023195596, "outflow_rate_mean": 1159.2816807223217, "cost2_min": -45.99546590200596}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 6193379, "time_total_s": 4949.146083831787, "timestamp": 1558597040, "iterations_since_restore": 175, "policy_reward_mean": {}, "training_iteration": 175, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1320>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c13c8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8138, "timesteps_total": 6193379, "episode_reward_mean": -374.3760873561808, "episodes_this_iter": 46, "date": "2019-05-23_07-37-20", "time_this_iter_s": 28.795032262802124, "num_metric_batches_dropped": 0, "episode_reward_min": -538.3879412067265}
{"time_since_restore": 4976.557165384293, "info": {"default": {"kl": 0.016030235216021538, "total_loss": 17.075725555419922, "vf_explained_var": 0.8776253461837769, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013043261133134365, "cur_kl_coeff": 0.37968748807907104, "vf_loss": 17.08268165588379, "entropy": 1.0566853284835815}, "num_steps_trained": 6227676, "grad_time_ms": 9857.603, "load_time_ms": 28.143, "sample_time_ms": 18821.085, "num_steps_sampled": 6227676, "update_time_ms": 10.158}, "hostname": "flow-main", "episode_reward_max": -29.327280683030978, "timesteps_this_iter": 34297, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.1895450180412, "cost1_mean": 187.0465191226491, "system_level_velocity_mean": 15.98478139881851, "cost2_mean": -34.506022584644185, "cost2_max": -12.668141948077524, "outflow_rate_max": 1346.4789297315924, "cost1_min": 22.88362953630662, "system_level_velocity_min": 12.014008510912241, "system_level_velocity_max": 19.001333517095176, "outflow_rate_min": 492.71989023195596, "outflow_rate_mean": 1161.2979338896369, "cost2_min": -46.18889924803425}, "episode_len_mean": 319.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 6227676, "time_total_s": 4976.557165384293, "timestamp": 1558597067, "iterations_since_restore": 176, "policy_reward_mean": {}, "training_iteration": 176, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0390>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0470>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8185, "timesteps_total": 6227676, "episode_reward_mean": -365.8265218532807, "episodes_this_iter": 47, "date": "2019-05-23_07-37-47", "time_this_iter_s": 27.411081552505493, "num_metric_batches_dropped": 0, "episode_reward_min": -585.6426804691564}
{"time_since_restore": 5005.700387954712, "info": {"default": {"kl": 0.015308203175663948, "total_loss": 15.67142391204834, "vf_explained_var": 0.890570878982544, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009922849014401436, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 15.67553424835205, "entropy": 1.0677496194839478}, "num_steps_trained": 6263227, "grad_time_ms": 9687.745, "load_time_ms": 29.963, "sample_time_ms": 18687.457, "num_steps_sampled": 6263227, "update_time_ms": 9.823}, "hostname": "flow-main", "episode_reward_max": -85.40907850206352, "timesteps_this_iter": 35551, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.7774114387848, "cost1_mean": 187.23809772948871, "system_level_velocity_mean": 15.894567911657946, "cost2_mean": -34.573555752656, "cost2_max": -18.444267734278867, "outflow_rate_max": 1351.876711659127, "cost1_min": 79.90462554225272, "system_level_velocity_min": 12.139080597485544, "system_level_velocity_max": 19.001333517095176, "outflow_rate_min": 761.7785109982733, "outflow_rate_mean": 1159.3348183363328, "cost2_min": -46.92406511340613}, "episode_len_mean": 321.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 6263227, "time_total_s": 5005.700387954712, "timestamp": 1558597096, "iterations_since_restore": 177, "policy_reward_mean": {}, "training_iteration": 177, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1080>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1b00>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c16a0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8232, "timesteps_total": 6263227, "episode_reward_mean": -368.07496048698124, "episodes_this_iter": 47, "date": "2019-05-23_07-38-16", "time_this_iter_s": 29.14322257041931, "num_metric_batches_dropped": 0, "episode_reward_min": -585.6426804691564}
{"time_since_restore": 5033.475408315659, "info": {"default": {"kl": 0.01568850688636303, "total_loss": 17.549259185791016, "vf_explained_var": 0.8847360014915466, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01164033729583025, "cur_kl_coeff": 0.37968748807907104, "vf_loss": 17.55494499206543, "entropy": 1.0763492584228516}, "num_steps_trained": 6297895, "grad_time_ms": 9579.601, "load_time_ms": 29.175, "sample_time_ms": 18762.581, "num_steps_sampled": 6297895, "update_time_ms": 10.111}, "hostname": "flow-main", "episode_reward_max": -22.410200645144542, "timesteps_this_iter": 34668, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 224.04465644651293, "cost1_mean": 184.7150104413493, "system_level_velocity_mean": 15.705399493747558, "cost2_mean": -35.143122899331544, "cost2_max": -11.958875891534577, "outflow_rate_max": 1358.3720261736983, "cost1_min": 17.52988150656835, "system_level_velocity_min": 11.778264535419153, "system_level_velocity_max": 19.058377755321576, "outflow_rate_min": 494.27405165189856, "outflow_rate_mean": 1145.6983849109415, "cost2_min": -48.87666438000657}, "episode_len_mean": 320.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 6297895, "time_total_s": 5033.475408315659, "timestamp": 1558597124, "iterations_since_restore": 178, "policy_reward_mean": {}, "training_iteration": 178, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de390>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de5f8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de0f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8281, "timesteps_total": 6297895, "episode_reward_mean": -372.13394046383934, "episodes_this_iter": 49, "date": "2019-05-23_07-38-44", "time_this_iter_s": 27.775020360946655, "num_metric_batches_dropped": 0, "episode_reward_min": -530.3179853458181}
{"time_since_restore": 5062.354792833328, "info": {"default": {"kl": 0.01623060181736946, "total_loss": 18.512056350708008, "vf_explained_var": 0.8822929263114929, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011483815498650074, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 18.517377853393555, "entropy": 1.1128851175308228}, "num_steps_trained": 6333125, "grad_time_ms": 9416.805, "load_time_ms": 31.121, "sample_time_ms": 18863.479, "num_steps_sampled": 6333125, "update_time_ms": 10.243}, "hostname": "flow-main", "episode_reward_max": -22.410200645144542, "timesteps_this_iter": 35230, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 224.04465644651293, "cost1_mean": 181.79116489877998, "system_level_velocity_mean": 15.686746415368685, "cost2_mean": -35.228388213899166, "cost2_max": -11.958875891534577, "outflow_rate_max": 1358.3720261736983, "cost1_min": 17.52988150656835, "system_level_velocity_min": 11.778264535419153, "system_level_velocity_max": 19.144963211600707, "outflow_rate_min": 494.27405165189856, "outflow_rate_mean": 1135.4920673663073, "cost2_min": -48.87666438000657}, "episode_len_mean": 316.66, "node_ip": "10.138.0.2", "timesteps_since_restore": 6333125, "time_total_s": 5062.354792833328, "timestamp": 1558597153, "iterations_since_restore": 179, "policy_reward_mean": {}, "training_iteration": 179, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6748>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6a20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846bd6a0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8326, "timesteps_total": 6333125, "episode_reward_mean": -369.5591295699725, "episodes_this_iter": 45, "date": "2019-05-23_07-39-13", "time_this_iter_s": 28.879384517669678, "num_metric_batches_dropped": 0, "episode_reward_min": -599.5102278862734}
{"time_since_restore": 5092.332802534103, "info": {"default": {"kl": 0.01578707993030548, "total_loss": 15.178345680236816, "vf_explained_var": 0.8936344385147095, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010595818050205708, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 15.182947158813477, "entropy": 1.0741839408874512}, "num_steps_trained": 6368283, "grad_time_ms": 9683.141, "load_time_ms": 31.026, "sample_time_ms": 18785.501, "num_steps_sampled": 6368283, "update_time_ms": 10.406}, "hostname": "flow-main", "episode_reward_max": -28.90070748859583, "timesteps_this_iter": 35158, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.58550460392962, "cost1_mean": 187.10838675962302, "system_level_velocity_mean": 16.007410746222966, "cost2_mean": -34.81359823788032, "cost2_max": -14.0354287457427, "outflow_rate_max": 1355.447360838488, "cost1_min": 23.089229528760193, "system_level_velocity_min": 11.921934752352541, "system_level_velocity_max": 19.144963211600707, "outflow_rate_min": 503.0853896324088, "outflow_rate_mean": 1156.7091402938868, "cost2_min": -48.77070424909028}, "episode_len_mean": 319.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 6368283, "time_total_s": 5092.332802534103, "timestamp": 1558597183, "iterations_since_restore": 180, "policy_reward_mean": {}, "training_iteration": 180, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7588>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de860>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8372, "timesteps_total": 6368283, "episode_reward_mean": -368.0422128870999, "episodes_this_iter": 46, "date": "2019-05-23_07-39-43", "time_this_iter_s": 29.978009700775146, "num_metric_batches_dropped": 0, "episode_reward_min": -599.5102278862734}
{"time_since_restore": 5120.473200082779, "info": {"default": {"kl": 0.015755318105220795, "total_loss": 15.527304649353027, "vf_explained_var": 0.8908885717391968, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008921272121369839, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 15.530244827270508, "entropy": 1.0249481201171875}, "num_steps_trained": 6403734, "grad_time_ms": 9715.524, "load_time_ms": 33.037, "sample_time_ms": 18727.79, "num_steps_sampled": 6403734, "update_time_ms": 10.488}, "hostname": "flow-main", "episode_reward_max": -223.41196083398788, "timesteps_this_iter": 35451, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.44397918883323, "cost1_mean": 194.22891770000152, "system_level_velocity_mean": 16.33960820086521, "cost2_mean": -34.50257897624447, "cost2_max": -19.2665706344044, "outflow_rate_max": 1355.8323029556655, "cost1_min": 144.56215007619932, "system_level_velocity_min": 12.299472838507615, "system_level_velocity_max": 18.988132682535284, "outflow_rate_min": 883.6291792496528, "outflow_rate_mean": 1191.2753524392344, "cost2_min": -48.77070424909028}, "episode_len_mean": 324.8, "node_ip": "10.138.0.2", "timesteps_since_restore": 6403734, "time_total_s": 5120.473200082779, "timestamp": 1558597211, "iterations_since_restore": 181, "policy_reward_mean": {}, "training_iteration": 181, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dea90>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de940>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dec18>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8420, "timesteps_total": 6403734, "episode_reward_mean": -365.12578036681776, "episodes_this_iter": 48, "date": "2019-05-23_07-40-11", "time_this_iter_s": 28.140397548675537, "num_metric_batches_dropped": 0, "episode_reward_min": -556.9586595960897}
{"time_since_restore": 5148.149788141251, "info": {"default": {"kl": 0.0180539321154356, "total_loss": 14.524381637573242, "vf_explained_var": 0.8862290382385254, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01462414488196373, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 14.532150268554688, "entropy": 1.0226051807403564}, "num_steps_trained": 6439000, "grad_time_ms": 9751.555, "load_time_ms": 33.314, "sample_time_ms": 18553.595, "num_steps_sampled": 6439000, "update_time_ms": 9.829}, "hostname": "flow-main", "episode_reward_max": -145.24667660301463, "timesteps_this_iter": 35266, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.31452999950955, "cost1_mean": 192.67413516755784, "system_level_velocity_mean": 16.26236626789065, "cost2_mean": -33.803603998562636, "cost2_max": -19.2665706344044, "outflow_rate_max": 1355.8323029556655, "cost1_min": 141.4110064577368, "system_level_velocity_min": 12.199054032561348, "system_level_velocity_max": 19.021555400281198, "outflow_rate_min": 841.6957825755654, "outflow_rate_mean": 1184.0506668689993, "cost2_min": -45.88825586818318}, "episode_len_mean": 323.62, "node_ip": "10.138.0.2", "timesteps_since_restore": 6439000, "time_total_s": 5148.149788141251, "timestamp": 1558597239, "iterations_since_restore": 182, "policy_reward_mean": {}, "training_iteration": 182, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b26a0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2a90>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a208>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8465, "timesteps_total": 6439000, "episode_reward_mean": -361.7026380184709, "episodes_this_iter": 45, "date": "2019-05-23_07-40-39", "time_this_iter_s": 27.67658805847168, "num_metric_batches_dropped": 0, "episode_reward_min": -527.4147365037883}
{"time_since_restore": 5176.179460763931, "info": {"default": {"kl": 0.01589963398873806, "total_loss": 16.965835571289062, "vf_explained_var": 0.8792394995689392, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00841354951262474, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 16.96821403503418, "entropy": 1.0333446264266968}, "num_steps_trained": 6474524, "grad_time_ms": 9748.721, "load_time_ms": 32.388, "sample_time_ms": 18464.989, "num_steps_sampled": 6474524, "update_time_ms": 9.556}, "hostname": "flow-main", "episode_reward_max": -22.73993674276663, "timesteps_this_iter": 35524, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.48170213841684, "cost1_mean": 188.3425909978153, "system_level_velocity_mean": 16.072677708515798, "cost2_mean": -33.9665674072963, "cost2_max": -8.450679112982842, "outflow_rate_max": 1355.029128770916, "cost1_min": 17.533054934275572, "system_level_velocity_min": 10.961558741198116, "system_level_velocity_max": 19.039625613458387, "outflow_rate_min": 471.3669816052633, "outflow_rate_mean": 1164.941825324336, "cost2_min": -48.092873897738954}, "episode_len_mean": 319.76, "node_ip": "10.138.0.2", "timesteps_since_restore": 6474524, "time_total_s": 5176.179460763931, "timestamp": 1558597267, "iterations_since_restore": 183, "policy_reward_mean": {}, "training_iteration": 183, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0be0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d08d0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8513, "timesteps_total": 6474524, "episode_reward_mean": -363.46892765744246, "episodes_this_iter": 48, "date": "2019-05-23_07-41-07", "time_this_iter_s": 28.029672622680664, "num_metric_batches_dropped": 0, "episode_reward_min": -525.4159889713741}
{"time_since_restore": 5204.436980962753, "info": {"default": {"kl": 0.019657496362924576, "total_loss": 17.194374084472656, "vf_explained_var": 0.8881192803382874, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01243437360972166, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 17.1993465423584, "entropy": 1.104816198348999}, "num_steps_trained": 6510016, "grad_time_ms": 9839.64, "load_time_ms": 28.99, "sample_time_ms": 18444.322, "num_steps_sampled": 6510016, "update_time_ms": 9.522}, "hostname": "flow-main", "episode_reward_max": -22.73993674276663, "timesteps_this_iter": 35492, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.48170213841684, "cost1_mean": 186.79796194544298, "system_level_velocity_mean": 15.95471880700742, "cost2_mean": -34.14759083289695, "cost2_max": -8.450679112982842, "outflow_rate_max": 1355.029128770916, "cost1_min": 17.533054934275572, "system_level_velocity_min": 10.961558741198116, "system_level_velocity_max": 19.039625613458387, "outflow_rate_min": 471.3669816052633, "outflow_rate_mean": 1160.4138467154642, "cost2_min": -48.092873897738954}, "episode_len_mean": 319.76, "node_ip": "10.138.0.2", "timesteps_since_restore": 6510016, "time_total_s": 5204.436980962753, "timestamp": 1558597295, "iterations_since_restore": 184, "policy_reward_mean": {}, "training_iteration": 184, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0eb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d02e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0860>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8561, "timesteps_total": 6510016, "episode_reward_mean": -370.2402507156816, "episodes_this_iter": 48, "date": "2019-05-23_07-41-35", "time_this_iter_s": 28.25752019882202, "num_metric_batches_dropped": 0, "episode_reward_min": -573.6220490895632}
{"time_since_restore": 5233.18495631218, "info": {"default": {"kl": 0.015813332051038742, "total_loss": 15.268174171447754, "vf_explained_var": 0.8912545442581177, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012385736219584942, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 15.274556159973145, "entropy": 1.0753154754638672}, "num_steps_trained": 6546001, "grad_time_ms": 9814.548, "load_time_ms": 26.773, "sample_time_ms": 18467.089, "num_steps_sampled": 6546001, "update_time_ms": 9.45}, "hostname": "flow-main", "episode_reward_max": -237.2461438986271, "timesteps_this_iter": 35985, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.68374527828104, "cost1_mean": 189.35284078250032, "system_level_velocity_mean": 15.895187752308495, "cost2_mean": -34.61473835353619, "cost2_max": -20.378761897994792, "outflow_rate_max": 1340.7753061224494, "cost1_min": 134.73915859547196, "system_level_velocity_min": 11.298483331895591, "system_level_velocity_max": 18.751571880357297, "outflow_rate_min": 831.2377358490564, "outflow_rate_mean": 1170.41108480193, "cost2_min": -53.6205379871139}, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6546001, "time_total_s": 5233.18495631218, "timestamp": 1558597324, "iterations_since_restore": 185, "policy_reward_mean": {}, "training_iteration": 185, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dee10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de2b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de550>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8605, "timesteps_total": 6546001, "episode_reward_mean": -384.3808184175281, "episodes_this_iter": 44, "date": "2019-05-23_07-42-04", "time_this_iter_s": 28.74797534942627, "num_metric_batches_dropped": 0, "episode_reward_min": -573.6220490895632}
{"time_since_restore": 5261.730823755264, "info": {"default": {"kl": 0.015661142766475677, "total_loss": 15.3226957321167, "vf_explained_var": 0.8925272822380066, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011657671071588993, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 15.328407287597656, "entropy": 1.065481185913086}, "num_steps_trained": 6581281, "grad_time_ms": 9876.389, "load_time_ms": 23.903, "sample_time_ms": 18521.213, "num_steps_sampled": 6581281, "update_time_ms": 9.644}, "hostname": "flow-main", "episode_reward_max": -30.48878029864601, "timesteps_this_iter": 35280, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.63486149159684, "cost1_mean": 187.88339157125938, "system_level_velocity_mean": 15.950434800813484, "cost2_mean": -35.17094655896509, "cost2_max": -9.11036323513959, "outflow_rate_max": 1344.4084919488023, "cost1_min": 22.61915669612863, "system_level_velocity_min": 11.298483331895591, "system_level_velocity_max": 18.901836243786786, "outflow_rate_min": 489.3996304716414, "outflow_rate_mean": 1169.0156291482297, "cost2_min": -53.6205379871139}, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 6581281, "time_total_s": 5261.730823755264, "timestamp": 1558597353, "iterations_since_restore": 186, "policy_reward_mean": {}, "training_iteration": 186, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846deb00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a160>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dec18>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8650, "timesteps_total": 6581281, "episode_reward_mean": -377.0726936310225, "episodes_this_iter": 45, "date": "2019-05-23_07-42-33", "time_this_iter_s": 28.545867443084717, "num_metric_batches_dropped": 0, "episode_reward_min": -643.7841666012121}
{"time_since_restore": 5290.77028465271, "info": {"default": {"kl": 0.016305113211274147, "total_loss": 16.40065574645996, "vf_explained_var": 0.8950129747390747, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01148527767509222, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 16.40595054626465, "entropy": 1.122921109199524}, "num_steps_trained": 6617712, "grad_time_ms": 9873.891, "load_time_ms": 24.717, "sample_time_ms": 18513.474, "num_steps_sampled": 6617712, "update_time_ms": 9.862}, "hostname": "flow-main", "episode_reward_max": -30.48878029864601, "timesteps_this_iter": 36431, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.93034246265307, "cost1_mean": 187.55632237622274, "system_level_velocity_mean": 15.936059689160851, "cost2_mean": -35.62113446016292, "cost2_max": -9.11036323513959, "outflow_rate_max": 1361.6789283056946, "cost1_min": 22.61915669612863, "system_level_velocity_min": 12.21655515889571, "system_level_velocity_max": 18.9936063316271, "outflow_rate_min": 489.3996304716414, "outflow_rate_mean": 1163.263306223863, "cost2_min": -48.00969493130303}, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 6617712, "time_total_s": 5290.77028465271, "timestamp": 1558597382, "iterations_since_restore": 187, "policy_reward_mean": {}, "training_iteration": 187, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d04e0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c1ac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0f28>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8700, "timesteps_total": 6617712, "episode_reward_mean": -380.90202991347246, "episodes_this_iter": 50, "date": "2019-05-23_07-43-02", "time_this_iter_s": 29.03946089744568, "num_metric_batches_dropped": 0, "episode_reward_min": -643.7841666012121}
{"time_since_restore": 5320.330162525177, "info": {"default": {"kl": 0.0173597801476717, "total_loss": 18.20454978942871, "vf_explained_var": 0.8938952088356018, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010970053263008595, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 18.20892906188965, "entropy": 1.2432022094726562}, "num_steps_trained": 6654233, "grad_time_ms": 9939.28, "load_time_ms": 26.345, "sample_time_ms": 18625.165, "num_steps_sampled": 6654233, "update_time_ms": 9.423}, "hostname": "flow-main", "episode_reward_max": -30.48878029864601, "timesteps_this_iter": 36521, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.93034246265307, "cost1_mean": 182.0573464064051, "system_level_velocity_mean": 15.46562355106366, "cost2_mean": -36.012312333960494, "cost2_max": -9.11036323513959, "outflow_rate_max": 1361.6789283056946, "cost1_min": 22.61915669612863, "system_level_velocity_min": 11.677228442314348, "system_level_velocity_max": 18.9936063316271, "outflow_rate_min": 489.3996304716414, "outflow_rate_mean": 1135.5844368214234, "cost2_min": -53.652947222165416}, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 6654233, "time_total_s": 5320.330162525177, "timestamp": 1558597411, "iterations_since_restore": 188, "policy_reward_mean": {}, "training_iteration": 188, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b73c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7e48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7438>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8746, "timesteps_total": 6654233, "episode_reward_mean": -407.63092536352406, "episodes_this_iter": 46, "date": "2019-05-23_07-43-31", "time_this_iter_s": 29.55987787246704, "num_metric_batches_dropped": 0, "episode_reward_min": -629.3748859268321}
{"time_since_restore": 5349.068542957306, "info": {"default": {"kl": 0.017907656729221344, "total_loss": 17.71891212463379, "vf_explained_var": 0.9000818729400635, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012784824706614017, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 17.724899291992188, "entropy": 1.2013226747512817}, "num_steps_trained": 6690566, "grad_time_ms": 9925.376, "load_time_ms": 27.626, "sample_time_ms": 18624.951, "num_steps_sampled": 6690566, "update_time_ms": 9.314}, "hostname": "flow-main", "episode_reward_max": -30.547712875814863, "timesteps_this_iter": 36333, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 223.36603805241435, "cost1_mean": 181.34426753937245, "system_level_velocity_mean": 15.400737119066152, "cost2_mean": -35.8979602501491, "cost2_max": -14.240752155209767, "outflow_rate_max": 1360.3304193151123, "cost1_min": 22.97123587977715, "system_level_velocity_min": 11.677228442314348, "system_level_velocity_max": 18.976777426771655, "outflow_rate_min": 471.8345490104016, "outflow_rate_mean": 1133.5016728918595, "cost2_min": -56.219398583280714}, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 6690566, "time_total_s": 5349.068542957306, "timestamp": 1558597440, "iterations_since_restore": 189, "policy_reward_mean": {}, "training_iteration": 189, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492ab70>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a7b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8492a0b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8791, "timesteps_total": 6690566, "episode_reward_mean": -412.0110450786419, "episodes_this_iter": 45, "date": "2019-05-23_07-44-00", "time_this_iter_s": 28.738380432128906, "num_metric_batches_dropped": 0, "episode_reward_min": -629.3748859268321}
{"time_since_restore": 5377.721199989319, "info": {"default": {"kl": 0.016343142837285995, "total_loss": 21.565391540527344, "vf_explained_var": 0.8820950388908386, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012516743503510952, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 21.571704864501953, "entropy": 1.2936069965362549}, "num_steps_trained": 6727281, "grad_time_ms": 9691.494, "load_time_ms": 27.211, "sample_time_ms": 18726.195, "num_steps_sampled": 6727281, "update_time_ms": 9.445}, "hostname": "flow-main", "episode_reward_max": -30.547712875814863, "timesteps_this_iter": 36715, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 223.36603805241435, "cost1_mean": 178.48613088346684, "system_level_velocity_mean": 15.245461208927713, "cost2_mean": -36.74459225349213, "cost2_max": -14.240752155209767, "outflow_rate_max": 1360.3304193151123, "cost1_min": 22.97123587977715, "system_level_velocity_min": 11.179107397631398, "system_level_velocity_max": 18.976777426771655, "outflow_rate_min": 471.8345490104016, "outflow_rate_mean": 1123.300737521542, "cost2_min": -56.219398583280714}, "episode_len_mean": 320.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 6727281, "time_total_s": 5377.721199989319, "timestamp": 1558597469, "iterations_since_restore": 190, "policy_reward_mean": {}, "training_iteration": 190, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b79b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b7a20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b73c8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8838, "timesteps_total": 6727281, "episode_reward_mean": -416.02276699365, "episodes_this_iter": 47, "date": "2019-05-23_07-44-29", "time_this_iter_s": 28.65265703201294, "num_metric_batches_dropped": 0, "episode_reward_min": -709.3752098346522}
{"time_since_restore": 5406.769960165024, "info": {"default": {"kl": 0.015405762940645218, "total_loss": 19.739835739135742, "vf_explained_var": 0.8848140239715576, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011218130588531494, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 19.74520492553711, "entropy": 1.1007225513458252}, "num_steps_trained": 6763485, "grad_time_ms": 9713.751, "load_time_ms": 27.733, "sample_time_ms": 18795.154, "num_steps_sampled": 6763485, "update_time_ms": 9.388}, "hostname": "flow-main", "episode_reward_max": -93.6572969464794, "timesteps_this_iter": 36204, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.47805730871627, "cost1_mean": 181.18226043951395, "system_level_velocity_mean": 15.286049208197468, "cost2_mean": -36.38112773268565, "cost2_max": -20.024834078070224, "outflow_rate_max": 1356.078313377374, "cost1_min": 84.81979754793528, "system_level_velocity_min": 11.179107397631398, "system_level_velocity_max": 19.082039874855383, "outflow_rate_min": 803.8559519919997, "outflow_rate_mean": 1131.5663026717482, "cost2_min": -49.357591072074364}, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6763485, "time_total_s": 5406.769960165024, "timestamp": 1558597498, "iterations_since_restore": 191, "policy_reward_mean": {}, "training_iteration": 191, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846c6a20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dfd68>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8886, "timesteps_total": 6763485, "episode_reward_mean": -412.59828833895847, "episodes_this_iter": 48, "date": "2019-05-23_07-44-58", "time_this_iter_s": 29.048760175704956, "num_metric_batches_dropped": 0, "episode_reward_min": -709.3752098346522}
{"time_since_restore": 5437.097923994064, "info": {"default": {"kl": 0.015725834295153618, "total_loss": 17.041353225708008, "vf_explained_var": 0.8949068784713745, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009916163980960846, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 17.045299530029297, "entropy": 1.1029759645462036}, "num_steps_trained": 6800519, "grad_time_ms": 9710.911, "load_time_ms": 25.848, "sample_time_ms": 19064.182, "num_steps_sampled": 6800519, "update_time_ms": 9.463}, "hostname": "flow-main", "episode_reward_max": -21.629386679094235, "timesteps_this_iter": 37034, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 223.72037155294353, "cost1_mean": 182.32979198665052, "system_level_velocity_mean": 15.670604386273395, "cost2_mean": -35.46380103618027, "cost2_max": -12.169672288177146, "outflow_rate_max": 1359.7667088278242, "cost1_min": 17.898656882896354, "system_level_velocity_min": 12.203101742321401, "system_level_velocity_max": 19.17378037178246, "outflow_rate_min": 494.27405165189856, "outflow_rate_mean": 1144.6649740484143, "cost2_min": -54.0345317960639}, "episode_len_mean": 317.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 6800519, "time_total_s": 5437.097923994064, "timestamp": 1558597528, "iterations_since_restore": 192, "policy_reward_mean": {}, "training_iteration": 192, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846de160>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846deac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846deb00>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8932, "timesteps_total": 6800519, "episode_reward_mean": -396.39272332958456, "episodes_this_iter": 46, "date": "2019-05-23_07-45-28", "time_this_iter_s": 30.327963829040527, "num_metric_batches_dropped": 0, "episode_reward_min": -663.6820904573194}
{"time_since_restore": 5466.352450370789, "info": {"default": {"kl": 0.017064712941646576, "total_loss": 15.895207405090332, "vf_explained_var": 0.902820348739624, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012396924197673798, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 15.901126861572266, "entropy": 1.0877310037612915}, "num_steps_trained": 6837420, "grad_time_ms": 9748.646, "load_time_ms": 26.872, "sample_time_ms": 19146.824, "num_steps_sampled": 6837420, "update_time_ms": 9.715}, "hostname": "flow-main", "episode_reward_max": -21.629386679094235, "timesteps_this_iter": 36901, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 223.72037155294353, "cost1_mean": 185.265480151539, "system_level_velocity_mean": 15.791182304173923, "cost2_mean": -35.4404616366482, "cost2_max": -12.169672288177146, "outflow_rate_max": 1359.7667088278242, "cost1_min": 17.898656882896354, "system_level_velocity_min": 12.245362872053239, "system_level_velocity_max": 19.17378037178246, "outflow_rate_min": 494.27405165189856, "outflow_rate_mean": 1160.2347457817364, "cost2_min": -54.0345317960639}, "episode_len_mean": 319.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 6837420, "time_total_s": 5466.352450370789, "timestamp": 1558597558, "iterations_since_restore": 193, "policy_reward_mean": {}, "training_iteration": 193, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0cf8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0dd8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8491a160>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 8978, "timesteps_total": 6837420, "episode_reward_mean": -398.96132103798436, "episodes_this_iter": 46, "date": "2019-05-23_07-45-58", "time_this_iter_s": 29.254526376724243, "num_metric_batches_dropped": 0, "episode_reward_min": -663.6820904573194}
{"time_since_restore": 5495.536909103394, "info": {"default": {"kl": 0.016263816505670547, "total_loss": 17.19451141357422, "vf_explained_var": 0.891650378704071, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012030422687530518, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 17.200366973876953, "entropy": 1.0977221727371216}, "num_steps_trained": 6874592, "grad_time_ms": 9751.447, "load_time_ms": 30.591, "sample_time_ms": 19232.256, "num_steps_sampled": 6874592, "update_time_ms": 9.845}, "hostname": "flow-main", "episode_reward_max": -21.629386679094235, "timesteps_this_iter": 37172, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.32418889313973, "cost1_mean": 186.0507997128047, "system_level_velocity_mean": 15.737928227696676, "cost2_mean": -35.80653076075559, "cost2_max": -12.169672288177146, "outflow_rate_max": 1360.4687916322594, "cost1_min": 17.898656882896354, "system_level_velocity_min": 11.677263668473746, "system_level_velocity_max": 19.072557173874653, "outflow_rate_min": 494.27405165189856, "outflow_rate_mean": 1161.290103598737, "cost2_min": -54.0345317960639}, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 6874592, "time_total_s": 5495.536909103394, "timestamp": 1558597587, "iterations_since_restore": 194, "policy_reward_mean": {}, "training_iteration": 194, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dfef0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df6d8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 9026, "timesteps_total": 6874592, "episode_reward_mean": -404.0525965884104, "episodes_this_iter": 48, "date": "2019-05-23_07-46-27", "time_this_iter_s": 29.18445873260498, "num_metric_batches_dropped": 0, "episode_reward_min": -615.1628132228275}
{"time_since_restore": 5526.136004924774, "info": {"default": {"kl": 0.01758303865790367, "total_loss": 16.951236724853516, "vf_explained_var": 0.9030990600585938, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010889096185564995, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 16.9554500579834, "entropy": 1.1872494220733643}, "num_steps_trained": 6912085, "grad_time_ms": 9827.975, "load_time_ms": 32.172, "sample_time_ms": 19338.306, "num_steps_sampled": 6912085, "update_time_ms": 9.925}, "hostname": "flow-main", "episode_reward_max": -31.62821099066445, "timesteps_this_iter": 37493, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.32418889313973, "cost1_mean": 182.66845172434313, "system_level_velocity_mean": 15.596271061681058, "cost2_mean": -36.14664963751112, "cost2_max": -14.04662740780633, "outflow_rate_max": 1360.4687916322594, "cost1_min": 24.203346975058377, "system_level_velocity_min": 11.677263668473746, "system_level_velocity_max": 19.072557173874653, "outflow_rate_min": 477.1055332935651, "outflow_rate_mean": 1145.6749310768087, "cost2_min": -50.58233922880014}, "episode_len_mean": 320.04, "node_ip": "10.138.0.2", "timesteps_since_restore": 6912085, "time_total_s": 5526.136004924774, "timestamp": 1558597617, "iterations_since_restore": 195, "policy_reward_mean": {}, "training_iteration": 195, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dfcc0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dff60>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df240>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 9072, "timesteps_total": 6912085, "episode_reward_mean": -410.1748942200627, "episodes_this_iter": 46, "date": "2019-05-23_07-46-57", "time_this_iter_s": 30.599095821380615, "num_metric_batches_dropped": 0, "episode_reward_min": -641.4473878243768}
{"time_since_restore": 5554.319758892059, "info": {"default": {"kl": 0.01598191447556019, "total_loss": 15.63133716583252, "vf_explained_var": 0.8978363275527954, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01204526424407959, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 15.63731575012207, "entropy": 1.1101069450378418}, "num_steps_trained": 6948252, "grad_time_ms": 9858.219, "load_time_ms": 32.404, "sample_time_ms": 19268.446, "num_steps_sampled": 6948252, "update_time_ms": 9.92}, "hostname": "flow-main", "episode_reward_max": -31.62821099066445, "timesteps_this_iter": 36167, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.68999745214668, "cost1_mean": 184.03694337166937, "system_level_velocity_mean": 15.729566130057458, "cost2_mean": -35.004331894163656, "cost2_max": -14.04662740780633, "outflow_rate_max": 1356.007264938615, "cost1_min": 24.203346975058377, "system_level_velocity_min": 12.213140365459228, "system_level_velocity_max": 18.97939896092151, "outflow_rate_min": 477.1055332935651, "outflow_rate_mean": 1149.9150745527222, "cost2_min": -50.58233922880014}, "episode_len_mean": 319.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 6948252, "time_total_s": 5554.319758892059, "timestamp": 1558597646, "iterations_since_restore": 196, "policy_reward_mean": {}, "training_iteration": 196, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df7b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df198>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dfa58>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 9119, "timesteps_total": 6948252, "episode_reward_mean": -401.18576635381004, "episodes_this_iter": 47, "date": "2019-05-23_07-47-26", "time_this_iter_s": 28.183753967285156, "num_metric_batches_dropped": 0, "episode_reward_min": -641.4473878243768}
{"time_since_restore": 5582.918256521225, "info": {"default": {"kl": 0.017226247116923332, "total_loss": 16.164630889892578, "vf_explained_var": 0.8914539217948914, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010231555439531803, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 16.168319702148438, "entropy": 1.0596256256103516}, "num_steps_trained": 6985329, "grad_time_ms": 9862.75, "load_time_ms": 29.625, "sample_time_ms": 19223.624, "num_steps_sampled": 6985329, "update_time_ms": 9.705}, "hostname": "flow-main", "episode_reward_max": -31.62821099066445, "timesteps_this_iter": 37077, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.68999745214668, "cost1_mean": 185.0237189861099, "system_level_velocity_mean": 15.783628570443414, "cost2_mean": -34.67880185586884, "cost2_max": -14.04662740780633, "outflow_rate_max": 1356.007264938615, "cost1_min": 24.203346975058377, "system_level_velocity_min": 12.534806686655326, "system_level_velocity_max": 18.96377514489672, "outflow_rate_min": 477.1055332935651, "outflow_rate_mean": 1157.4420460645044, "cost2_min": -50.47049533153403}, "episode_len_mean": 319.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 6985329, "time_total_s": 5582.918256521225, "timestamp": 1558597674, "iterations_since_restore": 197, "policy_reward_mean": {}, "training_iteration": 197, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df5f8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846dfda0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df7f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 9166, "timesteps_total": 6985329, "episode_reward_mean": -393.73200343728087, "episodes_this_iter": 47, "date": "2019-05-23_07-47-54", "time_this_iter_s": 28.59849762916565, "num_metric_batches_dropped": 0, "episode_reward_min": -599.4567148222778}
{"time_since_restore": 5614.127423524857, "info": {"default": {"kl": 0.015831539407372475, "total_loss": 13.264883041381836, "vf_explained_var": 0.9078242182731628, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011751020327210426, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 13.270622253417969, "entropy": 1.0538177490234375}, "num_steps_trained": 7021648, "grad_time_ms": 10080.369, "load_time_ms": 26.792, "sample_time_ms": 19156.214, "num_steps_sampled": 7021648, "update_time_ms": 9.672}, "hostname": "flow-main", "episode_reward_max": -151.28890671519497, "timesteps_this_iter": 36319, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 221.91183018242438, "cost1_mean": 187.38687528496538, "system_level_velocity_mean": 15.738802179385111, "cost2_mean": -35.55999769438139, "cost2_max": -21.0906818500249, "outflow_rate_max": 1355.275739058629, "cost1_min": 141.8727551624635, "system_level_velocity_min": 12.534806686655326, "system_level_velocity_max": 18.908015764217005, "outflow_rate_min": 863.0068584905661, "outflow_rate_mean": 1168.1717757389415, "cost2_min": -48.738783300218934}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 7021648, "time_total_s": 5614.127423524857, "timestamp": 1558597706, "iterations_since_restore": 198, "policy_reward_mean": {}, "training_iteration": 198, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2f98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846b2ef0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 9212, "timesteps_total": 7021648, "episode_reward_mean": -397.2036274474703, "episodes_this_iter": 46, "date": "2019-05-23_07-48-26", "time_this_iter_s": 31.209167003631592, "num_metric_batches_dropped": 0, "episode_reward_min": -599.4567148222778}
{"time_since_restore": 5662.768760919571, "info": {"default": {"kl": 0.016934633255004883, "total_loss": 14.249968528747559, "vf_explained_var": 0.9065372943878174, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011717314831912518, "cur_kl_coeff": 0.3796875476837158, "vf_loss": 14.255253791809082, "entropy": 1.1037229299545288}, "num_steps_trained": 7058207, "grad_time_ms": 10555.533, "load_time_ms": 24.824, "sample_time_ms": 20660.931, "num_steps_sampled": 7058207, "update_time_ms": 13.17}, "hostname": "flow-main", "episode_reward_max": -151.28890671519497, "timesteps_this_iter": 36559, "pid": 20300, "done": false, "custom_metrics": {"cost1_max": 222.48572110825415, "cost1_mean": 187.136743280314, "system_level_velocity_mean": 15.70526786035339, "cost2_mean": -35.682509353738666, "cost2_max": -17.756738483108748, "outflow_rate_max": 1355.275739058629, "cost1_min": 133.8485743265363, "system_level_velocity_min": 11.30641793427962, "system_level_velocity_max": 18.948275038193145, "outflow_rate_min": 858.8772177390556, "outflow_rate_mean": 1165.3711834156582, "cost2_min": -48.738783300218934}, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 7058207, "time_total_s": 5662.768760919571, "timestamp": 1558597754, "iterations_since_restore": 199, "policy_reward_mean": {}, "training_iteration": 199, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df470>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df1d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df4e0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 9256, "timesteps_total": 7058207, "episode_reward_mean": -392.68419332639974, "episodes_this_iter": 44, "date": "2019-05-23_07-49-14", "time_this_iter_s": 48.641337394714355, "num_metric_batches_dropped": 0, "episode_reward_min": -640.0879195021253}
{"time_since_restore": 5692.816664218903, "info": {"default": {"kl": 0.017862016335129738, "total_loss": 16.3278751373291, "vf_explained_var": 0.8990490436553955, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011966811493039131, "cur_kl_coeff": 0.37968751788139343, "vf_loss": 16.333057403564453, "entropy": 1.099622130393982}, "num_steps_trained": 7094390, "grad_time_ms": 10476.112, "load_time_ms": 24.483, "sample_time_ms": 20880.631, "num_steps_sampled": 7094390, "update_time_ms": 14.151}, "hostname": "flow-main", "episode_reward_max": -29.855787389128473, "timesteps_this_iter": 36183, "pid": 20300, "done": true, "custom_metrics": {"cost1_max": 222.48572110825415, "cost1_mean": 182.6229778558463, "system_level_velocity_mean": 15.548377542730618, "cost2_mean": -34.515099726677796, "cost2_max": -12.581297260329565, "outflow_rate_max": 1344.6125621722551, "cost1_min": 22.79560790924309, "system_level_velocity_min": 11.30641793427962, "system_level_velocity_max": 19.047109364226113, "outflow_rate_min": 487.27071284982367, "outflow_rate_mean": 1145.4397087656728, "cost2_min": -47.29274022618084}, "episode_len_mean": 319.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 7094390, "time_total_s": 5692.816664218903, "timestamp": 1558597784, "iterations_since_restore": 200, "policy_reward_mean": {}, "training_iteration": 200, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "entropy_coeff": 0.0, "num_envs_per_worker": 1, "vf_share_layers": false, "num_cpus_for_driver": 1, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0080>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d0400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84961198>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 3", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "dim": 84, "framestack": true, "zero_mean": true, "max_seq_len": 20, "conv_activation": "relu", "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "squash_to_range": false, "free_log_std": false, "use_lstm": false, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "fcnet_activation": "tanh", "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "4977d044f4e84bcbba1f82390d54a6c6", "episodes_total": 9307, "timesteps_total": 7094390, "episode_reward_mean": -395.41915359219973, "episodes_this_iter": 51, "date": "2019-05-23_07-49-44", "time_this_iter_s": 30.047903299331665, "num_metric_batches_dropped": 0, "episode_reward_min": -640.0879195021253}

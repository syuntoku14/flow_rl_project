{"time_since_restore": 32.34457302093506, "info": {"default": {"kl": 0.0024328099098056555, "entropy": 1.4136890172958374, "total_loss": 36.90430450439453, "vf_explained_var": -3.602607193897711e-06, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008307340904138982, "cur_kl_coeff": 0.20000003278255463, "vf_loss": 36.90464401245117}, "num_steps_trained": 41756, "grad_time_ms": 11690.022, "num_steps_sampled": 41756, "sample_time_ms": 19674.484, "load_time_ms": 89.581, "update_time_ms": 754.805}, "hostname": "flow-main", "episode_reward_max": -21.598128081962397, "timesteps_this_iter": 41756, "custom_metrics": {"cost1_max": 138.74113951505802, "cost1_mean": 117.2054811909551, "system_level_velocity_mean": 10.172753219355346, "cost2_mean": -25.360903005207824, "cost2_max": -10.838970454483611, "outflow_rate_max": 881.6898815331012, "cost1_min": 18.532131033451467, "system_level_velocity_min": 8.526605266847067, "system_level_velocity_max": 18.13504520038229, "outflow_rate_min": 421.32445161290326, "cost2_min": -39.94729181339892, "outflow_rate_mean": 710.6728883213691}, "done": false, "pid": 51582, "episode_len_mean": 317.7560975609756, "node_ip": "10.138.0.2", "timesteps_since_restore": 41756, "time_total_s": 32.34457302093506, "timestamp": 1558602821, "iterations_since_restore": 1, "policy_reward_mean": {}, "training_iteration": 1, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468d4a8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468de80>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468d9e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 41, "timesteps_total": 41756, "episode_reward_mean": -695.799840502144, "episodes_this_iter": 41, "date": "2019-05-23_09-13-41", "time_this_iter_s": 32.34457302093506, "num_metric_batches_dropped": 0, "episode_reward_min": -1005.7372389916932}
{"time_since_restore": 61.068068742752075, "info": {"default": {"kl": 0.007526183035224676, "entropy": 1.4093525409698486, "total_loss": 62.329437255859375, "vf_explained_var": -4.5211368160380516e-07, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0029602774884551764, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 62.33164978027344}, "num_steps_trained": 81601, "grad_time_ms": 10926.631, "num_steps_sampled": 81601, "sample_time_ms": 19066.835, "load_time_ms": 48.335, "update_time_ms": 381.518}, "hostname": "flow-main", "episode_reward_max": -21.598128081962397, "timesteps_this_iter": 39845, "custom_metrics": {"cost1_max": 145.98215242253352, "cost1_mean": 121.11644410985555, "system_level_velocity_mean": 10.312105869339826, "cost2_mean": -24.799066136988436, "cost2_max": -10.838970454483611, "outflow_rate_max": 923.5528908436625, "cost1_min": 18.532131033451467, "system_level_velocity_min": 8.526605266847067, "system_level_velocity_max": 18.13504520038229, "outflow_rate_min": 421.32445161290326, "cost2_min": -43.50843099490784, "outflow_rate_mean": 734.3653986159719}, "done": false, "pid": 51582, "episode_len_mean": 321.3333333333333, "node_ip": "10.138.0.2", "timesteps_since_restore": 81601, "time_total_s": 61.068068742752075, "timestamp": 1558602849, "iterations_since_restore": 2, "policy_reward_mean": {}, "training_iteration": 2, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84693e80>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846720f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846933c8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 81, "timesteps_total": 81601, "episode_reward_mean": -673.2639299870518, "episodes_this_iter": 40, "date": "2019-05-23_09-14-09", "time_this_iter_s": 28.723495721817017, "num_metric_batches_dropped": 0, "episode_reward_min": -1005.7372389916932}
{"time_since_restore": 90.78682804107666, "info": {"default": {"kl": 0.0028954888693988323, "entropy": 1.4190007448196411, "total_loss": 87.1024169921875, "vf_explained_var": -1.2031307505822042e-07, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0011838614009320736, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 87.10330963134766}, "num_steps_trained": 123135, "grad_time_ms": 10896.153, "num_steps_sampled": 123135, "sample_time_ms": 18974.078, "load_time_ms": 34.151, "update_time_ms": 257.184}, "hostname": "flow-main", "episode_reward_max": -21.598128081962397, "timesteps_this_iter": 41534, "custom_metrics": {"cost1_max": 161.10929529910587, "cost1_mean": 126.3443603121845, "system_level_velocity_mean": 10.708697636612701, "cost2_mean": -24.732673442482007, "cost2_max": -11.352236289107484, "outflow_rate_max": 1093.1852729345812, "cost1_min": 18.532131033451467, "system_level_velocity_min": 8.711742783031346, "system_level_velocity_max": 18.13504520038229, "outflow_rate_min": 421.32445161290326, "cost2_min": -43.50843099490784, "outflow_rate_mean": 780.3861900693406}, "done": false, "pid": 51582, "episode_len_mean": 322.03, "node_ip": "10.138.0.2", "timesteps_since_restore": 123135, "time_total_s": 90.78682804107666, "timestamp": 1558602879, "iterations_since_restore": 3, "policy_reward_mean": {}, "training_iteration": 3, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9cf8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9e48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9a90>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 121, "timesteps_total": 123135, "episode_reward_mean": -639.8293749491489, "episodes_this_iter": 40, "date": "2019-05-23_09-14-39", "time_this_iter_s": 29.718759298324585, "num_metric_batches_dropped": 0, "episode_reward_min": -957.6682351316349}
{"time_since_restore": 125.21658563613892, "info": {"default": {"kl": 0.003708263859152794, "entropy": 1.4096218347549438, "total_loss": 112.08487701416016, "vf_explained_var": -1.485355394237331e-08, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000883671804331243, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 112.08558654785156}, "num_steps_trained": 163309, "grad_time_ms": 11309.324, "num_steps_sampled": 163309, "sample_time_ms": 19676.25, "load_time_ms": 26.815, "update_time_ms": 195.211}, "hostname": "flow-main", "episode_reward_max": -28.33968158534505, "timesteps_this_iter": 40174, "custom_metrics": {"cost1_max": 186.67199717800509, "cost1_mean": 144.4867469039054, "system_level_velocity_mean": 12.143502893884794, "cost2_mean": -30.078931616639192, "cost2_max": -14.875801402396597, "outflow_rate_max": 1160.1517496706674, "cost1_min": 23.099559268107242, "system_level_velocity_min": 9.045381859357594, "system_level_velocity_max": 18.59843359907108, "outflow_rate_min": 495.7616787626828, "cost2_min": -53.66669992526167, "outflow_rate_mean": 926.1519678244638}, "done": false, "pid": 51582, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 163309, "time_total_s": 125.21658563613892, "timestamp": 1558602914, "iterations_since_restore": 4, "policy_reward_mean": {}, "training_iteration": 4, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2ba8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f25f8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2978>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 182, "timesteps_total": 163309, "episode_reward_mean": -581.8852655783876, "episodes_this_iter": 61, "date": "2019-05-23_09-15-14", "time_this_iter_s": 34.429757595062256, "num_metric_batches_dropped": 0, "episode_reward_min": -884.0894393428318}
{"time_since_restore": 153.98770403862, "info": {"default": {"kl": 0.017278047278523445, "entropy": 1.4137409925460815, "total_loss": 100.57772827148438, "vf_explained_var": -2.2806922572726762e-08, "cur_lr": 0.0005000000237487257, "policy_loss": -0.003015089314430952, "cur_kl_coeff": 0.02500000409781933, "vf_loss": 100.58030700683594}, "num_steps_trained": 203129, "grad_time_ms": 11324.918, "num_steps_sampled": 203129, "sample_time_ms": 19197.609, "load_time_ms": 22.825, "update_time_ms": 158.364}, "hostname": "flow-main", "episode_reward_max": -28.33968158534505, "timesteps_this_iter": 39820, "custom_metrics": {"cost1_max": 186.67199717800509, "cost1_mean": 153.33368639238338, "system_level_velocity_mean": 12.841713587980555, "cost2_mean": -31.83119685408242, "cost2_max": -14.875801402396597, "outflow_rate_max": 1160.1517496706674, "cost1_min": 23.099559268107242, "system_level_velocity_min": 9.12451243199061, "system_level_velocity_max": 18.59843359907108, "outflow_rate_min": 495.7616787626828, "cost2_min": -53.66669992526167, "outflow_rate_mean": 992.3702996531906}, "done": false, "pid": 51582, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 203129, "time_total_s": 153.98770403862, "timestamp": 1558602942, "iterations_since_restore": 5, "policy_reward_mean": {}, "training_iteration": 5, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849067b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9550>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a97b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 222, "timesteps_total": 203129, "episode_reward_mean": -549.3990120212054, "episodes_this_iter": 40, "date": "2019-05-23_09-15-42", "time_this_iter_s": 28.77111840248108, "num_metric_batches_dropped": 0, "episode_reward_min": -884.0894393428318}
{"time_since_restore": 181.97701740264893, "info": {"default": {"kl": 0.011605127714574337, "entropy": 1.4075500965118408, "total_loss": 101.43185424804688, "vf_explained_var": -1.9478642310222227e-10, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0037019674200564623, "cur_kl_coeff": 0.02500000409781933, "vf_loss": 101.43526458740234}, "num_steps_trained": 242316, "grad_time_ms": 11200.023, "num_steps_sampled": 242316, "sample_time_ms": 18881.355, "load_time_ms": 19.855, "update_time_ms": 133.862}, "hostname": "flow-main", "episode_reward_max": -28.33968158534505, "timesteps_this_iter": 39187, "custom_metrics": {"cost1_max": 191.7117700596981, "cost1_mean": 158.23089869478787, "system_level_velocity_mean": 13.278597040101024, "cost2_mean": -31.65771652698437, "cost2_max": -14.875801402396597, "outflow_rate_max": 1230.3015681367544, "cost1_min": 23.099559268107242, "system_level_velocity_min": 9.12451243199061, "system_level_velocity_max": 18.59843359907108, "outflow_rate_min": 495.7616787626828, "cost2_min": -46.461723764874634, "outflow_rate_mean": 1017.0939203106875}, "done": false, "pid": 51582, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 242316, "time_total_s": 181.97701740264893, "timestamp": 1558602970, "iterations_since_restore": 6, "policy_reward_mean": {}, "training_iteration": 6, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906b00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906780>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849068d0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 262, "timesteps_total": 242316, "episode_reward_mean": -517.3668071553618, "episodes_this_iter": 40, "date": "2019-05-23_09-16-10", "time_this_iter_s": 27.98931336402893, "num_metric_batches_dropped": 0, "episode_reward_min": -868.4498106033888}
{"time_since_restore": 212.31954622268677, "info": {"default": {"kl": 0.004630784969776869, "entropy": 1.4075349569320679, "total_loss": 43.24543380737305, "vf_explained_var": 0.575356125831604, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0005027643055655062, "cur_kl_coeff": 0.02500000409781933, "vf_loss": 43.245819091796875}, "num_steps_trained": 281621, "grad_time_ms": 11120.005, "num_steps_sampled": 281621, "sample_time_ms": 18984.467, "load_time_ms": 17.97, "update_time_ms": 116.316}, "hostname": "flow-main", "episode_reward_max": -312.29509683876387, "timesteps_this_iter": 39305, "custom_metrics": {"cost1_max": 209.84475698537267, "cost1_mean": 172.72399567155307, "system_level_velocity_mean": 14.358150339120902, "cost2_mean": -36.63485417114266, "cost2_max": -17.60519906694217, "outflow_rate_max": 1324.9290886612857, "cost1_min": 127.01405478426696, "system_level_velocity_min": 10.63443210851161, "system_level_velocity_max": 17.523665089526183, "outflow_rate_min": 796.566304945055, "cost2_min": -69.75312918056403, "outflow_rate_mean": 1102.7709173272037}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 281621, "time_total_s": 212.31954622268677, "timestamp": 1558603001, "iterations_since_restore": 7, "policy_reward_mean": {}, "training_iteration": 7, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9080>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9a20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9da0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 322, "timesteps_total": 281621, "episode_reward_mean": -466.4321667855267, "episodes_this_iter": 60, "date": "2019-05-23_09-16-41", "time_this_iter_s": 30.342528820037842, "num_metric_batches_dropped": 0, "episode_reward_min": -713.7140089427733}
{"time_since_restore": 242.09910225868225, "info": {"default": {"kl": 0.007422673515975475, "entropy": 1.3953166007995605, "total_loss": 28.058042526245117, "vf_explained_var": 0.7853299379348755, "cur_lr": 0.0005000000237487257, "policy_loss": -0.002071603201329708, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 28.06001853942871}, "num_steps_trained": 321916, "grad_time_ms": 11054.206, "num_steps_sampled": 321916, "sample_time_ms": 18995.766, "load_time_ms": 16.437, "update_time_ms": 102.831}, "hostname": "flow-main", "episode_reward_max": -312.29509683876387, "timesteps_this_iter": 40295, "custom_metrics": {"cost1_max": 209.84475698537267, "cost1_mean": 179.58683924475199, "system_level_velocity_mean": 14.907889361109333, "cost2_mean": -42.218824817333534, "cost2_max": -25.53459063683512, "outflow_rate_max": 1324.9290886612857, "cost1_min": 135.3132609344145, "system_level_velocity_min": 11.099726829661565, "system_level_velocity_max": 17.523665089526183, "outflow_rate_min": 909.6550846776761, "cost2_min": -70.73838991618254, "outflow_rate_mean": 1152.4713491914054}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 321916, "time_total_s": 242.09910225868225, "timestamp": 1558603031, "iterations_since_restore": 8, "policy_reward_mean": {}, "training_iteration": 8, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469a4e0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469aa20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469a9b0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 362, "timesteps_total": 321916, "episode_reward_mean": -455.00137273584164, "episodes_this_iter": 40, "date": "2019-05-23_09-17-11", "time_this_iter_s": 29.779556035995483, "num_metric_batches_dropped": 0, "episode_reward_min": -769.0023080589837}
{"time_since_restore": 272.8748400211334, "info": {"default": {"kl": 0.013001106679439545, "entropy": 1.3852649927139282, "total_loss": 32.25881576538086, "vf_explained_var": 0.7766177654266357, "cur_lr": 0.0005000000237487257, "policy_loss": -0.002266921801492572, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 32.260921478271484}, "num_steps_trained": 363108, "grad_time_ms": 11029.772, "num_steps_sampled": 363108, "sample_time_ms": 19089.943, "load_time_ms": 15.269, "update_time_ms": 92.28}, "hostname": "flow-main", "episode_reward_max": -28.46017534677194, "timesteps_this_iter": 41192, "custom_metrics": {"cost1_max": 213.68532400799293, "cost1_mean": 179.8443430379448, "system_level_velocity_mean": 15.07778576800352, "cost2_mean": -47.408899075171355, "cost2_max": -17.766475739928374, "outflow_rate_max": 1377.5150255102035, "cost1_min": 24.540369839155684, "system_level_velocity_min": 11.099726829661565, "system_level_velocity_max": 18.862036978932036, "outflow_rate_min": 511.1246851587969, "cost2_min": -78.53656910804736, "outflow_rate_mean": 1167.038049665859}, "done": false, "pid": 51582, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 363108, "time_total_s": 272.8748400211334, "timestamp": 1558603061, "iterations_since_restore": 9, "policy_reward_mean": {}, "training_iteration": 9, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2da0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2908>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2630>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 403, "timesteps_total": 363108, "episode_reward_mean": -456.3954585143334, "episodes_this_iter": 41, "date": "2019-05-23_09-17-41", "time_this_iter_s": 30.775737762451172, "num_metric_batches_dropped": 0, "episode_reward_min": -793.1767139577598}
{"time_since_restore": 308.4602828025818, "info": {"default": {"kl": 0.008797084912657738, "entropy": 1.3896304368972778, "total_loss": 39.669273376464844, "vf_explained_var": 0.7374180555343628, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0020746805239468813, "cur_kl_coeff": 0.012500000186264515, "vf_loss": 39.67123794555664}, "num_steps_trained": 405312, "grad_time_ms": 11282.509, "num_steps_sampled": 405312, "sample_time_ms": 19372.55, "load_time_ms": 14.493, "update_time_ms": 83.953}, "hostname": "flow-main", "episode_reward_max": -28.46017534677194, "timesteps_this_iter": 42204, "custom_metrics": {"cost1_max": 213.97898158526323, "cost1_mean": 179.93823353162682, "system_level_velocity_mean": 15.12554705138558, "cost2_mean": -53.49688920164195, "cost2_max": -17.766475739928374, "outflow_rate_max": 1390.932727370334, "cost1_min": 24.540369839155684, "system_level_velocity_min": 11.099726829661565, "system_level_velocity_max": 18.862036978932036, "outflow_rate_min": 511.1246851587969, "cost2_min": -78.53656910804736, "outflow_rate_mean": 1174.1223838757435}, "done": false, "pid": 51582, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 405312, "time_total_s": 308.4602828025818, "timestamp": 1558603097, "iterations_since_restore": 10, "policy_reward_mean": {}, "training_iteration": 10, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846935f8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84693eb8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84693438>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 460, "timesteps_total": 405312, "episode_reward_mean": -470.7193576928572, "episodes_this_iter": 57, "date": "2019-05-23_09-18-17", "time_this_iter_s": 35.585442781448364, "num_metric_batches_dropped": 0, "episode_reward_min": -793.1767139577598}
{"time_since_restore": 354.3291103839874, "info": {"default": {"kl": 0.008541618473827839, "entropy": 1.375398874282837, "total_loss": 28.307415008544922, "vf_explained_var": 0.8041030764579773, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0018203723011538386, "cur_kl_coeff": 0.012500002980232239, "vf_loss": 28.309127807617188}, "num_steps_trained": 446099, "grad_time_ms": 11876.634, "num_steps_sampled": 446099, "sample_time_ms": 20202.412, "load_time_ms": 7.749, "update_time_ms": 9.283}, "hostname": "flow-main", "episode_reward_max": -29.72015772417881, "timesteps_this_iter": 40787, "custom_metrics": {"cost1_max": 221.12035351415238, "cost1_mean": 177.12249850862324, "system_level_velocity_mean": 15.16561630459564, "cost2_mean": -54.160710300976724, "cost2_max": -17.196462297383125, "outflow_rate_max": 1418.5718545602344, "cost1_min": 22.912308645847, "system_level_velocity_min": 11.885571096371065, "system_level_velocity_max": 18.54644185531506, "outflow_rate_min": 473.8308088401575, "cost2_min": -74.14459843509002, "outflow_rate_mean": 1160.280328328102}, "done": false, "pid": 51582, "episode_len_mean": 318.15, "node_ip": "10.138.0.2", "timesteps_since_restore": 446099, "time_total_s": 354.3291103839874, "timestamp": 1558603143, "iterations_since_restore": 11, "policy_reward_mean": {}, "training_iteration": 11, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9b38>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a91d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9eb8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 505, "timesteps_total": 446099, "episode_reward_mean": -473.11519426180416, "episodes_this_iter": 45, "date": "2019-05-23_09-19-03", "time_this_iter_s": 45.86882758140564, "num_metric_batches_dropped": 0, "episode_reward_min": -789.3104883799216}
{"time_since_restore": 396.41741943359375, "info": {"default": {"kl": 0.009360981173813343, "entropy": 1.3585830926895142, "total_loss": 27.010417938232422, "vf_explained_var": 0.8256897926330566, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0022121185902506113, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 27.012514114379883}, "num_steps_trained": 486959, "grad_time_ms": 12022.856, "num_steps_sampled": 486959, "sample_time_ms": 21392.315, "load_time_ms": 7.843, "update_time_ms": 10.325}, "hostname": "flow-main", "episode_reward_max": -29.72015772417881, "timesteps_this_iter": 40860, "custom_metrics": {"cost1_max": 221.12035351415238, "cost1_mean": 179.5640733569688, "system_level_velocity_mean": 15.358808261296433, "cost2_mean": -54.669182770985934, "cost2_max": -17.196462297383125, "outflow_rate_max": 1418.5718545602344, "cost1_min": 22.912308645847, "system_level_velocity_min": 11.885571096371065, "system_level_velocity_max": 18.54644185531506, "outflow_rate_min": 473.8308088401575, "cost2_min": -77.39004508661884, "outflow_rate_mean": 1177.4019884280035}, "done": false, "pid": 51582, "episode_len_mean": 318.15, "node_ip": "10.138.0.2", "timesteps_since_restore": 486959, "time_total_s": 396.41741943359375, "timestamp": 1558603185, "iterations_since_restore": 12, "policy_reward_mean": {}, "training_iteration": 12, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84680b70>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d97b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849476a0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 545, "timesteps_total": 486959, "episode_reward_mean": -455.6513206639777, "episodes_this_iter": 40, "date": "2019-05-23_09-19-45", "time_this_iter_s": 42.08830904960632, "num_metric_batches_dropped": 0, "episode_reward_min": -695.8507655557121}
{"time_since_restore": 429.55785870552063, "info": {"default": {"kl": 0.007893295027315617, "entropy": 1.359834909439087, "total_loss": 35.92343521118164, "vf_explained_var": 0.772934079170227, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0016516466857865453, "cur_kl_coeff": 0.012500002980232239, "vf_loss": 35.92498779296875}, "num_steps_trained": 529906, "grad_time_ms": 12224.244, "num_steps_sampled": 529906, "sample_time_ms": 21532.599, "load_time_ms": 7.886, "update_time_ms": 10.255}, "hostname": "flow-main", "episode_reward_max": -269.9392452052315, "timesteps_this_iter": 42947, "custom_metrics": {"cost1_max": 219.34992612899654, "cost1_mean": 181.8925059362079, "system_level_velocity_mean": 15.171592916330672, "cost2_mean": -58.05716524586108, "cost2_max": -40.692657089980216, "outflow_rate_max": 1406.9021895068456, "cost1_min": 139.0778952119902, "system_level_velocity_min": 11.649297048468004, "system_level_velocity_max": 18.398438597663368, "outflow_rate_min": 981.9508787000939, "cost2_min": -77.39004508661884, "outflow_rate_mean": 1191.7477200628352}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 529906, "time_total_s": 429.55785870552063, "timestamp": 1558603218, "iterations_since_restore": 13, "policy_reward_mean": {}, "training_iteration": 13, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84961fd0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84961240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84961eb8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 601, "timesteps_total": 529906, "episode_reward_mean": -482.08182929498696, "episodes_this_iter": 56, "date": "2019-05-23_09-20-18", "time_this_iter_s": 33.14043927192688, "num_metric_batches_dropped": 0, "episode_reward_min": -749.4958714429787}
{"time_since_restore": 460.76895928382874, "info": {"default": {"kl": 0.008866471238434315, "entropy": 1.3456430435180664, "total_loss": 29.642526626586914, "vf_explained_var": 0.821850061416626, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0019778746645897627, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 29.64439582824707}, "num_steps_trained": 570858, "grad_time_ms": 12149.568, "num_steps_sampled": 570858, "sample_time_ms": 21284.575, "load_time_ms": 8.011, "update_time_ms": 10.341}, "hostname": "flow-main", "episode_reward_max": -269.2152831589768, "timesteps_this_iter": 40952, "custom_metrics": {"cost1_max": 221.68146777400432, "cost1_mean": 181.3768025115835, "system_level_velocity_mean": 15.153136859060458, "cost2_mean": -61.66757072523274, "cost2_max": -43.519642280410736, "outflow_rate_max": 1424.809194090115, "cost1_min": 139.0778952119902, "system_level_velocity_min": 11.649297048468004, "system_level_velocity_max": 18.666851560310008, "outflow_rate_min": 981.9508787000939, "cost2_min": -77.96263001538225, "outflow_rate_mean": 1192.5556961030538}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 570858, "time_total_s": 460.76895928382874, "timestamp": 1558603249, "iterations_since_restore": 14, "policy_reward_mean": {}, "training_iteration": 14, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a95c0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9080>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9da0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 645, "timesteps_total": 570858, "episode_reward_mean": -495.86652120623614, "episodes_this_iter": 44, "date": "2019-05-23_09-20-49", "time_this_iter_s": 31.211100578308105, "num_metric_batches_dropped": 0, "episode_reward_min": -749.4958714429787}
{"time_since_restore": 489.926717042923, "info": {"default": {"kl": 0.00958116166293621, "entropy": 1.3701634407043457, "total_loss": 24.600358963012695, "vf_explained_var": 0.8383755087852478, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0030935907270759344, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 24.60333251953125}, "num_steps_trained": 611052, "grad_time_ms": 12169.968, "num_steps_sampled": 611052, "sample_time_ms": 21302.718, "load_time_ms": 7.942, "update_time_ms": 10.15}, "hostname": "flow-main", "episode_reward_max": -269.2152831589768, "timesteps_this_iter": 40194, "custom_metrics": {"cost1_max": 221.68146777400432, "cost1_mean": 181.85331490628167, "system_level_velocity_mean": 15.174150796546744, "cost2_mean": -60.30085951357923, "cost2_max": -38.831602223233496, "outflow_rate_max": 1424.809194090115, "cost1_min": 139.0778952119902, "system_level_velocity_min": 11.649297048468004, "system_level_velocity_max": 18.666851560310008, "outflow_rate_min": 981.9508787000939, "cost2_min": -77.96263001538225, "outflow_rate_mean": 1196.4511699601292}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 611052, "time_total_s": 489.926717042923, "timestamp": 1558603279, "iterations_since_restore": 15, "policy_reward_mean": {}, "training_iteration": 15, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d9390>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d9f98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d9710>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 685, "timesteps_total": 611052, "episode_reward_mean": -480.4493604351678, "episodes_this_iter": 40, "date": "2019-05-23_09-21-19", "time_this_iter_s": 29.15775775909424, "num_metric_batches_dropped": 0, "episode_reward_min": -749.4958714429787}
{"time_since_restore": 519.5279324054718, "info": {"default": {"kl": 0.0091531528159976, "entropy": 1.3550807237625122, "total_loss": 29.387361526489258, "vf_explained_var": 0.8106996417045593, "cur_lr": 0.0005000000237487257, "policy_loss": -0.002640665275976062, "cur_kl_coeff": 0.01250000111758709, "vf_loss": 29.389892578125}, "num_steps_trained": 649992, "grad_time_ms": 12263.592, "num_steps_sampled": 649992, "sample_time_ms": 21368.896, "load_time_ms": 7.99, "update_time_ms": 9.999}, "hostname": "flow-main", "episode_reward_max": -104.36897159806331, "timesteps_this_iter": 38940, "custom_metrics": {"cost1_max": 221.23309684333876, "cost1_mean": 178.570565148669, "system_level_velocity_mean": 15.161634434532182, "cost2_mean": -57.99219915679929, "cost2_max": -34.77090018786196, "outflow_rate_max": 1421.6506954063557, "cost1_min": 84.05732093244129, "system_level_velocity_min": 11.729674143152279, "system_level_velocity_max": 18.87206065360728, "outflow_rate_min": 806.7823206315157, "cost2_min": -76.25663224458765, "outflow_rate_mean": 1180.8533187727069}, "done": false, "pid": 51582, "episode_len_mean": 319.85, "node_ip": "10.138.0.2", "timesteps_since_restore": 649992, "time_total_s": 519.5279324054718, "timestamp": 1558603308, "iterations_since_restore": 16, "policy_reward_mean": {}, "training_iteration": 16, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d9048>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9c18>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846805f8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 729, "timesteps_total": 649992, "episode_reward_mean": -459.3141338105906, "episodes_this_iter": 44, "date": "2019-05-23_09-21-48", "time_this_iter_s": 29.601215362548828, "num_metric_batches_dropped": 0, "episode_reward_min": -725.6552460105693}
{"time_since_restore": 551.3945496082306, "info": {"default": {"kl": 0.008505658246576786, "entropy": 1.3423035144805908, "total_loss": 33.48100280761719, "vf_explained_var": 0.8079111576080322, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0023928929585963488, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 33.48329162597656}, "num_steps_trained": 691469, "grad_time_ms": 12374.221, "num_steps_sampled": 691469, "sample_time_ms": 21408.719, "load_time_ms": 8.017, "update_time_ms": 9.959}, "hostname": "flow-main", "episode_reward_max": -104.36897159806331, "timesteps_this_iter": 41477, "custom_metrics": {"cost1_max": 221.68681522595267, "cost1_mean": 180.25324827233683, "system_level_velocity_mean": 15.3245913321655, "cost2_mean": -60.33166339768643, "cost2_max": -34.77090018786196, "outflow_rate_max": 1427.9692661962313, "cost1_min": 84.05732093244129, "system_level_velocity_min": 11.125404054525461, "system_level_velocity_max": 18.87206065360728, "outflow_rate_min": 806.7823206315157, "cost2_min": -83.27765047014023, "outflow_rate_mean": 1189.3048147314676}, "done": false, "pid": 51582, "episode_len_mean": 319.85, "node_ip": "10.138.0.2", "timesteps_since_restore": 691469, "time_total_s": 551.3945496082306, "timestamp": 1558603340, "iterations_since_restore": 17, "policy_reward_mean": {}, "training_iteration": 17, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468b400>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468bac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8468b6d8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 785, "timesteps_total": 691469, "episode_reward_mean": -454.28397949468774, "episodes_this_iter": 56, "date": "2019-05-23_09-22-20", "time_this_iter_s": 31.86661720275879, "num_metric_batches_dropped": 0, "episode_reward_min": -697.4434055899949}
{"time_since_restore": 582.7466285228729, "info": {"default": {"kl": 0.009064218029379845, "entropy": 1.33087956905365, "total_loss": 31.330188751220703, "vf_explained_var": 0.8207846879959106, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0032346181105822325, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 31.333311080932617}, "num_steps_trained": 732400, "grad_time_ms": 12527.155, "num_steps_sampled": 732400, "sample_time_ms": 21413.572, "load_time_ms": 7.992, "update_time_ms": 10.137}, "hostname": "flow-main", "episode_reward_max": -100.06877988513092, "timesteps_this_iter": 40931, "custom_metrics": {"cost1_max": 222.18835500456476, "cost1_mean": 182.06223076065768, "system_level_velocity_mean": 15.332054909330685, "cost2_mean": -64.75829130262902, "cost2_max": -38.80580288649489, "outflow_rate_max": 1440.0225844922163, "cost1_min": 86.66598062661036, "system_level_velocity_min": 11.125404054525461, "system_level_velocity_max": 18.918084326780214, "outflow_rate_min": 819.6847036089041, "cost2_min": -83.27765047014023, "outflow_rate_mean": 1203.6604385717515}, "done": false, "pid": 51582, "episode_len_mean": 323.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 732400, "time_total_s": 582.7466285228729, "timestamp": 1558603372, "iterations_since_restore": 18, "policy_reward_mean": {}, "training_iteration": 18, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469ac18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f24a8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469a518>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 828, "timesteps_total": 732400, "episode_reward_mean": -477.46181755922714, "episodes_this_iter": 43, "date": "2019-05-23_09-22-52", "time_this_iter_s": 31.352078914642334, "num_metric_batches_dropped": 0, "episode_reward_min": -787.4540436143556}
{"time_since_restore": 616.6266739368439, "info": {"default": {"kl": 0.008399883285164833, "entropy": 1.3180218935012817, "total_loss": 29.087902069091797, "vf_explained_var": 0.8350371718406677, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0028090320993214846, "cur_kl_coeff": 0.01250000111758709, "vf_loss": 29.090604782104492}, "num_steps_trained": 773866, "grad_time_ms": 12860.685, "num_steps_sampled": 773866, "sample_time_ms": 21387.05, "load_time_ms": 8.029, "update_time_ms": 10.416}, "hostname": "flow-main", "episode_reward_max": -100.06877988513092, "timesteps_this_iter": 41466, "custom_metrics": {"cost1_max": 222.18835500456476, "cost1_mean": 182.26165327251846, "system_level_velocity_mean": 15.35251875869866, "cost2_mean": -65.26933124902925, "cost2_max": -38.80580288649489, "outflow_rate_max": 1440.0225844922163, "cost1_min": 86.66598062661036, "system_level_velocity_min": 11.125404054525461, "system_level_velocity_max": 18.918084326780214, "outflow_rate_min": 819.6847036089041, "cost2_min": -83.79429444600648, "outflow_rate_mean": 1205.73217268091}, "done": false, "pid": 51582, "episode_len_mean": 323.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 773866, "time_total_s": 616.6266739368439, "timestamp": 1558603406, "iterations_since_restore": 19, "policy_reward_mean": {}, "training_iteration": 19, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d9f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d9470>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846d9390>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 870, "timesteps_total": 773866, "episode_reward_mean": -476.0439118289877, "episodes_this_iter": 42, "date": "2019-05-23_09-23-26", "time_this_iter_s": 33.88004541397095, "num_metric_batches_dropped": 0, "episode_reward_min": -787.4540436143556}
{"time_since_restore": 649.1243298053741, "info": {"default": {"kl": 0.012352941557765007, "entropy": 1.3036669492721558, "total_loss": 29.459312438964844, "vf_explained_var": 0.8190268278121948, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0036000944674015045, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 29.462759017944336}, "num_steps_trained": 813854, "grad_time_ms": 12738.422, "num_steps_sampled": 813854, "sample_time_ms": 21200.329, "load_time_ms": 7.889, "update_time_ms": 10.792}, "hostname": "flow-main", "episode_reward_max": -28.167475843974803, "timesteps_this_iter": 39988, "custom_metrics": {"cost1_max": 219.57269586799683, "cost1_mean": 182.76386136519739, "system_level_velocity_mean": 15.418376367508294, "cost2_mean": -63.57386551428704, "cost2_max": -17.05953105806045, "outflow_rate_max": 1435.0925602310965, "cost1_min": 23.116628596758005, "system_level_velocity_min": 11.599557701741798, "system_level_velocity_max": 18.71128327262268, "outflow_rate_min": 506.0695249140989, "cost2_min": -83.79429444600648, "outflow_rate_mean": 1207.835578649247}, "done": false, "pid": 51582, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 813854, "time_total_s": 649.1243298053741, "timestamp": 1558603438, "iterations_since_restore": 20, "policy_reward_mean": {}, "training_iteration": 20, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530eb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530128>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 926, "timesteps_total": 813854, "episode_reward_mean": -459.2802161532477, "episodes_this_iter": 56, "date": "2019-05-23_09-23-58", "time_this_iter_s": 32.49765586853027, "num_metric_batches_dropped": 0, "episode_reward_min": -702.1019493166477}
{"time_since_restore": 678.8235638141632, "info": {"default": {"kl": 0.013404049910604954, "entropy": 1.2815645933151245, "total_loss": 24.827926635742188, "vf_explained_var": 0.8313473463058472, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0036141856107860804, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 24.83137321472168}, "num_steps_trained": 852350, "grad_time_ms": 12156.659, "num_steps_sampled": 852350, "sample_time_ms": 20179.846, "load_time_ms": 6.086, "update_time_ms": 10.955}, "hostname": "flow-main", "episode_reward_max": -28.167475843974803, "timesteps_this_iter": 38496, "custom_metrics": {"cost1_max": 221.19867411965475, "cost1_mean": 184.13364090451122, "system_level_velocity_mean": 15.556827760858528, "cost2_mean": -60.19129572569398, "cost2_max": -17.05953105806045, "outflow_rate_max": 1435.0925602310965, "cost1_min": 23.116628596758005, "system_level_velocity_min": 11.599557701741798, "system_level_velocity_max": 18.71128327262268, "outflow_rate_min": 506.0695249140989, "cost2_min": -78.62554589293879, "outflow_rate_mean": 1212.3111031462724}, "done": false, "pid": 51582, "episode_len_mean": 321.34, "node_ip": "10.138.0.2", "timesteps_since_restore": 852350, "time_total_s": 678.8235638141632, "timestamp": 1558603468, "iterations_since_restore": 21, "policy_reward_mean": {}, "training_iteration": 21, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9748>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9fd0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9518>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 968, "timesteps_total": 852350, "episode_reward_mean": -435.8492988891173, "episodes_this_iter": 42, "date": "2019-05-23_09-24-28", "time_this_iter_s": 29.699234008789062, "num_metric_batches_dropped": 0, "episode_reward_min": -652.1596183978693}
{"time_since_restore": 708.7444291114807, "info": {"default": {"kl": 0.012449951842427254, "entropy": 1.2798027992248535, "total_loss": 21.13079261779785, "vf_explained_var": 0.8689007759094238, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004244537558406591, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 21.1348819732666}, "num_steps_trained": 890775, "grad_time_ms": 12161.442, "num_steps_sampled": 890775, "sample_time_ms": 18958.698, "load_time_ms": 5.664, "update_time_ms": 10.143}, "hostname": "flow-main", "episode_reward_max": -28.167475843974803, "timesteps_this_iter": 38425, "custom_metrics": {"cost1_max": 221.19867411965475, "cost1_mean": 180.8921634258617, "system_level_velocity_mean": 15.512021070135232, "cost2_mean": -56.82629859585208, "cost2_max": -17.05953105806045, "outflow_rate_max": 1431.8494201728172, "cost1_min": 23.116628596758005, "system_level_velocity_min": 11.484991026970308, "system_level_velocity_max": 18.724334139226574, "outflow_rate_min": 506.0695249140989, "cost2_min": -77.71002568537003, "outflow_rate_mean": 1195.5596417300542}, "done": false, "pid": 51582, "episode_len_mean": 317.66, "node_ip": "10.138.0.2", "timesteps_since_restore": 890775, "time_total_s": 708.7444291114807, "timestamp": 1558603498, "iterations_since_restore": 22, "policy_reward_mean": {}, "training_iteration": 22, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469af98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469ac18>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469af60>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1010, "timesteps_total": 890775, "episode_reward_mean": -420.23808102923766, "episodes_this_iter": 42, "date": "2019-05-23_09-24-58", "time_this_iter_s": 29.920865297317505, "num_metric_batches_dropped": 0, "episode_reward_min": -652.1596183978693}
{"time_since_restore": 738.8762400150299, "info": {"default": {"kl": 0.012884409166872501, "entropy": 1.2738500833511353, "total_loss": 24.54025650024414, "vf_explained_var": 0.8619335889816284, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004522425122559071, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 24.54461669921875}, "num_steps_trained": 929279, "grad_time_ms": 11911.382, "num_steps_sampled": 929279, "sample_time_ms": 18908.709, "load_time_ms": 5.491, "update_time_ms": 10.393}, "hostname": "flow-main", "episode_reward_max": -103.50808433917246, "timesteps_this_iter": 38504, "custom_metrics": {"cost1_max": 221.6985628523664, "cost1_mean": 179.83305969839867, "system_level_velocity_mean": 15.255611641763378, "cost2_mean": -56.93644009235409, "cost2_max": -37.83223617195683, "outflow_rate_max": 1424.154001529566, "cost1_min": 85.40728794686505, "system_level_velocity_min": 11.03488223996553, "system_level_velocity_max": 18.724334139226574, "outflow_rate_min": 814.7586042386157, "cost2_min": -74.74297146886434, "outflow_rate_mean": 1186.084331802505}, "done": false, "pid": 51582, "episode_len_mean": 321.04, "node_ip": "10.138.0.2", "timesteps_since_restore": 929279, "time_total_s": 738.8762400150299, "timestamp": 1558603528, "iterations_since_restore": 23, "policy_reward_mean": {}, "training_iteration": 23, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530f28>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530518>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530208>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1064, "timesteps_total": 929279, "episode_reward_mean": -436.23650699889816, "episodes_this_iter": 54, "date": "2019-05-23_09-25-28", "time_this_iter_s": 30.131810903549194, "num_metric_batches_dropped": 0, "episode_reward_min": -641.8698239205182}
{"time_since_restore": 768.3723273277283, "info": {"default": {"kl": 0.014429375529289246, "entropy": 1.2455734014511108, "total_loss": 21.965068817138672, "vf_explained_var": 0.87773197889328, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0053820232860744, "cur_kl_coeff": 0.01250000111758709, "vf_loss": 21.97027015686035}, "num_steps_trained": 967141, "grad_time_ms": 11682.661, "num_steps_sampled": 967141, "sample_time_ms": 18966.677, "load_time_ms": 5.637, "update_time_ms": 10.208}, "hostname": "flow-main", "episode_reward_max": -28.110060787018114, "timesteps_this_iter": 37862, "custom_metrics": {"cost1_max": 221.6985628523664, "cost1_mean": 176.8876595429091, "system_level_velocity_mean": 14.966458252609087, "cost2_mean": -56.63457078038993, "cost2_max": -18.7438727776293, "outflow_rate_max": 1416.5201878996618, "cost1_min": 23.40879746446626, "system_level_velocity_min": 11.03488223996553, "system_level_velocity_max": 18.85878182137168, "outflow_rate_min": 477.9372180334546, "cost2_min": -74.74297146886434, "outflow_rate_mean": 1164.9031209989525}, "done": false, "pid": 51582, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 967141, "time_total_s": 768.3723273277283, "timestamp": 1558603557, "iterations_since_restore": 24, "policy_reward_mean": {}, "training_iteration": 24, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df160>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df4a8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1109, "timesteps_total": 967141, "episode_reward_mean": -452.4161711554376, "episodes_this_iter": 45, "date": "2019-05-23_09-25-57", "time_this_iter_s": 29.496087312698364, "num_metric_batches_dropped": 0, "episode_reward_min": -641.8698239205182}
{"time_since_restore": 797.661360502243, "info": {"default": {"kl": 0.012465043924748898, "entropy": 1.2455556392669678, "total_loss": 18.62187957763672, "vf_explained_var": 0.9042105674743652, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004915200173854828, "cur_kl_coeff": 0.012500002980232239, "vf_loss": 18.626638412475586}, "num_steps_trained": 1005687, "grad_time_ms": 11485.417, "num_steps_sampled": 1005687, "sample_time_ms": 19178.202, "load_time_ms": 5.586, "update_time_ms": 10.056}, "hostname": "flow-main", "episode_reward_max": -28.110060787018114, "timesteps_this_iter": 38546, "custom_metrics": {"cost1_max": 221.53380605739784, "cost1_mean": 176.61357446996112, "system_level_velocity_mean": 14.954987920997162, "cost2_mean": -55.91666908016563, "cost2_max": -18.7438727776293, "outflow_rate_max": 1417.9839917762488, "cost1_min": 23.40879746446626, "system_level_velocity_min": 12.03161106380076, "system_level_velocity_max": 18.85878182137168, "outflow_rate_min": 477.9372180334546, "cost2_min": -73.54446719357169, "outflow_rate_mean": 1159.967812255038}, "done": false, "pid": 51582, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 1005687, "time_total_s": 797.661360502243, "timestamp": 1558603587, "iterations_since_restore": 25, "policy_reward_mean": {}, "training_iteration": 25, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530a58>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530d68>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530fd0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1151, "timesteps_total": 1005687, "episode_reward_mean": -450.7657217320256, "episodes_this_iter": 42, "date": "2019-05-23_09-26-27", "time_this_iter_s": 29.28903317451477, "num_metric_batches_dropped": 0, "episode_reward_min": -639.608767278312}
{"time_since_restore": 826.8685986995697, "info": {"default": {"kl": 0.012450114823877811, "entropy": 1.232090711593628, "total_loss": 21.26133155822754, "vf_explained_var": 0.8833589553833008, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005013555753976107, "cur_kl_coeff": 0.012500000186264515, "vf_loss": 21.266189575195312}, "num_steps_trained": 1042450, "grad_time_ms": 11314.884, "num_steps_sampled": 1042450, "sample_time_ms": 19311.304, "load_time_ms": 5.527, "update_time_ms": 9.903}, "hostname": "flow-main", "episode_reward_max": -20.363161829980765, "timesteps_this_iter": 36763, "custom_metrics": {"cost1_max": 221.84447919435806, "cost1_mean": 180.6582785549901, "system_level_velocity_mean": 15.283562861246722, "cost2_mean": -55.99186074119825, "cost2_max": -14.142227049204292, "outflow_rate_max": 1433.5205360375012, "cost1_min": 18.101931896297696, "system_level_velocity_min": 11.860133657117801, "system_level_velocity_max": 18.75333795150114, "outflow_rate_min": 492.0625426222078, "cost2_min": -71.82374194397823, "outflow_rate_mean": 1180.9886877620627}, "done": false, "pid": 51582, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 1042450, "time_total_s": 826.8685986995697, "timestamp": 1558603616, "iterations_since_restore": 26, "policy_reward_mean": {}, "training_iteration": 26, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530550>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1203, "timesteps_total": 1042450, "episode_reward_mean": -428.77660201991335, "episodes_this_iter": 52, "date": "2019-05-23_09-26-56", "time_this_iter_s": 29.20723819732666, "num_metric_batches_dropped": 0, "episode_reward_min": -623.7212946363663}
{"time_since_restore": 856.7960262298584, "info": {"default": {"kl": 0.013256416656076908, "entropy": 1.2210110425949097, "total_loss": 25.49447250366211, "vf_explained_var": 0.8670398592948914, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004440081771463156, "cur_kl_coeff": 0.01250000111758709, "vf_loss": 25.498746871948242}, "num_steps_trained": 1079549, "grad_time_ms": 11217.013, "num_steps_sampled": 1079549, "sample_time_ms": 19216.764, "load_time_ms": 5.291, "update_time_ms": 10.195}, "hostname": "flow-main", "episode_reward_max": -20.363161829980765, "timesteps_this_iter": 37099, "custom_metrics": {"cost1_max": 221.84447919435806, "cost1_mean": 183.91270994936326, "system_level_velocity_mean": 15.55774927806933, "cost2_mean": -57.345911619876254, "cost2_max": -14.142227049204292, "outflow_rate_max": 1433.5205360375012, "cost1_min": 18.101931896297696, "system_level_velocity_min": 11.860133657117801, "system_level_velocity_max": 18.731059939453274, "outflow_rate_min": 492.0625426222078, "cost2_min": -76.623025191476, "outflow_rate_mean": 1196.3505952143462}, "done": false, "pid": 51582, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 1079549, "time_total_s": 856.7960262298584, "timestamp": 1558603646, "iterations_since_restore": 27, "policy_reward_mean": {}, "training_iteration": 27, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469af98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469a748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469a0b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1250, "timesteps_total": 1079549, "episode_reward_mean": -410.2996688844421, "episodes_this_iter": 47, "date": "2019-05-23_09-27-26", "time_this_iter_s": 29.927427530288696, "num_metric_batches_dropped": 0, "episode_reward_min": -610.0012701021341}
{"time_since_restore": 886.7278101444244, "info": {"default": {"kl": 0.012559887953102589, "entropy": 1.2246601581573486, "total_loss": 23.343690872192383, "vf_explained_var": 0.8840035796165466, "cur_lr": 0.0005000000237487257, "policy_loss": -0.003846575738862157, "cur_kl_coeff": 0.012500002980232239, "vf_loss": 23.347379684448242}, "num_steps_trained": 1118115, "grad_time_ms": 11169.857, "num_steps_sampled": 1118115, "sample_time_ms": 19120.651, "load_time_ms": 5.502, "update_time_ms": 10.011}, "hostname": "flow-main", "episode_reward_max": -91.87806003342305, "timesteps_this_iter": 38566, "custom_metrics": {"cost1_max": 222.21786442720656, "cost1_mean": 184.59172860765838, "system_level_velocity_mean": 15.684761432095746, "cost2_mean": -59.022356872012814, "cost2_max": -33.18746786724442, "outflow_rate_max": 1423.6198866458058, "cost1_min": 79.75175439987538, "system_level_velocity_min": 12.535917766762418, "system_level_velocity_max": 18.900280481586435, "outflow_rate_min": 771.1901407185585, "cost2_min": -80.61227926326927, "outflow_rate_mean": 1202.0405396258957}, "done": false, "pid": 51582, "episode_len_mean": 320.95, "node_ip": "10.138.0.2", "timesteps_since_restore": 1118115, "time_total_s": 886.7278101444244, "timestamp": 1558603676, "iterations_since_restore": 28, "policy_reward_mean": {}, "training_iteration": 28, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530f98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530e10>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530ba8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1294, "timesteps_total": 1118115, "episode_reward_mean": -411.04511355932453, "episodes_this_iter": 44, "date": "2019-05-23_09-27-56", "time_this_iter_s": 29.93178391456604, "num_metric_batches_dropped": 0, "episode_reward_min": -610.0012701021341}
{"time_since_restore": 917.4278061389923, "info": {"default": {"kl": 0.011606822721660137, "entropy": 1.237939715385437, "total_loss": 22.345781326293945, "vf_explained_var": 0.8854911923408508, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0039168414659798145, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 22.349552154541016}, "num_steps_trained": 1156800, "grad_time_ms": 10958.264, "num_steps_sampled": 1156800, "sample_time_ms": 19013.326, "load_time_ms": 5.581, "update_time_ms": 9.939}, "hostname": "flow-main", "episode_reward_max": -21.690324336229132, "timesteps_this_iter": 38685, "custom_metrics": {"cost1_max": 222.21786442720656, "cost1_mean": 179.8327120181063, "system_level_velocity_mean": 15.424947775054163, "cost2_mean": -59.488565798668006, "cost2_max": -17.710169466133053, "outflow_rate_max": 1422.3581145059184, "cost1_min": 17.990161441427716, "system_level_velocity_min": 11.906052003044163, "system_level_velocity_max": 18.900280481586435, "outflow_rate_min": 431.75782487237836, "cost2_min": -80.61227926326927, "outflow_rate_mean": 1180.3105219985002}, "done": false, "pid": 51582, "episode_len_mean": 317.97, "node_ip": "10.138.0.2", "timesteps_since_restore": 1156800, "time_total_s": 917.4278061389923, "timestamp": 1558603707, "iterations_since_restore": 29, "policy_reward_mean": {}, "training_iteration": 29, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534ac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530748>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1338, "timesteps_total": 1156800, "episode_reward_mean": -427.90279332635765, "episodes_this_iter": 44, "date": "2019-05-23_09-28-27", "time_this_iter_s": 30.69999599456787, "num_metric_batches_dropped": 0, "episode_reward_min": -608.3363498129643}
{"time_since_restore": 950.6676335334778, "info": {"default": {"kl": 0.01402499619871378, "entropy": 1.2065229415893555, "total_loss": 25.526445388793945, "vf_explained_var": 0.8606149554252625, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004358938429504633, "cur_kl_coeff": 0.012500002980232239, "vf_loss": 25.530628204345703}, "num_steps_trained": 1195386, "grad_time_ms": 11012.494, "num_steps_sampled": 1195386, "sample_time_ms": 19034.851, "load_time_ms": 5.466, "update_time_ms": 9.872}, "hostname": "flow-main", "episode_reward_max": -21.690324336229132, "timesteps_this_iter": 38586, "custom_metrics": {"cost1_max": 223.91951187617207, "cost1_mean": 182.01656353576033, "system_level_velocity_mean": 15.501047070471486, "cost2_mean": -60.208306788055545, "cost2_max": -17.710169466133053, "outflow_rate_max": 1441.4459804120459, "cost1_min": 17.990161441427716, "system_level_velocity_min": 11.906052003044163, "system_level_velocity_max": 19.01839140642766, "outflow_rate_min": 431.75782487237836, "cost2_min": -80.61227926326927, "outflow_rate_mean": 1190.98931356821}, "done": false, "pid": 51582, "episode_len_mean": 320.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 1195386, "time_total_s": 950.6676335334778, "timestamp": 1558603740, "iterations_since_restore": 30, "policy_reward_mean": {}, "training_iteration": 30, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845306a0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845301d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530518>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1391, "timesteps_total": 1195386, "episode_reward_mean": -434.06038787716386, "episodes_this_iter": 53, "date": "2019-05-23_09-29-00", "time_this_iter_s": 33.239827394485474, "num_metric_batches_dropped": 0, "episode_reward_min": -608.3363498129643}
{"time_since_restore": 981.0336985588074, "info": {"default": {"kl": 0.012545786798000336, "entropy": 1.2196452617645264, "total_loss": 23.559106826782227, "vf_explained_var": 0.8735519051551819, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004226897843182087, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 23.56317710876465}, "num_steps_trained": 1234573, "grad_time_ms": 10822.998, "num_steps_sampled": 1234573, "sample_time_ms": 19292.975, "load_time_ms": 5.63, "update_time_ms": 9.763}, "hostname": "flow-main", "episode_reward_max": -28.785496671872043, "timesteps_this_iter": 39187, "custom_metrics": {"cost1_max": 223.91951187617207, "cost1_mean": 182.0959709963157, "system_level_velocity_mean": 15.656316412959093, "cost2_mean": -61.30328472561159, "cost2_max": -17.705600250288406, "outflow_rate_max": 1441.4459804120459, "cost1_min": 23.056603326355315, "system_level_velocity_min": 12.120477976258776, "system_level_velocity_max": 19.01839140642766, "outflow_rate_min": 476.63851673475335, "cost2_min": -80.2017097890893, "outflow_rate_mean": 1196.373712183858}, "done": false, "pid": 51582, "episode_len_mean": 318.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 1234573, "time_total_s": 981.0336985588074, "timestamp": 1558603770, "iterations_since_restore": 31, "policy_reward_mean": {}, "training_iteration": 31, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534358>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845307f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845309e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1437, "timesteps_total": 1234573, "episode_reward_mean": -432.3195638320025, "episodes_this_iter": 46, "date": "2019-05-23_09-29-30", "time_this_iter_s": 30.36606502532959, "num_metric_batches_dropped": 0, "episode_reward_min": -608.3363498129643}
{"time_since_restore": 1010.7914471626282, "info": {"default": {"kl": 0.015445887111127377, "entropy": 1.2227424383163452, "total_loss": 21.63616943359375, "vf_explained_var": 0.8886659145355225, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004231604747474194, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 21.640209197998047}, "num_steps_trained": 1273756, "grad_time_ms": 10583.931, "num_steps_sampled": 1273756, "sample_time_ms": 19515.738, "load_time_ms": 5.71, "update_time_ms": 9.622}, "hostname": "flow-main", "episode_reward_max": -28.785496671872043, "timesteps_this_iter": 39183, "custom_metrics": {"cost1_max": 224.38623077434576, "cost1_mean": 176.7166156967006, "system_level_velocity_mean": 15.506656585379893, "cost2_mean": -60.291161123942835, "cost2_max": -17.705600250288406, "outflow_rate_max": 1437.842698163905, "cost1_min": 23.056603326355315, "system_level_velocity_min": 12.235227477098636, "system_level_velocity_max": 19.01839140642766, "outflow_rate_min": 476.63851673475335, "cost2_min": -80.2017097890893, "outflow_rate_mean": 1172.7418888856853}, "done": false, "pid": 51582, "episode_len_mean": 312.87, "node_ip": "10.138.0.2", "timesteps_since_restore": 1273756, "time_total_s": 1010.7914471626282, "timestamp": 1558603800, "iterations_since_restore": 32, "policy_reward_mean": {}, "training_iteration": 32, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530160>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530b70>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530780>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1482, "timesteps_total": 1273756, "episode_reward_mean": -432.139229194411, "episodes_this_iter": 45, "date": "2019-05-23_09-30-00", "time_this_iter_s": 29.7577486038208, "num_metric_batches_dropped": 0, "episode_reward_min": -705.2211621555666}
{"time_since_restore": 1042.0138504505157, "info": {"default": {"kl": 0.0150635726749897, "entropy": 1.2074869871139526, "total_loss": 23.67840003967285, "vf_explained_var": 0.8686690330505371, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004335878882557154, "cur_kl_coeff": 0.01250000111758709, "vf_loss": 23.68254852294922}, "num_steps_trained": 1311667, "grad_time_ms": 10555.655, "num_steps_sampled": 1311667, "sample_time_ms": 19652.655, "load_time_ms": 5.948, "update_time_ms": 9.78}, "hostname": "flow-main", "episode_reward_max": -92.62580795193489, "timesteps_this_iter": 37911, "custom_metrics": {"cost1_max": 224.38623077434576, "cost1_mean": 179.55244545505477, "system_level_velocity_mean": 15.447916951278241, "cost2_mean": -57.859276086531196, "cost2_max": -29.458964244110383, "outflow_rate_max": 1437.842698163905, "cost1_min": 77.44512346716215, "system_level_velocity_min": 12.235227477098636, "system_level_velocity_max": 18.9231815572422, "outflow_rate_min": 760.885625790575, "cost2_min": -75.7199173009706, "outflow_rate_mean": 1176.4228177464734}, "done": false, "pid": 51582, "episode_len_mean": 317.77, "node_ip": "10.138.0.2", "timesteps_since_restore": 1311667, "time_total_s": 1042.0138504505157, "timestamp": 1558603831, "iterations_since_restore": 33, "policy_reward_mean": {}, "training_iteration": 33, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845300f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530470>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530a20>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1534, "timesteps_total": 1311667, "episode_reward_mean": -429.16932184531817, "episodes_this_iter": 52, "date": "2019-05-23_09-30-31", "time_this_iter_s": 31.222403287887573, "num_metric_batches_dropped": 0, "episode_reward_min": -705.2211621555666}
{"time_since_restore": 1071.4293220043182, "info": {"default": {"kl": 0.013403009623289108, "entropy": 1.192397117614746, "total_loss": 20.192472457885742, "vf_explained_var": 0.8640230894088745, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0045043048448860645, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 20.196809768676758}, "num_steps_trained": 1348269, "grad_time_ms": 10579.01, "num_steps_sampled": 1348269, "sample_time_ms": 19621.946, "load_time_ms": 5.844, "update_time_ms": 9.719}, "hostname": "flow-main", "episode_reward_max": -172.1099218752991, "timesteps_this_iter": 36602, "custom_metrics": {"cost1_max": 220.39303219954814, "cost1_mean": 184.937134300846, "system_level_velocity_mean": 15.613308846372341, "cost2_mean": -54.267914500014584, "cost2_max": -29.65637030569887, "outflow_rate_max": 1396.4738137398483, "cost1_min": 141.97548234602908, "system_level_velocity_min": 12.425481899488242, "system_level_velocity_max": 18.772754270573582, "outflow_rate_min": 997.1437682251442, "cost2_min": -73.9850370211776, "outflow_rate_mean": 1188.6983328292717}, "done": false, "pid": 51582, "episode_len_mean": 322.8, "node_ip": "10.138.0.2", "timesteps_since_restore": 1348269, "time_total_s": 1071.4293220043182, "timestamp": 1558603861, "iterations_since_restore": 34, "policy_reward_mean": {}, "training_iteration": 34, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845340b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534be0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1579, "timesteps_total": 1348269, "episode_reward_mean": -411.2758475526947, "episodes_this_iter": 45, "date": "2019-05-23_09-31-01", "time_this_iter_s": 29.41547155380249, "num_metric_batches_dropped": 0, "episode_reward_min": -580.3501001280762}
{"time_since_restore": 1100.1799404621124, "info": {"default": {"kl": 0.018220020458102226, "entropy": 1.1903828382492065, "total_loss": 19.859487533569336, "vf_explained_var": 0.8704554438591003, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005185265559703112, "cur_kl_coeff": 0.01250000111758709, "vf_loss": 19.864444732666016}, "num_steps_trained": 1385258, "grad_time_ms": 10692.99, "num_steps_sampled": 1385258, "sample_time_ms": 19452.676, "load_time_ms": 5.875, "update_time_ms": 9.729}, "hostname": "flow-main", "episode_reward_max": -172.1099218752991, "timesteps_this_iter": 36989, "custom_metrics": {"cost1_max": 220.39303219954814, "cost1_mean": 186.45796408901208, "system_level_velocity_mean": 15.689608505407902, "cost2_mean": -52.054921084974495, "cost2_max": -29.65637030569887, "outflow_rate_max": 1408.5373607860436, "cost1_min": 141.97548234602908, "system_level_velocity_min": 12.356876681569723, "system_level_velocity_max": 18.56333710293769, "outflow_rate_min": 997.1437682251442, "cost2_min": -71.90790405073768, "outflow_rate_mean": 1192.400099340402}, "done": false, "pid": 51582, "episode_len_mean": 323.9, "node_ip": "10.138.0.2", "timesteps_since_restore": 1385258, "time_total_s": 1100.1799404621124, "timestamp": 1558603890, "iterations_since_restore": 35, "policy_reward_mean": {}, "training_iteration": 35, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845346d8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534128>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1620, "timesteps_total": 1385258, "episode_reward_mean": -402.0867889817369, "episodes_this_iter": 41, "date": "2019-05-23_09-31-30", "time_this_iter_s": 28.75061845779419, "num_metric_batches_dropped": 0, "episode_reward_min": -642.2843729828134}
{"time_since_restore": 1129.8853113651276, "info": {"default": {"kl": 0.015676898881793022, "entropy": 1.1970998048782349, "total_loss": 19.3648738861084, "vf_explained_var": 0.8844308853149414, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004570012912154198, "cur_kl_coeff": 0.012500002048909664, "vf_loss": 19.369247436523438}, "num_steps_trained": 1422398, "grad_time_ms": 10849.546, "num_steps_sampled": 1422398, "sample_time_ms": 19346.959, "load_time_ms": 5.87, "update_time_ms": 10.157}, "hostname": "flow-main", "episode_reward_max": -258.11407719452114, "timesteps_this_iter": 37140, "custom_metrics": {"cost1_max": 221.01523758829683, "cost1_mean": 185.88500343839985, "system_level_velocity_mean": 15.608434130384488, "cost2_mean": -51.9719204131208, "cost2_max": -27.80686374021966, "outflow_rate_max": 1408.5373607860436, "cost1_min": 147.02511773025148, "system_level_velocity_min": 12.264842362721534, "system_level_velocity_max": 18.788326623026297, "outflow_rate_min": 1013.0306976744188, "cost2_min": -75.93823805537764, "outflow_rate_mean": 1186.9927859208524}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1422398, "time_total_s": 1129.8853113651276, "timestamp": 1558603919, "iterations_since_restore": 36, "policy_reward_mean": {}, "training_iteration": 36, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2320>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530cc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846df160>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1668, "timesteps_total": 1422398, "episode_reward_mean": -407.7626153230065, "episodes_this_iter": 48, "date": "2019-05-23_09-31-59", "time_this_iter_s": 29.705370903015137, "num_metric_batches_dropped": 0, "episode_reward_min": -642.2843729828134}
{"time_since_restore": 1157.7542479038239, "info": {"default": {"kl": 0.0205118078738451, "entropy": 1.199313998222351, "total_loss": 16.57025718688965, "vf_explained_var": 0.881142795085907, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007797700352966785, "cur_kl_coeff": 0.01250000111758709, "vf_loss": 16.577800750732422}, "num_steps_trained": 1456764, "grad_time_ms": 10774.826, "num_steps_sampled": 1456764, "sample_time_ms": 19215.461, "load_time_ms": 5.916, "update_time_ms": 9.868}, "hostname": "flow-main", "episode_reward_max": -90.10683031976666, "timesteps_this_iter": 34366, "custom_metrics": {"cost1_max": 221.01523758829683, "cost1_mean": 183.28000487159022, "system_level_velocity_mean": 15.603726237953062, "cost2_mean": -49.73867271093056, "cost2_max": -25.765128834405445, "outflow_rate_max": 1405.0530747120627, "cost1_min": 79.62626222174733, "system_level_velocity_min": 12.264842362721534, "system_level_velocity_max": 18.788326623026297, "outflow_rate_min": 777.7450457419707, "cost2_min": -75.93823805537764, "outflow_rate_mean": 1159.9824443043308}, "done": false, "pid": 51582, "episode_len_mean": 321.63, "node_ip": "10.138.0.2", "timesteps_since_restore": 1456764, "time_total_s": 1157.7542479038239, "timestamp": 1558603947, "iterations_since_restore": 37, "policy_reward_mean": {}, "training_iteration": 37, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534908>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534dd8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534ef0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1716, "timesteps_total": 1456764, "episode_reward_mean": -390.075911400312, "episodes_this_iter": 48, "date": "2019-05-23_09-32-27", "time_this_iter_s": 27.86893653869629, "num_metric_batches_dropped": 0, "episode_reward_min": -644.1066696146528}
{"time_since_restore": 1184.282295703888, "info": {"default": {"kl": 0.019308004528284073, "entropy": 1.2076389789581299, "total_loss": 14.38701057434082, "vf_explained_var": 0.8925241231918335, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00603806646540761, "cur_kl_coeff": 0.01874999888241291, "vf_loss": 14.39268684387207}, "num_steps_trained": 1489899, "grad_time_ms": 10393.243, "num_steps_sampled": 1489899, "sample_time_ms": 19258.775, "load_time_ms": 5.718, "update_time_ms": 10.629}, "hostname": "flow-main", "episode_reward_max": -88.11669217088553, "timesteps_this_iter": 33135, "custom_metrics": {"cost1_max": 218.54518900123907, "cost1_mean": 183.35541790887962, "system_level_velocity_mean": 15.83259661187406, "cost2_mean": -44.96429695051099, "cost2_max": -25.765128834405445, "outflow_rate_max": 1406.6711857251044, "cost1_min": 78.66742137031089, "system_level_velocity_min": 12.432504201782727, "system_level_velocity_max": 18.88430187866237, "outflow_rate_min": 776.3206846343352, "cost2_min": -68.69514824891058, "outflow_rate_mean": 1135.9797873267707}, "done": false, "pid": 51582, "episode_len_mean": 318.37, "node_ip": "10.138.0.2", "timesteps_since_restore": 1489899, "time_total_s": 1184.282295703888, "timestamp": 1558603974, "iterations_since_restore": 38, "policy_reward_mean": {}, "training_iteration": 38, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530828>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530c50>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1762, "timesteps_total": 1489899, "episode_reward_mean": -354.26922467933065, "episodes_this_iter": 46, "date": "2019-05-23_09-32-54", "time_this_iter_s": 26.528047800064087, "num_metric_batches_dropped": 0, "episode_reward_min": -644.1066696146528}
{"time_since_restore": 1212.9006702899933, "info": {"default": {"kl": 0.019278602674603462, "entropy": 1.23628568649292, "total_loss": 17.662094116210938, "vf_explained_var": 0.8956531882286072, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007638092618435621, "cur_kl_coeff": 0.01874999888241291, "vf_loss": 17.66937255859375}, "num_steps_trained": 1523616, "grad_time_ms": 10034.955, "num_steps_sampled": 1523616, "sample_time_ms": 19414.428, "load_time_ms": 5.533, "update_time_ms": 10.386}, "hostname": "flow-main", "episode_reward_max": -88.11669217088553, "timesteps_this_iter": 33717, "custom_metrics": {"cost1_max": 219.57761729331008, "cost1_mean": 185.57983418464036, "system_level_velocity_mean": 15.978403366920707, "cost2_mean": -44.43944991982014, "cost2_max": -25.99319355507574, "outflow_rate_max": 1406.6711857251044, "cost1_min": 78.66742137031089, "system_level_velocity_min": 11.77229212873776, "system_level_velocity_max": 18.88430187866237, "outflow_rate_min": 776.3206846343352, "cost2_min": -79.2886295162692, "outflow_rate_mean": 1127.6855288960219}, "done": false, "pid": 51582, "episode_len_mean": 319.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 1523616, "time_total_s": 1212.9006702899933, "timestamp": 1558604003, "iterations_since_restore": 39, "policy_reward_mean": {}, "training_iteration": 39, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534748>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534240>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1812, "timesteps_total": 1523616, "episode_reward_mean": -343.0625082802264, "episodes_this_iter": 50, "date": "2019-05-23_09-33-23", "time_this_iter_s": 28.618374586105347, "num_metric_batches_dropped": 0, "episode_reward_min": -623.1051476364706}
{"time_since_restore": 1243.1199278831482, "info": {"default": {"kl": 0.017172714695334435, "entropy": 1.21694016456604, "total_loss": 16.835281372070312, "vf_explained_var": 0.9068701267242432, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005303718615323305, "cur_kl_coeff": 0.01874999888241291, "vf_loss": 16.84026336669922}, "num_steps_trained": 1558261, "grad_time_ms": 9852.96, "num_steps_sampled": 1558261, "sample_time_ms": 19295.806, "load_time_ms": 5.624, "update_time_ms": 10.061}, "hostname": "flow-main", "episode_reward_max": -97.54291892606761, "timesteps_this_iter": 34645, "custom_metrics": {"cost1_max": 222.5861448240501, "cost1_mean": 185.1272890129938, "system_level_velocity_mean": 15.720480066305207, "cost2_mean": -47.39430617572208, "cost2_max": -29.290677917274408, "outflow_rate_max": 1401.636718532357, "cost1_min": 84.75081534977775, "system_level_velocity_min": 11.77229212873776, "system_level_velocity_max": 18.754444899562987, "outflow_rate_min": 800.6399607194675, "cost2_min": -79.2886295162692, "outflow_rate_mean": 1127.3261382448538}, "done": false, "pid": 51582, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1558261, "time_total_s": 1243.1199278831482, "timestamp": 1558604033, "iterations_since_restore": 40, "policy_reward_mean": {}, "training_iteration": 40, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534da0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845346a0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534128>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1856, "timesteps_total": 1558261, "episode_reward_mean": -365.14402996532476, "episodes_this_iter": 44, "date": "2019-05-23_09-33-53", "time_this_iter_s": 30.219257593154907, "num_metric_batches_dropped": 0, "episode_reward_min": -623.1051476364706}
{"time_since_restore": 1269.2533421516418, "info": {"default": {"kl": 0.015727195888757706, "entropy": 1.1890877485275269, "total_loss": 16.53569984436035, "vf_explained_var": 0.8937122821807861, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004804373253136873, "cur_kl_coeff": 0.01874999888241291, "vf_loss": 16.540210723876953}, "num_steps_trained": 1590759, "grad_time_ms": 9842.428, "num_steps_sampled": 1590759, "sample_time_ms": 18882.955, "load_time_ms": 5.442, "update_time_ms": 10.036}, "hostname": "flow-main", "episode_reward_max": -235.51772123474203, "timesteps_this_iter": 32498, "custom_metrics": {"cost1_max": 222.6397033658873, "cost1_mean": 187.8670296045967, "system_level_velocity_mean": 15.830354338334741, "cost2_mean": -49.27744384508169, "cost2_max": -25.913443081140045, "outflow_rate_max": 1423.534783776038, "cost1_min": 147.39227712586776, "system_level_velocity_min": 12.161772023678013, "system_level_velocity_max": 18.754267798465087, "outflow_rate_min": 924.9665935462434, "cost2_min": -70.31446764095071, "outflow_rate_mean": 1142.117873771909}, "done": false, "pid": 51582, "episode_len_mean": 324.8, "node_ip": "10.138.0.2", "timesteps_since_restore": 1590759, "time_total_s": 1269.2533421516418, "timestamp": 1558604059, "iterations_since_restore": 41, "policy_reward_mean": {}, "training_iteration": 41, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537518>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845374a8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845374e0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1901, "timesteps_total": 1590759, "episode_reward_mean": -364.47288064219623, "episodes_this_iter": 45, "date": "2019-05-23_09-34-19", "time_this_iter_s": 26.133414268493652, "num_metric_batches_dropped": 0, "episode_reward_min": -601.4277680271294}
{"time_since_restore": 1294.6977620124817, "info": {"default": {"kl": 0.016056042164564133, "entropy": 1.1874094009399414, "total_loss": 14.490937232971191, "vf_explained_var": 0.90036541223526, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00563254626467824, "cur_kl_coeff": 0.01874999701976776, "vf_loss": 14.496269226074219}, "num_steps_trained": 1622441, "grad_time_ms": 9722.0, "num_steps_sampled": 1622441, "sample_time_ms": 18572.809, "load_time_ms": 5.399, "update_time_ms": 10.136}, "hostname": "flow-main", "episode_reward_max": -220.32363897364036, "timesteps_this_iter": 31682, "custom_metrics": {"cost1_max": 222.6397033658873, "cost1_mean": 191.75420611505527, "system_level_velocity_mean": 16.216107670401684, "cost2_mean": -47.693605888165955, "cost2_max": -24.800965225124006, "outflow_rate_max": 1423.534783776038, "cost1_min": 154.36801056444364, "system_level_velocity_min": 12.92143303557205, "system_level_velocity_max": 18.754267798465087, "outflow_rate_min": 917.5128822159578, "cost2_min": -70.31446764095071, "outflow_rate_mean": 1144.9793213581702}, "done": false, "pid": 51582, "episode_len_mean": 324.52, "node_ip": "10.138.0.2", "timesteps_since_restore": 1622441, "time_total_s": 1294.6977620124817, "timestamp": 1558604084, "iterations_since_restore": 42, "policy_reward_mean": {}, "training_iteration": 42, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530b38>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530048>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530940>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1948, "timesteps_total": 1622441, "episode_reward_mean": -336.36837765708884, "episodes_this_iter": 47, "date": "2019-05-23_09-34-44", "time_this_iter_s": 25.444419860839844, "num_metric_batches_dropped": 0, "episode_reward_min": -601.4277680271294}
{"time_since_restore": 1321.6181344985962, "info": {"default": {"kl": 0.019158292561769485, "entropy": 1.1605924367904663, "total_loss": 16.20431900024414, "vf_explained_var": 0.8992992639541626, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007246081717312336, "cur_kl_coeff": 0.01875000074505806, "vf_loss": 16.211206436157227}, "num_steps_trained": 1655276, "grad_time_ms": 9499.691, "num_steps_sampled": 1655276, "sample_time_ms": 18366.615, "load_time_ms": 5.143, "update_time_ms": 10.014}, "hostname": "flow-main", "episode_reward_max": -29.68468028371567, "timesteps_this_iter": 32835, "custom_metrics": {"cost1_max": 221.92708961983823, "cost1_mean": 187.41558620953808, "system_level_velocity_mean": 16.1439043359185, "cost2_mean": -46.04071078494845, "cost2_max": -20.36435696270163, "outflow_rate_max": 1404.6289933070004, "cost1_min": 25.135460811384956, "system_level_velocity_min": 12.575191514240819, "system_level_velocity_max": 18.828206670744272, "outflow_rate_min": 515.6032332569888, "cost2_min": -67.71650742986796, "outflow_rate_mean": 1121.3636707354824}, "done": false, "pid": 51582, "episode_len_mean": 319.77, "node_ip": "10.138.0.2", "timesteps_since_restore": 1655276, "time_total_s": 1321.6181344985962, "timestamp": 1558604111, "iterations_since_restore": 43, "policy_reward_mean": {}, "training_iteration": 43, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845375c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537198>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 1997, "timesteps_total": 1655276, "episode_reward_mean": -326.9866784200001, "episodes_this_iter": 49, "date": "2019-05-23_09-35-11", "time_this_iter_s": 26.920372486114502, "num_metric_batches_dropped": 0, "episode_reward_min": -535.420339315506}
{"time_since_restore": 1350.3278353214264, "info": {"default": {"kl": 0.021680742502212524, "entropy": 1.1637827157974243, "total_loss": 14.892731666564941, "vf_explained_var": 0.9137927293777466, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007616506889462471, "cur_kl_coeff": 0.01874999888241291, "vf_loss": 14.899941444396973}, "num_steps_trained": 1688769, "grad_time_ms": 9490.829, "num_steps_sampled": 1688769, "sample_time_ms": 18305.401, "load_time_ms": 5.155, "update_time_ms": 10.027}, "hostname": "flow-main", "episode_reward_max": -29.68468028371567, "timesteps_this_iter": 33493, "custom_metrics": {"cost1_max": 222.29895503081815, "cost1_mean": 187.4699630325449, "system_level_velocity_mean": 16.1225854167547, "cost2_mean": -48.21962671303641, "cost2_max": -20.36435696270163, "outflow_rate_max": 1404.6289933070004, "cost1_min": 25.135460811384956, "system_level_velocity_min": 12.575191514240819, "system_level_velocity_max": 18.86116028675674, "outflow_rate_min": 515.6032332569888, "cost2_min": -70.668006748439, "outflow_rate_mean": 1133.8787039195217}, "done": false, "pid": 51582, "episode_len_mean": 320.05, "node_ip": "10.138.0.2", "timesteps_since_restore": 1688769, "time_total_s": 1350.3278353214264, "timestamp": 1558604140, "iterations_since_restore": 44, "policy_reward_mean": {}, "training_iteration": 44, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469a6d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469af98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469a358>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2043, "timesteps_total": 1688769, "episode_reward_mean": -334.9146996272517, "episodes_this_iter": 46, "date": "2019-05-23_09-35-40", "time_this_iter_s": 28.7097008228302, "num_metric_batches_dropped": 0, "episode_reward_min": -535.420339315506}
{"time_since_restore": 1374.9606840610504, "info": {"default": {"kl": 0.020331881940364838, "entropy": 1.2125041484832764, "total_loss": 13.902502059936523, "vf_explained_var": 0.8910568356513977, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007024550344794989, "cur_kl_coeff": 0.028124995529651642, "vf_loss": 13.908954620361328}, "num_steps_trained": 1718926, "grad_time_ms": 9295.185, "num_steps_sampled": 1718926, "sample_time_ms": 18089.657, "load_time_ms": 5.104, "update_time_ms": 9.992}, "hostname": "flow-main", "episode_reward_max": -102.26797799142498, "timesteps_this_iter": 30157, "custom_metrics": {"cost1_max": 223.46188880604834, "cost1_mean": 189.52602659310077, "system_level_velocity_mean": 16.18506429418065, "cost2_mean": -46.31834965396921, "cost2_max": -27.14585393743282, "outflow_rate_max": 1399.1148686254246, "cost1_min": 85.37676335235386, "system_level_velocity_min": 12.912553573062228, "system_level_velocity_max": 19.174806719361403, "outflow_rate_min": 777.0161163473083, "cost2_min": -70.668006748439, "outflow_rate_mean": 1117.1656308216723}, "done": false, "pid": 51582, "episode_len_mean": 322.83, "node_ip": "10.138.0.2", "timesteps_since_restore": 1718926, "time_total_s": 1374.9606840610504, "timestamp": 1558604165, "iterations_since_restore": 45, "policy_reward_mean": {}, "training_iteration": 45, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537c88>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537cc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537dd8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2091, "timesteps_total": 1718926, "episode_reward_mean": -325.23279962665464, "episodes_this_iter": 48, "date": "2019-05-23_09-36-05", "time_this_iter_s": 24.632848739624023, "num_metric_batches_dropped": 0, "episode_reward_min": -539.7767231199492}
{"time_since_restore": 1400.380720615387, "info": {"default": {"kl": 0.021058110520243645, "entropy": 1.189988374710083, "total_loss": 14.04700756072998, "vf_explained_var": 0.8869943022727966, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007299839053303003, "cur_kl_coeff": 0.042187511920928955, "vf_loss": 14.05341911315918}, "num_steps_trained": 1749005, "grad_time_ms": 9006.916, "num_steps_sampled": 1749005, "sample_time_ms": 17947.931, "load_time_ms": 5.103, "update_time_ms": 9.747}, "hostname": "flow-main", "episode_reward_max": -102.26797799142498, "timesteps_this_iter": 30079, "custom_metrics": {"cost1_max": 223.46188880604834, "cost1_mean": 190.0958929438417, "system_level_velocity_mean": 16.30227110301076, "cost2_mean": -41.42272781961904, "cost2_max": -24.27574458873031, "outflow_rate_max": 1390.02544788802, "cost1_min": 85.37676335235386, "system_level_velocity_min": 12.912553573062228, "system_level_velocity_max": 19.265879786550112, "outflow_rate_min": 777.0161163473083, "cost2_min": -58.458553448467676, "outflow_rate_mean": 1082.0521695202995}, "done": false, "pid": 51582, "episode_len_mean": 322.55, "node_ip": "10.138.0.2", "timesteps_since_restore": 1749005, "time_total_s": 1400.380720615387, "timestamp": 1558604190, "iterations_since_restore": 46, "policy_reward_mean": {}, "training_iteration": 46, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537390>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537160>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2137, "timesteps_total": 1749005, "episode_reward_mean": -302.0266107719464, "episodes_this_iter": 46, "date": "2019-05-23_09-36-30", "time_this_iter_s": 25.420036554336548, "num_metric_batches_dropped": 0, "episode_reward_min": -539.7767231199492}
{"time_since_restore": 1426.3372340202332, "info": {"default": {"kl": 0.024123268201947212, "entropy": 1.16957426071167, "total_loss": 13.308919906616211, "vf_explained_var": 0.9097771644592285, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009889948181807995, "cur_kl_coeff": 0.06328123807907104, "vf_loss": 13.317282676696777}, "num_steps_trained": 1779966, "grad_time_ms": 8699.046, "num_steps_sampled": 1779966, "sample_time_ms": 18067.54, "load_time_ms": 5.061, "update_time_ms": 9.735}, "hostname": "flow-main", "episode_reward_max": -209.65845388623794, "timesteps_this_iter": 30961, "custom_metrics": {"cost1_max": 219.62829629979294, "cost1_mean": 190.3699332809302, "system_level_velocity_mean": 16.184820659088295, "cost2_mean": -42.39325046788688, "cost2_max": -24.27574458873031, "outflow_rate_max": 1383.997116696632, "cost1_min": 154.33803705741883, "system_level_velocity_min": 12.912553573062228, "system_level_velocity_max": 19.265879786550112, "outflow_rate_min": 900.717320754717, "cost2_min": -59.18753941434843, "outflow_rate_mean": 1088.0882240763349}, "done": false, "pid": 51582, "episode_len_mean": 324.52, "node_ip": "10.138.0.2", "timesteps_since_restore": 1779966, "time_total_s": 1426.3372340202332, "timestamp": 1558604216, "iterations_since_restore": 47, "policy_reward_mean": {}, "training_iteration": 47, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534cc0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469ada0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534ba8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2182, "timesteps_total": 1779966, "episode_reward_mean": -305.4348338829217, "episodes_this_iter": 45, "date": "2019-05-23_09-36-56", "time_this_iter_s": 25.95651340484619, "num_metric_batches_dropped": 0, "episode_reward_min": -568.4668798548438}
{"time_since_restore": 1453.7865552902222, "info": {"default": {"kl": 0.016349898651242256, "entropy": 1.12775719165802, "total_loss": 15.307119369506836, "vf_explained_var": 0.8834648132324219, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005698784254491329, "cur_kl_coeff": 0.09492187201976776, "vf_loss": 15.311267852783203}, "num_steps_trained": 1810934, "grad_time_ms": 8704.128, "num_steps_sampled": 1810934, "sample_time_ms": 18155.709, "load_time_ms": 4.797, "update_time_ms": 8.853}, "hostname": "flow-main", "episode_reward_max": -21.48190246250793, "timesteps_this_iter": 30968, "custom_metrics": {"cost1_max": 221.32775618887257, "cost1_mean": 191.2588196800207, "system_level_velocity_mean": 16.403383991842254, "cost2_mean": -41.811962226016476, "cost2_max": -9.229068315898957, "outflow_rate_max": 1383.997116696632, "cost1_min": 17.674162591813747, "system_level_velocity_min": 13.152411186615788, "system_level_velocity_max": 19.015793466453147, "outflow_rate_min": 474.3699846082663, "cost2_min": -59.18753941434843, "outflow_rate_mean": 1105.8790561790943}, "done": false, "pid": 51582, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 1810934, "time_total_s": 1453.7865552902222, "timestamp": 1558604244, "iterations_since_restore": 48, "policy_reward_mean": {}, "training_iteration": 48, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534c18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534da0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534eb8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2230, "timesteps_total": 1810934, "episode_reward_mean": -300.58253973392186, "episodes_this_iter": 48, "date": "2019-05-23_09-37-24", "time_this_iter_s": 27.449321269989014, "num_metric_batches_dropped": 0, "episode_reward_min": -568.4668798548438}
{"time_since_restore": 1479.173488855362, "info": {"default": {"kl": 0.016704732552170753, "entropy": 1.1742340326309204, "total_loss": 13.460298538208008, "vf_explained_var": 0.9132104516029358, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006855919491499662, "cur_kl_coeff": 0.09492187201976776, "vf_loss": 13.465568542480469}, "num_steps_trained": 1842289, "grad_time_ms": 8768.784, "num_steps_sampled": 1842289, "sample_time_ms": 17765.985, "load_time_ms": 4.669, "update_time_ms": 9.095}, "hostname": "flow-main", "episode_reward_max": -21.48190246250793, "timesteps_this_iter": 31355, "custom_metrics": {"cost1_max": 221.32775618887257, "cost1_mean": 192.15398777059826, "system_level_velocity_mean": 16.543024517715867, "cost2_mean": -40.02908948791096, "cost2_max": -9.229068315898957, "outflow_rate_max": 1393.0856793410223, "cost1_min": 17.674162591813747, "system_level_velocity_min": 11.84464559439756, "system_level_velocity_max": 19.015793466453147, "outflow_rate_min": 474.3699846082663, "cost2_min": -56.336104386910264, "outflow_rate_mean": 1114.880944478521}, "done": false, "pid": 51582, "episode_len_mean": 320.95, "node_ip": "10.138.0.2", "timesteps_since_restore": 1842289, "time_total_s": 1479.173488855362, "timestamp": 1558604269, "iterations_since_restore": 49, "policy_reward_mean": {}, "training_iteration": 49, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537400>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469a550>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845375f8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2276, "timesteps_total": 1842289, "episode_reward_mean": -298.909304815411, "episodes_this_iter": 46, "date": "2019-05-23_09-37-49", "time_this_iter_s": 25.38693356513977, "num_metric_batches_dropped": 0, "episode_reward_min": -516.2753610499325}
{"time_since_restore": 1503.6879451274872, "info": {"default": {"kl": 0.03642376512289047, "entropy": 1.180325984954834, "total_loss": 13.811527252197266, "vf_explained_var": 0.9129509925842285, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000704773876350373, "cur_kl_coeff": 0.09492186456918716, "vf_loss": 13.808775901794434}, "num_steps_trained": 1873461, "grad_time_ms": 8507.149, "num_steps_sampled": 1873461, "sample_time_ms": 17456.371, "load_time_ms": 4.538, "update_time_ms": 9.216}, "hostname": "flow-main", "episode_reward_max": -179.37409103615727, "timesteps_this_iter": 31172, "custom_metrics": {"cost1_max": 221.32775618887257, "cost1_mean": 187.93025610883814, "system_level_velocity_mean": 16.007351204120354, "cost2_mean": -39.71860402155333, "cost2_max": -23.137571323926835, "outflow_rate_max": 1393.0856793410223, "cost1_min": 137.90623987003238, "system_level_velocity_min": 11.246359131557085, "system_level_velocity_max": 18.812110120920355, "outflow_rate_min": 886.8172797504084, "cost2_min": -56.336104386910264, "outflow_rate_mean": 1086.0694442858378}, "done": false, "pid": 51582, "episode_len_mean": 323.65, "node_ip": "10.138.0.2", "timesteps_since_restore": 1873461, "time_total_s": 1503.6879451274872, "timestamp": 1558604294, "iterations_since_restore": 50, "policy_reward_mean": {}, "training_iteration": 50, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541400>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845415f8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541fd0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2319, "timesteps_total": 1873461, "episode_reward_mean": -316.4461858969969, "episodes_this_iter": 43, "date": "2019-05-23_09-38-14", "time_this_iter_s": 24.514456272125244, "num_metric_batches_dropped": 0, "episode_reward_min": -568.655919341779}
{"time_since_restore": 1530.6192390918732, "info": {"default": {"kl": 0.01287770364433527, "entropy": 1.128783941268921, "total_loss": 16.66815948486328, "vf_explained_var": 0.8726238012313843, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00655588461086154, "cur_kl_coeff": 0.14238283038139343, "vf_loss": 16.672880172729492}, "num_steps_trained": 1905335, "grad_time_ms": 8287.461, "num_steps_sampled": 1905335, "sample_time_ms": 17757.398, "load_time_ms": 4.552, "update_time_ms": 9.329}, "hostname": "flow-main", "episode_reward_max": -179.37409103615727, "timesteps_this_iter": 31874, "custom_metrics": {"cost1_max": 221.17532511771543, "cost1_mean": 190.69955518728952, "system_level_velocity_mean": 16.247216371180794, "cost2_mean": -39.5437498474927, "cost2_max": -23.161758037706292, "outflow_rate_max": 1369.7333146626995, "cost1_min": 137.90623987003238, "system_level_velocity_min": 11.246359131557085, "system_level_velocity_max": 18.813128685146935, "outflow_rate_min": 886.8172797504084, "cost2_min": -58.10524810701603, "outflow_rate_mean": 1105.9061918308391}, "done": false, "pid": 51582, "episode_len_mean": 323.65, "node_ip": "10.138.0.2", "timesteps_since_restore": 1905335, "time_total_s": 1530.6192390918732, "timestamp": 1558604321, "iterations_since_restore": 51, "policy_reward_mean": {}, "training_iteration": 51, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845375f8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537198>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2367, "timesteps_total": 1905335, "episode_reward_mean": -313.3595223937447, "episodes_this_iter": 48, "date": "2019-05-23_09-38-41", "time_this_iter_s": 26.931293964385986, "num_metric_batches_dropped": 0, "episode_reward_min": -568.655919341779}
{"time_since_restore": 1560.2425532341003, "info": {"default": {"kl": 0.014997458085417747, "entropy": 1.1204237937927246, "total_loss": 20.332069396972656, "vf_explained_var": 0.8621536493301392, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007217905949801207, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 20.337148666381836}, "num_steps_trained": 1938987, "grad_time_ms": 8369.139, "num_steps_sampled": 1938987, "sample_time_ms": 18093.872, "load_time_ms": 4.803, "update_time_ms": 9.099}, "hostname": "flow-main", "episode_reward_max": -84.18841694982848, "timesteps_this_iter": 33652, "custom_metrics": {"cost1_max": 222.89590863896322, "cost1_mean": 191.37316887978352, "system_level_velocity_mean": 16.392891374437628, "cost2_mean": -42.207638485079926, "cost2_max": -22.991188828660754, "outflow_rate_max": 1414.0256617192335, "cost1_min": 79.30622069250563, "system_level_velocity_min": 12.107029560246975, "system_level_velocity_max": 18.88798636987468, "outflow_rate_min": 769.2863905507536, "cost2_min": -64.03898068501512, "outflow_rate_mean": 1136.8644605601821}, "done": false, "pid": 51582, "episode_len_mean": 321.46, "node_ip": "10.138.0.2", "timesteps_since_restore": 1938987, "time_total_s": 1560.2425532341003, "timestamp": 1558604350, "iterations_since_restore": 52, "policy_reward_mean": {}, "training_iteration": 52, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537d68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537fd0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537e10>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2416, "timesteps_total": 1938987, "episode_reward_mean": -319.9549928781292, "episodes_this_iter": 49, "date": "2019-05-23_09-39-10", "time_this_iter_s": 29.623314142227173, "num_metric_batches_dropped": 0, "episode_reward_min": -650.6852037702679}
{"time_since_restore": 1587.56285738945, "info": {"default": {"kl": 0.014064586721360683, "entropy": 1.1139577627182007, "total_loss": 18.476194381713867, "vf_explained_var": 0.8868021368980408, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005968341138213873, "cur_kl_coeff": 0.14238283038139343, "vf_loss": 18.480159759521484}, "num_steps_trained": 1973032, "grad_time_ms": 8590.356, "num_steps_sampled": 1973032, "sample_time_ms": 17910.804, "load_time_ms": 4.918, "update_time_ms": 8.744}, "hostname": "flow-main", "episode_reward_max": -84.18841694982848, "timesteps_this_iter": 34045, "custom_metrics": {"cost1_max": 222.89590863896322, "cost1_mean": 191.66721989431937, "system_level_velocity_mean": 16.407965393433564, "cost2_mean": -43.48467205571917, "cost2_max": -22.991188828660754, "outflow_rate_max": 1414.0256617192335, "cost1_min": 79.30622069250563, "system_level_velocity_min": 12.107029560246975, "system_level_velocity_max": 18.96349555919585, "outflow_rate_min": 769.2863905507536, "cost2_min": -66.75612394514289, "outflow_rate_mean": 1151.8979247625305}, "done": false, "pid": 51582, "episode_len_mean": 321.18, "node_ip": "10.138.0.2", "timesteps_since_restore": 1973032, "time_total_s": 1587.56285738945, "timestamp": 1558604378, "iterations_since_restore": 53, "policy_reward_mean": {}, "training_iteration": 53, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845415c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541b38>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2458, "timesteps_total": 1973032, "episode_reward_mean": -327.69362584181465, "episodes_this_iter": 42, "date": "2019-05-23_09-39-38", "time_this_iter_s": 27.32030415534973, "num_metric_batches_dropped": 0, "episode_reward_min": -650.6852037702679}
{"time_since_restore": 1616.365002155304, "info": {"default": {"kl": 0.013389494270086288, "entropy": 1.1130796670913696, "total_loss": 20.404787063598633, "vf_explained_var": 0.8822862505912781, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007263503968715668, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 20.410144805908203}, "num_steps_trained": 2008499, "grad_time_ms": 8731.056, "num_steps_sampled": 2008499, "sample_time_ms": 17777.634, "load_time_ms": 4.862, "update_time_ms": 9.233}, "hostname": "flow-main", "episode_reward_max": -89.07343078938408, "timesteps_this_iter": 35467, "custom_metrics": {"cost1_max": 222.89590863896322, "cost1_mean": 189.442473127477, "system_level_velocity_mean": 16.097812691167835, "cost2_mean": -46.0070751046467, "cost2_max": -29.848517509435396, "outflow_rate_max": 1414.0256617192335, "cost1_min": 80.32340148996356, "system_level_velocity_min": 12.480655663113216, "system_level_velocity_max": 18.96349555919585, "outflow_rate_min": 768.0536593672856, "cost2_min": -72.08628424073694, "outflow_rate_mean": 1153.7754869651824}, "done": false, "pid": 51582, "episode_len_mean": 322.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 2008499, "time_total_s": 1616.365002155304, "timestamp": 1558604406, "iterations_since_restore": 54, "policy_reward_mean": {}, "training_iteration": 54, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541588>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541438>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541e10>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2508, "timesteps_total": 2008499, "episode_reward_mean": -356.8951787733443, "episodes_this_iter": 50, "date": "2019-05-23_09-40-06", "time_this_iter_s": 28.802144765853882, "num_metric_batches_dropped": 0, "episode_reward_min": -632.4075431005804}
{"time_since_restore": 1644.4436419010162, "info": {"default": {"kl": 0.014133719727396965, "entropy": 1.1010173559188843, "total_loss": 19.308374404907227, "vf_explained_var": 0.8583790063858032, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008353211916983128, "cur_kl_coeff": 0.14238283038139343, "vf_loss": 19.314716339111328}, "num_steps_trained": 2042532, "grad_time_ms": 8849.7, "num_steps_sampled": 2042532, "sample_time_ms": 18002.61, "load_time_ms": 4.681, "update_time_ms": 9.498}, "hostname": "flow-main", "episode_reward_max": -89.07343078938408, "timesteps_this_iter": 34033, "custom_metrics": {"cost1_max": 222.82947699171297, "cost1_mean": 190.04575924959735, "system_level_velocity_mean": 16.156744131742904, "cost2_mean": -46.498766422653524, "cost2_max": -29.848517509435396, "outflow_rate_max": 1392.8634193383407, "cost1_min": 80.32340148996356, "system_level_velocity_min": 12.480655663113216, "system_level_velocity_max": 18.851038818759665, "outflow_rate_min": 768.0536593672856, "cost2_min": -72.08628424073694, "outflow_rate_mean": 1163.8816020671634}, "done": false, "pid": 51582, "episode_len_mean": 322.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 2042532, "time_total_s": 1644.4436419010162, "timestamp": 1558604435, "iterations_since_restore": 55, "policy_reward_mean": {}, "training_iteration": 55, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537f28>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537550>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537400>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2556, "timesteps_total": 2042532, "episode_reward_mean": -362.9323322484938, "episodes_this_iter": 48, "date": "2019-05-23_09-40-35", "time_this_iter_s": 28.07863974571228, "num_metric_batches_dropped": 0, "episode_reward_min": -632.4075431005804}
{"time_since_restore": 1671.8270626068115, "info": {"default": {"kl": 0.013805810362100601, "entropy": 1.1234151124954224, "total_loss": 14.864400863647461, "vf_explained_var": 0.9056528806686401, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006186839658766985, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 14.868623733520508}, "num_steps_trained": 2077334, "grad_time_ms": 8776.384, "num_steps_sampled": 2077334, "sample_time_ms": 18274.582, "load_time_ms": 4.635, "update_time_ms": 9.837}, "hostname": "flow-main", "episode_reward_max": -215.30395519546687, "timesteps_this_iter": 34802, "custom_metrics": {"cost1_max": 222.82947699171297, "cost1_mean": 193.0440514199635, "system_level_velocity_mean": 16.32046923259856, "cost2_mean": -45.77047440889568, "cost2_max": -27.874502945187736, "outflow_rate_max": 1392.8634193383407, "cost1_min": 151.29850462324137, "system_level_velocity_min": 12.65800800578671, "system_level_velocity_max": 18.94762620280931, "outflow_rate_min": 893.4047252803075, "cost2_min": -71.38674332239762, "outflow_rate_mean": 1171.049626550886}, "done": false, "pid": 51582, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 2077334, "time_total_s": 1671.8270626068115, "timestamp": 1558604462, "iterations_since_restore": 56, "policy_reward_mean": {}, "training_iteration": 56, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534550>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534ac8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2599, "timesteps_total": 2077334, "episode_reward_mean": -350.9523790603148, "episodes_this_iter": 43, "date": "2019-05-23_09-41-02", "time_this_iter_s": 27.383420705795288, "num_metric_batches_dropped": 0, "episode_reward_min": -559.1503424163003}
{"time_since_restore": 1700.4445559978485, "info": {"default": {"kl": 0.017308976501226425, "entropy": 1.123888611793518, "total_loss": 20.894092559814453, "vf_explained_var": 0.8591762185096741, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009012161754071712, "cur_kl_coeff": 0.14238283038139343, "vf_loss": 20.90064239501953}, "num_steps_trained": 2111854, "grad_time_ms": 8964.265, "num_steps_sampled": 2111854, "sample_time_ms": 18351.492, "load_time_ms": 4.537, "update_time_ms": 9.683}, "hostname": "flow-main", "episode_reward_max": -83.4972759498423, "timesteps_this_iter": 34520, "custom_metrics": {"cost1_max": 221.43484335992594, "cost1_mean": 188.90968548106414, "system_level_velocity_mean": 16.079950020620466, "cost2_mean": -46.4617503861342, "cost2_max": -20.956215696449966, "outflow_rate_max": 1359.3517169870352, "cost1_min": 80.48033609949191, "system_level_velocity_min": 12.454212064040576, "system_level_velocity_max": 18.996157785192786, "outflow_rate_min": 770.4066582225018, "cost2_min": -69.0397331907618, "outflow_rate_mean": 1153.0258410620786}, "done": false, "pid": 51582, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 2111854, "time_total_s": 1700.4445559978485, "timestamp": 1558604491, "iterations_since_restore": 57, "policy_reward_mean": {}, "training_iteration": 57, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537da0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537c50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537f60>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2648, "timesteps_total": 2111854, "episode_reward_mean": -358.8847457148033, "episodes_this_iter": 49, "date": "2019-05-23_09-41-31", "time_this_iter_s": 28.617493391036987, "num_metric_batches_dropped": 0, "episode_reward_min": -603.5598363225666}
{"time_since_restore": 1727.649909734726, "info": {"default": {"kl": 0.014802267774939537, "entropy": 1.1279964447021484, "total_loss": 17.269269943237305, "vf_explained_var": 0.8637331128120422, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007381504867225885, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 17.2745418548584}, "num_steps_trained": 2144927, "grad_time_ms": 9105.656, "num_steps_sampled": 2144927, "sample_time_ms": 18185.462, "load_time_ms": 4.762, "update_time_ms": 9.787}, "hostname": "flow-main", "episode_reward_max": -83.4972759498423, "timesteps_this_iter": 33073, "custom_metrics": {"cost1_max": 221.22029054692428, "cost1_mean": 188.7116251515634, "system_level_velocity_mean": 16.189937025810533, "cost2_mean": -44.72632395325893, "cost2_max": -20.956215696449966, "outflow_rate_max": 1347.5500230539392, "cost1_min": 78.57110270492909, "system_level_velocity_min": 12.373926650449912, "system_level_velocity_max": 18.996157785192786, "outflow_rate_min": 724.7810856632734, "cost2_min": -69.0397331907618, "outflow_rate_mean": 1150.463061671388}, "done": false, "pid": 51582, "episode_len_mean": 320.57, "node_ip": "10.138.0.2", "timesteps_since_restore": 2144927, "time_total_s": 1727.649909734726, "timestamp": 1558604518, "iterations_since_restore": 58, "policy_reward_mean": {}, "training_iteration": 58, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9ba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9cf8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2696, "timesteps_total": 2144927, "episode_reward_mean": -346.1834563951041, "episodes_this_iter": 48, "date": "2019-05-23_09-41-58", "time_this_iter_s": 27.20535373687744, "num_metric_batches_dropped": 0, "episode_reward_min": -603.5598363225666}
{"time_since_restore": 1754.9596064090729, "info": {"default": {"kl": 0.013974334113299847, "entropy": 1.1078280210494995, "total_loss": 18.075725555419922, "vf_explained_var": 0.8583680987358093, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00765244523063302, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 18.081388473510742}, "num_steps_trained": 2179201, "grad_time_ms": 9173.749, "num_steps_sampled": 2179201, "sample_time_ms": 18311.558, "load_time_ms": 4.847, "update_time_ms": 9.494}, "hostname": "flow-main", "episode_reward_max": -89.22446289495372, "timesteps_this_iter": 34274, "custom_metrics": {"cost1_max": 221.22029054692428, "cost1_mean": 192.8682934891857, "system_level_velocity_mean": 16.429084729179294, "cost2_mean": -42.871745056576245, "cost2_max": -22.762199118120698, "outflow_rate_max": 1367.6306138907175, "cost1_min": 78.57110270492909, "system_level_velocity_min": 11.378036196598982, "system_level_velocity_max": 18.927695040915978, "outflow_rate_min": 724.7810856632734, "cost2_min": -63.941910018164336, "outflow_rate_mean": 1162.5706013728254}, "done": false, "pid": 51582, "episode_len_mean": 322.65, "node_ip": "10.138.0.2", "timesteps_since_restore": 2179201, "time_total_s": 1754.9596064090729, "timestamp": 1558604545, "iterations_since_restore": 59, "policy_reward_mean": {}, "training_iteration": 59, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541b00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845412e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541ba8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2740, "timesteps_total": 2179201, "episode_reward_mean": -334.0615580162984, "episodes_this_iter": 44, "date": "2019-05-23_09-42-25", "time_this_iter_s": 27.309696674346924, "num_metric_batches_dropped": 0, "episode_reward_min": -567.2616017443371}
{"time_since_restore": 1783.5799944400787, "info": {"default": {"kl": 0.013532508164644241, "entropy": 1.1123296022415161, "total_loss": 19.616531372070312, "vf_explained_var": 0.8483075499534607, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006574558559805155, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 19.621179580688477}, "num_steps_trained": 2214455, "grad_time_ms": 9393.916, "num_steps_sampled": 2214455, "sample_time_ms": 18501.423, "load_time_ms": 4.898, "update_time_ms": 9.309}, "hostname": "flow-main", "episode_reward_max": -231.83583728768218, "timesteps_this_iter": 35254, "custom_metrics": {"cost1_max": 219.8197064769984, "cost1_mean": 193.31195686029307, "system_level_velocity_mean": 16.32527920976302, "cost2_mean": -43.31378310705992, "cost2_max": -26.19530775822088, "outflow_rate_max": 1367.6306138907175, "cost1_min": 139.94283233485123, "system_level_velocity_min": 11.378036196598982, "system_level_velocity_max": 18.733303845298753, "outflow_rate_min": 949.7570947420023, "cost2_min": -61.577332319537945, "outflow_rate_mean": 1168.164673799786}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2214455, "time_total_s": 1783.5799944400787, "timestamp": 1558604574, "iterations_since_restore": 60, "policy_reward_mean": {}, "training_iteration": 60, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534128>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534550>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534ac8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2788, "timesteps_total": 2214455, "episode_reward_mean": -350.6103340307529, "episodes_this_iter": 48, "date": "2019-05-23_09-42-54", "time_this_iter_s": 28.62038803100586, "num_metric_batches_dropped": 0, "episode_reward_min": -604.074278452602}
{"time_since_restore": 1810.8198382854462, "info": {"default": {"kl": 0.01670561172068119, "entropy": 1.1359007358551025, "total_loss": 17.702547073364258, "vf_explained_var": 0.8650323152542114, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008906626142561436, "cur_kl_coeff": 0.14238283038139343, "vf_loss": 17.709075927734375}, "num_steps_trained": 2248476, "grad_time_ms": 9438.296, "num_steps_sampled": 2248476, "sample_time_ms": 18487.32, "load_time_ms": 4.973, "update_time_ms": 9.427}, "hostname": "flow-main", "episode_reward_max": -234.41304111843084, "timesteps_this_iter": 34021, "custom_metrics": {"cost1_max": 217.28946660822373, "cost1_mean": 192.0372146254602, "system_level_velocity_mean": 16.24083823117911, "cost2_mean": -43.533380040407266, "cost2_max": -25.637866725395753, "outflow_rate_max": 1335.1578804246603, "cost1_min": 150.01531210560802, "system_level_velocity_min": 12.636442113631482, "system_level_velocity_max": 18.67891901075186, "outflow_rate_min": 990.9290495689659, "cost2_min": -66.73571941600065, "outflow_rate_mean": 1162.37111319168}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2248476, "time_total_s": 1810.8198382854462, "timestamp": 1558604601, "iterations_since_restore": 61, "policy_reward_mean": {}, "training_iteration": 61, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534b38>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537198>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2834, "timesteps_total": 2248476, "episode_reward_mean": -357.6693129282898, "episodes_this_iter": 46, "date": "2019-05-23_09-43-21", "time_this_iter_s": 27.23984384536743, "num_metric_batches_dropped": 0, "episode_reward_min": -604.074278452602}
{"time_since_restore": 1838.4312002658844, "info": {"default": {"kl": 0.01504578348249197, "entropy": 1.118843674659729, "total_loss": 17.674715042114258, "vf_explained_var": 0.8629144430160522, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0078639080747962, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 17.680438995361328}, "num_steps_trained": 2282854, "grad_time_ms": 9421.464, "num_steps_sampled": 2282854, "sample_time_ms": 18301.713, "load_time_ms": 4.875, "update_time_ms": 9.628}, "hostname": "flow-main", "episode_reward_max": -234.41304111843084, "timesteps_this_iter": 34378, "custom_metrics": {"cost1_max": 220.34586541276195, "cost1_mean": 191.1500963021578, "system_level_velocity_mean": 16.19159989921873, "cost2_mean": -44.30585007951852, "cost2_max": -25.637866725395753, "outflow_rate_max": 1378.0328151744566, "cost1_min": 141.21819495650718, "system_level_velocity_min": 12.636442113631482, "system_level_velocity_max": 18.873005222928402, "outflow_rate_min": 876.4990443974629, "cost2_min": -68.4459390370952, "outflow_rate_mean": 1158.5475711094375}, "done": false, "pid": 51582, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 2282854, "time_total_s": 1838.4312002658844, "timestamp": 1558604629, "iterations_since_restore": 62, "policy_reward_mean": {}, "training_iteration": 62, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537c50>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537ba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537da0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2879, "timesteps_total": 2282854, "episode_reward_mean": -354.18608289087285, "episodes_this_iter": 45, "date": "2019-05-23_09-43-49", "time_this_iter_s": 27.611361980438232, "num_metric_batches_dropped": 0, "episode_reward_min": -550.5768269294214}
{"time_since_restore": 1868.4426741600037, "info": {"default": {"kl": 0.015318579971790314, "entropy": 1.1149483919143677, "total_loss": 18.518932342529297, "vf_explained_var": 0.8627797365188599, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008307671174407005, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 18.525060653686523}, "num_steps_trained": 2318682, "grad_time_ms": 9454.71, "num_steps_sampled": 2318682, "sample_time_ms": 18537.762, "load_time_ms": 4.979, "update_time_ms": 9.893}, "hostname": "flow-main", "episode_reward_max": -81.56838048410472, "timesteps_this_iter": 35828, "custom_metrics": {"cost1_max": 220.34586541276195, "cost1_mean": 188.3262541302477, "system_level_velocity_mean": 16.0459856444203, "cost2_mean": -45.40202962056657, "cost2_max": -24.071365040047716, "outflow_rate_max": 1378.0328151744566, "cost1_min": 79.95509113027252, "system_level_velocity_min": 10.942944729857219, "system_level_velocity_max": 18.88813025541769, "outflow_rate_min": 771.3016953662029, "cost2_min": -68.9076469145728, "outflow_rate_mean": 1149.0276014292372}, "done": false, "pid": 51582, "episode_len_mean": 322.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 2318682, "time_total_s": 1868.4426741600037, "timestamp": 1558604659, "iterations_since_restore": 63, "policy_reward_mean": {}, "training_iteration": 63, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541c88>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2925, "timesteps_total": 2318682, "episode_reward_mean": -362.83143706193533, "episodes_this_iter": 46, "date": "2019-05-23_09-44-19", "time_this_iter_s": 30.011473894119263, "num_metric_batches_dropped": 0, "episode_reward_min": -605.2710926021421}
{"time_since_restore": 1896.6170423030853, "info": {"default": {"kl": 0.012974835932254791, "entropy": 1.083940863609314, "total_loss": 19.898723602294922, "vf_explained_var": 0.8508111834526062, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006683573592454195, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 19.903560638427734}, "num_steps_trained": 2354156, "grad_time_ms": 9345.239, "num_steps_sampled": 2354156, "sample_time_ms": 18584.219, "load_time_ms": 4.856, "update_time_ms": 9.509}, "hostname": "flow-main", "episode_reward_max": -26.75676101459563, "timesteps_this_iter": 35474, "custom_metrics": {"cost1_max": 222.57121355882512, "cost1_mean": 185.80616556164816, "system_level_velocity_mean": 16.13796190150059, "cost2_mean": -44.77626140154709, "cost2_max": -13.598383831293916, "outflow_rate_max": 1376.8936806478728, "cost1_min": 22.965372984197504, "system_level_velocity_min": 10.942944729857219, "system_level_velocity_max": 18.94696523982488, "outflow_rate_min": 481.55774239171393, "cost2_min": -68.9076469145728, "outflow_rate_mean": 1146.1081570148167}, "done": false, "pid": 51582, "episode_len_mean": 316.86, "node_ip": "10.138.0.2", "timesteps_since_restore": 2354156, "time_total_s": 1896.6170423030853, "timestamp": 1558604687, "iterations_since_restore": 64, "policy_reward_mean": {}, "training_iteration": 64, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530898>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 2973, "timesteps_total": 2354156, "episode_reward_mean": -359.6155993119501, "episodes_this_iter": 48, "date": "2019-05-23_09-44-47", "time_this_iter_s": 28.174368143081665, "num_metric_batches_dropped": 0, "episode_reward_min": -605.2710926021421}
{"time_since_restore": 1925.0954480171204, "info": {"default": {"kl": 0.013400084339082241, "entropy": 1.0762509107589722, "total_loss": 19.975948333740234, "vf_explained_var": 0.847969651222229, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004794762935489416, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 19.978836059570312}, "num_steps_trained": 2389392, "grad_time_ms": 9320.251, "num_steps_sampled": 2389392, "sample_time_ms": 18648.199, "load_time_ms": 4.87, "update_time_ms": 9.486}, "hostname": "flow-main", "episode_reward_max": -26.75676101459563, "timesteps_this_iter": 35236, "custom_metrics": {"cost1_max": 222.57121355882512, "cost1_mean": 188.39130849924788, "system_level_velocity_mean": 16.391303468742173, "cost2_mean": -44.829137770987785, "cost2_max": -13.598383831293916, "outflow_rate_max": 1376.8936806478728, "cost1_min": 22.965372984197504, "system_level_velocity_min": 12.723276327277219, "system_level_velocity_max": 19.038418837432832, "outflow_rate_min": 481.55774239171393, "cost2_min": -64.21866079600282, "outflow_rate_mean": 1164.5696655446802}, "done": false, "pid": 51582, "episode_len_mean": 316.34, "node_ip": "10.138.0.2", "timesteps_since_restore": 2389392, "time_total_s": 1925.0954480171204, "timestamp": 1558604716, "iterations_since_restore": 65, "policy_reward_mean": {}, "training_iteration": 65, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537748>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845375f8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537400>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3021, "timesteps_total": 2389392, "episode_reward_mean": -349.9239946310909, "episodes_this_iter": 48, "date": "2019-05-23_09-45-16", "time_this_iter_s": 28.478405714035034, "num_metric_batches_dropped": 0, "episode_reward_min": -540.8550674766869}
{"time_since_restore": 1955.0469944477081, "info": {"default": {"kl": 0.015742816030979156, "entropy": 1.0799448490142822, "total_loss": 18.432289123535156, "vf_explained_var": 0.8620479106903076, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006503650918602943, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 18.436552047729492}, "num_steps_trained": 2425527, "grad_time_ms": 9636.996, "num_steps_sampled": 2425527, "sample_time_ms": 18585.86, "load_time_ms": 4.905, "update_time_ms": 9.321}, "hostname": "flow-main", "episode_reward_max": -29.777080949241565, "timesteps_this_iter": 36135, "custom_metrics": {"cost1_max": 223.2113451871324, "cost1_mean": 191.88062268456045, "system_level_velocity_mean": 16.380961054976567, "cost2_mean": -46.97489083736007, "cost2_max": -16.649198253318232, "outflow_rate_max": 1392.7768870865536, "cost1_min": 24.4557351127401, "system_level_velocity_min": 12.754286540923465, "system_level_velocity_max": 19.080674627096112, "outflow_rate_min": 483.75182862378074, "cost2_min": -71.91806503149198, "outflow_rate_mean": 1181.4611911930901}, "done": false, "pid": 51582, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 2425527, "time_total_s": 1955.0469944477081, "timestamp": 1558604746, "iterations_since_restore": 66, "policy_reward_mean": {}, "training_iteration": 66, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534ac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534e80>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3064, "timesteps_total": 2425527, "episode_reward_mean": -359.59524756001554, "episodes_this_iter": 43, "date": "2019-05-23_09-45-46", "time_this_iter_s": 29.95154643058777, "num_metric_batches_dropped": 0, "episode_reward_min": -619.21528049742}
{"time_since_restore": 1983.3820016384125, "info": {"default": {"kl": 0.017325833439826965, "entropy": 1.0829203128814697, "total_loss": 20.67942237854004, "vf_explained_var": 0.8416509032249451, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008711558766663074, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 20.685667037963867}, "num_steps_trained": 2460738, "grad_time_ms": 9684.699, "num_steps_sampled": 2460738, "sample_time_ms": 18507.993, "load_time_ms": 5.603, "update_time_ms": 9.642}, "hostname": "flow-main", "episode_reward_max": -223.96327470918783, "timesteps_this_iter": 35211, "custom_metrics": {"cost1_max": 223.2113451871324, "cost1_mean": 191.00399610423563, "system_level_velocity_mean": 16.151660596644295, "cost2_mean": -48.28550498891188, "cost2_max": -25.29398556674034, "outflow_rate_max": 1392.7768870865536, "cost1_min": 151.9840238209394, "system_level_velocity_min": 12.754286540923465, "system_level_velocity_max": 19.080674627096112, "outflow_rate_min": 952.952395917105, "cost2_min": -71.91806503149198, "outflow_rate_mean": 1170.8487852095882}, "done": false, "pid": 51582, "episode_len_mean": 324.8, "node_ip": "10.138.0.2", "timesteps_since_restore": 2460738, "time_total_s": 1983.3820016384125, "timestamp": 1558604774, "iterations_since_restore": 67, "policy_reward_mean": {}, "training_iteration": 67, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541ef0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541cf8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3113, "timesteps_total": 2460738, "episode_reward_mean": -374.390773288508, "episodes_this_iter": 49, "date": "2019-05-23_09-46-14", "time_this_iter_s": 28.335007190704346, "num_metric_batches_dropped": 0, "episode_reward_min": -619.21528049742}
{"time_since_restore": 2011.6328201293945, "info": {"default": {"kl": 0.01818149909377098, "entropy": 1.1284985542297363, "total_loss": 17.216320037841797, "vf_explained_var": 0.8762529492378235, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010667119175195694, "cur_kl_coeff": 0.14238283038139343, "vf_loss": 17.22439956665039}, "num_steps_trained": 2495906, "grad_time_ms": 9707.472, "num_steps_sampled": 2495906, "sample_time_ms": 18588.799, "load_time_ms": 5.603, "update_time_ms": 9.641}, "hostname": "flow-main", "episode_reward_max": -225.6139520305649, "timesteps_this_iter": 35168, "custom_metrics": {"cost1_max": 222.5090826298817, "cost1_mean": 189.30560131349114, "system_level_velocity_mean": 16.008495719315032, "cost2_mean": -46.7543474840901, "cost2_max": -25.16164824498703, "outflow_rate_max": 1357.8844383306794, "cost1_min": 150.76303415586432, "system_level_velocity_min": 12.66451653396456, "system_level_velocity_max": 19.057227003241508, "outflow_rate_min": 944.7682610294121, "cost2_min": -70.18077300374678, "outflow_rate_mean": 1156.0898947266796}, "done": false, "pid": 51582, "episode_len_mean": 324.52, "node_ip": "10.138.0.2", "timesteps_since_restore": 2495906, "time_total_s": 2011.6328201293945, "timestamp": 1558604802, "iterations_since_restore": 68, "policy_reward_mean": {}, "training_iteration": 68, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530da0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845305c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530e48>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3160, "timesteps_total": 2495906, "episode_reward_mean": -371.15552288991756, "episodes_this_iter": 47, "date": "2019-05-23_09-46-42", "time_this_iter_s": 28.250818490982056, "num_metric_batches_dropped": 0, "episode_reward_min": -612.3500345544408}
{"time_since_restore": 2038.7398631572723, "info": {"default": {"kl": 0.015702802687883377, "entropy": 1.0776879787445068, "total_loss": 16.687686920166016, "vf_explained_var": 0.8658518195152283, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006377135403454304, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 16.691829681396484}, "num_steps_trained": 2529619, "grad_time_ms": 9621.658, "num_steps_sampled": 2529619, "sample_time_ms": 18652.927, "load_time_ms": 5.647, "update_time_ms": 9.93}, "hostname": "flow-main", "episode_reward_max": -225.6139520305649, "timesteps_this_iter": 33713, "custom_metrics": {"cost1_max": 220.5214292604777, "cost1_mean": 191.04947560395354, "system_level_velocity_mean": 16.152797235402883, "cost2_mean": -46.33791880342051, "cost2_max": -25.16164824498703, "outflow_rate_max": 1357.8844383306794, "cost1_min": 150.76303415586432, "system_level_velocity_min": 12.66451653396456, "system_level_velocity_max": 18.96848862858841, "outflow_rate_min": 944.7682610294121, "cost2_min": -70.18077300374678, "outflow_rate_mean": 1160.6712538834895}, "done": false, "pid": 51582, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 2529619, "time_total_s": 2038.7398631572723, "timestamp": 1558604829, "iterations_since_restore": 69, "policy_reward_mean": {}, "training_iteration": 69, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534198>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534b38>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534e80>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3204, "timesteps_total": 2529619, "episode_reward_mean": -361.9827958675375, "episodes_this_iter": 44, "date": "2019-05-23_09-47-09", "time_this_iter_s": 27.107043027877808, "num_metric_batches_dropped": 0, "episode_reward_min": -612.3500345544408}
{"time_since_restore": 2065.8379509449005, "info": {"default": {"kl": 0.01715794950723648, "entropy": 1.1248891353607178, "total_loss": 15.565755844116211, "vf_explained_var": 0.8758764266967773, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009581704623997211, "cur_kl_coeff": 0.14238283038139343, "vf_loss": 15.572894096374512}, "num_steps_trained": 2562803, "grad_time_ms": 9469.868, "num_steps_sampled": 2562803, "sample_time_ms": 18653.333, "load_time_ms": 5.78, "update_time_ms": 9.927}, "hostname": "flow-main", "episode_reward_max": -226.36794556973769, "timesteps_this_iter": 33184, "custom_metrics": {"cost1_max": 221.56507809238087, "cost1_mean": 193.54681920409345, "system_level_velocity_mean": 16.41209926923021, "cost2_mean": -43.475911252327194, "cost2_max": -27.48862699355585, "outflow_rate_max": 1335.8597071742347, "cost1_min": 152.6688055343888, "system_level_velocity_min": 12.83682949318597, "system_level_velocity_max": 18.96848862858841, "outflow_rate_min": 883.2881059907834, "cost2_min": -70.18077300374678, "outflow_rate_mean": 1159.6638736424177}, "done": false, "pid": 51582, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 2562803, "time_total_s": 2065.8379509449005, "timestamp": 1558604857, "iterations_since_restore": 70, "policy_reward_mean": {}, "training_iteration": 70, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469a0b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541b00>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845418d0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3252, "timesteps_total": 2562803, "episode_reward_mean": -340.58588604310273, "episodes_this_iter": 48, "date": "2019-05-23_09-47-37", "time_this_iter_s": 27.098087787628174, "num_metric_batches_dropped": 0, "episode_reward_min": -559.0534085511069}
{"time_since_restore": 2092.639544248581, "info": {"default": {"kl": 0.017165357246994972, "entropy": 1.081211805343628, "total_loss": 15.6989107131958, "vf_explained_var": 0.8751320242881775, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009159758687019348, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 15.70562744140625}, "num_steps_trained": 2595936, "grad_time_ms": 9567.084, "num_steps_sampled": 2595936, "sample_time_ms": 18511.376, "load_time_ms": 5.885, "update_time_ms": 9.811}, "hostname": "flow-main", "episode_reward_max": -28.748182577923934, "timesteps_this_iter": 33133, "custom_metrics": {"cost1_max": 221.58100284419982, "cost1_mean": 190.95759781786828, "system_level_velocity_mean": 16.365684868947234, "cost2_mean": -41.0153796140574, "cost2_max": -18.75394322190326, "outflow_rate_max": 1377.8060033514869, "cost1_min": 23.21867434478676, "system_level_velocity_min": 12.83682949318597, "system_level_velocity_max": 19.038823915987283, "outflow_rate_min": 471.8345490104016, "cost2_min": -61.7820229715043, "outflow_rate_mean": 1136.5101871944807}, "done": false, "pid": 51582, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 2595936, "time_total_s": 2092.639544248581, "timestamp": 1558604883, "iterations_since_restore": 71, "policy_reward_mean": {}, "training_iteration": 71, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9d30>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9978>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3298, "timesteps_total": 2595936, "episode_reward_mean": -329.36456953079346, "episodes_this_iter": 46, "date": "2019-05-23_09-48-03", "time_this_iter_s": 26.80159330368042, "num_metric_batches_dropped": 0, "episode_reward_min": -555.4773204355116}
{"time_since_restore": 2118.7928426265717, "info": {"default": {"kl": 0.016711905598640442, "entropy": 1.1279723644256592, "total_loss": 16.13188934326172, "vf_explained_var": 0.8818262815475464, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007876306772232056, "cur_kl_coeff": 0.14238283038139343, "vf_loss": 16.137386322021484}, "num_steps_trained": 2628732, "grad_time_ms": 9543.763, "num_steps_sampled": 2628732, "sample_time_ms": 18390.543, "load_time_ms": 5.752, "update_time_ms": 9.697}, "hostname": "flow-main", "episode_reward_max": -28.748182577923934, "timesteps_this_iter": 32796, "custom_metrics": {"cost1_max": 221.58100284419982, "cost1_mean": 191.44358453604906, "system_level_velocity_mean": 16.49574564099008, "cost2_mean": -40.68407418159711, "cost2_max": -18.75394322190326, "outflow_rate_max": 1377.8060033514869, "cost1_min": 23.21867434478676, "system_level_velocity_min": 12.754153855507665, "system_level_velocity_max": 19.038823915987283, "outflow_rate_min": 471.8345490104016, "cost2_min": -61.7820229715043, "outflow_rate_mean": 1136.9063510528658}, "done": false, "pid": 51582, "episode_len_mean": 320.47, "node_ip": "10.138.0.2", "timesteps_since_restore": 2628732, "time_total_s": 2118.7928426265717, "timestamp": 1558604910, "iterations_since_restore": 72, "policy_reward_mean": {}, "training_iteration": 72, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845492b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549710>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549160>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3346, "timesteps_total": 2628732, "episode_reward_mean": -323.30788024133426, "episodes_this_iter": 48, "date": "2019-05-23_09-48-30", "time_this_iter_s": 26.153298377990723, "num_metric_batches_dropped": 0, "episode_reward_min": -567.598937865978}
{"time_since_restore": 2145.465444803238, "info": {"default": {"kl": 0.01669398322701454, "entropy": 1.1090632677078247, "total_loss": 17.961284637451172, "vf_explained_var": 0.8593312501907349, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009199913591146469, "cur_kl_coeff": 0.14238283038139343, "vf_loss": 17.968107223510742}, "num_steps_trained": 2662005, "grad_time_ms": 9365.477, "num_steps_sampled": 2662005, "sample_time_ms": 18236.012, "load_time_ms": 5.61, "update_time_ms": 9.699}, "hostname": "flow-main", "episode_reward_max": -22.313493119867477, "timesteps_this_iter": 33273, "custom_metrics": {"cost1_max": 221.7367522921988, "cost1_mean": 189.60471064619233, "system_level_velocity_mean": 16.4145234613596, "cost2_mean": -42.29497368964838, "cost2_max": -9.376546091884949, "outflow_rate_max": 1343.4632045696771, "cost1_min": 17.699224122532645, "system_level_velocity_min": 12.754153855507665, "system_level_velocity_max": 19.09165731278448, "outflow_rate_min": 479.04193413947917, "cost2_min": -67.10008850594164, "outflow_rate_mean": 1133.526477523538}, "done": false, "pid": 51582, "episode_len_mean": 318.73, "node_ip": "10.138.0.2", "timesteps_since_restore": 2662005, "time_total_s": 2145.465444803238, "timestamp": 1558604936, "iterations_since_restore": 73, "policy_reward_mean": {}, "training_iteration": 73, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845345c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534748>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3394, "timesteps_total": 2662005, "episode_reward_mean": -328.69739497817653, "episodes_this_iter": 48, "date": "2019-05-23_09-48-56", "time_this_iter_s": 26.67260217666626, "num_metric_batches_dropped": 0, "episode_reward_min": -567.598937865978}
{"time_since_restore": 2173.844622373581, "info": {"default": {"kl": 0.01859947293996811, "entropy": 1.0891062021255493, "total_loss": 16.316593170166016, "vf_explained_var": 0.8597931861877441, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008454871363937855, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 16.32240104675293}, "num_steps_trained": 2695363, "grad_time_ms": 9432.645, "num_steps_sampled": 2695363, "sample_time_ms": 18189.69, "load_time_ms": 5.695, "update_time_ms": 9.833}, "hostname": "flow-main", "episode_reward_max": -22.313493119867477, "timesteps_this_iter": 33358, "custom_metrics": {"cost1_max": 221.83978551064772, "cost1_mean": 192.85392114080406, "system_level_velocity_mean": 16.61222547774182, "cost2_mean": -42.54750340469488, "cost2_max": -9.376546091884949, "outflow_rate_max": 1343.4632045696771, "cost1_min": 17.699224122532645, "system_level_velocity_min": 13.035835154197258, "system_level_velocity_max": 19.09165731278448, "outflow_rate_min": 479.04193413947917, "cost2_min": -67.10008850594164, "outflow_rate_mean": 1145.8003190245995}, "done": false, "pid": 51582, "episode_len_mean": 320.08, "node_ip": "10.138.0.2", "timesteps_since_restore": 2695363, "time_total_s": 2173.844622373581, "timestamp": 1558604965, "iterations_since_restore": 74, "policy_reward_mean": {}, "training_iteration": 74, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845496a0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549dd8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3439, "timesteps_total": 2695363, "episode_reward_mean": -320.4574828704775, "episodes_this_iter": 45, "date": "2019-05-23_09-49-25", "time_this_iter_s": 28.379177570343018, "num_metric_batches_dropped": 0, "episode_reward_min": -546.7241497781681}
{"time_since_restore": 2200.066642999649, "info": {"default": {"kl": 0.022206073626875877, "entropy": 1.1574113368988037, "total_loss": 15.1299467086792, "vf_explained_var": 0.8720173239707947, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012781951576471329, "cur_kl_coeff": 0.14238281548023224, "vf_loss": 15.139567375183105}, "num_steps_trained": 2728083, "grad_time_ms": 9330.393, "num_steps_sampled": 2728083, "sample_time_ms": 18069.509, "load_time_ms": 5.738, "update_time_ms": 9.59}, "hostname": "flow-main", "episode_reward_max": -22.313493119867477, "timesteps_this_iter": 32720, "custom_metrics": {"cost1_max": 221.83978551064772, "cost1_mean": 194.7100415019564, "system_level_velocity_mean": 16.66183007819722, "cost2_mean": -41.55144661395356, "cost2_max": -9.376546091884949, "outflow_rate_max": 1371.4965026839561, "cost1_min": 17.699224122532645, "system_level_velocity_min": 12.517190906793406, "system_level_velocity_max": 18.92970469591525, "outflow_rate_min": 479.04193413947917, "cost2_min": -63.477358910124465, "outflow_rate_mean": 1151.9379138040613}, "done": false, "pid": 51582, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 2728083, "time_total_s": 2200.066642999649, "timestamp": 1558604991, "iterations_since_restore": 75, "policy_reward_mean": {}, "training_iteration": 75, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530da0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530b00>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530be0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3484, "timesteps_total": 2728083, "episode_reward_mean": -322.1034168086983, "episodes_this_iter": 45, "date": "2019-05-23_09-49-51", "time_this_iter_s": 26.222020626068115, "num_metric_batches_dropped": 0, "episode_reward_min": -559.8666267037347}
{"time_since_restore": 2226.3025436401367, "info": {"default": {"kl": 0.020114507526159286, "entropy": 1.2053701877593994, "total_loss": 15.728879928588867, "vf_explained_var": 0.8827091455459595, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012237776070833206, "cur_kl_coeff": 0.21357418596744537, "vf_loss": 15.736822128295898}, "num_steps_trained": 2760931, "grad_time_ms": 9100.1, "num_steps_sampled": 2760931, "sample_time_ms": 17929.782, "load_time_ms": 5.639, "update_time_ms": 9.397}, "hostname": "flow-main", "episode_reward_max": -147.47600945752063, "timesteps_this_iter": 32848, "custom_metrics": {"cost1_max": 221.74358292975435, "cost1_mean": 192.41098466158164, "system_level_velocity_mean": 16.39013051631003, "cost2_mean": -40.71934744097107, "cost2_max": -21.574670457178584, "outflow_rate_max": 1371.4965026839561, "cost1_min": 145.22570677086287, "system_level_velocity_min": 12.517190906793406, "system_level_velocity_max": 18.898756022349005, "outflow_rate_min": 927.0427871044424, "cost2_min": -63.477358910124465, "outflow_rate_mean": 1141.6660699393951}, "done": false, "pid": 51582, "episode_len_mean": 323.62, "node_ip": "10.138.0.2", "timesteps_since_restore": 2760931, "time_total_s": 2226.3025436401367, "timestamp": 1558605017, "iterations_since_restore": 76, "policy_reward_mean": {}, "training_iteration": 76, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469af60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469a780>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3534, "timesteps_total": 2760931, "episode_reward_mean": -335.8542481458875, "episodes_this_iter": 50, "date": "2019-05-23_09-50-17", "time_this_iter_s": 26.23590064048767, "num_metric_batches_dropped": 0, "episode_reward_min": -570.7478104450656}
{"time_since_restore": 2252.1745715141296, "info": {"default": {"kl": 0.013000719249248505, "entropy": 1.1281580924987793, "total_loss": 13.80443000793457, "vf_explained_var": 0.8902390003204346, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009258822537958622, "cur_kl_coeff": 0.32036131620407104, "vf_loss": 13.80952262878418}, "num_steps_trained": 2792732, "grad_time_ms": 9014.928, "num_steps_sampled": 2792732, "sample_time_ms": 17770.732, "load_time_ms": 4.999, "update_time_ms": 9.105}, "hostname": "flow-main", "episode_reward_max": -147.47600945752063, "timesteps_this_iter": 31801, "custom_metrics": {"cost1_max": 223.62566408101208, "cost1_mean": 191.26518339662337, "system_level_velocity_mean": 16.351486441810756, "cost2_mean": -39.67780273382403, "cost2_max": -23.576505248193037, "outflow_rate_max": 1375.4217380821835, "cost1_min": 133.87783623910713, "system_level_velocity_min": 12.626151396420934, "system_level_velocity_max": 19.00605887183601, "outflow_rate_min": 946.3010294117645, "cost2_min": -58.28621741787468, "outflow_rate_mean": 1136.1461001029068}, "done": false, "pid": 51582, "episode_len_mean": 322.32, "node_ip": "10.138.0.2", "timesteps_since_restore": 2792732, "time_total_s": 2252.1745715141296, "timestamp": 1558605043, "iterations_since_restore": 77, "policy_reward_mean": {}, "training_iteration": 77, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845342b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845416d8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845417b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3577, "timesteps_total": 2792732, "episode_reward_mean": -324.96835223452325, "episodes_this_iter": 43, "date": "2019-05-23_09-50-43", "time_this_iter_s": 25.87202787399292, "num_metric_batches_dropped": 0, "episode_reward_min": -570.7478104450656}
{"time_since_restore": 2281.1097269058228, "info": {"default": {"kl": 0.011303807608783245, "entropy": 1.1088429689407349, "total_loss": 20.593231201171875, "vf_explained_var": 0.8759793043136597, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007512893993407488, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 20.597124099731445}, "num_steps_trained": 2827285, "grad_time_ms": 9067.268, "num_steps_sampled": 2827285, "sample_time_ms": 17787.049, "load_time_ms": 4.934, "update_time_ms": 9.17}, "hostname": "flow-main", "episode_reward_max": -22.440922478425552, "timesteps_this_iter": 34553, "custom_metrics": {"cost1_max": 223.62566408101208, "cost1_mean": 189.17191477476123, "system_level_velocity_mean": 16.245889078582533, "cost2_mean": -42.16293995520746, "cost2_max": -16.17221755116969, "outflow_rate_max": 1390.9730946661737, "cost1_min": 17.6237607636089, "system_level_velocity_min": 12.46329770878209, "system_level_velocity_max": 19.00605887183601, "outflow_rate_min": 440.0050268646629, "cost2_min": -66.0599626398308, "outflow_rate_mean": 1134.6464419216657}, "done": false, "pid": 51582, "episode_len_mean": 320.44, "node_ip": "10.138.0.2", "timesteps_since_restore": 2827285, "time_total_s": 2281.1097269058228, "timestamp": 1558605072, "iterations_since_restore": 78, "policy_reward_mean": {}, "training_iteration": 78, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845492e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549dd8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845499e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3625, "timesteps_total": 2827285, "episode_reward_mean": -332.7089798459464, "episodes_this_iter": 48, "date": "2019-05-23_09-51-12", "time_this_iter_s": 28.935155391693115, "num_metric_batches_dropped": 0, "episode_reward_min": -570.7478104450656}
{"time_since_restore": 2308.661672115326, "info": {"default": {"kl": 0.012173478491604328, "entropy": 1.1127334833145142, "total_loss": 22.976356506347656, "vf_explained_var": 0.8436058163642883, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008570168167352676, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 22.981027603149414}, "num_steps_trained": 2861384, "grad_time_ms": 9126.807, "num_steps_sampled": 2861384, "sample_time_ms": 17770.182, "load_time_ms": 4.945, "update_time_ms": 9.003}, "hostname": "flow-main", "episode_reward_max": -22.440922478425552, "timesteps_this_iter": 34099, "custom_metrics": {"cost1_max": 220.36960486769607, "cost1_mean": 190.10974178566383, "system_level_velocity_mean": 16.37250393942944, "cost2_mean": -43.64210664523782, "cost2_max": -16.17221755116969, "outflow_rate_max": 1390.9730946661737, "cost1_min": 17.6237607636089, "system_level_velocity_min": 12.46329770878209, "system_level_velocity_max": 18.99985118139205, "outflow_rate_min": 440.0050268646629, "cost2_min": -66.0599626398308, "outflow_rate_mean": 1145.7769851605462}, "done": false, "pid": 51582, "episode_len_mean": 319.46, "node_ip": "10.138.0.2", "timesteps_since_restore": 2861384, "time_total_s": 2308.661672115326, "timestamp": 1558605100, "iterations_since_restore": 79, "policy_reward_mean": {}, "training_iteration": 79, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845345c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534860>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3675, "timesteps_total": 2861384, "episode_reward_mean": -342.30747076181717, "episodes_this_iter": 50, "date": "2019-05-23_09-51-40", "time_this_iter_s": 27.551945209503174, "num_metric_batches_dropped": 0, "episode_reward_min": -568.0353873417342}
{"time_since_restore": 2335.348724603653, "info": {"default": {"kl": 0.011534018442034721, "entropy": 1.1151444911956787, "total_loss": 16.84501838684082, "vf_explained_var": 0.8876639604568481, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009486798197031021, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.85080909729004}, "num_steps_trained": 2895288, "grad_time_ms": 9181.835, "num_steps_sampled": 2895288, "sample_time_ms": 17672.137, "load_time_ms": 4.751, "update_time_ms": 9.183}, "hostname": "flow-main", "episode_reward_max": -88.32872776405924, "timesteps_this_iter": 33904, "custom_metrics": {"cost1_max": 222.20171240601297, "cost1_mean": 191.1672323053777, "system_level_velocity_mean": 16.364413457097083, "cost2_mean": -44.37768191597239, "cost2_max": -21.054561097203834, "outflow_rate_max": 1400.446796036334, "cost1_min": 79.26948292911827, "system_level_velocity_min": 12.407513168503586, "system_level_velocity_max": 18.99985118139205, "outflow_rate_min": 752.3321165725232, "cost2_min": -71.36852253392914, "outflow_rate_mean": 1156.2929702041922}, "done": false, "pid": 51582, "episode_len_mean": 321.34, "node_ip": "10.138.0.2", "timesteps_since_restore": 2895288, "time_total_s": 2335.348724603653, "timestamp": 1558605126, "iterations_since_restore": 80, "policy_reward_mean": {}, "training_iteration": 80, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530f98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530e48>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3718, "timesteps_total": 2895288, "episode_reward_mean": -339.5568709605024, "episodes_this_iter": 43, "date": "2019-05-23_09-52-06", "time_this_iter_s": 26.687052488327026, "num_metric_batches_dropped": 0, "episode_reward_min": -568.0353873417342}
{"time_since_restore": 2364.8964219093323, "info": {"default": {"kl": 0.0125650679692626, "entropy": 1.2042169570922852, "total_loss": 17.77889060974121, "vf_explained_var": 0.8955346941947937, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009457143023610115, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 17.784324645996094}, "num_steps_trained": 2929495, "grad_time_ms": 9301.456, "num_steps_sampled": 2929495, "sample_time_ms": 17825.99, "load_time_ms": 4.775, "update_time_ms": 9.25}, "hostname": "flow-main", "episode_reward_max": -28.852963060219214, "timesteps_this_iter": 34207, "custom_metrics": {"cost1_max": 224.3426740591119, "cost1_mean": 183.84509487635637, "system_level_velocity_mean": 16.028694049505805, "cost2_mean": -45.331198882730625, "cost2_max": -16.309941102081503, "outflow_rate_max": 1400.446796036334, "cost1_min": 25.27522699874912, "system_level_velocity_min": 11.678179931565442, "system_level_velocity_max": 19.098240773004214, "outflow_rate_min": 516.8048929101521, "cost2_min": -71.36852253392914, "outflow_rate_mean": 1129.8593299528204}, "done": false, "pid": 51582, "episode_len_mean": 316.55, "node_ip": "10.138.0.2", "timesteps_since_restore": 2929495, "time_total_s": 2364.8964219093323, "timestamp": 1558605156, "iterations_since_restore": 81, "policy_reward_mean": {}, "training_iteration": 81, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845305c0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530908>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3766, "timesteps_total": 2929495, "episode_reward_mean": -348.3990817993048, "episodes_this_iter": 48, "date": "2019-05-23_09-52-36", "time_this_iter_s": 29.54769730567932, "num_metric_batches_dropped": 0, "episode_reward_min": -611.9663478911565}
{"time_since_restore": 2391.684726715088, "info": {"default": {"kl": 0.012593390420079231, "entropy": 1.1546630859375, "total_loss": 21.42217254638672, "vf_explained_var": 0.8669177293777466, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009505760855972767, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 21.427644729614258}, "num_steps_trained": 2964060, "grad_time_ms": 9246.956, "num_steps_sampled": 2964060, "sample_time_ms": 17943.272, "load_time_ms": 4.875, "update_time_ms": 9.51}, "hostname": "flow-main", "episode_reward_max": -28.852963060219214, "timesteps_this_iter": 34565, "custom_metrics": {"cost1_max": 224.3426740591119, "cost1_mean": 182.48815697838833, "system_level_velocity_mean": 15.843033469897357, "cost2_mean": -44.61906517550497, "cost2_max": -16.309941102081503, "outflow_rate_max": 1373.6588759516342, "cost1_min": 25.27522699874912, "system_level_velocity_min": 11.678179931565442, "system_level_velocity_max": 19.098240773004214, "outflow_rate_min": 516.8048929101521, "cost2_min": -64.79458441944331, "outflow_rate_mean": 1122.1377206426603}, "done": false, "pid": 51582, "episode_len_mean": 317.65, "node_ip": "10.138.0.2", "timesteps_since_restore": 2964060, "time_total_s": 2391.684726715088, "timestamp": 1558605183, "iterations_since_restore": 82, "policy_reward_mean": {}, "training_iteration": 82, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849062b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e849068d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906710>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3815, "timesteps_total": 2964060, "episode_reward_mean": -365.3271374395338, "episodes_this_iter": 49, "date": "2019-05-23_09-53-03", "time_this_iter_s": 26.788304805755615, "num_metric_batches_dropped": 0, "episode_reward_min": -675.9628999173409}
{"time_since_restore": 2419.939607858658, "info": {"default": {"kl": 0.01240190677344799, "entropy": 1.109056830406189, "total_loss": 18.68269920349121, "vf_explained_var": 0.8741098046302795, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0103512704372406, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 18.68907928466797}, "num_steps_trained": 2998944, "grad_time_ms": 9258.241, "num_steps_sampled": 2998944, "sample_time_ms": 18089.813, "load_time_ms": 5.169, "update_time_ms": 9.317}, "hostname": "flow-main", "episode_reward_max": -28.852963060219214, "timesteps_this_iter": 34884, "custom_metrics": {"cost1_max": 222.5707405687312, "cost1_mean": 185.66772562116319, "system_level_velocity_mean": 16.087323662831917, "cost2_mean": -44.61730322064095, "cost2_max": -16.309941102081503, "outflow_rate_max": 1373.6588759516342, "cost1_min": 25.27522699874912, "system_level_velocity_min": 11.964106789307268, "system_level_velocity_max": 19.098240773004214, "outflow_rate_min": 516.8048929101521, "cost2_min": -63.229588900203574, "outflow_rate_mean": 1145.2973211527228}, "done": false, "pid": 51582, "episode_len_mean": 317.77, "node_ip": "10.138.0.2", "timesteps_since_restore": 2998944, "time_total_s": 2419.939607858658, "timestamp": 1558605211, "iterations_since_restore": 83, "policy_reward_mean": {}, "training_iteration": 83, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549198>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549470>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845492b0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3860, "timesteps_total": 2998944, "episode_reward_mean": -359.2253136939164, "episodes_this_iter": 45, "date": "2019-05-23_09-53-31", "time_this_iter_s": 28.254881143569946, "num_metric_batches_dropped": 0, "episode_reward_min": -675.9628999173409}
{"time_since_restore": 2447.974812746048, "info": {"default": {"kl": 0.012244638055562973, "entropy": 1.1770756244659424, "total_loss": 17.408035278320312, "vf_explained_var": 0.8888271450996399, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008028880693018436, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 17.412139892578125}, "num_steps_trained": 3033784, "grad_time_ms": 9068.422, "num_steps_sampled": 3033784, "sample_time_ms": 18247.408, "load_time_ms": 4.957, "update_time_ms": 9.153}, "hostname": "flow-main", "episode_reward_max": -26.722537102493572, "timesteps_this_iter": 34840, "custom_metrics": {"cost1_max": 222.5707405687312, "cost1_mean": 185.55827323283648, "system_level_velocity_mean": 15.973478078928478, "cost2_mean": -44.180593007605474, "cost2_max": -15.345244358587117, "outflow_rate_max": 1370.910929802955, "cost1_min": 23.088402023684317, "system_level_velocity_min": 12.694806319486947, "system_level_velocity_max": 18.902242593170552, "outflow_rate_min": 508.5934821910147, "cost2_min": -67.90406398279714, "outflow_rate_mean": 1142.010422727898}, "done": false, "pid": 51582, "episode_len_mean": 319.46, "node_ip": "10.138.0.2", "timesteps_since_restore": 3033784, "time_total_s": 2447.974812746048, "timestamp": 1558605239, "iterations_since_restore": 84, "policy_reward_mean": {}, "training_iteration": 84, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9fd0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549668>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3907, "timesteps_total": 3033784, "episode_reward_mean": -364.20032688728264, "episodes_this_iter": 47, "date": "2019-05-23_09-53-59", "time_this_iter_s": 28.035204887390137, "num_metric_batches_dropped": 0, "episode_reward_min": -568.6335423008732}
{"time_since_restore": 2475.846878528595, "info": {"default": {"kl": 0.01209428533911705, "entropy": 1.136002779006958, "total_loss": 17.79897117614746, "vf_explained_var": 0.8776309490203857, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00822488497942686, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 17.803321838378906}, "num_steps_trained": 3067850, "grad_time_ms": 9215.225, "num_steps_sampled": 3067850, "sample_time_ms": 18264.612, "load_time_ms": 5.037, "update_time_ms": 9.152}, "hostname": "flow-main", "episode_reward_max": -26.722537102493572, "timesteps_this_iter": 34066, "custom_metrics": {"cost1_max": 222.61870361591156, "cost1_mean": 187.83659627181726, "system_level_velocity_mean": 16.10837164651912, "cost2_mean": -43.29951165162866, "cost2_max": -15.345244358587117, "outflow_rate_max": 1342.7384693877557, "cost1_min": 23.088402023684317, "system_level_velocity_min": 11.919696062909834, "system_level_velocity_max": 19.10509551876264, "outflow_rate_min": 508.5934821910147, "cost2_min": -67.90406398279714, "outflow_rate_mean": 1145.7509331399247}, "done": false, "pid": 51582, "episode_len_mean": 320.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 3067850, "time_total_s": 2475.846878528595, "timestamp": 1558605267, "iterations_since_restore": 85, "policy_reward_mean": {}, "training_iteration": 85, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534be0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534208>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 3953, "timesteps_total": 3067850, "episode_reward_mean": -355.33042403983353, "episodes_this_iter": 46, "date": "2019-05-23_09-54-27", "time_this_iter_s": 27.872065782546997, "num_metric_batches_dropped": 0, "episode_reward_min": -595.9968927344487}
{"time_since_restore": 2503.6054315567017, "info": {"default": {"kl": 0.012871366925537586, "entropy": 1.1601725816726685, "total_loss": 19.100141525268555, "vf_explained_var": 0.8837679624557495, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009688624180853367, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 19.10570526123047}, "num_steps_trained": 3102756, "grad_time_ms": 9336.165, "num_steps_sampled": 3102756, "sample_time_ms": 18295.666, "load_time_ms": 5.153, "update_time_ms": 9.216}, "hostname": "flow-main", "episode_reward_max": -227.3512107368966, "timesteps_this_iter": 34906, "custom_metrics": {"cost1_max": 222.61870361591156, "cost1_mean": 189.64534116374315, "system_level_velocity_mean": 16.015243170403053, "cost2_mean": -43.34321642926886, "cost2_max": -21.373654278999165, "outflow_rate_max": 1381.8610529556654, "cost1_min": 141.52665749074646, "system_level_velocity_min": 11.793193917622707, "system_level_velocity_max": 19.10509551876264, "outflow_rate_min": 939.2328942081357, "cost2_min": -65.19422797777067, "outflow_rate_mean": 1153.5772390608138}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3102756, "time_total_s": 2503.6054315567017, "timestamp": 1558605295, "iterations_since_restore": 86, "policy_reward_mean": {}, "training_iteration": 86, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549438>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469ac18>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549048>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4001, "timesteps_total": 3102756, "episode_reward_mean": -361.8406128082213, "episodes_this_iter": 48, "date": "2019-05-23_09-54-55", "time_this_iter_s": 27.75855302810669, "num_metric_batches_dropped": 0, "episode_reward_min": -595.9968927344487}
{"time_since_restore": 2531.7592878341675, "info": {"default": {"kl": 0.011491945944726467, "entropy": 1.1470143795013428, "total_loss": 18.82272720336914, "vf_explained_var": 0.8868846893310547, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008631731383502483, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 18.82767677307129}, "num_steps_trained": 3138299, "grad_time_ms": 9574.589, "num_steps_sampled": 3138299, "sample_time_ms": 18283.436, "load_time_ms": 5.195, "update_time_ms": 9.384}, "hostname": "flow-main", "episode_reward_max": -227.3512107368966, "timesteps_this_iter": 35543, "custom_metrics": {"cost1_max": 222.33928197280147, "cost1_mean": 185.40708326070578, "system_level_velocity_mean": 15.659541321645, "cost2_mean": -44.235385800981504, "cost2_max": -21.373654278999165, "outflow_rate_max": 1381.8610529556654, "cost1_min": 141.52665749074646, "system_level_velocity_min": 11.793193917622707, "system_level_velocity_max": 18.84967049154939, "outflow_rate_min": 939.2328942081357, "cost2_min": -60.3487624368893, "outflow_rate_mean": 1141.0729005423916}, "done": false, "pid": 51582, "episode_len_mean": 324.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 3138299, "time_total_s": 2531.7592878341675, "timestamp": 1558605323, "iterations_since_restore": 87, "policy_reward_mean": {}, "training_iteration": 87, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549b00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549c50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549940>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4046, "timesteps_total": 3138299, "episode_reward_mean": -381.2006959545364, "episodes_this_iter": 45, "date": "2019-05-23_09-55-23", "time_this_iter_s": 28.15385627746582, "num_metric_batches_dropped": 0, "episode_reward_min": -594.9969901620702}
{"time_since_restore": 2558.3010125160217, "info": {"default": {"kl": 0.011770911514759064, "entropy": 1.0963488817214966, "total_loss": 18.59583854675293, "vf_explained_var": 0.8825108408927917, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007136404514312744, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 18.599206924438477}, "num_steps_trained": 3173736, "grad_time_ms": 9398.628, "num_steps_sampled": 3173736, "sample_time_ms": 18220.232, "load_time_ms": 5.37, "update_time_ms": 9.523}, "hostname": "flow-main", "episode_reward_max": -227.3512107368966, "timesteps_this_iter": 35437, "custom_metrics": {"cost1_max": 223.9182786519247, "cost1_mean": 187.62182929620772, "system_level_velocity_mean": 15.843875734236576, "cost2_mean": -44.67880563073523, "cost2_max": -25.44014813075847, "outflow_rate_max": 1374.3098980569234, "cost1_min": 142.1673112872145, "system_level_velocity_min": 12.141845249053466, "system_level_velocity_max": 18.998186080738922, "outflow_rate_min": 940.2071519285896, "cost2_min": -63.052453927003334, "outflow_rate_mean": 1161.4472788592816}, "done": false, "pid": 51582, "episode_len_mean": 324.36, "node_ip": "10.138.0.2", "timesteps_since_restore": 3173736, "time_total_s": 2558.3010125160217, "timestamp": 1558605350, "iterations_since_restore": 88, "policy_reward_mean": {}, "training_iteration": 88, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845495c0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549978>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549f98>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4091, "timesteps_total": 3173736, "episode_reward_mean": -379.7195025473947, "episodes_this_iter": 45, "date": "2019-05-23_09-55-50", "time_this_iter_s": 26.541724681854248, "num_metric_batches_dropped": 0, "episode_reward_min": -594.9969901620702}
{"time_since_restore": 2586.765973806381, "info": {"default": {"kl": 0.011674550361931324, "entropy": 1.1099294424057007, "total_loss": 19.441333770751953, "vf_explained_var": 0.8816215395927429, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006286126561462879, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 19.443880081176758}, "num_steps_trained": 3210015, "grad_time_ms": 9275.916, "num_steps_sampled": 3210015, "sample_time_ms": 18437.211, "load_time_ms": 5.432, "update_time_ms": 9.515}, "hostname": "flow-main", "episode_reward_max": -86.17445767862459, "timesteps_this_iter": 36279, "custom_metrics": {"cost1_max": 223.9182786519247, "cost1_mean": 189.92463704699318, "system_level_velocity_mean": 16.12397517626043, "cost2_mean": -46.17457996280917, "cost2_max": -29.896803917355154, "outflow_rate_max": 1374.3098980569234, "cost1_min": 79.4530070465968, "system_level_velocity_min": 11.581600665284377, "system_level_velocity_max": 18.998186080738922, "outflow_rate_min": 768.0191388038589, "cost2_min": -63.052453927003334, "outflow_rate_mean": 1180.4366762644922}, "done": false, "pid": 51582, "episode_len_mean": 322.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 3210015, "time_total_s": 2586.765973806381, "timestamp": 1558605378, "iterations_since_restore": 89, "policy_reward_mean": {}, "training_iteration": 89, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549668>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845495f8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4141, "timesteps_total": 3210015, "episode_reward_mean": -376.50764758079754, "episodes_this_iter": 50, "date": "2019-05-23_09-56-18", "time_this_iter_s": 28.464961290359497, "num_metric_batches_dropped": 0, "episode_reward_min": -628.5043033553845}
{"time_since_restore": 2614.984342098236, "info": {"default": {"kl": 0.01152162067592144, "entropy": 1.1058127880096436, "total_loss": 18.277124404907227, "vf_explained_var": 0.879848837852478, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007693198975175619, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 18.2811279296875}, "num_steps_trained": 3246058, "grad_time_ms": 9224.519, "num_steps_sampled": 3246058, "sample_time_ms": 18644.132, "load_time_ms": 5.406, "update_time_ms": 9.266}, "hostname": "flow-main", "episode_reward_max": -86.17445767862459, "timesteps_this_iter": 36043, "custom_metrics": {"cost1_max": 223.3544085016091, "cost1_mean": 189.0532935079521, "system_level_velocity_mean": 16.14806081882725, "cost2_mean": -45.845037712939664, "cost2_max": -29.896803917355154, "outflow_rate_max": 1378.6577003084612, "cost1_min": 77.85955771635706, "system_level_velocity_min": 11.581600665284377, "system_level_velocity_max": 19.01556225065692, "outflow_rate_min": 734.9832142960751, "cost2_min": -63.01264310947552, "outflow_rate_mean": 1179.1668208501849}, "done": false, "pid": 51582, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 3246058, "time_total_s": 2614.984342098236, "timestamp": 1558605406, "iterations_since_restore": 90, "policy_reward_mean": {}, "training_iteration": 90, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549e80>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845492b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549518>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4185, "timesteps_total": 3246058, "episode_reward_mean": -378.0218959544699, "episodes_this_iter": 44, "date": "2019-05-23_09-56-46", "time_this_iter_s": 28.21836829185486, "num_metric_batches_dropped": 0, "episode_reward_min": -628.5043033553845}
{"time_since_restore": 2643.172210216522, "info": {"default": {"kl": 0.012406181544065475, "entropy": 1.1333454847335815, "total_loss": 19.385984420776367, "vf_explained_var": 0.8771064281463623, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00783566851168871, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 19.389842987060547}, "num_steps_trained": 3281303, "grad_time_ms": 9226.399, "num_steps_sampled": 3281303, "sample_time_ms": 18508.285, "load_time_ms": 5.266, "update_time_ms": 8.982}, "hostname": "flow-main", "episode_reward_max": -22.032618407726748, "timesteps_this_iter": 35245, "custom_metrics": {"cost1_max": 223.3544085016091, "cost1_mean": 186.08787710913646, "system_level_velocity_mean": 16.142833743857498, "cost2_mean": -45.163207770243304, "cost2_max": -12.111374875784886, "outflow_rate_max": 1378.6577003084612, "cost1_min": 17.604405409003455, "system_level_velocity_min": 11.890366313262856, "system_level_velocity_max": 19.10040370408266, "outflow_rate_min": 456.9659565674539, "cost2_min": -63.01264310947552, "outflow_rate_mean": 1160.317823361612}, "done": false, "pid": 51582, "episode_len_mean": 316.68, "node_ip": "10.138.0.2", "timesteps_since_restore": 3281303, "time_total_s": 2643.172210216522, "timestamp": 1558605435, "iterations_since_restore": 91, "policy_reward_mean": {}, "training_iteration": 91, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549048>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845497f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549438>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4234, "timesteps_total": 3281303, "episode_reward_mean": -366.6201975335584, "episodes_this_iter": 49, "date": "2019-05-23_09-57-15", "time_this_iter_s": 28.187868118286133, "num_metric_batches_dropped": 0, "episode_reward_min": -622.6751932804581}
{"time_since_restore": 2670.746742248535, "info": {"default": {"kl": 0.013601896353065968, "entropy": 1.1068652868270874, "total_loss": 18.445098876953125, "vf_explained_var": 0.8645901083946228, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009930799715220928, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 18.450672149658203}, "num_steps_trained": 3315912, "grad_time_ms": 9459.888, "num_steps_sampled": 3315912, "sample_time_ms": 18351.477, "load_time_ms": 5.224, "update_time_ms": 8.976}, "hostname": "flow-main", "episode_reward_max": -22.032618407726748, "timesteps_this_iter": 34609, "custom_metrics": {"cost1_max": 223.3544085016091, "cost1_mean": 188.3068881722806, "system_level_velocity_mean": 16.31779294961107, "cost2_mean": -43.788836409724375, "cost2_max": -12.111374875784886, "outflow_rate_max": 1365.1969486845305, "cost1_min": 17.604405409003455, "system_level_velocity_min": 12.502981018084835, "system_level_velocity_max": 19.10040370408266, "outflow_rate_min": 456.9659565674539, "cost2_min": -62.057337829316616, "outflow_rate_mean": 1162.1083418176802}, "done": false, "pid": 51582, "episode_len_mean": 317.38, "node_ip": "10.138.0.2", "timesteps_since_restore": 3315912, "time_total_s": 2670.746742248535, "timestamp": 1558605462, "iterations_since_restore": 92, "policy_reward_mean": {}, "training_iteration": 92, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549128>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549710>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549f98>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4281, "timesteps_total": 3315912, "episode_reward_mean": -352.17811635105494, "episodes_this_iter": 47, "date": "2019-05-23_09-57-42", "time_this_iter_s": 27.57453203201294, "num_metric_batches_dropped": 0, "episode_reward_min": -552.0768851718359}
{"time_since_restore": 2697.3218247890472, "info": {"default": {"kl": 0.013436514884233475, "entropy": 1.1353363990783691, "total_loss": 18.089120864868164, "vf_explained_var": 0.8720943331718445, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009062445722520351, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 18.093881607055664}, "num_steps_trained": 3349418, "grad_time_ms": 9493.181, "num_steps_sampled": 3349418, "sample_time_ms": 18148.212, "load_time_ms": 4.805, "update_time_ms": 9.063}, "hostname": "flow-main", "episode_reward_max": -155.63323530991838, "timesteps_this_iter": 33506, "custom_metrics": {"cost1_max": 222.34933548125534, "cost1_mean": 190.04901766834462, "system_level_velocity_mean": 16.125341803316555, "cost2_mean": -43.04088350675906, "cost2_max": -25.685629862366213, "outflow_rate_max": 1357.4995907825942, "cost1_min": 146.02232132383818, "system_level_velocity_min": 12.625003538318857, "system_level_velocity_max": 18.955518770551606, "outflow_rate_min": 980.9782720588238, "cost2_min": -62.057337829316616, "outflow_rate_mean": 1155.246017445718}, "done": false, "pid": 51582, "episode_len_mean": 323.62, "node_ip": "10.138.0.2", "timesteps_since_restore": 3349418, "time_total_s": 2697.3218247890472, "timestamp": 1558605489, "iterations_since_restore": 93, "policy_reward_mean": {}, "training_iteration": 93, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541cf8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845378d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541630>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4325, "timesteps_total": 3349418, "episode_reward_mean": -357.00725598613457, "episodes_this_iter": 44, "date": "2019-05-23_09-58-09", "time_this_iter_s": 26.575082540512085, "num_metric_batches_dropped": 0, "episode_reward_min": -537.6858610292546}
{"time_since_restore": 2724.9444313049316, "info": {"default": {"kl": 0.013056988827884197, "entropy": 1.1403123140335083, "total_loss": 17.23222541809082, "vf_explained_var": 0.8871254324913025, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009177622385323048, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 17.237220764160156}, "num_steps_trained": 3383701, "grad_time_ms": 9432.88, "num_steps_sampled": 3383701, "sample_time_ms": 18165.082, "load_time_ms": 5.045, "update_time_ms": 9.447}, "hostname": "flow-main", "episode_reward_max": -155.63323530991838, "timesteps_this_iter": 34283, "custom_metrics": {"cost1_max": 222.35021863365802, "cost1_mean": 188.38243864072086, "system_level_velocity_mean": 16.02617786132622, "cost2_mean": -41.051094540649075, "cost2_max": -25.54333856824375, "outflow_rate_max": 1348.2018367346943, "cost1_min": 146.02232132383818, "system_level_velocity_min": 12.905517726939943, "system_level_velocity_max": 19.017594731818082, "outflow_rate_min": 946.780758876349, "cost2_min": -62.05518359937841, "outflow_rate_mean": 1138.0806423927147}, "done": false, "pid": 51582, "episode_len_mean": 323.34, "node_ip": "10.138.0.2", "timesteps_since_restore": 3383701, "time_total_s": 2724.9444313049316, "timestamp": 1558605516, "iterations_since_restore": 94, "policy_reward_mean": {}, "training_iteration": 94, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549f98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549550>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549160>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4374, "timesteps_total": 3383701, "episode_reward_mean": -350.95837129344307, "episodes_this_iter": 49, "date": "2019-05-23_09-58-36", "time_this_iter_s": 27.6226065158844, "num_metric_batches_dropped": 0, "episode_reward_min": -526.5336069874271}
{"time_since_restore": 2752.441989183426, "info": {"default": {"kl": 0.012924388982355595, "entropy": 1.070791244506836, "total_loss": 19.251745223999023, "vf_explained_var": 0.8584950566291809, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00964607298374176, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 19.257253646850586}, "num_steps_trained": 3417524, "grad_time_ms": 9239.626, "num_steps_sampled": 3417524, "sample_time_ms": 18322.72, "load_time_ms": 5.045, "update_time_ms": 9.523}, "hostname": "flow-main", "episode_reward_max": -161.04436225570603, "timesteps_this_iter": 33823, "custom_metrics": {"cost1_max": 222.49624562299218, "cost1_mean": 191.42750001545363, "system_level_velocity_mean": 16.286022391245208, "cost2_mean": -40.64762756670973, "cost2_max": -25.54333856824375, "outflow_rate_max": 1350.1867836617412, "cost1_min": 143.29658870468057, "system_level_velocity_min": 12.46423159525084, "system_level_velocity_max": 19.017594731818082, "outflow_rate_min": 946.780758876349, "cost2_min": -62.05518359937841, "outflow_rate_mean": 1160.7924152366545}, "done": false, "pid": 51582, "episode_len_mean": 323.34, "node_ip": "10.138.0.2", "timesteps_since_restore": 3417524, "time_total_s": 2752.441989183426, "timestamp": 1558605544, "iterations_since_restore": 95, "policy_reward_mean": {}, "training_iteration": 95, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530668>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530198>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4418, "timesteps_total": 3417524, "episode_reward_mean": -344.98425074090346, "episodes_this_iter": 44, "date": "2019-05-23_09-59-04", "time_this_iter_s": 27.497557878494263, "num_metric_batches_dropped": 0, "episode_reward_min": -546.3398049755834}
{"time_since_restore": 2780.057713031769, "info": {"default": {"kl": 0.011934078298509121, "entropy": 1.1250537633895874, "total_loss": 18.160242080688477, "vf_explained_var": 0.8673925995826721, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008451057597994804, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 18.164871215820312}, "num_steps_trained": 3451124, "grad_time_ms": 9278.885, "num_steps_sampled": 3451124, "sample_time_ms": 18269.4, "load_time_ms": 5.02, "update_time_ms": 9.147}, "hostname": "flow-main", "episode_reward_max": -161.04436225570603, "timesteps_this_iter": 33600, "custom_metrics": {"cost1_max": 222.49624562299218, "cost1_mean": 192.59212602134542, "system_level_velocity_mean": 16.375832037904452, "cost2_mean": -40.956978950301234, "cost2_max": -22.658912811332755, "outflow_rate_max": 1358.5384524848307, "cost1_min": 143.29658870468057, "system_level_velocity_min": 12.388621420472468, "system_level_velocity_max": 18.879521747108985, "outflow_rate_min": 921.2783967168261, "cost2_min": -57.60662076097043, "outflow_rate_mean": 1163.1479754155914}, "done": false, "pid": 51582, "episode_len_mean": 323.62, "node_ip": "10.138.0.2", "timesteps_since_restore": 3451124, "time_total_s": 2780.057713031769, "timestamp": 1558605572, "iterations_since_restore": 96, "policy_reward_mean": {}, "training_iteration": 96, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845340f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4467, "timesteps_total": 3451124, "episode_reward_mean": -339.78310940468475, "episodes_this_iter": 49, "date": "2019-05-23_09-59-32", "time_this_iter_s": 27.615723848342896, "num_metric_batches_dropped": 0, "episode_reward_min": -566.9876613310528}
{"time_since_restore": 2807.585394859314, "info": {"default": {"kl": 0.013433135114610195, "entropy": 1.1448792219161987, "total_loss": 19.43246078491211, "vf_explained_var": 0.8697153925895691, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009835759177803993, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 19.4379940032959}, "num_steps_trained": 3484993, "grad_time_ms": 9213.119, "num_steps_sampled": 3484993, "sample_time_ms": 18274.556, "load_time_ms": 4.932, "update_time_ms": 9.036}, "hostname": "flow-main", "episode_reward_max": -32.451888729435105, "timesteps_this_iter": 33869, "custom_metrics": {"cost1_max": 221.6800253687399, "cost1_mean": 188.51176675907448, "system_level_velocity_mean": 16.206841091565977, "cost2_mean": -40.57216796769831, "cost2_max": -16.327918496607555, "outflow_rate_max": 1358.5384524848307, "cost1_min": 22.472733777189575, "system_level_velocity_min": 12.347847299491542, "system_level_velocity_max": 18.839984562426807, "outflow_rate_min": 424.4559491199726, "cost2_min": -58.514553362507286, "outflow_rate_mean": 1141.762678961355}, "done": false, "pid": 51582, "episode_len_mean": 320.36, "node_ip": "10.138.0.2", "timesteps_since_restore": 3484993, "time_total_s": 2807.585394859314, "timestamp": 1558605599, "iterations_since_restore": 97, "policy_reward_mean": {}, "training_iteration": 97, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537518>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537dd8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537208>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4512, "timesteps_total": 3484993, "episode_reward_mean": -339.67344460378604, "episodes_this_iter": 45, "date": "2019-05-23_09-59-59", "time_this_iter_s": 27.527681827545166, "num_metric_batches_dropped": 0, "episode_reward_min": -566.9876613310528}
{"time_since_restore": 2834.140694141388, "info": {"default": {"kl": 0.012765479274094105, "entropy": 1.1312867403030396, "total_loss": 15.895339965820312, "vf_explained_var": 0.8768721222877502, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009570390917360783, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 15.900819778442383}, "num_steps_trained": 3517559, "grad_time_ms": 9220.272, "num_steps_sampled": 3517559, "sample_time_ms": 18269.257, "load_time_ms": 4.785, "update_time_ms": 8.986}, "hostname": "flow-main", "episode_reward_max": -32.451888729435105, "timesteps_this_iter": 32566, "custom_metrics": {"cost1_max": 218.93073871637876, "cost1_mean": 183.6501156402541, "system_level_velocity_mean": 15.94612739011594, "cost2_mean": -39.36885706736643, "cost2_max": -16.327918496607555, "outflow_rate_max": 1330.1139085872667, "cost1_min": 22.472733777189575, "system_level_velocity_min": 11.761867055717698, "system_level_velocity_max": 18.73282265045672, "outflow_rate_min": 424.4559491199726, "cost2_min": -60.71742201422527, "outflow_rate_mean": 1112.1923334278108}, "done": false, "pid": 51582, "episode_len_mean": 317.38, "node_ip": "10.138.0.2", "timesteps_since_restore": 3517559, "time_total_s": 2834.140694141388, "timestamp": 1558605626, "iterations_since_restore": 98, "policy_reward_mean": {}, "training_iteration": 98, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549ef0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549160>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549390>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4561, "timesteps_total": 3517559, "episode_reward_mean": -341.1255978939841, "episodes_this_iter": 49, "date": "2019-05-23_10-00-26", "time_this_iter_s": 26.555299282073975, "num_metric_batches_dropped": 0, "episode_reward_min": -505.13374451168977}
{"time_since_restore": 2860.9298911094666, "info": {"default": {"kl": 0.015096966177225113, "entropy": 1.096678614616394, "total_loss": 15.175312995910645, "vf_explained_var": 0.8841473460197449, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009327276609838009, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 15.179802894592285}, "num_steps_trained": 3551166, "grad_time_ms": 9106.004, "num_steps_sampled": 3551166, "sample_time_ms": 18216.494, "load_time_ms": 4.67, "update_time_ms": 9.267}, "hostname": "flow-main", "episode_reward_max": -32.451888729435105, "timesteps_this_iter": 33607, "custom_metrics": {"cost1_max": 219.10956660316413, "cost1_mean": 185.9646494818899, "system_level_velocity_mean": 16.25341337972069, "cost2_mean": -38.6420155713306, "cost2_max": -16.327918496607555, "outflow_rate_max": 1330.1139085872667, "cost1_min": 22.472733777189575, "system_level_velocity_min": 11.761867055717698, "system_level_velocity_max": 18.73282265045672, "outflow_rate_min": 424.4559491199726, "cost2_min": -60.71742201422527, "outflow_rate_mean": 1123.418735486492}, "done": false, "pid": 51582, "episode_len_mean": 315.66, "node_ip": "10.138.0.2", "timesteps_since_restore": 3551166, "time_total_s": 2860.9298911094666, "timestamp": 1558605653, "iterations_since_restore": 99, "policy_reward_mean": {}, "training_iteration": 99, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537dd8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537fd0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4608, "timesteps_total": 3551166, "episode_reward_mean": -325.9140832464561, "episodes_this_iter": 47, "date": "2019-05-23_10-00-53", "time_this_iter_s": 26.789196968078613, "num_metric_batches_dropped": 0, "episode_reward_min": -536.2756531751132}
{"time_since_restore": 2887.775484085083, "info": {"default": {"kl": 0.013503721915185452, "entropy": 1.137405514717102, "total_loss": 16.681991577148438, "vf_explained_var": 0.8810682892799377, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009039311669766903, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.686704635620117}, "num_steps_trained": 3584416, "grad_time_ms": 9087.152, "num_steps_sampled": 3584416, "sample_time_ms": 18097.415, "load_time_ms": 4.727, "update_time_ms": 9.271}, "hostname": "flow-main", "episode_reward_max": -100.6974957615403, "timesteps_this_iter": 33250, "custom_metrics": {"cost1_max": 220.9893034366251, "cost1_mean": 189.61739506759534, "system_level_velocity_mean": 16.243532555512573, "cost2_mean": -38.483219566487286, "cost2_max": -24.776321952747367, "outflow_rate_max": 1323.397562775809, "cost1_min": 83.27667251032942, "system_level_velocity_min": 12.337699107448982, "system_level_velocity_max": 18.877752864618405, "outflow_rate_min": 808.9284259950867, "cost2_min": -57.33587960160166, "outflow_rate_mean": 1137.2042359670215}, "done": false, "pid": 51582, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 3584416, "time_total_s": 2887.775484085083, "timestamp": 1558605679, "iterations_since_restore": 100, "policy_reward_mean": {}, "training_iteration": 100, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549080>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549438>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549f28>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4652, "timesteps_total": 3584416, "episode_reward_mean": -330.96295282493884, "episodes_this_iter": 44, "date": "2019-05-23_10-01-19", "time_this_iter_s": 26.845592975616455, "num_metric_batches_dropped": 0, "episode_reward_min": -536.2756531751132}
{"time_since_restore": 2914.296739578247, "info": {"default": {"kl": 0.012570023536682129, "entropy": 1.1654460430145264, "total_loss": 17.604515075683594, "vf_explained_var": 0.8807213306427002, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008393916301429272, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 17.6088809967041}, "num_steps_trained": 3618062, "grad_time_ms": 9017.17, "num_steps_sampled": 3618062, "sample_time_ms": 18000.6, "load_time_ms": 4.803, "update_time_ms": 9.316}, "hostname": "flow-main", "episode_reward_max": -233.10661854110086, "timesteps_this_iter": 33646, "custom_metrics": {"cost1_max": 221.70329158125486, "cost1_mean": 190.46329520313208, "system_level_velocity_mean": 16.13096473079084, "cost2_mean": -39.802897636249284, "cost2_max": -24.776321952747367, "outflow_rate_max": 1345.30393570555, "cost1_min": 146.42439063383492, "system_level_velocity_min": 12.337699107448982, "system_level_velocity_max": 18.877752864618405, "outflow_rate_min": 927.0702728438014, "cost2_min": -60.31160887948538, "outflow_rate_mean": 1147.3021888743208}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3618062, "time_total_s": 2914.296739578247, "timestamp": 1558605706, "iterations_since_restore": 101, "policy_reward_mean": {}, "training_iteration": 101, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530518>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530438>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530668>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4700, "timesteps_total": 3618062, "episode_reward_mean": -345.5955059684158, "episodes_this_iter": 48, "date": "2019-05-23_10-01-46", "time_this_iter_s": 26.521255493164062, "num_metric_batches_dropped": 0, "episode_reward_min": -542.545733967394}
{"time_since_restore": 2941.547728538513, "info": {"default": {"kl": 0.012385237030684948, "entropy": 1.1345263719558716, "total_loss": 16.025074005126953, "vf_explained_var": 0.8903433084487915, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009030858986079693, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.03013801574707}, "num_steps_trained": 3651911, "grad_time_ms": 9042.867, "num_steps_sampled": 3651911, "sample_time_ms": 17942.23, "load_time_ms": 4.705, "update_time_ms": 9.114}, "hostname": "flow-main", "episode_reward_max": -230.39367765379916, "timesteps_this_iter": 33849, "custom_metrics": {"cost1_max": 222.8072158335712, "cost1_mean": 193.27933923773742, "system_level_velocity_mean": 16.35406680093657, "cost2_mean": -41.73964163105015, "cost2_max": -25.97941940213929, "outflow_rate_max": 1359.100606145325, "cost1_min": 147.29801464239696, "system_level_velocity_min": 12.475695844464122, "system_level_velocity_max": 18.983887119911447, "outflow_rate_min": 927.0702728438014, "cost2_min": -60.51547295409901, "outflow_rate_mean": 1172.4358384918564}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3651911, "time_total_s": 2941.547728538513, "timestamp": 1558605733, "iterations_since_restore": 102, "policy_reward_mean": {}, "training_iteration": 102, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549ac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845496d8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4747, "timesteps_total": 3651911, "episode_reward_mean": -343.31737349780013, "episodes_this_iter": 47, "date": "2019-05-23_10-02-13", "time_this_iter_s": 27.250988960266113, "num_metric_batches_dropped": 0, "episode_reward_min": -564.1184374678885}
{"time_since_restore": 2968.1215374469757, "info": {"default": {"kl": 0.012284712865948677, "entropy": 1.1922551393508911, "total_loss": 16.92119789123535, "vf_explained_var": 0.8879406452178955, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008530345745384693, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.925790786743164}, "num_steps_trained": 3686332, "grad_time_ms": 8972.607, "num_steps_sampled": 3686332, "sample_time_ms": 18013.885, "load_time_ms": 4.824, "update_time_ms": 9.17}, "hostname": "flow-main", "episode_reward_max": -230.39367765379916, "timesteps_this_iter": 34421, "custom_metrics": {"cost1_max": 222.8072158335712, "cost1_mean": 190.9493508968239, "system_level_velocity_mean": 16.146447713046438, "cost2_mean": -42.281208513193235, "cost2_max": -25.97941940213929, "outflow_rate_max": 1359.100606145325, "cost1_min": 143.3079539097649, "system_level_velocity_min": 12.18429749611646, "system_level_velocity_max": 18.983887119911447, "outflow_rate_min": 927.0702728438014, "cost2_min": -60.76454890657516, "outflow_rate_mean": 1161.2132139385592}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3686332, "time_total_s": 2968.1215374469757, "timestamp": 1558605760, "iterations_since_restore": 103, "policy_reward_mean": {}, "training_iteration": 103, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9ba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9080>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4791, "timesteps_total": 3686332, "episode_reward_mean": -349.8769024426722, "episodes_this_iter": 44, "date": "2019-05-23_10-02-40", "time_this_iter_s": 26.573808908462524, "num_metric_batches_dropped": 0, "episode_reward_min": -577.0381588765346}
{"time_since_restore": 2996.684985399246, "info": {"default": {"kl": 0.012328848242759705, "entropy": 1.1978079080581665, "total_loss": 16.2419376373291, "vf_explained_var": 0.8874915838241577, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009207827039062977, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.247194290161133}, "num_steps_trained": 3719561, "grad_time_ms": 9014.174, "num_steps_sampled": 3719561, "sample_time_ms": 18063.91, "load_time_ms": 4.718, "update_time_ms": 8.973}, "hostname": "flow-main", "episode_reward_max": -29.979755076804455, "timesteps_this_iter": 33229, "custom_metrics": {"cost1_max": 222.5562025833085, "cost1_mean": 184.945800320642, "system_level_velocity_mean": 15.801598790753781, "cost2_mean": -41.20678625495835, "cost2_max": -13.158704764084254, "outflow_rate_max": 1369.9230161023945, "cost1_min": 24.154196923603035, "system_level_velocity_min": 11.696621714189357, "system_level_velocity_max": 18.977206166362638, "outflow_rate_min": 500.9902957805507, "cost2_min": -60.76454890657516, "outflow_rate_mean": 1129.6479156947314}, "done": false, "pid": 51582, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 3719561, "time_total_s": 2996.684985399246, "timestamp": 1558605789, "iterations_since_restore": 104, "policy_reward_mean": {}, "training_iteration": 104, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454beb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bef0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b9e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4839, "timesteps_total": 3719561, "episode_reward_mean": -358.01753737093367, "episodes_this_iter": 48, "date": "2019-05-23_10-03-09", "time_this_iter_s": 28.563447952270508, "num_metric_batches_dropped": 0, "episode_reward_min": -577.0381588765346}
{"time_since_restore": 3024.7011909484863, "info": {"default": {"kl": 0.01318003423511982, "entropy": 1.1665562391281128, "total_loss": 16.35990333557129, "vf_explained_var": 0.8871475458145142, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00820659939199686, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.363887786865234}, "num_steps_trained": 3753037, "grad_time_ms": 9066.956, "num_steps_sampled": 3753037, "sample_time_ms": 18062.379, "load_time_ms": 4.627, "update_time_ms": 9.527}, "hostname": "flow-main", "episode_reward_max": -29.979755076804455, "timesteps_this_iter": 33476, "custom_metrics": {"cost1_max": 222.5562025833085, "cost1_mean": 184.7541273390548, "system_level_velocity_mean": 15.873972784218639, "cost2_mean": -39.84511559570944, "cost2_max": -13.158704764084254, "outflow_rate_max": 1369.9230161023945, "cost1_min": 24.154196923603035, "system_level_velocity_min": 11.696621714189357, "system_level_velocity_max": 18.977206166362638, "outflow_rate_min": 500.9902957805507, "cost2_min": -61.245153562193586, "outflow_rate_mean": 1125.5258141707218}, "done": false, "pid": 51582, "episode_len_mean": 320.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 3753037, "time_total_s": 3024.7011909484863, "timestamp": 1558605817, "iterations_since_restore": 105, "policy_reward_mean": {}, "training_iteration": 105, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845349b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541b38>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541e10>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4886, "timesteps_total": 3753037, "episode_reward_mean": -350.43456815033016, "episodes_this_iter": 47, "date": "2019-05-23_10-03-37", "time_this_iter_s": 28.016205549240112, "num_metric_batches_dropped": 0, "episode_reward_min": -552.1765609185238}
{"time_since_restore": 3050.2202410697937, "info": {"default": {"kl": 0.01450356561690569, "entropy": 1.1763932704925537, "total_loss": 14.568506240844727, "vf_explained_var": 0.8958894610404968, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008582551963627338, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 14.572443008422852}, "num_steps_trained": 3785382, "grad_time_ms": 8958.872, "num_steps_sampled": 3785382, "sample_time_ms": 17961.588, "load_time_ms": 4.625, "update_time_ms": 9.672}, "hostname": "flow-main", "episode_reward_max": -170.50229735499016, "timesteps_this_iter": 32345, "custom_metrics": {"cost1_max": 220.43241334235887, "cost1_mean": 186.5387393650539, "system_level_velocity_mean": 15.899566419148952, "cost2_mean": -38.698742522473246, "cost2_max": -18.37150595007075, "outflow_rate_max": 1353.7892058920343, "cost1_min": 134.0513581668886, "system_level_velocity_min": 11.696621714189357, "system_level_velocity_max": 18.72042672797444, "outflow_rate_min": 847.4653105324525, "cost2_min": -61.245153562193586, "outflow_rate_mean": 1121.1466982174582}, "done": false, "pid": 51582, "episode_len_mean": 323.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 3785382, "time_total_s": 3050.2202410697937, "timestamp": 1558605842, "iterations_since_restore": 106, "policy_reward_mean": {}, "training_iteration": 106, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84906710>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530518>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4930, "timesteps_total": 3785382, "episode_reward_mean": -344.0460801596036, "episodes_this_iter": 44, "date": "2019-05-23_10-04-02", "time_this_iter_s": 25.519050121307373, "num_metric_batches_dropped": 0, "episode_reward_min": -517.0179432413174}
{"time_since_restore": 3077.305522918701, "info": {"default": {"kl": 0.011524582281708717, "entropy": 1.178635835647583, "total_loss": 17.02692985534668, "vf_explained_var": 0.8811934590339661, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0073802354745566845, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 17.03061866760254}, "num_steps_trained": 3817753, "grad_time_ms": 8900.941, "num_steps_sampled": 3817753, "sample_time_ms": 17972.414, "load_time_ms": 4.478, "update_time_ms": 9.625}, "hostname": "flow-main", "episode_reward_max": -153.0116499842031, "timesteps_this_iter": 32371, "custom_metrics": {"cost1_max": 220.43241334235887, "cost1_mean": 189.74978228965128, "system_level_velocity_mean": 16.20190449436921, "cost2_mean": -37.45828560043272, "cost2_max": -18.37150595007075, "outflow_rate_max": 1353.7892058920343, "cost1_min": 136.67613408997468, "system_level_velocity_min": 12.750952476091726, "system_level_velocity_max": 18.72042672797444, "outflow_rate_min": 946.0710883631098, "cost2_min": -61.245153562193586, "outflow_rate_mean": 1131.509721355464}, "done": false, "pid": 51582, "episode_len_mean": 323.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 3817753, "time_total_s": 3077.305522918701, "timestamp": 1558605869, "iterations_since_restore": 107, "policy_reward_mean": {}, "training_iteration": 107, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549160>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534ef0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534ac8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 4978, "timesteps_total": 3817753, "episode_reward_mean": -332.59427738171905, "episodes_this_iter": 48, "date": "2019-05-23_10-04-29", "time_this_iter_s": 27.08528184890747, "num_metric_batches_dropped": 0, "episode_reward_min": -498.35110857736004}
{"time_since_restore": 3105.4946506023407, "info": {"default": {"kl": 0.012846523895859718, "entropy": 1.1117689609527588, "total_loss": 18.14401626586914, "vf_explained_var": 0.8704057931900024, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00836971402168274, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 18.148271560668945}, "num_steps_trained": 3850891, "grad_time_ms": 9091.739, "num_steps_sampled": 3850891, "sample_time_ms": 17944.68, "load_time_ms": 4.603, "update_time_ms": 9.586}, "hostname": "flow-main", "episode_reward_max": -21.348221740371528, "timesteps_this_iter": 33138, "custom_metrics": {"cost1_max": 219.14837078730687, "cost1_mean": 190.7735882938853, "system_level_velocity_mean": 16.42106189601232, "cost2_mean": -36.53895999874876, "cost2_max": -15.699829884881419, "outflow_rate_max": 1324.0700647088102, "cost1_min": 18.025669688839407, "system_level_velocity_min": 12.906359020916364, "system_level_velocity_max": 18.704164461472175, "outflow_rate_min": 437.2949997643919, "cost2_min": -54.83469511584646, "outflow_rate_mean": 1135.775587182355}, "done": false, "pid": 51582, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 3850891, "time_total_s": 3105.4946506023407, "timestamp": 1558605898, "iterations_since_restore": 108, "policy_reward_mean": {}, "training_iteration": 108, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530048>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845300b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530400>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5025, "timesteps_total": 3850891, "episode_reward_mean": -322.34377948576036, "episodes_this_iter": 47, "date": "2019-05-23_10-04-58", "time_this_iter_s": 28.189127683639526, "num_metric_batches_dropped": 0, "episode_reward_min": -482.0591441532233}
{"time_since_restore": 3132.5870468616486, "info": {"default": {"kl": 0.01232889574021101, "entropy": 1.156318187713623, "total_loss": 18.56173324584961, "vf_explained_var": 0.8776178359985352, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007621423341333866, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 18.56540298461914}, "num_steps_trained": 3883872, "grad_time_ms": 9222.898, "num_steps_sampled": 3883872, "sample_time_ms": 17841.069, "load_time_ms": 4.514, "update_time_ms": 9.424}, "hostname": "flow-main", "episode_reward_max": -21.348221740371528, "timesteps_this_iter": 32981, "custom_metrics": {"cost1_max": 221.42718606695465, "cost1_mean": 191.83754821469662, "system_level_velocity_mean": 16.49620152663572, "cost2_mean": -36.12082685043987, "cost2_max": -15.699829884881419, "outflow_rate_max": 1333.1601585872666, "cost1_min": 18.025669688839407, "system_level_velocity_min": 11.66998494671197, "system_level_velocity_max": 18.886034062980784, "outflow_rate_min": 437.2949997643919, "cost2_min": -52.70209543572054, "outflow_rate_mean": 1143.4966359083164}, "done": false, "pid": 51582, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 3883872, "time_total_s": 3132.5870468616486, "timestamp": 1558605925, "iterations_since_restore": 109, "policy_reward_mean": {}, "training_iteration": 109, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b860>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b588>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454be48>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5072, "timesteps_total": 3883872, "episode_reward_mean": -320.54453079343875, "episodes_this_iter": 47, "date": "2019-05-23_10-05-25", "time_this_iter_s": 27.09239625930786, "num_metric_batches_dropped": 0, "episode_reward_min": -582.3447116332596}
{"time_since_restore": 3159.015760421753, "info": {"default": {"kl": 0.01489711832255125, "entropy": 1.2480554580688477, "total_loss": 17.10399627685547, "vf_explained_var": 0.8949242830276489, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010778193362057209, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 17.110000610351562}, "num_steps_trained": 3916474, "grad_time_ms": 9165.1, "num_steps_sampled": 3916474, "sample_time_ms": 17856.833, "load_time_ms": 4.54, "update_time_ms": 9.547}, "hostname": "flow-main", "episode_reward_max": -202.37808506808832, "timesteps_this_iter": 32602, "custom_metrics": {"cost1_max": 222.35302283240296, "cost1_mean": 191.88172808487306, "system_level_velocity_mean": 16.268853659902963, "cost2_mean": -37.16043922633587, "cost2_max": -20.5880737509112, "outflow_rate_max": 1343.3861085779427, "cost1_min": 138.98555325270453, "system_level_velocity_min": 11.66998494671197, "system_level_velocity_max": 18.886034062980784, "outflow_rate_min": 937.8463511029413, "cost2_min": -52.70209543572054, "outflow_rate_mean": 1147.0702623568725}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3916474, "time_total_s": 3159.015760421753, "timestamp": 1558605951, "iterations_since_restore": 110, "policy_reward_mean": {}, "training_iteration": 110, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9d30>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9f98>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5116, "timesteps_total": 3916474, "episode_reward_mean": -336.4473704623881, "episodes_this_iter": 44, "date": "2019-05-23_10-05-51", "time_this_iter_s": 26.42871356010437, "num_metric_batches_dropped": 0, "episode_reward_min": -582.3447116332596}
{"time_since_restore": 3185.740474462509, "info": {"default": {"kl": 0.011788682080805302, "entropy": 1.16439950466156, "total_loss": 14.967324256896973, "vf_explained_var": 0.9019606709480286, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008969735354185104, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 14.972517967224121}, "num_steps_trained": 3949188, "grad_time_ms": 9193.813, "num_steps_sampled": 3949188, "sample_time_ms": 17847.08, "load_time_ms": 4.378, "update_time_ms": 9.479}, "hostname": "flow-main", "episode_reward_max": -84.37176248473536, "timesteps_this_iter": 32714, "custom_metrics": {"cost1_max": 222.35302283240296, "cost1_mean": 186.05873956461167, "system_level_velocity_mean": 15.955363948440421, "cost2_mean": -37.537756993132604, "cost2_max": -20.5880737509112, "outflow_rate_max": 1343.3861085779427, "cost1_min": 79.79433033270618, "system_level_velocity_min": 12.783410849671233, "system_level_velocity_max": 18.878594762936487, "outflow_rate_min": 759.1765427247777, "cost2_min": -53.468837313334326, "outflow_rate_mean": 1120.7976970838413}, "done": false, "pid": 51582, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 3949188, "time_total_s": 3185.740474462509, "timestamp": 1558605978, "iterations_since_restore": 111, "policy_reward_mean": {}, "training_iteration": 111, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845306d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e848f2438>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5165, "timesteps_total": 3949188, "episode_reward_mean": -342.6775683301177, "episodes_this_iter": 49, "date": "2019-05-23_10-06-18", "time_this_iter_s": 26.724714040756226, "num_metric_batches_dropped": 0, "episode_reward_min": -529.2490317925268}
{"time_since_restore": 3211.01366853714, "info": {"default": {"kl": 0.012370381504297256, "entropy": 1.1379050016403198, "total_loss": 19.902376174926758, "vf_explained_var": 0.8668515682220459, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009467517957091331, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 19.907878875732422}, "num_steps_trained": 3982290, "grad_time_ms": 9000.363, "num_steps_sampled": 3982290, "sample_time_ms": 17843.479, "load_time_ms": 4.465, "update_time_ms": 9.615}, "hostname": "flow-main", "episode_reward_max": -84.37176248473536, "timesteps_this_iter": 33102, "custom_metrics": {"cost1_max": 220.38116929005292, "cost1_mean": 187.90717505200882, "system_level_velocity_mean": 16.120188747116593, "cost2_mean": -38.15310333951572, "cost2_max": -22.956229313834612, "outflow_rate_max": 1324.7804084625054, "cost1_min": 79.79433033270618, "system_level_velocity_min": 12.783410849671233, "system_level_velocity_max": 18.836841027024107, "outflow_rate_min": 759.1765427247777, "cost2_min": -57.70154894334677, "outflow_rate_mean": 1129.5929997633395}, "done": false, "pid": 51582, "episode_len_mean": 321.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 3982290, "time_total_s": 3211.01366853714, "timestamp": 1558606003, "iterations_since_restore": 112, "policy_reward_mean": {}, "training_iteration": 112, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bcc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bf28>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5213, "timesteps_total": 3982290, "episode_reward_mean": -336.69342083510213, "episodes_this_iter": 48, "date": "2019-05-23_10-06-43", "time_this_iter_s": 25.273194074630737, "num_metric_batches_dropped": 0, "episode_reward_min": -517.8696364144384}
{"time_since_restore": 3236.177343606949, "info": {"default": {"kl": 0.013238119892776012, "entropy": 1.1712045669555664, "total_loss": 15.298480033874512, "vf_explained_var": 0.8916532397270203, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010558621026575565, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 15.30479907989502}, "num_steps_trained": 4014913, "grad_time_ms": 8932.255, "num_steps_sampled": 4014913, "sample_time_ms": 17770.793, "load_time_ms": 4.325, "update_time_ms": 9.664}, "hostname": "flow-main", "episode_reward_max": -149.4680965746656, "timesteps_this_iter": 32623, "custom_metrics": {"cost1_max": 220.64611876217674, "cost1_mean": 189.8000974271676, "system_level_velocity_mean": 16.185015748840176, "cost2_mean": -37.282229034494655, "cost2_max": -22.956229313834612, "outflow_rate_max": 1338.842551630109, "cost1_min": 138.18097840688984, "system_level_velocity_min": 12.334431313216255, "system_level_velocity_max": 18.836841027024107, "outflow_rate_min": 913.1606988088487, "cost2_min": -57.70154894334677, "outflow_rate_mean": 1136.55074119076}, "done": false, "pid": 51582, "episode_len_mean": 323.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 4014913, "time_total_s": 3236.177343606949, "timestamp": 1558606028, "iterations_since_restore": 113, "policy_reward_mean": {}, "training_iteration": 113, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530c50>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530198>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5254, "timesteps_total": 4014913, "episode_reward_mean": -334.72768034377305, "episodes_this_iter": 41, "date": "2019-05-23_10-07-08", "time_this_iter_s": 25.16367506980896, "num_metric_batches_dropped": 0, "episode_reward_min": -527.4428415938172}
{"time_since_restore": 3263.2630939483643, "info": {"default": {"kl": 0.013213107362389565, "entropy": 1.2187317609786987, "total_loss": 18.42354393005371, "vf_explained_var": 0.8737021088600159, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010503668338060379, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 18.429813385009766}, "num_steps_trained": 4047887, "grad_time_ms": 8929.946, "num_steps_sampled": 4047887, "sample_time_ms": 17629.409, "load_time_ms": 4.372, "update_time_ms": 9.524}, "hostname": "flow-main", "episode_reward_max": -86.56956841896564, "timesteps_this_iter": 32974, "custom_metrics": {"cost1_max": 221.66737480505054, "cost1_mean": 190.49244990810166, "system_level_velocity_mean": 16.341198559583123, "cost2_mean": -36.75076713433, "cost2_max": -20.931701542019347, "outflow_rate_max": 1350.8534752670407, "cost1_min": 79.67365400128817, "system_level_velocity_min": 12.334431313216255, "system_level_velocity_max": 18.94977276408886, "outflow_rate_min": 771.6506666813684, "cost2_min": -53.85834823320165, "outflow_rate_mean": 1138.3553568991654}, "done": false, "pid": 51582, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 4047887, "time_total_s": 3263.2630939483643, "timestamp": 1558606055, "iterations_since_restore": 114, "policy_reward_mean": {}, "training_iteration": 114, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454be48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b470>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bf60>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5305, "timesteps_total": 4047887, "episode_reward_mean": -326.07959078945555, "episodes_this_iter": 51, "date": "2019-05-23_10-07-35", "time_this_iter_s": 27.085750341415405, "num_metric_batches_dropped": 0, "episode_reward_min": -527.4428415938172}
{"time_since_restore": 3289.4063432216644, "info": {"default": {"kl": 0.012529615312814713, "entropy": 1.2194137573242188, "total_loss": 13.674437522888184, "vf_explained_var": 0.9063095450401306, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008761199191212654, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 13.679184913635254}, "num_steps_trained": 4080554, "grad_time_ms": 8912.215, "num_steps_sampled": 4080554, "sample_time_ms": 17459.183, "load_time_ms": 4.469, "update_time_ms": 8.923}, "hostname": "flow-main", "episode_reward_max": -86.56956841896564, "timesteps_this_iter": 32667, "custom_metrics": {"cost1_max": 221.66737480505054, "cost1_mean": 187.25835399036197, "system_level_velocity_mean": 15.974878205357008, "cost2_mean": -36.976221669967856, "cost2_max": -20.931701542019347, "outflow_rate_max": 1350.8534752670407, "cost1_min": 79.67365400128817, "system_level_velocity_min": 13.01954285373029, "system_level_velocity_max": 18.94977276408886, "outflow_rate_min": 771.6506666813684, "cost2_min": -56.13396833448071, "outflow_rate_mean": 1118.9229108173138}, "done": false, "pid": 51582, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4080554, "time_total_s": 3289.4063432216644, "timestamp": 1558606082, "iterations_since_restore": 115, "policy_reward_mean": {}, "training_iteration": 115, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845495c0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534208>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845496d8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5353, "timesteps_total": 4080554, "episode_reward_mean": -342.190966512821, "episodes_this_iter": 48, "date": "2019-05-23_10-08-02", "time_this_iter_s": 26.14324927330017, "num_metric_batches_dropped": 0, "episode_reward_min": -552.1728851257122}
{"time_since_restore": 3315.1889114379883, "info": {"default": {"kl": 0.013824365101754665, "entropy": 1.119566559791565, "total_loss": 17.560218811035156, "vf_explained_var": 0.8731074333190918, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009670211002230644, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 17.565462112426758}, "num_steps_trained": 4113765, "grad_time_ms": 8894.56, "num_steps_sampled": 4113765, "sample_time_ms": 17502.851, "load_time_ms": 4.415, "update_time_ms": 9.091}, "hostname": "flow-main", "episode_reward_max": -28.74408097995545, "timesteps_this_iter": 33211, "custom_metrics": {"cost1_max": 219.996208431664, "cost1_mean": 189.9635888745758, "system_level_velocity_mean": 16.258405167089773, "cost2_mean": -35.60472931842524, "cost2_max": -10.941005554157922, "outflow_rate_max": 1338.119912783655, "cost1_min": 22.968456526702116, "system_level_velocity_min": 13.01954285373029, "system_level_velocity_max": 18.71215820478457, "outflow_rate_min": 484.88522595723686, "cost2_min": -56.13396833448071, "outflow_rate_mean": 1129.1372263334279}, "done": false, "pid": 51582, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "timesteps_since_restore": 4113765, "time_total_s": 3315.1889114379883, "timestamp": 1558606107, "iterations_since_restore": 116, "policy_reward_mean": {}, "training_iteration": 116, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549400>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530b00>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530c50>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5396, "timesteps_total": 4113765, "episode_reward_mean": -329.51140081024175, "episodes_this_iter": 43, "date": "2019-05-23_10-08-27", "time_this_iter_s": 25.782568216323853, "num_metric_batches_dropped": 0, "episode_reward_min": -552.1728851257122}
{"time_since_restore": 3340.869871854782, "info": {"default": {"kl": 0.01565117947757244, "entropy": 1.2811763286590576, "total_loss": 14.475227355957031, "vf_explained_var": 0.8998083472251892, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011387055739760399, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 14.481599807739258}, "num_steps_trained": 4145429, "grad_time_ms": 8786.747, "num_steps_sampled": 4145429, "sample_time_ms": 17473.947, "load_time_ms": 4.565, "update_time_ms": 8.965}, "hostname": "flow-main", "episode_reward_max": -28.74408097995545, "timesteps_this_iter": 31664, "custom_metrics": {"cost1_max": 221.32116892390474, "cost1_mean": 189.31705196264912, "system_level_velocity_mean": 16.282129077476963, "cost2_mean": -35.43342879299346, "cost2_max": -10.941005554157922, "outflow_rate_max": 1345.246592609374, "cost1_min": 22.968456526702116, "system_level_velocity_min": 11.989084099938026, "system_level_velocity_max": 18.890822754105848, "outflow_rate_min": 484.88522595723686, "cost2_min": -53.36241248978487, "outflow_rate_mean": 1125.824468485115}, "done": false, "pid": 51582, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4145429, "time_total_s": 3340.869871854782, "timestamp": 1558606133, "iterations_since_restore": 117, "policy_reward_mean": {}, "training_iteration": 117, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b358>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b0f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bda0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5444, "timesteps_total": 4145429, "episode_reward_mean": -324.13762600212124, "episodes_this_iter": 48, "date": "2019-05-23_10-08-53", "time_this_iter_s": 25.680960416793823, "num_metric_batches_dropped": 0, "episode_reward_min": -536.1924909322872}
{"time_since_restore": 3367.540811061859, "info": {"default": {"kl": 0.01362829003483057, "entropy": 1.196804165840149, "total_loss": 17.594575881958008, "vf_explained_var": 0.870918869972229, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010831181891262531, "cur_kl_coeff": 0.32036131620407104, "vf_loss": 17.601037979125977}, "num_steps_trained": 4177204, "grad_time_ms": 8593.18, "num_steps_sampled": 4177204, "sample_time_ms": 17516.3, "load_time_ms": 4.438, "update_time_ms": 9.25}, "hostname": "flow-main", "episode_reward_max": -27.201259156552844, "timesteps_this_iter": 31775, "custom_metrics": {"cost1_max": 221.32116892390474, "cost1_mean": 188.50070550445392, "system_level_velocity_mean": 16.24650942688809, "cost2_mean": -34.42408154284259, "cost2_max": -14.155341698442562, "outflow_rate_max": 1347.372252554184, "cost1_min": 22.78280659580485, "system_level_velocity_min": 11.989084099938026, "system_level_velocity_max": 18.890822754105848, "outflow_rate_min": 516.5375004973323, "cost2_min": -50.412815973802545, "outflow_rate_mean": 1112.6025060690426}, "done": false, "pid": 51582, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4177204, "time_total_s": 3367.540811061859, "timestamp": 1558606160, "iterations_since_restore": 118, "policy_reward_mean": {}, "training_iteration": 118, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845379e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845374e0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537208>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5495, "timesteps_total": 4177204, "episode_reward_mean": -321.18149709635577, "episodes_this_iter": 51, "date": "2019-05-23_10-09-20", "time_this_iter_s": 26.670939207077026, "num_metric_batches_dropped": 0, "episode_reward_min": -536.1924909322872}
{"time_since_restore": 3392.8198285102844, "info": {"default": {"kl": 0.014700262807309628, "entropy": 1.2137998342514038, "total_loss": 16.072702407836914, "vf_explained_var": 0.8821454644203186, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011366968974471092, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.07935905456543}, "num_steps_trained": 4209120, "grad_time_ms": 8587.545, "num_steps_sampled": 4209120, "sample_time_ms": 17343.317, "load_time_ms": 4.449, "update_time_ms": 9.151}, "hostname": "flow-main", "episode_reward_max": -27.201259156552844, "timesteps_this_iter": 31916, "custom_metrics": {"cost1_max": 220.99048373460323, "cost1_mean": 187.92368332926782, "system_level_velocity_mean": 16.31635334240325, "cost2_mean": -34.278076686946775, "cost2_max": -12.70753769198623, "outflow_rate_max": 1347.372252554184, "cost1_min": 22.78280659580485, "system_level_velocity_min": 12.91476666848984, "system_level_velocity_max": 19.04097109431558, "outflow_rate_min": 503.0980853371426, "cost2_min": -52.00142232405701, "outflow_rate_mean": 1110.829660295541}, "done": false, "pid": 51582, "episode_len_mean": 318.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 4209120, "time_total_s": 3392.8198285102844, "timestamp": 1558606185, "iterations_since_restore": 119, "policy_reward_mean": {}, "training_iteration": 119, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b9b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bcf8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5537, "timesteps_total": 4209120, "episode_reward_mean": -316.32407050721184, "episodes_this_iter": 42, "date": "2019-05-23_10-09-45", "time_this_iter_s": 25.279017448425293, "num_metric_batches_dropped": 0, "episode_reward_min": -472.44894752557906}
{"time_since_restore": 3418.586275100708, "info": {"default": {"kl": 0.015934662893414497, "entropy": 1.3083220720291138, "total_loss": 14.179242134094238, "vf_explained_var": 0.8957211971282959, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011234000325202942, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 14.185371398925781}, "num_steps_trained": 4239810, "grad_time_ms": 8638.104, "num_steps_sampled": 4239810, "sample_time_ms": 17226.199, "load_time_ms": 4.452, "update_time_ms": 9.107}, "hostname": "flow-main", "episode_reward_max": -28.788159762100932, "timesteps_this_iter": 30690, "custom_metrics": {"cost1_max": 219.98557957398106, "cost1_mean": 189.08962723222405, "system_level_velocity_mean": 16.28188098353223, "cost2_mean": -33.56904157121397, "cost2_max": -12.70753769198623, "outflow_rate_max": 1326.6561276548496, "cost1_min": 24.680296435208874, "system_level_velocity_min": 13.166886322720753, "system_level_velocity_max": 19.04097109431558, "outflow_rate_min": 503.0980853371426, "cost2_min": -52.00142232405701, "outflow_rate_mean": 1109.962523357813}, "done": false, "pid": 51582, "episode_len_mean": 321.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 4239810, "time_total_s": 3418.586275100708, "timestamp": 1558606211, "iterations_since_restore": 120, "policy_reward_mean": {}, "training_iteration": 120, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bc50>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b780>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5583, "timesteps_total": 4239810, "episode_reward_mean": -313.4268120341089, "episodes_this_iter": 46, "date": "2019-05-23_10-10-11", "time_this_iter_s": 25.766446590423584, "num_metric_batches_dropped": 0, "episode_reward_min": -446.81261701407357}
{"time_since_restore": 3443.504766225815, "info": {"default": {"kl": 0.012659569270908833, "entropy": 1.285050392150879, "total_loss": 15.816088676452637, "vf_explained_var": 0.8926227688789368, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01014833152294159, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 15.822181701660156}, "num_steps_trained": 4270942, "grad_time_ms": 8468.866, "num_steps_sampled": 4270942, "sample_time_ms": 17216.495, "load_time_ms": 4.454, "update_time_ms": 9.136}, "hostname": "flow-main", "episode_reward_max": -28.788159762100932, "timesteps_this_iter": 31132, "custom_metrics": {"cost1_max": 219.98557957398106, "cost1_mean": 187.57106743903168, "system_level_velocity_mean": 16.165484554130952, "cost2_mean": -33.41006790682794, "cost2_max": -12.70753769198623, "outflow_rate_max": 1326.6561276548496, "cost1_min": 24.680296435208874, "system_level_velocity_min": 13.166886322720753, "system_level_velocity_max": 19.04097109431558, "outflow_rate_min": 503.0980853371426, "cost2_min": -50.63628600913091, "outflow_rate_mean": 1092.623362941462}, "done": false, "pid": 51582, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "timesteps_since_restore": 4270942, "time_total_s": 3443.504766225815, "timestamp": 1558606236, "iterations_since_restore": 121, "policy_reward_mean": {}, "training_iteration": 121, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845491d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549860>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549710>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5632, "timesteps_total": 4270942, "episode_reward_mean": -315.2059097128198, "episodes_this_iter": 49, "date": "2019-05-23_10-10-36", "time_this_iter_s": 24.91849112510681, "num_metric_batches_dropped": 0, "episode_reward_min": -476.1193743200012}
{"time_since_restore": 3468.531665325165, "info": {"default": {"kl": 0.01592187024652958, "entropy": 1.40756094455719, "total_loss": 12.273934364318848, "vf_explained_var": 0.9254579544067383, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010079623199999332, "cur_kl_coeff": 0.32036131620407104, "vf_loss": 12.278913497924805}, "num_steps_trained": 4301782, "grad_time_ms": 8422.411, "num_steps_sampled": 4301782, "sample_time_ms": 17241.365, "load_time_ms": 4.357, "update_time_ms": 8.989}, "hostname": "flow-main", "episode_reward_max": -29.469987340975177, "timesteps_this_iter": 30840, "custom_metrics": {"cost1_max": 218.72924963377483, "cost1_mean": 184.41887259140134, "system_level_velocity_mean": 15.898665991696175, "cost2_mean": -33.5590660956606, "cost2_max": -14.996795613203705, "outflow_rate_max": 1316.6412268149513, "cost1_min": 24.745275922380284, "system_level_velocity_min": 13.374140021922631, "system_level_velocity_max": 18.757174178906457, "outflow_rate_min": 506.4167257881143, "cost2_min": -51.675576609144564, "outflow_rate_mean": 1072.7208211448906}, "done": false, "pid": 51582, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "timesteps_since_restore": 4301782, "time_total_s": 3468.531665325165, "timestamp": 1558606261, "iterations_since_restore": 122, "policy_reward_mean": {}, "training_iteration": 122, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845306d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530518>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530588>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5678, "timesteps_total": 4301782, "episode_reward_mean": -321.8791456512067, "episodes_this_iter": 46, "date": "2019-05-23_10-11-01", "time_this_iter_s": 25.026899099349976, "num_metric_batches_dropped": 0, "episode_reward_min": -476.1193743200012}
{"time_since_restore": 3494.2333340644836, "info": {"default": {"kl": 0.015184036456048489, "entropy": 1.4291493892669678, "total_loss": 16.300106048583984, "vf_explained_var": 0.9115344285964966, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009430613368749619, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.304672241210938}, "num_steps_trained": 4332964, "grad_time_ms": 8470.894, "num_steps_sampled": 4332964, "sample_time_ms": 17208.54, "load_time_ms": 4.457, "update_time_ms": 8.878}, "hostname": "flow-main", "episode_reward_max": -29.469987340975177, "timesteps_this_iter": 31182, "custom_metrics": {"cost1_max": 221.32835413190605, "cost1_mean": 180.99972887787968, "system_level_velocity_mean": 15.600505327336055, "cost2_mean": -33.84781992318436, "cost2_max": -14.996795613203705, "outflow_rate_max": 1351.08445912469, "cost1_min": 24.745275922380284, "system_level_velocity_min": 12.637105674948597, "system_level_velocity_max": 19.05807005155978, "outflow_rate_min": 506.4167257881143, "cost2_min": -52.09619325023729, "outflow_rate_mean": 1062.833507561284}, "done": false, "pid": 51582, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "timesteps_since_restore": 4332964, "time_total_s": 3494.2333340644836, "timestamp": 1558606287, "iterations_since_restore": 123, "policy_reward_mean": {}, "training_iteration": 123, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bf60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b588>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bda0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5722, "timesteps_total": 4332964, "episode_reward_mean": -334.28953850694836, "episodes_this_iter": 44, "date": "2019-05-23_10-11-27", "time_this_iter_s": 25.701668739318848, "num_metric_batches_dropped": 0, "episode_reward_min": -479.9148368592001}
{"time_since_restore": 3518.9576370716095, "info": {"default": {"kl": 0.013145492412149906, "entropy": 1.354198694229126, "total_loss": 14.688429832458496, "vf_explained_var": 0.9159309267997742, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008460077457129955, "cur_kl_coeff": 0.32036131620407104, "vf_loss": 14.692679405212402}, "num_steps_trained": 4363857, "grad_time_ms": 8418.491, "num_steps_sampled": 4363857, "sample_time_ms": 17023.897, "load_time_ms": 4.325, "update_time_ms": 8.963}, "hostname": "flow-main", "episode_reward_max": -229.25705998256385, "timesteps_this_iter": 30893, "custom_metrics": {"cost1_max": 221.32835413190605, "cost1_mean": 181.7096907755471, "system_level_velocity_mean": 15.515201506624027, "cost2_mean": -34.05068260739868, "cost2_max": -20.81935541522911, "outflow_rate_max": 1351.08445912469, "cost1_min": 146.63774936775914, "system_level_velocity_min": 12.629603845388242, "system_level_velocity_max": 19.05807005155978, "outflow_rate_min": 846.7594540610601, "cost2_min": -52.09619325023729, "outflow_rate_mean": 1062.6369739516806}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4363857, "time_total_s": 3518.9576370716095, "timestamp": 1558606312, "iterations_since_restore": 124, "policy_reward_mean": {}, "training_iteration": 124, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845490f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845496d8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845495c0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5770, "timesteps_total": 4363857, "episode_reward_mean": -339.3692989646378, "episodes_this_iter": 48, "date": "2019-05-23_10-11-52", "time_this_iter_s": 24.724303007125854, "num_metric_batches_dropped": 0, "episode_reward_min": -479.9148368592001}
{"time_since_restore": 3543.566629886627, "info": {"default": {"kl": 0.013777338899672031, "entropy": 1.4082471132278442, "total_loss": 15.945279121398926, "vf_explained_var": 0.9088959097862244, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010169393382966518, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 15.951034545898438}, "num_steps_trained": 4394094, "grad_time_ms": 8322.118, "num_steps_sampled": 4394094, "sample_time_ms": 16967.55, "load_time_ms": 4.452, "update_time_ms": 9.279}, "hostname": "flow-main", "episode_reward_max": -83.11701086106329, "timesteps_this_iter": 30237, "custom_metrics": {"cost1_max": 216.78767837915424, "cost1_mean": 180.5394538139028, "system_level_velocity_mean": 15.542626513430319, "cost2_mean": -33.71686831280624, "cost2_max": -22.802321761548544, "outflow_rate_max": 1276.0296108727034, "cost1_min": 79.37524523940503, "system_level_velocity_min": 12.629603845388242, "system_level_velocity_max": 18.715438049712215, "outflow_rate_min": 767.2980105291921, "cost2_min": -51.66249606486611, "outflow_rate_mean": 1046.4641993837681}, "done": false, "pid": 51582, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4394094, "time_total_s": 3543.566629886627, "timestamp": 1558606336, "iterations_since_restore": 125, "policy_reward_mean": {}, "training_iteration": 125, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b4e0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b3c8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5819, "timesteps_total": 4394094, "episode_reward_mean": -331.8309726948048, "episodes_this_iter": 49, "date": "2019-05-23_10-12-16", "time_this_iter_s": 24.6089928150177, "num_metric_batches_dropped": 0, "episode_reward_min": -479.9148368592001}
{"time_since_restore": 3568.645071029663, "info": {"default": {"kl": 0.014624214731156826, "entropy": 1.393094778060913, "total_loss": 15.091388702392578, "vf_explained_var": 0.9089537858963013, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012213969603180885, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 15.098917007446289}, "num_steps_trained": 4424159, "grad_time_ms": 8209.988, "num_steps_sampled": 4424159, "sample_time_ms": 17009.951, "load_time_ms": 4.552, "update_time_ms": 8.984}, "hostname": "flow-main", "episode_reward_max": -83.11701086106329, "timesteps_this_iter": 30065, "custom_metrics": {"cost1_max": 215.65078971762142, "cost1_mean": 180.35647856282722, "system_level_velocity_mean": 15.732492310745709, "cost2_mean": -33.172007407881225, "cost2_max": -20.30678351003949, "outflow_rate_max": 1255.7341331019888, "cost1_min": 78.96224309011731, "system_level_velocity_min": 12.86585114421231, "system_level_velocity_max": 18.99640104760024, "outflow_rate_min": 759.0552908019349, "cost2_min": -51.66249606486611, "outflow_rate_mean": 1040.446864464465}, "done": false, "pid": 51582, "episode_len_mean": 319.76, "node_ip": "10.138.0.2", "timesteps_since_restore": 4424159, "time_total_s": 3568.645071029663, "timestamp": 1558606361, "iterations_since_restore": 126, "policy_reward_mean": {}, "training_iteration": 126, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549dd8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845494a8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549470>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5862, "timesteps_total": 4424159, "episode_reward_mean": -320.37142121403946, "episodes_this_iter": 43, "date": "2019-05-23_10-12-41", "time_this_iter_s": 25.07844114303589, "num_metric_batches_dropped": 0, "episode_reward_min": -460.81413830096574}
{"time_since_restore": 3592.7052931785583, "info": {"default": {"kl": 0.01421369332820177, "entropy": 1.3779369592666626, "total_loss": 14.402264595031738, "vf_explained_var": 0.9102727770805359, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00918001588433981, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 14.406892776489258}, "num_steps_trained": 4453388, "grad_time_ms": 8138.816, "num_steps_sampled": 4453388, "sample_time_ms": 16919.122, "load_time_ms": 4.563, "update_time_ms": 9.025}, "hostname": "flow-main", "episode_reward_max": -87.03567894518808, "timesteps_this_iter": 29229, "custom_metrics": {"cost1_max": 221.45943844489813, "cost1_mean": 183.61874814305975, "system_level_velocity_mean": 15.939501806893526, "cost2_mean": -32.96233201583678, "cost2_max": -20.30678351003949, "outflow_rate_max": 1321.2108108964208, "cost1_min": 78.96224309011731, "system_level_velocity_min": 12.979242453951644, "system_level_velocity_max": 18.99640104760024, "outflow_rate_min": 759.0552908019349, "cost2_min": -48.143552881450226, "outflow_rate_mean": 1051.7330627222523}, "done": false, "pid": 51582, "episode_len_mean": 321.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 4453388, "time_total_s": 3592.7052931785583, "timestamp": 1558606385, "iterations_since_restore": 127, "policy_reward_mean": {}, "training_iteration": 127, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541128>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534c50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534b00>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5910, "timesteps_total": 4453388, "episode_reward_mean": -314.2964205057597, "episodes_this_iter": 48, "date": "2019-05-23_10-13-05", "time_this_iter_s": 24.060222148895264, "num_metric_batches_dropped": 0, "episode_reward_min": -459.07604827434244}
{"time_since_restore": 3616.5729978084564, "info": {"default": {"kl": 0.01353280059993267, "entropy": 1.4042201042175293, "total_loss": 14.931100845336914, "vf_explained_var": 0.9111294150352478, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010340026579797268, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 14.937106132507324}, "num_steps_trained": 4482788, "grad_time_ms": 8066.661, "num_steps_sampled": 4482788, "sample_time_ms": 16711.047, "load_time_ms": 4.569, "update_time_ms": 8.772}, "hostname": "flow-main", "episode_reward_max": -20.793184094271055, "timesteps_this_iter": 29400, "custom_metrics": {"cost1_max": 221.45943844489813, "cost1_mean": 184.86748289704505, "system_level_velocity_mean": 16.076750683387708, "cost2_mean": -32.14131971159081, "cost2_max": -13.898924337954563, "outflow_rate_max": 1321.2108108964208, "cost1_min": 18.15714471630869, "system_level_velocity_min": 13.053686027451958, "system_level_velocity_max": 18.861775896495825, "outflow_rate_min": 470.30216034021953, "cost2_min": -47.67281878664534, "outflow_rate_mean": 1050.5655024546377}, "done": false, "pid": 51582, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 4482788, "time_total_s": 3616.5729978084564, "timestamp": 1558606409, "iterations_since_restore": 128, "policy_reward_mean": {}, "training_iteration": 128, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845571d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557f98>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 5958, "timesteps_total": 4482788, "episode_reward_mean": -304.2544701986243, "episodes_this_iter": 48, "date": "2019-05-23_10-13-29", "time_this_iter_s": 23.86770462989807, "num_metric_batches_dropped": 0, "episode_reward_min": -471.856563870552}
{"time_since_restore": 3641.044896841049, "info": {"default": {"kl": 0.014406712725758553, "entropy": 1.3566064834594727, "total_loss": 16.03199577331543, "vf_explained_var": 0.9057416915893555, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009181227535009384, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.036561965942383}, "num_steps_trained": 4513481, "grad_time_ms": 8010.033, "num_steps_sampled": 4513481, "sample_time_ms": 16687.364, "load_time_ms": 4.628, "update_time_ms": 8.868}, "hostname": "flow-main", "episode_reward_max": -20.793184094271055, "timesteps_this_iter": 30693, "custom_metrics": {"cost1_max": 218.8227475298121, "cost1_mean": 184.12818609374568, "system_level_velocity_mean": 15.973317098558692, "cost2_mean": -32.79451006125745, "cost2_max": -13.898924337954563, "outflow_rate_max": 1315.7603571428572, "cost1_min": 18.15714471630869, "system_level_velocity_min": 12.628690149550387, "system_level_velocity_max": 18.606290370299654, "outflow_rate_min": 470.30216034021953, "cost2_min": -50.81359219174469, "outflow_rate_mean": 1055.0573439796992}, "done": false, "pid": 51582, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 4513481, "time_total_s": 3641.044896841049, "timestamp": 1558606434, "iterations_since_restore": 129, "policy_reward_mean": {}, "training_iteration": 129, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b2b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bf98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b780>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6003, "timesteps_total": 4513481, "episode_reward_mean": -309.33821276315024, "episodes_this_iter": 45, "date": "2019-05-23_10-13-54", "time_this_iter_s": 24.471899032592773, "num_metric_batches_dropped": 0, "episode_reward_min": -471.856563870552}
{"time_since_restore": 3664.799058675766, "info": {"default": {"kl": 0.013949788175523281, "entropy": 1.363625168800354, "total_loss": 13.921168327331543, "vf_explained_var": 0.9161249995231628, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010967092588543892, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 13.927667617797852}, "num_steps_trained": 4543401, "grad_time_ms": 7890.753, "num_steps_sampled": 4543401, "sample_time_ms": 16606.232, "load_time_ms": 4.692, "update_time_ms": 9.042}, "hostname": "flow-main", "episode_reward_max": -20.793184094271055, "timesteps_this_iter": 29920, "custom_metrics": {"cost1_max": 218.8227475298121, "cost1_mean": 182.18299515208398, "system_level_velocity_mean": 15.895304310075932, "cost2_mean": -34.258305743244975, "cost2_max": -13.898924337954563, "outflow_rate_max": 1323.455322942152, "cost1_min": 18.15714471630869, "system_level_velocity_min": 12.628690149550387, "system_level_velocity_max": 18.726057329057284, "outflow_rate_min": 470.30216034021953, "cost2_min": -50.81359219174469, "outflow_rate_mean": 1058.0650389159703}, "done": false, "pid": 51582, "episode_len_mean": 319.38, "node_ip": "10.138.0.2", "timesteps_since_restore": 4543401, "time_total_s": 3664.799058675766, "timestamp": 1558606458, "iterations_since_restore": 130, "policy_reward_mean": {}, "training_iteration": 130, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534978>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534438>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6050, "timesteps_total": 4543401, "episode_reward_mean": -314.4344993640657, "episodes_this_iter": 47, "date": "2019-05-23_10-14-18", "time_this_iter_s": 23.754161834716797, "num_metric_batches_dropped": 0, "episode_reward_min": -456.9809335781266}
{"time_since_restore": 3690.213496685028, "info": {"default": {"kl": 0.012804429046809673, "entropy": 1.3383210897445679, "total_loss": 16.99403190612793, "vf_explained_var": 0.9059788584709167, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008205858990550041, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.998136520385742}, "num_steps_trained": 4574724, "grad_time_ms": 7943.756, "num_steps_sampled": 4574724, "sample_time_ms": 16602.01, "load_time_ms": 4.802, "update_time_ms": 9.313}, "hostname": "flow-main", "episode_reward_max": -29.421467777326637, "timesteps_this_iter": 31323, "custom_metrics": {"cost1_max": 220.31036238671112, "cost1_mean": 183.98915782535576, "system_level_velocity_mean": 16.025398708779722, "cost2_mean": -35.12855868326688, "cost2_max": -12.978827846570148, "outflow_rate_max": 1326.9480001069749, "cost1_min": 24.342171137044527, "system_level_velocity_min": 12.429738143412893, "system_level_velocity_max": 18.894939925732764, "outflow_rate_min": 500.9902957805507, "cost2_min": -54.601925445035185, "outflow_rate_mean": 1067.4461932068714}, "done": false, "pid": 51582, "episode_len_mean": 319.48, "node_ip": "10.138.0.2", "timesteps_since_restore": 4574724, "time_total_s": 3690.213496685028, "timestamp": 1558606483, "iterations_since_restore": 131, "policy_reward_mean": {}, "training_iteration": 131, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845494a8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b7f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549438>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6099, "timesteps_total": 4574724, "episode_reward_mean": -315.5010405758904, "episodes_this_iter": 49, "date": "2019-05-23_10-14-43", "time_this_iter_s": 25.414438009262085, "num_metric_batches_dropped": 0, "episode_reward_min": -473.45674628590814}
{"time_since_restore": 3715.0176899433136, "info": {"default": {"kl": 0.014992217533290386, "entropy": 1.377295732498169, "total_loss": 14.057767868041992, "vf_explained_var": 0.9202496409416199, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011498340405523777, "cur_kl_coeff": 0.32036131620407104, "vf_loss": 14.06446361541748}, "num_steps_trained": 4605549, "grad_time_ms": 7928.778, "num_steps_sampled": 4605549, "sample_time_ms": 16594.573, "load_time_ms": 4.78, "update_time_ms": 9.449}, "hostname": "flow-main", "episode_reward_max": -29.421467777326637, "timesteps_this_iter": 30825, "custom_metrics": {"cost1_max": 220.31036238671112, "cost1_mean": 182.30507855686207, "system_level_velocity_mean": 16.035355361187218, "cost2_mean": -34.956469724889914, "cost2_max": -12.978827846570148, "outflow_rate_max": 1326.9480001069749, "cost1_min": 24.342171137044527, "system_level_velocity_min": 12.429738143412893, "system_level_velocity_max": 18.89827164838026, "outflow_rate_min": 500.9902957805507, "cost2_min": -54.601925445035185, "outflow_rate_mean": 1066.9113440237159}, "done": false, "pid": 51582, "episode_len_mean": 316.78, "node_ip": "10.138.0.2", "timesteps_since_restore": 4605549, "time_total_s": 3715.0176899433136, "timestamp": 1558606508, "iterations_since_restore": 132, "policy_reward_mean": {}, "training_iteration": 132, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b358>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b8d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b2e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6144, "timesteps_total": 4605549, "episode_reward_mean": -317.6482000607805, "episodes_this_iter": 45, "date": "2019-05-23_10-15-08", "time_this_iter_s": 24.804193258285522, "num_metric_batches_dropped": 0, "episode_reward_min": -473.45674628590814}
{"time_since_restore": 3742.3143107891083, "info": {"default": {"kl": 0.013585664331912994, "entropy": 1.315704584121704, "total_loss": 15.645447731018066, "vf_explained_var": 0.9135918617248535, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00745445815846324, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 15.648550033569336}, "num_steps_trained": 4637070, "grad_time_ms": 7938.308, "num_steps_sampled": 4637070, "sample_time_ms": 16782.471, "load_time_ms": 4.776, "update_time_ms": 9.901}, "hostname": "flow-main", "episode_reward_max": -82.30152278095727, "timesteps_this_iter": 31521, "custom_metrics": {"cost1_max": 219.0827319689983, "cost1_mean": 182.1276610129931, "system_level_velocity_mean": 15.866704849742792, "cost2_mean": -34.90655398598419, "cost2_max": -18.23458117667419, "outflow_rate_max": 1355.2246302376066, "cost1_min": 78.98797157381357, "system_level_velocity_min": 12.462876781084196, "system_level_velocity_max": 18.89827164838026, "outflow_rate_min": 756.3454510722363, "cost2_min": -50.66514588776949, "outflow_rate_mean": 1068.4726927870108}, "done": false, "pid": 51582, "episode_len_mean": 318.76, "node_ip": "10.138.0.2", "timesteps_since_restore": 4637070, "time_total_s": 3742.3143107891083, "timestamp": 1558606535, "iterations_since_restore": 133, "policy_reward_mean": {}, "training_iteration": 133, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845579e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557a58>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557b00>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6191, "timesteps_total": 4637070, "episode_reward_mean": -323.47900081778926, "episodes_this_iter": 47, "date": "2019-05-23_10-15-35", "time_this_iter_s": 27.296620845794678, "num_metric_batches_dropped": 0, "episode_reward_min": -463.5692597412708}
{"time_since_restore": 3767.5742449760437, "info": {"default": {"kl": 0.01533305924385786, "entropy": 1.3827760219573975, "total_loss": 17.477510452270508, "vf_explained_var": 0.9007046818733215, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010282384231686592, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 17.482877731323242}, "num_steps_trained": 4668323, "grad_time_ms": 7968.701, "num_steps_sampled": 4668323, "sample_time_ms": 16805.636, "load_time_ms": 4.912, "update_time_ms": 9.689}, "hostname": "flow-main", "episode_reward_max": -86.73285705301207, "timesteps_this_iter": 31253, "custom_metrics": {"cost1_max": 220.43306587918832, "cost1_mean": 184.04934426051656, "system_level_velocity_mean": 15.846091751117319, "cost2_mean": -35.98802318983883, "cost2_max": -22.569090579809046, "outflow_rate_max": 1355.2246302376066, "cost1_min": 79.59480261073305, "system_level_velocity_min": 12.815482821373248, "system_level_velocity_max": 18.81952679044599, "outflow_rate_min": 756.3454510722363, "cost2_min": -51.30662908994749, "outflow_rate_mean": 1085.9060114452811}, "done": false, "pid": 51582, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 4668323, "time_total_s": 3767.5742449760437, "timestamp": 1558606560, "iterations_since_restore": 134, "policy_reward_mean": {}, "training_iteration": 134, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9da0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9630>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6239, "timesteps_total": 4668323, "episode_reward_mean": -330.543314707319, "episodes_this_iter": 48, "date": "2019-05-23_10-16-00", "time_this_iter_s": 25.259934186935425, "num_metric_batches_dropped": 0, "episode_reward_min": -468.30283704290156}
{"time_since_restore": 3792.813822746277, "info": {"default": {"kl": 0.013731839135289192, "entropy": 1.379553198814392, "total_loss": 14.675600051879883, "vf_explained_var": 0.9146928191184998, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009576398879289627, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 14.680776596069336}, "num_steps_trained": 4699465, "grad_time_ms": 8141.085, "num_steps_sampled": 4699465, "sample_time_ms": 16694.706, "load_time_ms": 4.596, "update_time_ms": 9.473}, "hostname": "flow-main", "episode_reward_max": -183.0295867740872, "timesteps_this_iter": 31142, "custom_metrics": {"cost1_max": 220.43306587918832, "cost1_mean": 184.2775409863439, "system_level_velocity_mean": 15.749411087081056, "cost2_mean": -35.78330422930788, "cost2_max": -22.569090579809046, "outflow_rate_max": 1355.2246302376066, "cost1_min": 129.98161208684502, "system_level_velocity_min": 12.672625655032107, "system_level_velocity_max": 18.81952679044599, "outflow_rate_min": 790.9045354645355, "cost2_min": -51.30662908994749, "outflow_rate_mean": 1082.5410892568334}, "done": false, "pid": 51582, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 4699465, "time_total_s": 3792.813822746277, "timestamp": 1558606586, "iterations_since_restore": 135, "policy_reward_mean": {}, "training_iteration": 135, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534b38>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845345c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534080>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6283, "timesteps_total": 4699465, "episode_reward_mean": -333.6676976811344, "episodes_this_iter": 44, "date": "2019-05-23_10-16-26", "time_this_iter_s": 25.239577770233154, "num_metric_batches_dropped": 0, "episode_reward_min": -471.876197656918}
{"time_since_restore": 3817.7545199394226, "info": {"default": {"kl": 0.013239586725831032, "entropy": 1.376543402671814, "total_loss": 13.37419319152832, "vf_explained_var": 0.9265449643135071, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009353509172797203, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 13.379305839538574}, "num_steps_trained": 4730795, "grad_time_ms": 8190.877, "num_steps_sampled": 4730795, "sample_time_ms": 16630.106, "load_time_ms": 4.526, "update_time_ms": 9.758}, "hostname": "flow-main", "episode_reward_max": -183.0295867740872, "timesteps_this_iter": 31330, "custom_metrics": {"cost1_max": 222.1167084126277, "cost1_mean": 185.79569409465338, "system_level_velocity_mean": 15.940888129695129, "cost2_mean": -34.93870568263733, "cost2_max": -22.569090579809046, "outflow_rate_max": 1344.342154123467, "cost1_min": 129.98161208684502, "system_level_velocity_min": 12.554054136255182, "system_level_velocity_max": 18.934985922382538, "outflow_rate_min": 790.9045354645355, "cost2_min": -53.34141411487606, "outflow_rate_mean": 1088.7802543280511}, "done": false, "pid": 51582, "episode_len_mean": 323.54, "node_ip": "10.138.0.2", "timesteps_since_restore": 4730795, "time_total_s": 3817.7545199394226, "timestamp": 1558606611, "iterations_since_restore": 136, "policy_reward_mean": {}, "training_iteration": 136, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541d68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541e48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845412e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6330, "timesteps_total": 4730795, "episode_reward_mean": -327.5136895586344, "episodes_this_iter": 47, "date": "2019-05-23_10-16-51", "time_this_iter_s": 24.940697193145752, "num_metric_batches_dropped": 0, "episode_reward_min": -558.027244120095}
{"time_since_restore": 3843.1776480674744, "info": {"default": {"kl": 0.012966280803084373, "entropy": 1.322769284248352, "total_loss": 14.124423027038574, "vf_explained_var": 0.9192981719970703, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009821716696023941, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 14.130091667175293}, "num_steps_trained": 4762456, "grad_time_ms": 8133.859, "num_steps_sampled": 4762456, "sample_time_ms": 16822.765, "load_time_ms": 4.48, "update_time_ms": 10.023}, "hostname": "flow-main", "episode_reward_max": -21.28485618887112, "timesteps_this_iter": 31661, "custom_metrics": {"cost1_max": 222.1167084126277, "cost1_mean": 184.0875717261917, "system_level_velocity_mean": 15.892069485836968, "cost2_mean": -35.258180062573416, "cost2_max": -14.532077063308293, "outflow_rate_max": 1357.11240291585, "cost1_min": 18.10919124596194, "system_level_velocity_min": 12.554054136255182, "system_level_velocity_max": 18.934985922382538, "outflow_rate_min": 462.55509215489616, "cost2_min": -53.34141411487606, "outflow_rate_mean": 1093.1083382911208}, "done": false, "pid": 51582, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 4762456, "time_total_s": 3843.1776480674744, "timestamp": 1558606636, "iterations_since_restore": 137, "policy_reward_mean": {}, "training_iteration": 137, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534e10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534208>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6379, "timesteps_total": 4762456, "episode_reward_mean": -331.06190231768153, "episodes_this_iter": 49, "date": "2019-05-23_10-17-16", "time_this_iter_s": 25.423128128051758, "num_metric_batches_dropped": 0, "episode_reward_min": -558.027244120095}
{"time_since_restore": 3869.4874472618103, "info": {"default": {"kl": 0.01503951009362936, "entropy": 1.3622112274169922, "total_loss": 17.899343490600586, "vf_explained_var": 0.9086065888404846, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011030730791389942, "cur_kl_coeff": 0.32036131620407104, "vf_loss": 17.905553817749023}, "num_steps_trained": 4794577, "grad_time_ms": 8183.761, "num_steps_sampled": 4794577, "sample_time_ms": 17016.729, "load_time_ms": 4.481, "update_time_ms": 9.882}, "hostname": "flow-main", "episode_reward_max": -21.28485618887112, "timesteps_this_iter": 32121, "custom_metrics": {"cost1_max": 221.76298220475027, "cost1_mean": 184.22002175235903, "system_level_velocity_mean": 15.833621809656975, "cost2_mean": -36.34241603882139, "cost2_max": -14.532077063308293, "outflow_rate_max": 1357.11240291585, "cost1_min": 18.10919124596194, "system_level_velocity_min": 12.869048088328476, "system_level_velocity_max": 18.866616511280366, "outflow_rate_min": 462.55509215489616, "cost2_min": -51.672658199197116, "outflow_rate_mean": 1097.1325193122132}, "done": false, "pid": 51582, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 4794577, "time_total_s": 3869.4874472618103, "timestamp": 1558606663, "iterations_since_restore": 138, "policy_reward_mean": {}, "training_iteration": 138, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549748>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549fd0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549b00>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6424, "timesteps_total": 4794577, "episode_reward_mean": -334.16303795531786, "episodes_this_iter": 45, "date": "2019-05-23_10-17-43", "time_this_iter_s": 26.309799194335938, "num_metric_batches_dropped": 0, "episode_reward_min": -478.64900105031603}
{"time_since_restore": 3894.918170452118, "info": {"default": {"kl": 0.014990080147981644, "entropy": 1.361566185951233, "total_loss": 15.1324462890625, "vf_explained_var": 0.9235151410102844, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00996690709143877, "cur_kl_coeff": 0.32036131620407104, "vf_loss": 15.13761043548584}, "num_steps_trained": 4826693, "grad_time_ms": 8301.954, "num_steps_sampled": 4826693, "sample_time_ms": 16993.305, "load_time_ms": 4.228, "update_time_ms": 9.716}, "hostname": "flow-main", "episode_reward_max": -209.93390770133138, "timesteps_this_iter": 32116, "custom_metrics": {"cost1_max": 220.59755793306473, "cost1_mean": 185.4662744514764, "system_level_velocity_mean": 15.770321809757506, "cost2_mean": -37.082891120423994, "cost2_max": -23.205856423273595, "outflow_rate_max": 1357.11240291585, "cost1_min": 153.26363145656057, "system_level_velocity_min": 12.869048088328476, "system_level_velocity_max": 18.878960239926897, "outflow_rate_min": 897.4932992756388, "cost2_min": -51.672658199197116, "outflow_rate_mean": 1101.730267440318}, "done": false, "pid": 51582, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 4826693, "time_total_s": 3894.918170452118, "timestamp": 1558606688, "iterations_since_restore": 139, "policy_reward_mean": {}, "training_iteration": 139, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541ac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541f98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845416a0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6467, "timesteps_total": 4826693, "episode_reward_mean": -343.02742045548365, "episodes_this_iter": 43, "date": "2019-05-23_10-18-08", "time_this_iter_s": 25.430723190307617, "num_metric_batches_dropped": 0, "episode_reward_min": -517.0556381139545}
{"time_since_restore": 3921.3528060913086, "info": {"default": {"kl": 0.013139337301254272, "entropy": 1.302385926246643, "total_loss": 19.348918914794922, "vf_explained_var": 0.9038835763931274, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007491546683013439, "cur_kl_coeff": 0.32036131620407104, "vf_loss": 19.35219955444336}, "num_steps_trained": 4859516, "grad_time_ms": 8524.256, "num_steps_sampled": 4859516, "sample_time_ms": 17038.838, "load_time_ms": 4.057, "update_time_ms": 9.764}, "hostname": "flow-main", "episode_reward_max": -209.93390770133138, "timesteps_this_iter": 32823, "custom_metrics": {"cost1_max": 221.52149533333454, "cost1_mean": 184.54675543366872, "system_level_velocity_mean": 15.685366572062911, "cost2_mean": -38.84334766406349, "cost2_max": -22.432397830626147, "outflow_rate_max": 1367.5161715792044, "cost1_min": 146.0544810779718, "system_level_velocity_min": 12.385344104279687, "system_level_velocity_max": 18.878960239926897, "outflow_rate_min": 970.0116461324686, "cost2_min": -55.720150852980616, "outflow_rate_mean": 1108.0953884670607}, "done": false, "pid": 51582, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 4859516, "time_total_s": 3921.3528060913086, "timestamp": 1558606714, "iterations_since_restore": 140, "policy_reward_mean": {}, "training_iteration": 140, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845346d8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845572e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6517, "timesteps_total": 4859516, "episode_reward_mean": -352.7592092985562, "episodes_this_iter": 50, "date": "2019-05-23_10-18-34", "time_this_iter_s": 26.434635639190674, "num_metric_batches_dropped": 0, "episode_reward_min": -588.0593999670805}
{"time_since_restore": 3948.5597219467163, "info": {"default": {"kl": 0.012461822479963303, "entropy": 1.3005257844924927, "total_loss": 15.91384506225586, "vf_explained_var": 0.9078262448310852, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005783239845186472, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 15.915635108947754}, "num_steps_trained": 4891514, "grad_time_ms": 8542.704, "num_steps_sampled": 4891514, "sample_time_ms": 17199.448, "load_time_ms": 4.015, "update_time_ms": 9.723}, "hostname": "flow-main", "episode_reward_max": -21.634648996540733, "timesteps_this_iter": 31998, "custom_metrics": {"cost1_max": 222.83093857990247, "cost1_mean": 186.39825430972363, "system_level_velocity_mean": 15.987139565915886, "cost2_mean": -39.360789655167856, "cost2_max": -15.765485930029763, "outflow_rate_max": 1372.8375501991018, "cost1_min": 17.912262602628616, "system_level_velocity_min": 12.385344104279687, "system_level_velocity_max": 18.966736853291597, "outflow_rate_min": 440.0050268646629, "cost2_min": -55.720150852980616, "outflow_rate_mean": 1119.8829259924446}, "done": false, "pid": 51582, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 4891514, "time_total_s": 3948.5597219467163, "timestamp": 1558606742, "iterations_since_restore": 141, "policy_reward_mean": {}, "training_iteration": 141, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557da0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530e80>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557be0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6565, "timesteps_total": 4891514, "episode_reward_mean": -341.2906895223325, "episodes_this_iter": 48, "date": "2019-05-23_10-19-02", "time_this_iter_s": 27.206915855407715, "num_metric_batches_dropped": 0, "episode_reward_min": -588.0593999670805}
{"time_since_restore": 3973.9057149887085, "info": {"default": {"kl": 0.015125523321330547, "entropy": 1.3317204713821411, "total_loss": 16.06809425354004, "vf_explained_var": 0.9119012355804443, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01079229824244976, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.074039459228516}, "num_steps_trained": 4923741, "grad_time_ms": 8424.948, "num_steps_sampled": 4923741, "sample_time_ms": 17371.48, "load_time_ms": 4.012, "update_time_ms": 9.773}, "hostname": "flow-main", "episode_reward_max": -21.634648996540733, "timesteps_this_iter": 32227, "custom_metrics": {"cost1_max": 224.16685938465093, "cost1_mean": 185.19481971187668, "system_level_velocity_mean": 16.005753176455215, "cost2_mean": -39.15010849131403, "cost2_max": -15.765485930029763, "outflow_rate_max": 1372.8375501991018, "cost1_min": 17.912262602628616, "system_level_velocity_min": 12.604274547915903, "system_level_velocity_max": 19.141100774983094, "outflow_rate_min": 440.0050268646629, "cost2_min": -57.949591613947554, "outflow_rate_mean": 1110.4923517527848}, "done": false, "pid": 51582, "episode_len_mean": 320.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 4923741, "time_total_s": 3973.9057149887085, "timestamp": 1558606767, "iterations_since_restore": 142, "policy_reward_mean": {}, "training_iteration": 142, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845572e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557908>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557240>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6608, "timesteps_total": 4923741, "episode_reward_mean": -336.8362332665406, "episodes_this_iter": 43, "date": "2019-05-23_10-19-27", "time_this_iter_s": 25.345993041992188, "num_metric_batches_dropped": 0, "episode_reward_min": -499.95394501043074}
{"time_since_restore": 4000.6313683986664, "info": {"default": {"kl": 0.01519418228417635, "entropy": 1.320366382598877, "total_loss": 14.233054161071777, "vf_explained_var": 0.9222559332847595, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009444521740078926, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 14.237629890441895}, "num_steps_trained": 4955658, "grad_time_ms": 8413.438, "num_steps_sampled": 4955658, "sample_time_ms": 17327.165, "load_time_ms": 4.01, "update_time_ms": 9.191}, "hostname": "flow-main", "episode_reward_max": -21.634648996540733, "timesteps_this_iter": 31917, "custom_metrics": {"cost1_max": 224.16685938465093, "cost1_mean": 184.75698300985027, "system_level_velocity_mean": 15.953605991624274, "cost2_mean": -39.78897242428126, "cost2_max": -15.765485930029763, "outflow_rate_max": 1374.2070034882279, "cost1_min": 17.912262602628616, "system_level_velocity_min": 11.8568785081536, "system_level_velocity_max": 19.141100774983094, "outflow_rate_min": 440.0050268646629, "cost2_min": -57.949591613947554, "outflow_rate_mean": 1109.6597261452143}, "done": false, "pid": 51582, "episode_len_mean": 320.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 4955658, "time_total_s": 4000.6313683986664, "timestamp": 1558606794, "iterations_since_restore": 143, "policy_reward_mean": {}, "training_iteration": 143, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557d68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541860>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557748>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6656, "timesteps_total": 4955658, "episode_reward_mean": -336.62223458609583, "episodes_this_iter": 48, "date": "2019-05-23_10-19-54", "time_this_iter_s": 26.725653409957886, "num_metric_batches_dropped": 0, "episode_reward_min": -537.7478831854513}
{"time_since_restore": 4027.959983587265, "info": {"default": {"kl": 0.015962796285748482, "entropy": 1.350753903388977, "total_loss": 15.080571174621582, "vf_explained_var": 0.9239333868026733, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00873672403395176, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 15.08419418334961}, "num_steps_trained": 4988232, "grad_time_ms": 8533.866, "num_steps_sampled": 4988232, "sample_time_ms": 17413.264, "load_time_ms": 3.858, "update_time_ms": 9.241}, "hostname": "flow-main", "episode_reward_max": -81.68257684291922, "timesteps_this_iter": 32574, "custom_metrics": {"cost1_max": 222.452431808423, "cost1_mean": 185.2008706537103, "system_level_velocity_mean": 15.844904287229935, "cost2_mean": -41.14705908819188, "cost2_max": -24.75798864435002, "outflow_rate_max": 1374.2070034882279, "cost1_min": 80.82545836355031, "system_level_velocity_min": 11.8568785081536, "system_level_velocity_max": 19.1546605560862, "outflow_rate_min": 758.6246925870272, "cost2_min": -57.700994949220636, "outflow_rate_mean": 1119.8412370450123}, "done": false, "pid": 51582, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 4988232, "time_total_s": 4027.959983587265, "timestamp": 1558606821, "iterations_since_restore": 144, "policy_reward_mean": {}, "training_iteration": 144, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557710>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557eb8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6705, "timesteps_total": 4988232, "episode_reward_mean": -345.0168182832068, "episodes_this_iter": 49, "date": "2019-05-23_10-20-21", "time_this_iter_s": 27.328615188598633, "num_metric_batches_dropped": 0, "episode_reward_min": -541.410688729583}
{"time_since_restore": 4053.9888396263123, "info": {"default": {"kl": 0.015342246741056442, "entropy": 1.297235131263733, "total_loss": 16.265827178955078, "vf_explained_var": 0.9205050468444824, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008639838546514511, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 16.269554138183594}, "num_steps_trained": 5020953, "grad_time_ms": 8568.135, "num_steps_sampled": 5020953, "sample_time_ms": 17458.947, "load_time_ms": 4.026, "update_time_ms": 9.296}, "hostname": "flow-main", "episode_reward_max": -28.485691416904686, "timesteps_this_iter": 32721, "custom_metrics": {"cost1_max": 223.6532195438166, "cost1_mean": 184.81568244890107, "system_level_velocity_mean": 15.971149000180018, "cost2_mean": -41.77404245681221, "cost2_max": -14.919400103717363, "outflow_rate_max": 1376.2694362342643, "cost1_min": 23.1363394835824, "system_level_velocity_min": 12.715983953558268, "system_level_velocity_max": 19.1546605560862, "outflow_rate_min": 466.74083028559994, "cost2_min": -57.700994949220636, "outflow_rate_mean": 1122.7648893674905}, "done": false, "pid": 51582, "episode_len_mean": 320.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 5020953, "time_total_s": 4053.9888396263123, "timestamp": 1558606847, "iterations_since_restore": 145, "policy_reward_mean": {}, "training_iteration": 145, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541b70>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845415f8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845410f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6748, "timesteps_total": 5020953, "episode_reward_mean": -340.0928113731359, "episodes_this_iter": 43, "date": "2019-05-23_10-20-47", "time_this_iter_s": 26.02885603904724, "num_metric_batches_dropped": 0, "episode_reward_min": -541.410688729583}
{"time_since_restore": 4081.236996412277, "info": {"default": {"kl": 0.012564778327941895, "entropy": 1.3354649543762207, "total_loss": 16.11102867126465, "vf_explained_var": 0.9241437911987305, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007342037744820118, "cur_kl_coeff": 0.32036131620407104, "vf_loss": 16.114347457885742}, "num_steps_trained": 5054263, "grad_time_ms": 8690.31, "num_steps_sampled": 5054263, "sample_time_ms": 17568.006, "load_time_ms": 4.046, "update_time_ms": 9.247}, "hostname": "flow-main", "episode_reward_max": -26.504844814935826, "timesteps_this_iter": 33310, "custom_metrics": {"cost1_max": 223.6532195438166, "cost1_mean": 183.6823687892211, "system_level_velocity_mean": 15.89800167123869, "cost2_mean": -42.70285135810322, "cost2_max": -14.919400103717363, "outflow_rate_max": 1376.2694362342643, "cost1_min": 23.1363394835824, "system_level_velocity_min": 12.506935732484411, "system_level_velocity_max": 18.990093064175888, "outflow_rate_min": 466.74083028559994, "cost2_min": -58.16905662775012, "outflow_rate_mean": 1123.0198359858805}, "done": false, "pid": 51582, "episode_len_mean": 319.2, "node_ip": "10.138.0.2", "timesteps_since_restore": 5054263, "time_total_s": 4081.236996412277, "timestamp": 1558606875, "iterations_since_restore": 146, "policy_reward_mean": {}, "training_iteration": 146, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845576a0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557080>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557a90>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6797, "timesteps_total": 5054263, "episode_reward_mean": -346.62943318261745, "episodes_this_iter": 49, "date": "2019-05-23_10-21-15", "time_this_iter_s": 27.248156785964966, "num_metric_batches_dropped": 0, "episode_reward_min": -520.1311428059493}
{"time_since_restore": 4108.259022474289, "info": {"default": {"kl": 0.013469463214278221, "entropy": 1.3594051599502563, "total_loss": 17.444820404052734, "vf_explained_var": 0.9105459451675415, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008851628750562668, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 17.449356079101562}, "num_steps_trained": 5087006, "grad_time_ms": 8769.92, "num_steps_sampled": 5087006, "sample_time_ms": 17647.605, "load_time_ms": 4.06, "update_time_ms": 9.203}, "hostname": "flow-main", "episode_reward_max": -26.504844814935826, "timesteps_this_iter": 32743, "custom_metrics": {"cost1_max": 223.07707424506827, "cost1_mean": 181.67373943490915, "system_level_velocity_mean": 15.71251190413875, "cost2_mean": -43.21970157077465, "cost2_max": -15.279671893395761, "outflow_rate_max": 1387.9382899573486, "cost1_min": 23.216110321187543, "system_level_velocity_min": 12.22151087055874, "system_level_velocity_max": 18.988646435355204, "outflow_rate_min": 515.1876692262412, "cost2_min": -64.58352704032275, "outflow_rate_mean": 1113.19061415302}, "done": false, "pid": 51582, "episode_len_mean": 319.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 5087006, "time_total_s": 4108.259022474289, "timestamp": 1558606902, "iterations_since_restore": 147, "policy_reward_mean": {}, "training_iteration": 147, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557550>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530d30>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6846, "timesteps_total": 5087006, "episode_reward_mean": -356.73082312108437, "episodes_this_iter": 49, "date": "2019-05-23_10-21-42", "time_this_iter_s": 27.02202606201172, "num_metric_batches_dropped": 0, "episode_reward_min": -541.1010811143097}
{"time_since_restore": 4134.762451410294, "info": {"default": {"kl": 0.014673363417387009, "entropy": 1.3803164958953857, "total_loss": 15.483480453491211, "vf_explained_var": 0.9212304353713989, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008633758872747421, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 15.487412452697754}, "num_steps_trained": 5119621, "grad_time_ms": 8758.924, "num_steps_sampled": 5119621, "sample_time_ms": 17677.643, "load_time_ms": 3.978, "update_time_ms": 9.302}, "hostname": "flow-main", "episode_reward_max": -81.72662109224711, "timesteps_this_iter": 32615, "custom_metrics": {"cost1_max": 225.5054348465976, "cost1_mean": 181.095500306712, "system_level_velocity_mean": 15.644743184198706, "cost2_mean": -42.34415138068527, "cost2_max": -24.163690735745107, "outflow_rate_max": 1387.9382899573486, "cost1_min": 80.48074918766477, "system_level_velocity_min": 12.22151087055874, "system_level_velocity_max": 19.28452633592324, "outflow_rate_min": 761.5139624402864, "cost2_min": -64.58352704032275, "outflow_rate_mean": 1102.597656093589}, "done": false, "pid": 51582, "episode_len_mean": 320.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 5119621, "time_total_s": 4134.762451410294, "timestamp": 1558606928, "iterations_since_restore": 148, "policy_reward_mean": {}, "training_iteration": 148, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845577b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557f60>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845570f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6890, "timesteps_total": 5119621, "episode_reward_mean": -356.4762979266715, "episodes_this_iter": 44, "date": "2019-05-23_10-22-08", "time_this_iter_s": 26.50342893600464, "num_metric_batches_dropped": 0, "episode_reward_min": -541.1010811143097}
{"time_since_restore": 4160.926045656204, "info": {"default": {"kl": 0.014663889072835445, "entropy": 1.4560922384262085, "total_loss": 14.981844902038574, "vf_explained_var": 0.9262647032737732, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0090718325227499, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 14.98621940612793}, "num_steps_trained": 5151892, "grad_time_ms": 8750.072, "num_steps_sampled": 5151892, "sample_time_ms": 17760.675, "load_time_ms": 4.166, "update_time_ms": 9.31}, "hostname": "flow-main", "episode_reward_max": -94.37149867036375, "timesteps_this_iter": 32271, "custom_metrics": {"cost1_max": 225.5054348465976, "cost1_mean": 181.5284856513403, "system_level_velocity_mean": 15.548487290842266, "cost2_mean": -42.11188553482352, "cost2_max": -25.452851500902312, "outflow_rate_max": 1364.4351533728197, "cost1_min": 85.26177636179101, "system_level_velocity_min": 12.300597365405507, "system_level_velocity_max": 19.28452633592324, "outflow_rate_min": 764.3093525179856, "cost2_min": -63.43007718798882, "outflow_rate_mean": 1099.8318601949081}, "done": false, "pid": 51582, "episode_len_mean": 323.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5151892, "time_total_s": 4160.926045656204, "timestamp": 1558606954, "iterations_since_restore": 149, "policy_reward_mean": {}, "training_iteration": 149, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557278>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6936, "timesteps_total": 5151892, "episode_reward_mean": -362.6270557496611, "episodes_this_iter": 46, "date": "2019-05-23_10-22-34", "time_this_iter_s": 26.163594245910645, "num_metric_batches_dropped": 0, "episode_reward_min": -527.3675945304561}
{"time_since_restore": 4187.035156965256, "info": {"default": {"kl": 0.014045934192836285, "entropy": 1.291369080543518, "total_loss": 18.795488357543945, "vf_explained_var": 0.9103074669837952, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008248496800661087, "cur_kl_coeff": 0.32036134600639343, "vf_loss": 18.799236297607422}, "num_steps_trained": 5185684, "grad_time_ms": 8703.371, "num_steps_sampled": 5185684, "sample_time_ms": 17773.478, "load_time_ms": 4.124, "update_time_ms": 9.059}, "hostname": "flow-main", "episode_reward_max": -27.998521940963556, "timesteps_this_iter": 33792, "custom_metrics": {"cost1_max": 224.0691914372469, "cost1_mean": 182.66463935566128, "system_level_velocity_mean": 15.745078169604858, "cost2_mean": -43.23749729581572, "cost2_max": -17.239841236326512, "outflow_rate_max": 1367.775948201089, "cost1_min": 24.89449254656155, "system_level_velocity_min": 12.177195539266947, "system_level_velocity_max": 19.25757812033178, "outflow_rate_min": 504.77807277306727, "cost2_min": -63.43007718798882, "outflow_rate_mean": 1116.4104014161553}, "done": false, "pid": 51582, "episode_len_mean": 320.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 5185684, "time_total_s": 4187.035156965256, "timestamp": 1558606980, "iterations_since_restore": 150, "policy_reward_mean": {}, "training_iteration": 150, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541710>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845414a8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541c18>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 6985, "timesteps_total": 5185684, "episode_reward_mean": -362.31240297348523, "episodes_this_iter": 49, "date": "2019-05-23_10-23-00", "time_this_iter_s": 26.109111309051514, "num_metric_batches_dropped": 0, "episode_reward_min": -559.3173614388797}
{"time_since_restore": 4213.80975484848, "info": {"default": {"kl": 0.013765234500169754, "entropy": 1.3637709617614746, "total_loss": 18.034748077392578, "vf_explained_var": 0.9126284122467041, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007834894582629204, "cur_kl_coeff": 0.32036131620407104, "vf_loss": 18.038171768188477}, "num_steps_trained": 5219066, "grad_time_ms": 8784.852, "num_steps_sampled": 5219066, "sample_time_ms": 17647.991, "load_time_ms": 4.167, "update_time_ms": 9.328}, "hostname": "flow-main", "episode_reward_max": -21.83957027313883, "timesteps_this_iter": 33382, "custom_metrics": {"cost1_max": 224.0691914372469, "cost1_mean": 180.17341002178415, "system_level_velocity_mean": 15.802393230764812, "cost2_mean": -44.934352845574395, "cost2_max": -16.358076233573925, "outflow_rate_max": 1378.6309444580652, "cost1_min": 18.22152942171725, "system_level_velocity_min": 12.146301837207304, "system_level_velocity_max": 19.25757812033178, "outflow_rate_min": 447.40921683303424, "cost2_min": -63.02820945815363, "outflow_rate_mean": 1116.5882046580912}, "done": false, "pid": 51582, "episode_len_mean": 315.88, "node_ip": "10.138.0.2", "timesteps_since_restore": 5219066, "time_total_s": 4213.80975484848, "timestamp": 1558607007, "iterations_since_restore": 151, "policy_reward_mean": {}, "training_iteration": 151, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557828>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557a20>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7032, "timesteps_total": 5219066, "episode_reward_mean": -357.6128690664532, "episodes_this_iter": 47, "date": "2019-05-23_10-23-27", "time_this_iter_s": 26.774597883224487, "num_metric_batches_dropped": 0, "episode_reward_min": -559.3173614388797}
{"time_since_restore": 4239.887547254562, "info": {"default": {"kl": 0.020008530467748642, "entropy": 1.395825743675232, "total_loss": 19.56211280822754, "vf_explained_var": 0.8970792293548584, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00944350752979517, "cur_kl_coeff": 0.3203613758087158, "vf_loss": 19.565143585205078}, "num_steps_trained": 5251376, "grad_time_ms": 8911.08, "num_steps_sampled": 5251376, "sample_time_ms": 17594.356, "load_time_ms": 4.152, "update_time_ms": 9.195}, "hostname": "flow-main", "episode_reward_max": -21.83957027313883, "timesteps_this_iter": 32310, "custom_metrics": {"cost1_max": 223.84935358851146, "cost1_mean": 181.3012879237459, "system_level_velocity_mean": 15.930915124369546, "cost2_mean": -43.31278348632064, "cost2_max": -16.358076233573925, "outflow_rate_max": 1378.6309444580652, "cost1_min": 18.22152942171725, "system_level_velocity_min": 12.146301837207304, "system_level_velocity_max": 19.17705333432298, "outflow_rate_min": 447.40921683303424, "cost2_min": -63.02820945815363, "outflow_rate_mean": 1115.550498501265}, "done": false, "pid": 51582, "episode_len_mean": 315.5, "node_ip": "10.138.0.2", "timesteps_since_restore": 5251376, "time_total_s": 4239.887547254562, "timestamp": 1558607033, "iterations_since_restore": 152, "policy_reward_mean": {}, "training_iteration": 152, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557c50>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557908>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557208>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7079, "timesteps_total": 5251376, "episode_reward_mean": -349.1412425406177, "episodes_this_iter": 47, "date": "2019-05-23_10-23-53", "time_this_iter_s": 26.077792406082153, "num_metric_batches_dropped": 0, "episode_reward_min": -626.4518470454599}
{"time_since_restore": 4265.170852899551, "info": {"default": {"kl": 0.0116806048899889, "entropy": 1.4323066473007202, "total_loss": 14.239290237426758, "vf_explained_var": 0.926694393157959, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00881993304938078, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 14.242496490478516}, "num_steps_trained": 5282637, "grad_time_ms": 8885.08, "num_steps_sampled": 5282637, "sample_time_ms": 17475.834, "load_time_ms": 4.099, "update_time_ms": 9.268}, "hostname": "flow-main", "episode_reward_max": -83.05239316792263, "timesteps_this_iter": 31261, "custom_metrics": {"cost1_max": 223.84935358851146, "cost1_mean": 182.25341191917164, "system_level_velocity_mean": 15.705202440381779, "cost2_mean": -40.79909470737562, "cost2_max": -21.37994407899882, "outflow_rate_max": 1375.4180458445894, "cost1_min": 79.60668458295741, "system_level_velocity_min": 12.80995251484794, "system_level_velocity_max": 19.17524529909418, "outflow_rate_min": 768.0248115397934, "cost2_min": -59.894786674898654, "outflow_rate_mean": 1099.3911376217952}, "done": false, "pid": 51582, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 5282637, "time_total_s": 4265.170852899551, "timestamp": 1558607059, "iterations_since_restore": 153, "policy_reward_mean": {}, "training_iteration": 153, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c2b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455cda0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469ac50>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7125, "timesteps_total": 5282637, "episode_reward_mean": -351.20093432999437, "episodes_this_iter": 46, "date": "2019-05-23_10-24-19", "time_this_iter_s": 25.283305644989014, "num_metric_batches_dropped": 0, "episode_reward_min": -626.4518470454599}
{"time_since_restore": 4290.307323694229, "info": {"default": {"kl": 0.010004322975873947, "entropy": 1.408684492111206, "total_loss": 17.623767852783203, "vf_explained_var": 0.9078406095504761, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008325846865773201, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 17.627286911010742}, "num_steps_trained": 5313382, "grad_time_ms": 8718.289, "num_steps_sampled": 5313382, "sample_time_ms": 17424.674, "load_time_ms": 4.028, "update_time_ms": 9.492}, "hostname": "flow-main", "episode_reward_max": -227.0962239982686, "timesteps_this_iter": 30745, "custom_metrics": {"cost1_max": 223.79119318280823, "cost1_mean": 183.58656029620818, "system_level_velocity_mean": 15.641250943337338, "cost2_mean": -39.989350425096426, "cost2_max": -21.37994407899882, "outflow_rate_max": 1364.3731931165596, "cost1_min": 148.23735706466425, "system_level_velocity_min": 12.506775820592088, "system_level_velocity_max": 19.024001765174617, "outflow_rate_min": 789.6542641625617, "cost2_min": -59.894786674898654, "outflow_rate_mean": 1085.8361251461931}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5313382, "time_total_s": 4290.307323694229, "timestamp": 1558607084, "iterations_since_restore": 154, "policy_reward_mean": {}, "training_iteration": 154, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530588>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530c50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530518>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7172, "timesteps_total": 5313382, "episode_reward_mean": -344.61764479457366, "episodes_this_iter": 47, "date": "2019-05-23_10-24-44", "time_this_iter_s": 25.136470794677734, "num_metric_batches_dropped": 0, "episode_reward_min": -496.1855303428056}
{"time_since_restore": 4315.036486387253, "info": {"default": {"kl": 0.011017740704119205, "entropy": 1.421927571296692, "total_loss": 16.163055419921875, "vf_explained_var": 0.9175138473510742, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007661439012736082, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 16.165422439575195}, "num_steps_trained": 5344160, "grad_time_ms": 8529.948, "num_steps_sampled": 5344160, "sample_time_ms": 17483.54, "load_time_ms": 3.793, "update_time_ms": 9.377}, "hostname": "flow-main", "episode_reward_max": -227.6112389247886, "timesteps_this_iter": 30778, "custom_metrics": {"cost1_max": 223.79119318280823, "cost1_mean": 185.03440016920328, "system_level_velocity_mean": 15.760077176942476, "cost2_mean": -39.590959727874655, "cost2_max": -22.22458789205273, "outflow_rate_max": 1364.3731931165596, "cost1_min": 148.23735706466425, "system_level_velocity_min": 12.506775820592088, "system_level_velocity_max": 19.024001765174617, "outflow_rate_min": 865.8655165876777, "cost2_min": -52.80673731318565, "outflow_rate_mean": 1086.6927523620545}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5344160, "time_total_s": 4315.036486387253, "timestamp": 1558607109, "iterations_since_restore": 155, "policy_reward_mean": {}, "training_iteration": 155, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534e10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845345c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534080>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7218, "timesteps_total": 5344160, "episode_reward_mean": -335.29288694231116, "episodes_this_iter": 46, "date": "2019-05-23_10-25-09", "time_this_iter_s": 24.72916269302368, "num_metric_batches_dropped": 0, "episode_reward_min": -481.7008074236313}
{"time_since_restore": 4340.2025446891785, "info": {"default": {"kl": 0.01217628363519907, "entropy": 1.380940556526184, "total_loss": 17.033485412597656, "vf_explained_var": 0.9082930088043213, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007048584520816803, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 17.034683227539062}, "num_steps_trained": 5374299, "grad_time_ms": 8387.251, "num_steps_sampled": 5374299, "sample_time_ms": 17418.557, "load_time_ms": 3.774, "update_time_ms": 9.143}, "hostname": "flow-main", "episode_reward_max": -143.18903647378116, "timesteps_this_iter": 30139, "custom_metrics": {"cost1_max": 223.79119318280823, "cost1_mean": 187.30460226428644, "system_level_velocity_mean": 16.04193365641303, "cost2_mean": -38.16002774431362, "cost2_max": -21.25745501667108, "outflow_rate_max": 1364.3731931165596, "cost1_min": 141.8994809620229, "system_level_velocity_min": 12.527063170002048, "system_level_velocity_max": 19.045812674949726, "outflow_rate_min": 855.483781077348, "cost2_min": -53.30251513276107, "outflow_rate_mean": 1089.570617912546}, "done": false, "pid": 51582, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 5374299, "time_total_s": 4340.2025446891785, "timestamp": 1558607134, "iterations_since_restore": 156, "policy_reward_mean": {}, "training_iteration": 156, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c320>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455ce80>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455ce10>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7264, "timesteps_total": 5374299, "episode_reward_mean": -323.6277084739889, "episodes_this_iter": 46, "date": "2019-05-23_10-25-34", "time_this_iter_s": 25.16605830192566, "num_metric_batches_dropped": 0, "episode_reward_min": -481.7008074236313}
{"time_since_restore": 4366.336102724075, "info": {"default": {"kl": 0.011101423762738705, "entropy": 1.3906276226043701, "total_loss": 14.308938026428223, "vf_explained_var": 0.9280210733413696, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009073366411030293, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 14.312676429748535}, "num_steps_trained": 5405158, "grad_time_ms": 8443.726, "num_steps_sampled": 5405158, "sample_time_ms": 17273.725, "load_time_ms": 3.946, "update_time_ms": 9.112}, "hostname": "flow-main", "episode_reward_max": -143.18903647378116, "timesteps_this_iter": 30859, "custom_metrics": {"cost1_max": 223.3030657587048, "cost1_mean": 186.98863452689147, "system_level_velocity_mean": 16.066042834837628, "cost2_mean": -38.11014426299348, "cost2_max": -21.25745501667108, "outflow_rate_max": 1357.480930232558, "cost1_min": 141.8994809620229, "system_level_velocity_min": 12.843864755099377, "system_level_velocity_max": 19.220884943394235, "outflow_rate_min": 855.483781077348, "cost2_min": -59.7298852292757, "outflow_rate_mean": 1089.308057140389}, "done": false, "pid": 51582, "episode_len_mean": 322.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 5405158, "time_total_s": 4366.336102724075, "timestamp": 1558607160, "iterations_since_restore": 157, "policy_reward_mean": {}, "training_iteration": 157, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530f28>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530c50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530518>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7310, "timesteps_total": 5405158, "episode_reward_mean": -320.4783766267211, "episodes_this_iter": 46, "date": "2019-05-23_10-26-00", "time_this_iter_s": 26.13355803489685, "num_metric_batches_dropped": 0, "episode_reward_min": -508.96649489487834}
{"time_since_restore": 4391.675285577774, "info": {"default": {"kl": 0.010413047857582569, "entropy": 1.4325716495513916, "total_loss": 14.894805908203125, "vf_explained_var": 0.9258585572242737, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007656394504010677, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 14.897459030151367}, "num_steps_trained": 5435887, "grad_time_ms": 8519.157, "num_steps_sampled": 5435887, "sample_time_ms": 17082.844, "load_time_ms": 3.993, "update_time_ms": 9.017}, "hostname": "flow-main", "episode_reward_max": -27.495292665916395, "timesteps_this_iter": 30729, "custom_metrics": {"cost1_max": 223.28715411814284, "cost1_mean": 181.0264083832808, "system_level_velocity_mean": 15.83704457013635, "cost2_mean": -37.80794963017888, "cost2_max": -16.18485816990877, "outflow_rate_max": 1351.6741331019887, "cost1_min": 23.243383292344642, "system_level_velocity_min": 12.77900859178582, "system_level_velocity_max": 19.220884943394235, "outflow_rate_min": 491.73258691368204, "cost2_min": -59.7298852292757, "outflow_rate_mean": 1066.8407808277877}, "done": false, "pid": 51582, "episode_len_mean": 317.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 5435887, "time_total_s": 4391.675285577774, "timestamp": 1558607185, "iterations_since_restore": 158, "policy_reward_mean": {}, "training_iteration": 158, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549fd0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549b38>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7357, "timesteps_total": 5435887, "episode_reward_mean": -325.5744038403551, "episodes_this_iter": 47, "date": "2019-05-23_10-26-25", "time_this_iter_s": 25.33918285369873, "num_metric_batches_dropped": 0, "episode_reward_min": -555.61021325562}
{"time_since_restore": 4417.441370487213, "info": {"default": {"kl": 0.010272208601236343, "entropy": 1.4048939943313599, "total_loss": 17.285232543945312, "vf_explained_var": 0.9053983092308044, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007690920494496822, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 17.287986755371094}, "num_steps_trained": 5465646, "grad_time_ms": 8350.376, "num_steps_sampled": 5465646, "sample_time_ms": 17211.589, "load_time_ms": 4.082, "update_time_ms": 9.242}, "hostname": "flow-main", "episode_reward_max": -27.495292665916395, "timesteps_this_iter": 29759, "custom_metrics": {"cost1_max": 224.05620213511628, "cost1_mean": 181.629417127178, "system_level_velocity_mean": 16.096109097622502, "cost2_mean": -36.27170124380225, "cost2_max": -13.751120362699275, "outflow_rate_max": 1375.254789363756, "cost1_min": 23.06678465120638, "system_level_velocity_min": 12.579551389715192, "system_level_velocity_max": 19.193366461639368, "outflow_rate_min": 491.2472742482783, "cost2_min": -55.38925540113392, "outflow_rate_mean": 1056.9936072132805}, "done": false, "pid": 51582, "episode_len_mean": 315.14, "node_ip": "10.138.0.2", "timesteps_since_restore": 5465646, "time_total_s": 4417.441370487213, "timestamp": 1558607211, "iterations_since_restore": 159, "policy_reward_mean": {}, "training_iteration": 159, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c630>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7407, "timesteps_total": 5465646, "episode_reward_mean": -309.67220976520775, "episodes_this_iter": 50, "date": "2019-05-23_10-26-51", "time_this_iter_s": 25.766084909439087, "num_metric_batches_dropped": 0, "episode_reward_min": -564.6280689482113}
{"time_since_restore": 4443.8796644210815, "info": {"default": {"kl": 0.010892563499510288, "entropy": 1.4300729036331177, "total_loss": 13.357397079467773, "vf_explained_var": 0.9313268065452576, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0094239367172122, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 13.36158561706543}, "num_steps_trained": 5495744, "grad_time_ms": 8205.507, "num_steps_sampled": 5495744, "sample_time_ms": 17387.521, "load_time_ms": 4.305, "update_time_ms": 9.487}, "hostname": "flow-main", "episode_reward_max": -28.208927920727902, "timesteps_this_iter": 30098, "custom_metrics": {"cost1_max": 224.05620213511628, "cost1_mean": 183.84242104906286, "system_level_velocity_mean": 16.09310992505027, "cost2_mean": -36.99555408543206, "cost2_max": -13.751120362699275, "outflow_rate_max": 1381.529211732932, "cost1_min": 23.06678465120638, "system_level_velocity_min": 12.579551389715192, "system_level_velocity_max": 19.193366461639368, "outflow_rate_min": 491.2472742482783, "cost2_min": -55.38925540113392, "outflow_rate_mean": 1067.0953027798002}, "done": false, "pid": 51582, "episode_len_mean": 318.05, "node_ip": "10.138.0.2", "timesteps_since_restore": 5495744, "time_total_s": 4443.8796644210815, "timestamp": 1558607238, "iterations_since_restore": 160, "policy_reward_mean": {}, "training_iteration": 160, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b5c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bb38>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7452, "timesteps_total": 5495744, "episode_reward_mean": -308.4396187642732, "episodes_this_iter": 45, "date": "2019-05-23_10-27-18", "time_this_iter_s": 26.438293933868408, "num_metric_batches_dropped": 0, "episode_reward_min": -564.6280689482113}
{"time_since_restore": 4470.3209528923035, "info": {"default": {"kl": 0.011681517586112022, "entropy": 1.3505409955978394, "total_loss": 14.547792434692383, "vf_explained_var": 0.9224361777305603, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009215706028044224, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 14.55139446258545}, "num_steps_trained": 5526846, "grad_time_ms": 8083.967, "num_steps_sampled": 5526846, "sample_time_ms": 17475.499, "load_time_ms": 4.413, "update_time_ms": 9.32}, "hostname": "flow-main", "episode_reward_max": -101.55419332987918, "timesteps_this_iter": 31102, "custom_metrics": {"cost1_max": 225.2189214361496, "cost1_mean": 185.04548256080272, "system_level_velocity_mean": 15.940386161537658, "cost2_mean": -38.12680440032194, "cost2_max": -22.86747222018875, "outflow_rate_max": 1381.529211732932, "cost1_min": 86.38610381410129, "system_level_velocity_min": 12.972996366234186, "system_level_velocity_max": 19.25124233293284, "outflow_rate_min": 774.2294907643741, "cost2_min": -58.13483507513874, "outflow_rate_mean": 1084.668527289764}, "done": false, "pid": 51582, "episode_len_mean": 321.85, "node_ip": "10.138.0.2", "timesteps_since_restore": 5526846, "time_total_s": 4470.3209528923035, "timestamp": 1558607264, "iterations_since_restore": 161, "policy_reward_mean": {}, "training_iteration": 161, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454ba20>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c0b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c860>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7500, "timesteps_total": 5526846, "episode_reward_mean": -318.60505492912193, "episodes_this_iter": 48, "date": "2019-05-23_10-27-44", "time_this_iter_s": 26.441288471221924, "num_metric_batches_dropped": 0, "episode_reward_min": -466.7070767029878}
{"time_since_restore": 4495.2604694366455, "info": {"default": {"kl": 0.009952819906175137, "entropy": 1.4441120624542236, "total_loss": 16.779399871826172, "vf_explained_var": 0.9209936261177063, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00817020796239376, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 16.782787322998047}, "num_steps_trained": 5558070, "grad_time_ms": 8168.421, "num_steps_sampled": 5558070, "sample_time_ms": 17276.957, "load_time_ms": 4.413, "update_time_ms": 9.278}, "hostname": "flow-main", "episode_reward_max": -21.371802380053417, "timesteps_this_iter": 31224, "custom_metrics": {"cost1_max": 225.2189214361496, "cost1_mean": 184.9964182287079, "system_level_velocity_mean": 15.97097303832709, "cost2_mean": -38.52964913879541, "cost2_max": -15.192392904490923, "outflow_rate_max": 1374.3402179067996, "cost1_min": 17.98392830049504, "system_level_velocity_min": 12.273233520332079, "system_level_velocity_max": 19.25124233293284, "outflow_rate_min": 437.2949997643919, "cost2_min": -58.13483507513874, "outflow_rate_mean": 1090.984117425756}, "done": false, "pid": 51582, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 5558070, "time_total_s": 4495.2604694366455, "timestamp": 1558607289, "iterations_since_restore": 162, "policy_reward_mean": {}, "training_iteration": 162, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537c50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537358>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7545, "timesteps_total": 5558070, "episode_reward_mean": -322.31667582871216, "episodes_this_iter": 45, "date": "2019-05-23_10-28-09", "time_this_iter_s": 24.93951654434204, "num_metric_batches_dropped": 0, "episode_reward_min": -490.15678970024624}
{"time_since_restore": 4519.464558839798, "info": {"default": {"kl": 0.0118267722427845, "entropy": 1.4703847169876099, "total_loss": 15.913185119628906, "vf_explained_var": 0.9230549335479736, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00941186212003231, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 15.916914939880371}, "num_steps_trained": 5588359, "grad_time_ms": 8210.128, "num_steps_sampled": 5588359, "sample_time_ms": 17126.336, "load_time_ms": 4.441, "update_time_ms": 9.381}, "hostname": "flow-main", "episode_reward_max": -21.371802380053417, "timesteps_this_iter": 30289, "custom_metrics": {"cost1_max": 225.11862679636894, "cost1_mean": 185.02119584299257, "system_level_velocity_mean": 15.973725748166729, "cost2_mean": -38.39772316647089, "cost2_max": -15.192392904490923, "outflow_rate_max": 1355.3393534482757, "cost1_min": 17.98392830049504, "system_level_velocity_min": 12.273233520332079, "system_level_velocity_max": 19.123509954327893, "outflow_rate_min": 437.2949997643919, "cost2_min": -59.168045643951324, "outflow_rate_mean": 1086.8210057387817}, "done": false, "pid": 51582, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 5588359, "time_total_s": 4519.464558839798, "timestamp": 1558607313, "iterations_since_restore": 163, "policy_reward_mean": {}, "training_iteration": 163, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534e10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537128>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84537780>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7592, "timesteps_total": 5588359, "episode_reward_mean": -323.64435087926023, "episodes_this_iter": 47, "date": "2019-05-23_10-28-33", "time_this_iter_s": 24.204089403152466, "num_metric_batches_dropped": 0, "episode_reward_min": -490.15678970024624}
{"time_since_restore": 4544.176780700684, "info": {"default": {"kl": 0.011614943854510784, "entropy": 1.4539194107055664, "total_loss": 15.949481010437012, "vf_explained_var": 0.9220784306526184, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009856337681412697, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 15.953756332397461}, "num_steps_trained": 5619227, "grad_time_ms": 8134.321, "num_steps_sampled": 5619227, "sample_time_ms": 17160.69, "load_time_ms": 4.579, "update_time_ms": 9.26}, "hostname": "flow-main", "episode_reward_max": -87.29999526569682, "timesteps_this_iter": 30868, "custom_metrics": {"cost1_max": 223.62000524012927, "cost1_mean": 183.20872000302123, "system_level_velocity_mean": 15.79404920282651, "cost2_mean": -38.992020233726464, "cost2_max": -23.49908109502571, "outflow_rate_max": 1355.3393534482757, "cost1_min": 79.7156036736331, "system_level_velocity_min": 12.273233520332079, "system_level_velocity_max": 19.244560004404665, "outflow_rate_min": 710.5118181818183, "cost2_min": -62.42140815590379, "outflow_rate_mean": 1070.0781570386996}, "done": false, "pid": 51582, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 5619227, "time_total_s": 4544.176780700684, "timestamp": 1558607338, "iterations_since_restore": 164, "policy_reward_mean": {}, "training_iteration": 164, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530748>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7640, "timesteps_total": 5619227, "episode_reward_mean": -330.0616900218106, "episodes_this_iter": 48, "date": "2019-05-23_10-28-58", "time_this_iter_s": 24.71222186088562, "num_metric_batches_dropped": 0, "episode_reward_min": -490.15678970024624}
{"time_since_restore": 4568.756837844849, "info": {"default": {"kl": 0.012044543400406837, "entropy": 1.5288118124008179, "total_loss": 13.171360969543457, "vf_explained_var": 0.9358494281768799, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009500858373939991, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 13.17507266998291}, "num_steps_trained": 5649101, "grad_time_ms": 8122.898, "num_steps_sampled": 5649101, "sample_time_ms": 17157.346, "load_time_ms": 4.803, "update_time_ms": 9.205}, "hostname": "flow-main", "episode_reward_max": -87.29999526569682, "timesteps_this_iter": 29874, "custom_metrics": {"cost1_max": 225.06762146709806, "cost1_mean": 180.56759961938863, "system_level_velocity_mean": 15.607136891479472, "cost2_mean": -37.48537965854934, "cost2_max": -23.49908109502571, "outflow_rate_max": 1361.9240224687671, "cost1_min": 79.7156036736331, "system_level_velocity_min": 11.843397889446532, "system_level_velocity_max": 19.244560004404665, "outflow_rate_min": 747.2965782079423, "cost2_min": -62.42140815590379, "outflow_rate_mean": 1049.3937786118427}, "done": false, "pid": 51582, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 5649101, "time_total_s": 4568.756837844849, "timestamp": 1558607363, "iterations_since_restore": 165, "policy_reward_mean": {}, "training_iteration": 165, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454ba20>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bf60>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b0b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7686, "timesteps_total": 5649101, "episode_reward_mean": -329.55383773974836, "episodes_this_iter": 46, "date": "2019-05-23_10-29-23", "time_this_iter_s": 24.58005714416504, "num_metric_batches_dropped": 0, "episode_reward_min": -480.14213650239094}
{"time_since_restore": 4592.784883260727, "info": {"default": {"kl": 0.011396070010960102, "entropy": 1.5313398838043213, "total_loss": 14.708182334899902, "vf_explained_var": 0.9297566413879395, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008082866668701172, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 14.710790634155273}, "num_steps_trained": 5678629, "grad_time_ms": 8153.254, "num_steps_sampled": 5678629, "sample_time_ms": 17011.999, "load_time_ms": 4.886, "update_time_ms": 9.274}, "hostname": "flow-main", "episode_reward_max": -206.29935564203763, "timesteps_this_iter": 29528, "custom_metrics": {"cost1_max": 225.06762146709806, "cost1_mean": 180.7602285744439, "system_level_velocity_mean": 15.45230870882888, "cost2_mean": -36.907209560157206, "cost2_max": -21.604365096474215, "outflow_rate_max": 1361.9240224687671, "cost1_min": 139.91273544166734, "system_level_velocity_min": 11.843397889446532, "system_level_velocity_max": 19.171051504565167, "outflow_rate_min": 715.316300063573, "cost2_min": -55.96275823170862, "outflow_rate_mean": 1048.304276436905}, "done": false, "pid": 51582, "episode_len_mean": 324.45, "node_ip": "10.138.0.2", "timesteps_since_restore": 5678629, "time_total_s": 4592.784883260727, "timestamp": 1558607387, "iterations_since_restore": 166, "policy_reward_mean": {}, "training_iteration": 166, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455cc50>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c3c8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7731, "timesteps_total": 5678629, "episode_reward_mean": -331.89283678177037, "episodes_this_iter": 45, "date": "2019-05-23_10-29-47", "time_this_iter_s": 24.028045415878296, "num_metric_batches_dropped": 0, "episode_reward_min": -474.9902584703706}
{"time_since_restore": 4619.06741309166, "info": {"default": {"kl": 0.010992617346346378, "entropy": 1.4537911415100098, "total_loss": 18.52499008178711, "vf_explained_var": 0.9090316891670227, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007709259632974863, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 18.527420043945312}, "num_steps_trained": 5708477, "grad_time_ms": 8215.543, "num_steps_sampled": 5708477, "sample_time_ms": 16964.916, "load_time_ms": 4.795, "update_time_ms": 9.236}, "hostname": "flow-main", "episode_reward_max": -206.29935564203763, "timesteps_this_iter": 29848, "custom_metrics": {"cost1_max": 222.6961436051477, "cost1_mean": 185.87308662344591, "system_level_velocity_mean": 15.889231023883251, "cost2_mean": -37.47218489731299, "cost2_max": -21.604365096474215, "outflow_rate_max": 1358.2861717721107, "cost1_min": 151.94652947812716, "system_level_velocity_min": 13.013596686368126, "system_level_velocity_max": 19.087961451480883, "outflow_rate_min": 714.4283408847517, "cost2_min": -61.536949939313836, "outflow_rate_mean": 1068.5937290019608}, "done": false, "pid": 51582, "episode_len_mean": 324.26, "node_ip": "10.138.0.2", "timesteps_since_restore": 5708477, "time_total_s": 4619.06741309166, "timestamp": 1558607413, "iterations_since_restore": 167, "policy_reward_mean": {}, "training_iteration": 167, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549e10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549b70>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845496a0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7780, "timesteps_total": 5708477, "episode_reward_mean": -319.2209863515393, "episodes_this_iter": 49, "date": "2019-05-23_10-30-13", "time_this_iter_s": 26.282529830932617, "num_metric_batches_dropped": 0, "episode_reward_min": -528.9998823883473}
{"time_since_restore": 4644.973851442337, "info": {"default": {"kl": 0.011246885173022747, "entropy": 1.4322079420089722, "total_loss": 17.165952682495117, "vf_explained_var": 0.9185700416564941, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009244941174983978, "cur_kl_coeff": 0.48054200410842896, "vf_loss": 17.16979217529297}, "num_steps_trained": 5740365, "grad_time_ms": 8150.967, "num_steps_sampled": 5740365, "sample_time_ms": 17085.757, "load_time_ms": 4.719, "update_time_ms": 9.495}, "hostname": "flow-main", "episode_reward_max": -216.2092794347573, "timesteps_this_iter": 31888, "custom_metrics": {"cost1_max": 222.6961436051477, "cost1_mean": 188.53917876664792, "system_level_velocity_mean": 16.08797474244701, "cost2_mean": -39.29929553628834, "cost2_max": -24.038685750198766, "outflow_rate_max": 1379.1376336905303, "cost1_min": 144.028097650093, "system_level_velocity_min": 12.262281339505176, "system_level_velocity_max": 19.087961451480883, "outflow_rate_min": 714.4283408847517, "cost2_min": -61.536949939313836, "outflow_rate_mean": 1092.1669068756635}, "done": false, "pid": 51582, "episode_len_mean": 324.81, "node_ip": "10.138.0.2", "timesteps_since_restore": 5740365, "time_total_s": 4644.973851442337, "timestamp": 1558607439, "iterations_since_restore": 168, "policy_reward_mean": {}, "training_iteration": 168, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557e10>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845577b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7825, "timesteps_total": 5740365, "episode_reward_mean": -324.5430969212789, "episodes_this_iter": 45, "date": "2019-05-23_10-30-39", "time_this_iter_s": 25.90643835067749, "num_metric_batches_dropped": 0, "episode_reward_min": -605.5275059825585}
{"time_since_restore": 4672.267797708511, "info": {"default": {"kl": 0.011259380728006363, "entropy": 1.4453930854797363, "total_loss": 14.91914176940918, "vf_explained_var": 0.9300879836082458, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007878164760768414, "cur_kl_coeff": 0.48054200410842896, "vf_loss": 14.921610832214355}, "num_steps_trained": 5772571, "grad_time_ms": 8263.66, "num_steps_sampled": 5772571, "sample_time_ms": 17124.424, "load_time_ms": 4.672, "update_time_ms": 9.428}, "hostname": "flow-main", "episode_reward_max": -216.2202601712165, "timesteps_this_iter": 32206, "custom_metrics": {"cost1_max": 223.2555233653604, "cost1_mean": 185.68820329697976, "system_level_velocity_mean": 15.824023173811163, "cost2_mean": -41.12013172485861, "cost2_max": -16.321947295586114, "outflow_rate_max": 1379.1376336905303, "cost1_min": 144.028097650093, "system_level_velocity_min": 12.239378515744527, "system_level_velocity_max": 19.070019017839872, "outflow_rate_min": 714.4283408847517, "cost2_min": -62.57032252472357, "outflow_rate_mean": 1085.5771609229282}, "done": false, "pid": 51582, "episode_len_mean": 324.81, "node_ip": "10.138.0.2", "timesteps_since_restore": 5772571, "time_total_s": 4672.267797708511, "timestamp": 1558607466, "iterations_since_restore": 169, "policy_reward_mean": {}, "training_iteration": 169, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b128>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454bc50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b940>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7868, "timesteps_total": 5772571, "episode_reward_mean": -340.5657497671475, "episodes_this_iter": 43, "date": "2019-05-23_10-31-06", "time_this_iter_s": 27.293946266174316, "num_metric_batches_dropped": 0, "episode_reward_min": -605.5275059825585}
{"time_since_restore": 4698.5011875629425, "info": {"default": {"kl": 0.010777355171740055, "entropy": 1.468388557434082, "total_loss": 17.437429428100586, "vf_explained_var": 0.9177793264389038, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00925678201019764, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 17.441509246826172}, "num_steps_trained": 5803888, "grad_time_ms": 8270.56, "num_steps_sampled": 5803888, "sample_time_ms": 17101.129, "load_time_ms": 4.519, "update_time_ms": 9.34}, "hostname": "flow-main", "episode_reward_max": -216.2202601712165, "timesteps_this_iter": 31317, "custom_metrics": {"cost1_max": 224.4873203480692, "cost1_mean": 184.81605160635837, "system_level_velocity_mean": 15.71902965187843, "cost2_mean": -42.65266087753935, "cost2_max": -16.321947295586114, "outflow_rate_max": 1392.5866656678847, "cost1_min": 144.1421670209283, "system_level_velocity_min": 12.239378515744527, "system_level_velocity_max": 19.070019017839872, "outflow_rate_min": 734.6633003386701, "cost2_min": -62.57032252472357, "outflow_rate_mean": 1099.6525908826015}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5803888, "time_total_s": 4698.5011875629425, "timestamp": 1558607493, "iterations_since_restore": 170, "policy_reward_mean": {}, "training_iteration": 170, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549da0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845496a0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549e48>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7917, "timesteps_total": 5803888, "episode_reward_mean": -351.18343828181395, "episodes_this_iter": 49, "date": "2019-05-23_10-31-33", "time_this_iter_s": 26.233389854431152, "num_metric_batches_dropped": 0, "episode_reward_min": -605.5275059825585}
{"time_since_restore": 4724.738824605942, "info": {"default": {"kl": 0.01000033225864172, "entropy": 1.3583437204360962, "total_loss": 16.272180557250977, "vf_explained_var": 0.9173697829246521, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008429143577814102, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 16.275802612304688}, "num_steps_trained": 5835376, "grad_time_ms": 8242.989, "num_steps_sampled": 5835376, "sample_time_ms": 17110.275, "load_time_ms": 4.341, "update_time_ms": 9.354}, "hostname": "flow-main", "episode_reward_max": -156.12174373733657, "timesteps_this_iter": 31488, "custom_metrics": {"cost1_max": 225.96538586907275, "cost1_mean": 186.75779355559342, "system_level_velocity_mean": 15.932569875656968, "cost2_mean": -44.294083538116666, "cost2_max": -23.526917754509288, "outflow_rate_max": 1392.5866656678847, "cost1_min": 144.35380918382407, "system_level_velocity_min": 12.798026056740502, "system_level_velocity_max": 19.24149403602214, "outflow_rate_min": 734.6633003386701, "cost2_min": -62.57032252472357, "outflow_rate_mean": 1116.8434378876964}, "done": false, "pid": 51582, "episode_len_mean": 323.6, "node_ip": "10.138.0.2", "timesteps_since_restore": 5835376, "time_total_s": 4724.738824605942, "timestamp": 1558607519, "iterations_since_restore": 171, "policy_reward_mean": {}, "training_iteration": 171, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557a58>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557ef0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 7964, "timesteps_total": 5835376, "episode_reward_mean": -338.3891510782234, "episodes_this_iter": 47, "date": "2019-05-23_10-31-59", "time_this_iter_s": 26.237637042999268, "num_metric_batches_dropped": 0, "episode_reward_min": -508.7513900342823}
{"time_since_restore": 4750.2583520412445, "info": {"default": {"kl": 0.011801348999142647, "entropy": 1.4288028478622437, "total_loss": 18.095977783203125, "vf_explained_var": 0.8991274833679199, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009690462611615658, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 18.100000381469727}, "num_steps_trained": 5866860, "grad_time_ms": 8136.158, "num_steps_sampled": 5866860, "sample_time_ms": 17275.845, "load_time_ms": 4.378, "update_time_ms": 9.231}, "hostname": "flow-main", "episode_reward_max": -29.35915725799266, "timesteps_this_iter": 31484, "custom_metrics": {"cost1_max": 225.96538586907275, "cost1_mean": 187.16906688119275, "system_level_velocity_mean": 16.160762313476656, "cost2_mean": -42.429640577034554, "cost2_max": -16.628847119611766, "outflow_rate_max": 1381.2792243760296, "cost1_min": 24.728546025252218, "system_level_velocity_min": 12.06583617743831, "system_level_velocity_max": 19.24149403602214, "outflow_rate_min": 472.1492185913593, "cost2_min": -63.337097640948436, "outflow_rate_mean": 1111.6560759898823}, "done": false, "pid": 51582, "episode_len_mean": 320.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 5866860, "time_total_s": 4750.2583520412445, "timestamp": 1558607544, "iterations_since_restore": 172, "policy_reward_mean": {}, "training_iteration": 172, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c8d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c588>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455ceb8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8010, "timesteps_total": 5866860, "episode_reward_mean": -328.9838961386586, "episodes_this_iter": 46, "date": "2019-05-23_10-32-24", "time_this_iter_s": 25.519527435302734, "num_metric_batches_dropped": 0, "episode_reward_min": -508.7513900342823}
{"time_since_restore": 4775.619022130966, "info": {"default": {"kl": 0.010476674884557724, "entropy": 1.4128352403640747, "total_loss": 17.12952423095703, "vf_explained_var": 0.9095611572265625, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008666655980050564, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 17.133155822753906}, "num_steps_trained": 5898194, "grad_time_ms": 8112.138, "num_steps_sampled": 5898194, "sample_time_ms": 17416.74, "load_time_ms": 4.321, "update_time_ms": 9.102}, "hostname": "flow-main", "episode_reward_max": -29.35915725799266, "timesteps_this_iter": 31334, "custom_metrics": {"cost1_max": 225.40077438149723, "cost1_mean": 186.30263004161642, "system_level_velocity_mean": 16.239234309621633, "cost2_mean": -40.68953459776715, "cost2_max": -16.628847119611766, "outflow_rate_max": 1367.477457446525, "cost1_min": 24.728546025252218, "system_level_velocity_min": 12.06583617743831, "system_level_velocity_max": 19.25201068012498, "outflow_rate_min": 472.1492185913593, "cost2_min": -63.337097640948436, "outflow_rate_mean": 1102.5402782261676}, "done": false, "pid": 51582, "episode_len_mean": 318.64, "node_ip": "10.138.0.2", "timesteps_since_restore": 5898194, "time_total_s": 4775.619022130966, "timestamp": 1558607570, "iterations_since_restore": 173, "policy_reward_mean": {}, "training_iteration": 173, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549470>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845496d8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549128>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8055, "timesteps_total": 5898194, "episode_reward_mean": -321.2450053104943, "episodes_this_iter": 45, "date": "2019-05-23_10-32-50", "time_this_iter_s": 25.36067008972168, "num_metric_batches_dropped": 0, "episode_reward_min": -474.03507108733413}
{"time_since_restore": 4801.458070516586, "info": {"default": {"kl": 0.011151508428156376, "entropy": 1.3681919574737549, "total_loss": 18.282716751098633, "vf_explained_var": 0.9029139876365662, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007538179866969585, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 18.284894943237305}, "num_steps_trained": 5929657, "grad_time_ms": 8286.453, "num_steps_sampled": 5929657, "sample_time_ms": 17354.218, "load_time_ms": 4.22, "update_time_ms": 9.079}, "hostname": "flow-main", "episode_reward_max": -82.16412411089904, "timesteps_this_iter": 31463, "custom_metrics": {"cost1_max": 225.40077438149723, "cost1_mean": 187.63758825888686, "system_level_velocity_mean": 16.10681365502532, "cost2_mean": -41.511988991700946, "cost2_max": -20.003436762767944, "outflow_rate_max": 1385.800611543213, "cost1_min": 81.33815269584079, "system_level_velocity_min": 12.413374905509276, "system_level_velocity_max": 19.29187168235857, "outflow_rate_min": 736.1598495212035, "cost2_min": -60.43240736325114, "outflow_rate_mean": 1110.578690715898}, "done": false, "pid": 51582, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 5929657, "time_total_s": 4801.458070516586, "timestamp": 1558607596, "iterations_since_restore": 174, "policy_reward_mean": {}, "training_iteration": 174, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549b38>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845495f8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549240>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8103, "timesteps_total": 5929657, "episode_reward_mean": -329.5880666727717, "episodes_this_iter": 48, "date": "2019-05-23_10-33-16", "time_this_iter_s": 25.839048385620117, "num_metric_batches_dropped": 0, "episode_reward_min": -573.2008177687529}
{"time_since_restore": 4826.179423093796, "info": {"default": {"kl": 0.011293455958366394, "entropy": 1.3991488218307495, "total_loss": 16.603256225585938, "vf_explained_var": 0.916215181350708, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008312957361340523, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 16.606142044067383}, "num_steps_trained": 5961191, "grad_time_ms": 8405.596, "num_steps_sampled": 5961191, "sample_time_ms": 17249.427, "load_time_ms": 4.203, "update_time_ms": 9.275}, "hostname": "flow-main", "episode_reward_max": -99.5245421226523, "timesteps_this_iter": 31534, "custom_metrics": {"cost1_max": 225.16146235983237, "cost1_mean": 187.05339020666594, "system_level_velocity_mean": 16.04069308097287, "cost2_mean": -42.11350248989234, "cost2_max": -20.003436762767944, "outflow_rate_max": 1385.800611543213, "cost1_min": 85.96847373567878, "system_level_velocity_min": 12.413374905509276, "system_level_velocity_max": 19.29187168235857, "outflow_rate_min": 802.5862400559408, "cost2_min": -60.43240736325114, "outflow_rate_mean": 1102.2761284124279}, "done": false, "pid": 51582, "episode_len_mean": 323.02, "node_ip": "10.138.0.2", "timesteps_since_restore": 5961191, "time_total_s": 4826.179423093796, "timestamp": 1558607621, "iterations_since_restore": 175, "policy_reward_mean": {}, "training_iteration": 175, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455cb00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549c18>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549898>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8150, "timesteps_total": 5961191, "episode_reward_mean": -332.21181874748066, "episodes_this_iter": 47, "date": "2019-05-23_10-33-41", "time_this_iter_s": 24.721352577209473, "num_metric_batches_dropped": 0, "episode_reward_min": -573.2008177687529}
{"time_since_restore": 4853.151828289032, "info": {"default": {"kl": 0.010845756158232689, "entropy": 1.3290221691131592, "total_loss": 15.731752395629883, "vf_explained_var": 0.9218213558197021, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008108076639473438, "cur_kl_coeff": 0.48054200410842896, "vf_loss": 15.734648704528809}, "num_steps_trained": 5993088, "grad_time_ms": 8462.011, "num_steps_sampled": 5993088, "sample_time_ms": 17487.716, "load_time_ms": 4.123, "update_time_ms": 9.584}, "hostname": "flow-main", "episode_reward_max": -28.577544621560378, "timesteps_this_iter": 31897, "custom_metrics": {"cost1_max": 224.943773335863, "cost1_mean": 184.5176439718117, "system_level_velocity_mean": 15.976625924128623, "cost2_mean": -42.321324559973654, "cost2_max": -18.413079586687616, "outflow_rate_max": 1374.7008330450594, "cost1_min": 24.646532531844073, "system_level_velocity_min": 12.32083269860781, "system_level_velocity_max": 19.277047839883778, "outflow_rate_min": 506.10059557486335, "cost2_min": -58.60626987599723, "outflow_rate_mean": 1095.6606959533883}, "done": false, "pid": 51582, "episode_len_mean": 320.14, "node_ip": "10.138.0.2", "timesteps_since_restore": 5993088, "time_total_s": 4853.151828289032, "timestamp": 1558607648, "iterations_since_restore": 176, "policy_reward_mean": {}, "training_iteration": 176, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c160>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c588>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c0b8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8196, "timesteps_total": 5993088, "episode_reward_mean": -329.6185748325525, "episodes_this_iter": 46, "date": "2019-05-23_10-34-08", "time_this_iter_s": 26.972405195236206, "num_metric_batches_dropped": 0, "episode_reward_min": -493.53923212115797}
{"time_since_restore": 4877.674960136414, "info": {"default": {"kl": 0.009624015539884567, "entropy": 1.3962907791137695, "total_loss": 16.586034774780273, "vf_explained_var": 0.9201473593711853, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008911650627851486, "cur_kl_coeff": 0.48054200410842896, "vf_loss": 16.590322494506836}, "num_steps_trained": 6024963, "grad_time_ms": 8208.213, "num_steps_sampled": 6024963, "sample_time_ms": 17566.488, "load_time_ms": 3.958, "update_time_ms": 9.519}, "hostname": "flow-main", "episode_reward_max": -20.711815042711045, "timesteps_this_iter": 31875, "custom_metrics": {"cost1_max": 224.943773335863, "cost1_mean": 183.54225145902828, "system_level_velocity_mean": 15.931895819596543, "cost2_mean": -43.29934371322922, "cost2_max": -12.91719408620103, "outflow_rate_max": 1374.7008330450594, "cost1_min": 18.001974896474486, "system_level_velocity_min": 11.42685602789088, "system_level_velocity_max": 19.277047839883778, "outflow_rate_min": 489.92492200470633, "cost2_min": -58.60626987599723, "outflow_rate_mean": 1110.1689700801653}, "done": false, "pid": 51582, "episode_len_mean": 318.97, "node_ip": "10.138.0.2", "timesteps_since_restore": 6024963, "time_total_s": 4877.674960136414, "timestamp": 1558607672, "iterations_since_restore": 177, "policy_reward_mean": {}, "training_iteration": 177, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845346d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845570f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84534898>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8244, "timesteps_total": 6024963, "episode_reward_mean": -334.3698158055478, "episodes_this_iter": 48, "date": "2019-05-23_10-34-32", "time_this_iter_s": 24.523131847381592, "num_metric_batches_dropped": 0, "episode_reward_min": -493.53923212115797}
{"time_since_restore": 4905.4306204319, "info": {"default": {"kl": 0.010796704329550266, "entropy": 1.322456955909729, "total_loss": 15.295875549316406, "vf_explained_var": 0.9217557311058044, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008235610090196133, "cur_kl_coeff": 0.48054200410842896, "vf_loss": 15.298922538757324}, "num_steps_trained": 6057205, "grad_time_ms": 8145.75, "num_steps_sampled": 6057205, "sample_time_ms": 17814.103, "load_time_ms": 4.158, "update_time_ms": 9.435}, "hostname": "flow-main", "episode_reward_max": -20.711815042711045, "timesteps_this_iter": 32242, "custom_metrics": {"cost1_max": 225.24862164088546, "cost1_mean": 185.4686847941796, "system_level_velocity_mean": 16.07231758837574, "cost2_mean": -43.860278917226545, "cost2_max": -12.91719408620103, "outflow_rate_max": 1374.1337494891195, "cost1_min": 18.001974896474486, "system_level_velocity_min": 11.42685602789088, "system_level_velocity_max": 19.34522019700044, "outflow_rate_min": 468.0395315843013, "cost2_min": -58.46494432318653, "outflow_rate_mean": 1124.0432161818896}, "done": false, "pid": 51582, "episode_len_mean": 318.95, "node_ip": "10.138.0.2", "timesteps_since_restore": 6057205, "time_total_s": 4905.4306204319, "timestamp": 1558607700, "iterations_since_restore": 178, "policy_reward_mean": {}, "training_iteration": 178, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845492e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549208>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8292, "timesteps_total": 6057205, "episode_reward_mean": -330.5235271429872, "episodes_this_iter": 48, "date": "2019-05-23_10-35-00", "time_this_iter_s": 27.75566029548645, "num_metric_batches_dropped": 0, "episode_reward_min": -483.0654316275116}
{"time_since_restore": 4931.903051137924, "info": {"default": {"kl": 0.012804334983229637, "entropy": 1.3669946193695068, "total_loss": 15.363608360290527, "vf_explained_var": 0.9194040894508362, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010948292911052704, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 15.368402481079102}, "num_steps_trained": 6088578, "grad_time_ms": 8152.263, "num_steps_sampled": 6088578, "sample_time_ms": 17727.45, "load_time_ms": 4.185, "update_time_ms": 9.214}, "hostname": "flow-main", "episode_reward_max": -29.195716507398753, "timesteps_this_iter": 31373, "custom_metrics": {"cost1_max": 225.24862164088546, "cost1_mean": 188.2707452618238, "system_level_velocity_mean": 16.156321171503727, "cost2_mean": -43.182251464625466, "cost2_max": -17.484332115147154, "outflow_rate_max": 1371.8893194880034, "cost1_min": 22.955146470850558, "system_level_velocity_min": 11.42685602789088, "system_level_velocity_max": 19.34522019700044, "outflow_rate_min": 468.0395315843013, "cost2_min": -65.45582162091635, "outflow_rate_mean": 1130.0394625229644}, "done": false, "pid": 51582, "episode_len_mean": 321.65, "node_ip": "10.138.0.2", "timesteps_since_restore": 6088578, "time_total_s": 4931.903051137924, "timestamp": 1558607726, "iterations_since_restore": 179, "policy_reward_mean": {}, "training_iteration": 179, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455ce10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455ca20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c5f8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8337, "timesteps_total": 6088578, "episode_reward_mean": -328.2548172754921, "episodes_this_iter": 45, "date": "2019-05-23_10-35-26", "time_this_iter_s": 26.47243070602417, "num_metric_batches_dropped": 0, "episode_reward_min": -500.7805250793333}
{"time_since_restore": 4956.769388914108, "info": {"default": {"kl": 0.012062628753483295, "entropy": 1.4263734817504883, "total_loss": 16.270597457885742, "vf_explained_var": 0.917527437210083, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009828288108110428, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 16.274627685546875}, "num_steps_trained": 6119292, "grad_time_ms": 8195.962, "num_steps_sampled": 6119292, "sample_time_ms": 17546.737, "load_time_ms": 4.194, "update_time_ms": 9.063}, "hostname": "flow-main", "episode_reward_max": -206.29050998526333, "timesteps_this_iter": 30714, "custom_metrics": {"cost1_max": 224.7327244469367, "cost1_mean": 190.58253547556455, "system_level_velocity_mean": 16.228201998472713, "cost2_mean": -41.5403889824452, "cost2_max": -17.484332115147154, "outflow_rate_max": 1369.8868086427287, "cost1_min": 146.188260427183, "system_level_velocity_min": 12.90845367840592, "system_level_velocity_max": 19.2984022213678, "outflow_rate_min": 761.8554545454544, "cost2_min": -65.45582162091635, "outflow_rate_mean": 1121.7759278058065}, "done": false, "pid": 51582, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 6119292, "time_total_s": 4956.769388914108, "timestamp": 1558607751, "iterations_since_restore": 180, "policy_reward_mean": {}, "training_iteration": 180, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e846a9f28>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557cc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557e80>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8385, "timesteps_total": 6119292, "episode_reward_mean": -322.8198833948252, "episodes_this_iter": 48, "date": "2019-05-23_10-35-51", "time_this_iter_s": 24.866337776184082, "num_metric_batches_dropped": 0, "episode_reward_min": -500.7805250793333}
{"time_since_restore": 4981.076466798782, "info": {"default": {"kl": 0.011141462251543999, "entropy": 1.4460369348526, "total_loss": 13.958806037902832, "vf_explained_var": 0.9265325665473938, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008732506074011326, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 13.96218490600586}, "num_steps_trained": 6149501, "grad_time_ms": 8167.83, "num_steps_sampled": 6149501, "sample_time_ms": 17380.484, "load_time_ms": 4.22, "update_time_ms": 8.799}, "hostname": "flow-main", "episode_reward_max": -220.02562007391643, "timesteps_this_iter": 30209, "custom_metrics": {"cost1_max": 223.4199693400928, "cost1_mean": 188.56095431065046, "system_level_velocity_mean": 16.07915342463888, "cost2_mean": -39.308395309599824, "cost2_max": -21.385157657337626, "outflow_rate_max": 1369.8868086427287, "cost1_min": 146.188260427183, "system_level_velocity_min": 12.825042855058346, "system_level_velocity_max": 19.013920792559784, "outflow_rate_min": 761.8554545454544, "cost2_min": -55.291443415340595, "outflow_rate_mean": 1090.4997171809002}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6149501, "time_total_s": 4981.076466798782, "timestamp": 1558607776, "iterations_since_restore": 181, "policy_reward_mean": {}, "training_iteration": 181, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549da0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549668>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549518>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8430, "timesteps_total": 6149501, "episode_reward_mean": -318.45512443092207, "episodes_this_iter": 45, "date": "2019-05-23_10-36-16", "time_this_iter_s": 24.307077884674072, "num_metric_batches_dropped": 0, "episode_reward_min": -485.2530764816391}
{"time_since_restore": 5005.361588001251, "info": {"default": {"kl": 0.011144544929265976, "entropy": 1.4309139251708984, "total_loss": 15.287198066711426, "vf_explained_var": 0.9257221221923828, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008928933180868626, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 15.290771484375}, "num_steps_trained": 6180019, "grad_time_ms": 8121.94, "num_steps_sampled": 6180019, "sample_time_ms": 17302.244, "load_time_ms": 4.272, "update_time_ms": 9.067}, "hostname": "flow-main", "episode_reward_max": -82.23232062243984, "timesteps_this_iter": 30518, "custom_metrics": {"cost1_max": 224.54763794495898, "cost1_mean": 183.35036349477667, "system_level_velocity_mean": 15.874107591804808, "cost2_mean": -40.19281515168207, "cost2_max": -21.385157657337626, "outflow_rate_max": 1360.9162086689837, "cost1_min": 79.9093694174789, "system_level_velocity_min": 12.825042855058346, "system_level_velocity_max": 19.169210065102128, "outflow_rate_min": 764.3838095238096, "cost2_min": -61.17405751289566, "outflow_rate_mean": 1072.5720396995575}, "done": false, "pid": 51582, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 6180019, "time_total_s": 5005.361588001251, "timestamp": 1558607800, "iterations_since_restore": 182, "policy_reward_mean": {}, "training_iteration": 182, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c0f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c860>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c9b0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8477, "timesteps_total": 6180019, "episode_reward_mean": -321.77192015533933, "episodes_this_iter": 47, "date": "2019-05-23_10-36-40", "time_this_iter_s": 24.285121202468872, "num_metric_batches_dropped": 0, "episode_reward_min": -480.9981281581854}
{"time_since_restore": 5031.070658445358, "info": {"default": {"kl": 0.013239006511867046, "entropy": 1.371317982673645, "total_loss": 16.13054084777832, "vf_explained_var": 0.9178569316864014, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007349534425884485, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 16.131528854370117}, "num_steps_trained": 6211384, "grad_time_ms": 8150.989, "num_steps_sampled": 6211384, "sample_time_ms": 17307.591, "load_time_ms": 4.29, "update_time_ms": 9.012}, "hostname": "flow-main", "episode_reward_max": -82.23232062243984, "timesteps_this_iter": 31365, "custom_metrics": {"cost1_max": 224.54763794495898, "cost1_mean": 186.7420497346716, "system_level_velocity_mean": 16.157321704347293, "cost2_mean": -41.828153220223314, "cost2_max": -24.01672407449807, "outflow_rate_max": 1360.695745063347, "cost1_min": 79.9093694174789, "system_level_velocity_min": 12.866710378599635, "system_level_velocity_max": 19.169210065102128, "outflow_rate_min": 771.4442311070665, "cost2_min": -61.17405751289566, "outflow_rate_mean": 1095.8796459998775}, "done": false, "pid": 51582, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 6211384, "time_total_s": 5031.070658445358, "timestamp": 1558607826, "iterations_since_restore": 183, "policy_reward_mean": {}, "training_iteration": 183, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549d30>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549198>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8525, "timesteps_total": 6211384, "episode_reward_mean": -322.1247387198971, "episodes_this_iter": 48, "date": "2019-05-23_10-37-06", "time_this_iter_s": 25.709070444107056, "num_metric_batches_dropped": 0, "episode_reward_min": -481.5215487910551}
{"time_since_restore": 5055.831920385361, "info": {"default": {"kl": 0.010791461914777756, "entropy": 1.5334681272506714, "total_loss": 16.586360931396484, "vf_explained_var": 0.9188432693481445, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008761599659919739, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 16.589935302734375}, "num_steps_trained": 6241961, "grad_time_ms": 8082.777, "num_steps_sampled": 6241961, "sample_time_ms": 17267.976, "load_time_ms": 4.392, "update_time_ms": 9.202}, "hostname": "flow-main", "episode_reward_max": -210.27660388203617, "timesteps_this_iter": 30577, "custom_metrics": {"cost1_max": 223.68301133248207, "cost1_mean": 187.0610716051708, "system_level_velocity_mean": 15.967029697469773, "cost2_mean": -41.59747416175436, "cost2_max": -22.97317881254331, "outflow_rate_max": 1362.3631237997377, "cost1_min": 138.18347281636298, "system_level_velocity_min": 11.962105759260577, "system_level_velocity_max": 19.207774702887825, "outflow_rate_min": 803.9277129186601, "cost2_min": -56.24751994759394, "outflow_rate_mean": 1085.1146194586308}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6241961, "time_total_s": 5055.831920385361, "timestamp": 1558607850, "iterations_since_restore": 184, "policy_reward_mean": {}, "training_iteration": 184, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c160>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c4e0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c2e8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8568, "timesteps_total": 6241961, "episode_reward_mean": -328.1131678409432, "episodes_this_iter": 43, "date": "2019-05-23_10-37-30", "time_this_iter_s": 24.76126194000244, "num_metric_batches_dropped": 0, "episode_reward_min": -513.7011473590643}
{"time_since_restore": 5080.742809295654, "info": {"default": {"kl": 0.011192629113793373, "entropy": 1.5211832523345947, "total_loss": 14.427157402038574, "vf_explained_var": 0.929360568523407, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008408388122916222, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 14.430187225341797}, "num_steps_trained": 6271947, "grad_time_ms": 7919.089, "num_steps_sampled": 6271947, "sample_time_ms": 17450.472, "load_time_ms": 4.38, "update_time_ms": 9.216}, "hostname": "flow-main", "episode_reward_max": -28.90334186933976, "timesteps_this_iter": 29986, "custom_metrics": {"cost1_max": 223.68301133248207, "cost1_mean": 182.45941740260434, "system_level_velocity_mean": 15.760477107995271, "cost2_mean": -40.63081749186148, "cost2_max": -19.72626431289568, "outflow_rate_max": 1362.3631237997377, "cost1_min": 23.199233569508955, "system_level_velocity_min": 11.9345069781103, "system_level_velocity_max": 19.207774702887825, "outflow_rate_min": 462.43348918263234, "cost2_min": -54.41819877276292, "outflow_rate_mean": 1059.7547536417817}, "done": false, "pid": 51582, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 6271947, "time_total_s": 5080.742809295654, "timestamp": 1558607875, "iterations_since_restore": 185, "policy_reward_mean": {}, "training_iteration": 185, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84530240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455cef0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455cb70>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8617, "timesteps_total": 6271947, "episode_reward_mean": -328.1879730394911, "episodes_this_iter": 49, "date": "2019-05-23_10-37-55", "time_this_iter_s": 24.91088891029358, "num_metric_batches_dropped": 0, "episode_reward_min": -513.7011473590643}
{"time_since_restore": 5106.7634217739105, "info": {"default": {"kl": 0.011282427236437798, "entropy": 1.473751187324524, "total_loss": 17.692909240722656, "vf_explained_var": 0.9125266671180725, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008355571888387203, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 17.695842742919922}, "num_steps_trained": 6302214, "grad_time_ms": 7766.19, "num_steps_sampled": 6302214, "sample_time_ms": 17509.728, "load_time_ms": 4.432, "update_time_ms": 9.207}, "hostname": "flow-main", "episode_reward_max": -28.90334186933976, "timesteps_this_iter": 30267, "custom_metrics": {"cost1_max": 223.8765094607851, "cost1_mean": 182.78145318452397, "system_level_velocity_mean": 15.886499078740657, "cost2_mean": -40.23432783121435, "cost2_max": -8.798553196766925, "outflow_rate_max": 1384.0874724525295, "cost1_min": 23.199233569508955, "system_level_velocity_min": 10.956653152651377, "system_level_velocity_max": 19.121815691205708, "outflow_rate_min": 462.43348918263234, "cost2_min": -56.901784294774444, "outflow_rate_mean": 1065.810389597}, "done": false, "pid": 51582, "episode_len_mean": 319.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 6302214, "time_total_s": 5106.7634217739105, "timestamp": 1558607901, "iterations_since_restore": 186, "policy_reward_mean": {}, "training_iteration": 186, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845414a8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541b70>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84541ac8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8663, "timesteps_total": 6302214, "episode_reward_mean": -319.43812831782253, "episodes_this_iter": 46, "date": "2019-05-23_10-38-21", "time_this_iter_s": 26.020612478256226, "num_metric_batches_dropped": 0, "episode_reward_min": -479.37260379177104}
{"time_since_restore": 5133.216141939163, "info": {"default": {"kl": 0.011703240685164928, "entropy": 1.4316275119781494, "total_loss": 14.976602554321289, "vf_explained_var": 0.9280921220779419, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008497534319758415, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 14.979475975036621}, "num_steps_trained": 6333076, "grad_time_ms": 7978.106, "num_steps_sampled": 6333076, "sample_time_ms": 17490.479, "load_time_ms": 4.506, "update_time_ms": 8.966}, "hostname": "flow-main", "episode_reward_max": -21.51490601983513, "timesteps_this_iter": 30862, "custom_metrics": {"cost1_max": 223.8765094607851, "cost1_mean": 183.09634627643882, "system_level_velocity_mean": 15.899104273457496, "cost2_mean": -39.59997149548762, "cost2_max": -8.798553196766925, "outflow_rate_max": 1384.0874724525295, "cost1_min": 17.975337584394808, "system_level_velocity_min": 10.956653152651377, "system_level_velocity_max": 19.142321635882205, "outflow_rate_min": 431.75782487237836, "cost2_min": -56.901784294774444, "outflow_rate_mean": 1065.6184776977766}, "done": false, "pid": 51582, "episode_len_mean": 319.66, "node_ip": "10.138.0.2", "timesteps_since_restore": 6333076, "time_total_s": 5133.216141939163, "timestamp": 1558607928, "iterations_since_restore": 187, "policy_reward_mean": {}, "training_iteration": 187, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845570f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557710>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557be0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8709, "timesteps_total": 6333076, "episode_reward_mean": -317.89446369956056, "episodes_this_iter": 46, "date": "2019-05-23_10-38-48", "time_this_iter_s": 26.452720165252686, "num_metric_batches_dropped": 0, "episode_reward_min": -486.91108293162665}
{"time_since_restore": 5157.556185007095, "info": {"default": {"kl": 0.012028982862830162, "entropy": 1.5013288259506226, "total_loss": 18.692052841186523, "vf_explained_var": 0.91351717710495, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010686345398426056, "cur_kl_coeff": 0.48054200410842896, "vf_loss": 18.696956634521484}, "num_steps_trained": 6363422, "grad_time_ms": 8118.796, "num_steps_sampled": 6363422, "sample_time_ms": 17005.086, "load_time_ms": 4.375, "update_time_ms": 8.793}, "hostname": "flow-main", "episode_reward_max": -21.51490601983513, "timesteps_this_iter": 30346, "custom_metrics": {"cost1_max": 224.81799614554097, "cost1_mean": 185.52872799762713, "system_level_velocity_mean": 15.97898404182724, "cost2_mean": -39.64633988702168, "cost2_max": -16.26413557959479, "outflow_rate_max": 1367.3205890409256, "cost1_min": 17.975337584394808, "system_level_velocity_min": 12.015687405200051, "system_level_velocity_max": 19.1497262753323, "outflow_rate_min": 431.75782487237836, "cost2_min": -55.322831708332714, "outflow_rate_mean": 1076.7679183456694}, "done": false, "pid": 51582, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "timesteps_since_restore": 6363422, "time_total_s": 5157.556185007095, "timestamp": 1558607952, "iterations_since_restore": 188, "policy_reward_mean": {}, "training_iteration": 188, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b0f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549828>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549eb8>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8757, "timesteps_total": 6363422, "episode_reward_mean": -321.6861237266939, "episodes_this_iter": 48, "date": "2019-05-23_10-39-12", "time_this_iter_s": 24.34004306793213, "num_metric_batches_dropped": 0, "episode_reward_min": -545.7138764956626}
{"time_since_restore": 5183.992447376251, "info": {"default": {"kl": 0.01096799410879612, "entropy": 1.521573543548584, "total_loss": 18.75989532470703, "vf_explained_var": 0.9175155162811279, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007912197150290012, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 18.762537002563477}, "num_steps_trained": 6394487, "grad_time_ms": 8121.94, "num_steps_sampled": 6394487, "sample_time_ms": 16996.043, "load_time_ms": 4.264, "update_time_ms": 9.137}, "hostname": "flow-main", "episode_reward_max": -217.16438178129408, "timesteps_this_iter": 31065, "custom_metrics": {"cost1_max": 224.81799614554097, "cost1_mean": 186.60295524879115, "system_level_velocity_mean": 15.907464268666683, "cost2_mean": -41.00352444742056, "cost2_max": -17.4269169138998, "outflow_rate_max": 1367.3205890409256, "cost1_min": 136.66454523779817, "system_level_velocity_min": 11.888000757692462, "system_level_velocity_max": 19.238444531800013, "outflow_rate_min": 708.234191755442, "cost2_min": -58.29847921753315, "outflow_rate_mean": 1081.652845291517}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6394487, "time_total_s": 5183.992447376251, "timestamp": 1558607979, "iterations_since_restore": 189, "policy_reward_mean": {}, "training_iteration": 189, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845499e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549470>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549e48>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8803, "timesteps_total": 6394487, "episode_reward_mean": -331.1975833821742, "episodes_this_iter": 46, "date": "2019-05-23_10-39-39", "time_this_iter_s": 26.436262369155884, "num_metric_batches_dropped": 0, "episode_reward_min": -545.7138764956626}
{"time_since_restore": 5209.492985010147, "info": {"default": {"kl": 0.011276237666606903, "entropy": 1.4203647375106812, "total_loss": 17.696979522705078, "vf_explained_var": 0.9184551239013672, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009608972817659378, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 17.701168060302734}, "num_steps_trained": 6425484, "grad_time_ms": 8012.69, "num_steps_sampled": 6425484, "sample_time_ms": 17169.256, "load_time_ms": 4.056, "update_time_ms": 9.449}, "hostname": "flow-main", "episode_reward_max": -86.37540723260288, "timesteps_this_iter": 30997, "custom_metrics": {"cost1_max": 225.43885341023298, "cost1_mean": 185.54499471307284, "system_level_velocity_mean": 15.946549951249771, "cost2_mean": -41.05277201625072, "cost2_max": -18.228505866341855, "outflow_rate_max": 1374.0144365363592, "cost1_min": 79.98598586332686, "system_level_velocity_min": 11.888000757692462, "system_level_velocity_max": 19.238444531800013, "outflow_rate_min": 708.234191755442, "cost2_min": -58.29847921753315, "outflow_rate_mean": 1078.8031504810317}, "done": false, "pid": 51582, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "timesteps_since_restore": 6425484, "time_total_s": 5209.492985010147, "timestamp": 1558608004, "iterations_since_restore": 190, "policy_reward_mean": {}, "training_iteration": 190, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565da0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557e80>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8454b0f0>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8849, "timesteps_total": 6425484, "episode_reward_mean": -330.8108892314, "episodes_this_iter": 46, "date": "2019-05-23_10-40-04", "time_this_iter_s": 25.500537633895874, "num_metric_batches_dropped": 0, "episode_reward_min": -581.4674811203324}
{"time_since_restore": 5234.849112987518, "info": {"default": {"kl": 0.01079083327203989, "entropy": 1.4395027160644531, "total_loss": 19.782176971435547, "vf_explained_var": 0.9103013277053833, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008485420607030392, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 19.785478591918945}, "num_steps_trained": 6456220, "grad_time_ms": 7987.725, "num_steps_sampled": 6456220, "sample_time_ms": 17299.928, "load_time_ms": 4.042, "update_time_ms": 9.372}, "hostname": "flow-main", "episode_reward_max": -85.8267133952573, "timesteps_this_iter": 30736, "custom_metrics": {"cost1_max": 225.43885341023298, "cost1_mean": 185.81388921303827, "system_level_velocity_mean": 16.093203536264074, "cost2_mean": -40.64025068988754, "cost2_max": -22.464842028868123, "outflow_rate_max": 1380.6819213604124, "cost1_min": 79.98598586332686, "system_level_velocity_min": 11.888000757692462, "system_level_velocity_max": 19.262274358054334, "outflow_rate_min": 744.2072441587985, "cost2_min": -56.08388430421838, "outflow_rate_mean": 1087.6012352409196}, "done": false, "pid": 51582, "episode_len_mean": 320.84, "node_ip": "10.138.0.2", "timesteps_since_restore": 6456220, "time_total_s": 5234.849112987518, "timestamp": 1558608030, "iterations_since_restore": 191, "policy_reward_mean": {}, "training_iteration": 191, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845659e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565710>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565240>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8897, "timesteps_total": 6456220, "episode_reward_mean": -322.97911671075707, "episodes_this_iter": 48, "date": "2019-05-23_10-40-30", "time_this_iter_s": 25.356127977371216, "num_metric_batches_dropped": 0, "episode_reward_min": -581.4674811203324}
{"time_since_restore": 5260.134742736816, "info": {"default": {"kl": 0.010645492002367973, "entropy": 1.4508289098739624, "total_loss": 17.289623260498047, "vf_explained_var": 0.9230771064758301, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007789271418005228, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 17.29229736328125}, "num_steps_trained": 6487158, "grad_time_ms": 8029.103, "num_steps_sampled": 6487158, "sample_time_ms": 17358.339, "load_time_ms": 3.987, "update_time_ms": 9.03}, "hostname": "flow-main", "episode_reward_max": -85.8267133952573, "timesteps_this_iter": 30938, "custom_metrics": {"cost1_max": 225.3155942764392, "cost1_mean": 186.55311561778376, "system_level_velocity_mean": 16.162273253708264, "cost2_mean": -41.64839085187097, "cost2_max": -20.097232128346683, "outflow_rate_max": 1384.3817651059956, "cost1_min": 79.98598586332686, "system_level_velocity_min": 12.984726379951201, "system_level_velocity_max": 19.262274358054334, "outflow_rate_min": 716.7447417414944, "cost2_min": -56.10762128961307, "outflow_rate_mean": 1093.561048159615}, "done": false, "pid": 51582, "episode_len_mean": 320.56, "node_ip": "10.138.0.2", "timesteps_since_restore": 6487158, "time_total_s": 5260.134742736816, "timestamp": 1558608055, "iterations_since_restore": 192, "policy_reward_mean": {}, "training_iteration": 192, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845652e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565198>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565828>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8945, "timesteps_total": 6487158, "episode_reward_mean": -321.8139955678223, "episodes_this_iter": 48, "date": "2019-05-23_10-40-55", "time_this_iter_s": 25.285629749298096, "num_metric_batches_dropped": 0, "episode_reward_min": -521.6520697618267}
{"time_since_restore": 5286.004986286163, "info": {"default": {"kl": 0.011056223884224892, "entropy": 1.4538614749908447, "total_loss": 17.455602645874023, "vf_explained_var": 0.9243283271789551, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008481385186314583, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 17.458772659301758}, "num_steps_trained": 6518653, "grad_time_ms": 8047.768, "num_steps_sampled": 6518653, "sample_time_ms": 17355.095, "load_time_ms": 4.04, "update_time_ms": 9.159}, "hostname": "flow-main", "episode_reward_max": -209.83686039523246, "timesteps_this_iter": 31495, "custom_metrics": {"cost1_max": 226.4197684221104, "cost1_mean": 185.8878861421141, "system_level_velocity_mean": 15.853783414964017, "cost2_mean": -42.816131586592675, "cost2_max": -20.097232128346683, "outflow_rate_max": 1391.6045629268087, "cost1_min": 145.38937570423735, "system_level_velocity_min": 12.410443927337004, "system_level_velocity_max": 19.32377310501258, "outflow_rate_min": 716.7447417414944, "cost2_min": -60.36698219076112, "outflow_rate_mean": 1102.7045754137898}, "done": false, "pid": 51582, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "timesteps_since_restore": 6518653, "time_total_s": 5286.004986286163, "timestamp": 1558608081, "iterations_since_restore": 193, "policy_reward_mean": {}, "training_iteration": 193, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557cc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84557d68>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 8989, "timesteps_total": 6518653, "episode_reward_mean": -340.34680851296963, "episodes_this_iter": 44, "date": "2019-05-23_10-41-21", "time_this_iter_s": 25.870243549346924, "num_metric_batches_dropped": 0, "episode_reward_min": -500.4808258481331}
{"time_since_restore": 5311.552062749863, "info": {"default": {"kl": 0.011296961456537247, "entropy": 1.4350452423095703, "total_loss": 17.959796905517578, "vf_explained_var": 0.9155981540679932, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00993708148598671, "cur_kl_coeff": 0.48054200410842896, "vf_loss": 17.964303970336914}, "num_steps_trained": 6549078, "grad_time_ms": 7996.214, "num_steps_sampled": 6549078, "sample_time_ms": 17485.412, "load_time_ms": 4.113, "update_time_ms": 8.961}, "hostname": "flow-main", "episode_reward_max": -80.6314616421682, "timesteps_this_iter": 30425, "custom_metrics": {"cost1_max": 226.4197684221104, "cost1_mean": 183.39587365857034, "system_level_velocity_mean": 15.888011302678105, "cost2_mean": -42.02377625818836, "cost2_max": -25.105376543675973, "outflow_rate_max": 1391.6045629268087, "cost1_min": 80.77550407115704, "system_level_velocity_min": 12.410443927337004, "system_level_velocity_max": 19.32377310501258, "outflow_rate_min": 715.1058348968104, "cost2_min": -62.42643946830904, "outflow_rate_mean": 1083.002757566425}, "done": false, "pid": 51582, "episode_len_mean": 320.56, "node_ip": "10.138.0.2", "timesteps_since_restore": 6549078, "time_total_s": 5311.552062749863, "timestamp": 1558608107, "iterations_since_restore": 194, "policy_reward_mean": {}, "training_iteration": 194, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565f28>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565dd8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565908>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 9035, "timesteps_total": 6549078, "episode_reward_mean": -330.7579534341468, "episodes_this_iter": 46, "date": "2019-05-23_10-41-47", "time_this_iter_s": 25.54707646369934, "num_metric_batches_dropped": 0, "episode_reward_min": -500.4808258481331}
{"time_since_restore": 5337.907061576843, "info": {"default": {"kl": 0.011326482519507408, "entropy": 1.446568250656128, "total_loss": 17.491018295288086, "vf_explained_var": 0.913340151309967, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007889261469244957, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 17.493465423583984}, "num_steps_trained": 6580511, "grad_time_ms": 8102.061, "num_steps_sampled": 6580511, "sample_time_ms": 17523.96, "load_time_ms": 4.048, "update_time_ms": 8.794}, "hostname": "flow-main", "episode_reward_max": -27.237583442688393, "timesteps_this_iter": 31433, "custom_metrics": {"cost1_max": 224.52574455559903, "cost1_mean": 181.71194373267713, "system_level_velocity_mean": 16.16546790100623, "cost2_mean": -41.31808454377596, "cost2_max": -16.364531471846828, "outflow_rate_max": 1380.2594633518881, "cost1_min": 23.252517617934696, "system_level_velocity_min": 13.391939253378599, "system_level_velocity_max": 19.217377538291572, "outflow_rate_min": 477.1055332935651, "cost2_min": -62.42643946830904, "outflow_rate_mean": 1071.8072818141256}, "done": false, "pid": 51582, "episode_len_mean": 312.98, "node_ip": "10.138.0.2", "timesteps_since_restore": 6580511, "time_total_s": 5337.907061576843, "timestamp": 1558608133, "iterations_since_restore": 195, "policy_reward_mean": {}, "training_iteration": 195, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549a90>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549b38>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 9085, "timesteps_total": 6580511, "episode_reward_mean": -318.0327326252836, "episodes_this_iter": 50, "date": "2019-05-23_10-42-13", "time_this_iter_s": 26.35499882698059, "num_metric_batches_dropped": 0, "episode_reward_min": -483.68189214464735}
{"time_since_restore": 5365.807675361633, "info": {"default": {"kl": 0.011709575541317463, "entropy": 1.4464551210403442, "total_loss": 18.189807891845703, "vf_explained_var": 0.9126340746879578, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007600962184369564, "cur_kl_coeff": 0.48054200410842896, "vf_loss": 18.191781997680664}, "num_steps_trained": 6612210, "grad_time_ms": 8249.45, "num_steps_sampled": 6612210, "sample_time_ms": 17561.78, "load_time_ms": 3.966, "update_time_ms": 8.515}, "hostname": "flow-main", "episode_reward_max": -27.237583442688393, "timesteps_this_iter": 31699, "custom_metrics": {"cost1_max": 225.89326475116505, "cost1_mean": 179.1869705536278, "system_level_velocity_mean": 16.119985411062835, "cost2_mean": -42.27891417840991, "cost2_max": -12.423636063645393, "outflow_rate_max": 1393.3403960568644, "cost1_min": 22.98792652506666, "system_level_velocity_min": 12.138076308518164, "system_level_velocity_max": 19.255686048390125, "outflow_rate_min": 477.1055332935651, "cost2_min": -62.42643946830904, "outflow_rate_mean": 1073.5290537665894}, "done": false, "pid": 51582, "episode_len_mean": 310.08, "node_ip": "10.138.0.2", "timesteps_since_restore": 6612210, "time_total_s": 5365.807675361633, "timestamp": 1558608161, "iterations_since_restore": 196, "policy_reward_mean": {}, "training_iteration": 196, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845659e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845657f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84565908>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 9133, "timesteps_total": 6612210, "episode_reward_mean": -324.9872040629232, "episodes_this_iter": 48, "date": "2019-05-23_10-42-41", "time_this_iter_s": 27.90061378479004, "num_metric_batches_dropped": 0, "episode_reward_min": -559.5050990196678}
{"time_since_restore": 5389.977421045303, "info": {"default": {"kl": 0.01162212435156107, "entropy": 1.5036998987197876, "total_loss": 17.58097267150879, "vf_explained_var": 0.908100962638855, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009564693085849285, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 17.58495330810547}, "num_steps_trained": 6642527, "grad_time_ms": 8225.218, "num_steps_sampled": 6642527, "sample_time_ms": 17357.428, "load_time_ms": 3.989, "update_time_ms": 8.62}, "hostname": "flow-main", "episode_reward_max": -28.52542431809323, "timesteps_this_iter": 30317, "custom_metrics": {"cost1_max": 225.89326475116505, "cost1_mean": 185.51484306469007, "system_level_velocity_mean": 16.213194172367707, "cost2_mean": -42.47057593974674, "cost2_max": -12.423636063645393, "outflow_rate_max": 1397.5596743636916, "cost1_min": 22.98792652506666, "system_level_velocity_min": 12.138076308518164, "system_level_velocity_max": 19.255686048390125, "outflow_rate_min": 486.5197872620737, "cost2_min": -62.289117953075305, "outflow_rate_mean": 1095.6648223762586}, "done": false, "pid": 51582, "episode_len_mean": 317.94, "node_ip": "10.138.0.2", "timesteps_since_restore": 6642527, "time_total_s": 5389.977421045303, "timestamp": 1558608185, "iterations_since_restore": 197, "policy_reward_mean": {}, "training_iteration": 197, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8469ac50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549f60>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 9176, "timesteps_total": 6642527, "episode_reward_mean": -323.7361934125523, "episodes_this_iter": 43, "date": "2019-05-23_10-43-05", "time_this_iter_s": 24.169745683670044, "num_metric_batches_dropped": 0, "episode_reward_min": -580.3623286374636}
{"time_since_restore": 5415.283004045486, "info": {"default": {"kl": 0.012459458783268929, "entropy": 1.4969782829284668, "total_loss": 18.097349166870117, "vf_explained_var": 0.9090785384178162, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009422434493899345, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 18.100784301757812}, "num_steps_trained": 6673572, "grad_time_ms": 8106.13, "num_steps_sampled": 6673572, "sample_time_ms": 17576.667, "load_time_ms": 3.866, "update_time_ms": 8.804}, "hostname": "flow-main", "episode_reward_max": -207.5150670840613, "timesteps_this_iter": 31045, "custom_metrics": {"cost1_max": 225.89326475116505, "cost1_mean": 189.61386938438173, "system_level_velocity_mean": 16.163509279790052, "cost2_mean": -41.575211774074106, "cost2_max": -22.97423159904342, "outflow_rate_max": 1397.5596743636916, "cost1_min": 142.3506755448575, "system_level_velocity_min": 12.138076308518164, "system_level_velocity_max": 19.255686048390125, "outflow_rate_min": 798.2042641625617, "cost2_min": -59.22910268958903, "outflow_rate_mean": 1095.9239962920524}, "done": false, "pid": 51582, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "timesteps_since_restore": 6673572, "time_total_s": 5415.283004045486, "timestamp": 1558608210, "iterations_since_restore": 198, "policy_reward_mean": {}, "training_iteration": 198, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549470>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e845492e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549e10>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 9226, "timesteps_total": 6673572, "episode_reward_mean": -325.9626347597926, "episodes_this_iter": 50, "date": "2019-05-23_10-43-30", "time_this_iter_s": 25.305583000183105, "num_metric_batches_dropped": 0, "episode_reward_min": -580.3623286374636}
{"time_since_restore": 5440.661628961563, "info": {"default": {"kl": 0.01159767247736454, "entropy": 1.477670431137085, "total_loss": 18.11754035949707, "vf_explained_var": 0.9086728096008301, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009145361371338367, "cur_kl_coeff": 0.48054203391075134, "vf_loss": 18.121110916137695}, "num_steps_trained": 6704679, "grad_time_ms": 7974.414, "num_steps_sampled": 6704679, "sample_time_ms": 17605.704, "load_time_ms": 3.855, "update_time_ms": 8.509}, "hostname": "flow-main", "episode_reward_max": -29.028705417646304, "timesteps_this_iter": 31107, "custom_metrics": {"cost1_max": 224.81613504646356, "cost1_mean": 186.42691082081626, "system_level_velocity_mean": 16.084603720797674, "cost2_mean": -40.92162995646882, "cost2_max": -16.256681264742475, "outflow_rate_max": 1359.1844350213132, "cost1_min": 22.986059968324273, "system_level_velocity_min": 12.843501689637975, "system_level_velocity_max": 19.028857392513263, "outflow_rate_min": 471.084583467557, "cost2_min": -62.82806697376543, "outflow_rate_mean": 1077.3229362699378}, "done": false, "pid": 51582, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 6704679, "time_total_s": 5440.661628961563, "timestamp": 1558608236, "iterations_since_restore": 199, "policy_reward_mean": {}, "training_iteration": 199, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549da0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e84549400>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 9273, "timesteps_total": 6704679, "episode_reward_mean": -330.37671949337476, "episodes_this_iter": 47, "date": "2019-05-23_10-43-56", "time_this_iter_s": 25.37862491607666, "num_metric_batches_dropped": 0, "episode_reward_min": -544.7718815753453}
{"time_since_restore": 5465.96833896637, "info": {"default": {"kl": 0.010116488672792912, "entropy": 1.526960849761963, "total_loss": 15.018111228942871, "vf_explained_var": 0.9291337728500366, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00853290967643261, "cur_kl_coeff": 0.48054206371307373, "vf_loss": 15.021784782409668}, "num_steps_trained": 6736464, "grad_time_ms": 8055.72, "num_steps_sampled": 6736464, "sample_time_ms": 17505.259, "load_time_ms": 4.006, "update_time_ms": 8.004}, "hostname": "flow-main", "episode_reward_max": -29.028705417646304, "timesteps_this_iter": 31785, "custom_metrics": {"cost1_max": 224.81613504646356, "cost1_mean": 185.48282700094234, "system_level_velocity_mean": 16.014166166927268, "cost2_mean": -41.3282274451745, "cost2_max": -16.256681264742475, "outflow_rate_max": 1383.2458572373957, "cost1_min": 22.986059968324273, "system_level_velocity_min": 12.112460955466116, "system_level_velocity_max": 19.028857392513263, "outflow_rate_min": 471.084583467557, "cost2_min": -62.82806697376543, "outflow_rate_mean": 1079.0230506791218}, "done": true, "pid": 51582, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "timesteps_since_restore": 6736464, "time_total_s": 5465.96833896637, "timestamp": 1558608261, "iterations_since_restore": 200, "policy_reward_mean": {}, "training_iteration": 200, "config": {"lambda": 0.97, "clip_param": 0.3, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "output": null, "simple_optimizer": false, "train_batch_size": 15000, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "output_max_file_size": 67108864, "num_gpus_per_worker": 0, "log_level": "INFO", "optimizer": {}, "horizon": 750, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "entropy_coeff": 0.0, "kl_coeff": 0.2, "num_sgd_iter": 10, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455ce10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c588>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5e8455c240>"}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler", "synchronize_filters": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "input_evaluation": null, "sample_async": false, "vf_clip_param": 1000000.0, "compress_observations": false, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "kl_target": 0.01, "monitor": false, "num_cpus_per_worker": 1, "straggler_mitigation": false, "num_gpus": 0, "sample_batch_size": 750, "batch_mode": "truncate_episodes", "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 3,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "custom_resources_per_worker": {}, "use_gae": true, "collect_metrics_timeout": 180, "clip_actions": false, "model": {"conv_filters": null, "conv_activation": "relu", "framestack": true, "custom_preprocessor": null, "use_lstm": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "free_log_std": false, "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false, "zero_mean": true, "max_seq_len": 20, "custom_model": null, "custom_options": {}}, "lr_schedule": null, "num_workers": 20, "lr": 0.0005}, "experiment_id": "93eb213baa164bc2a342ebf76d4b0100", "episodes_total": 9316, "timesteps_total": 6736464, "episode_reward_mean": -333.02125349939246, "episodes_this_iter": 43, "date": "2019-05-23_10-44-21", "time_this_iter_s": 25.30671000480652, "num_metric_batches_dropped": 0, "episode_reward_min": -496.7614252702979}

{"info": {"num_steps_sampled": 41877, "sample_time_ms": 40413.877, "update_time_ms": 1475.24, "learner": {"default_policy": {"kl": 0.0019007212249562144, "policy_loss": -0.0006805213633924723, "entropy": 1.4136883020401, "total_loss": 35.168060302734375, "vf_explained_var": 1.6302873291351716e-06, "vf_loss": 35.16836166381836, "cur_kl_coeff": 0.20000003278255463, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9796.01, "load_time_ms": 58.035, "num_steps_trained": 41856}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 41, "pid": 45081, "episode_reward_min": -904.8342206150705, "time_total_s": 51.90108942985535, "num_metric_batches_dropped": 0, "time_this_iter_s": 51.90108942985535, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9ff28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9fea0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9fe18>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9fd90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 41877, "timesteps_since_restore": 41877, "date": "2019-05-30_01-10-11", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 19.635803116978074, "mean_inference_ms": 1.9324519542800513, "mean_processing_ms": 6.022979066330957}, "training_iteration": 1, "timesteps_total": 41877, "episode_reward_mean": -697.7256852270898, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -34.36155903772639, "episode_len_mean": 317.9756097560976, "timestamp": 1559178611, "off_policy_estimator": {}, "time_since_restore": 51.90108942985535, "custom_metrics": {"cost1_max": 143.19847103641473, "cost1_mean": 119.10800468738067, "cost2_mean": -47.769976669708136, "cost2_max": -22.565352352019787, "system_level_velocity_max": 17.816042428704893, "cost2_min": -78.52114870001904, "system_level_velocity_min": 8.218565250561248, "system_level_velocity_mean": 10.266175188833936, "outflow_rate_mean": 750.3976299425774, "cost1_min": 24.023977074129444, "outflow_rate_min": 471.02151734420755, "outflow_rate_max": 914.7878038613673}, "iterations_since_restore": 1}
{"info": {"num_steps_sampled": 84550, "sample_time_ms": 30218.773, "update_time_ms": 742.058, "learner": {"default_policy": {"kl": 0.0024056171532720327, "policy_loss": -0.0009235625038854778, "entropy": 1.4148041009902954, "total_loss": 33.17474365234375, "vf_explained_var": 0.433565616607666, "vf_loss": 33.17543029785156, "cur_kl_coeff": 0.10000000894069672, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9649.345, "load_time_ms": 31.985, "num_steps_trained": 84480}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 81, "pid": 45081, "episode_reward_min": -986.9148920751185, "time_total_s": 81.54402947425842, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.642940044403076, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9fd08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f510>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f488>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f7b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 42673, "timesteps_since_restore": 84550, "date": "2019-05-30_01-10-40", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 19.06546555298794, "mean_inference_ms": 1.9155929788106902, "mean_processing_ms": 5.97957615913346}, "training_iteration": 2, "timesteps_total": 84550, "episode_reward_mean": -683.7818507105242, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -34.36155903772639, "episode_len_mean": 321.44444444444446, "timestamp": 1559178640, "off_policy_estimator": {}, "time_since_restore": 81.54402947425842, "custom_metrics": {"cost1_max": 166.6324025793632, "cost1_mean": 127.51171226281397, "cost2_mean": -53.57302949389442, "cost2_max": -22.565352352019787, "system_level_velocity_max": 17.816042428704893, "cost2_min": -93.17267205177379, "system_level_velocity_min": 8.218565250561248, "system_level_velocity_mean": 10.763216282252415, "outflow_rate_mean": 789.6870397755101, "cost1_min": 24.023977074129444, "outflow_rate_min": 471.02151734420755, "outflow_rate_max": 1000.9584186946336}, "iterations_since_restore": 2}
{"info": {"num_steps_sampled": 128430, "sample_time_ms": 26779.418, "update_time_ms": 498.243, "learner": {"default_policy": {"kl": 0.008751502260565758, "policy_loss": -0.0020620976574718952, "entropy": 1.4048259258270264, "total_loss": 41.64609146118164, "vf_explained_var": 0.6362990140914917, "vf_loss": 41.64771270751953, "cur_kl_coeff": 0.050000011920928955, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9641.915, "load_time_ms": 23.359, "num_steps_trained": 128256}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 121, "pid": 45081, "episode_reward_min": -986.9148920751185, "time_total_s": 111.17384648323059, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.629817008972168, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aafc9950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aafc98c8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aafc9840>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aafc97b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 43880, "timesteps_since_restore": 128430, "date": "2019-05-30_01-11-10", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 18.506478474539268, "mean_inference_ms": 1.8997664843176567, "mean_processing_ms": 5.995752743538492}, "training_iteration": 3, "timesteps_total": 128430, "episode_reward_mean": -663.9211700325166, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -34.36155903772639, "episode_len_mean": 322.12, "timestamp": 1559178670, "off_policy_estimator": {}, "time_since_restore": 111.17384648323059, "custom_metrics": {"cost1_max": 168.27540630190117, "cost1_mean": 134.006953758598, "cost2_mean": -57.26668129660623, "cost2_max": -22.565352352019787, "system_level_velocity_max": 17.816042428704893, "cost2_min": -93.17267205177379, "system_level_velocity_min": 8.86206385732852, "system_level_velocity_mean": 11.240246361083482, "outflow_rate_mean": 838.8351979014813, "cost1_min": 24.023977074129444, "outflow_rate_min": 471.02151734420755, "outflow_rate_max": 1094.638613445378}, "iterations_since_restore": 3}
{"info": {"num_steps_sampled": 169125, "sample_time_ms": 25601.692, "update_time_ms": 375.727, "learner": {"default_policy": {"kl": 0.009030560031533241, "policy_loss": -0.003061107359826565, "entropy": 1.389314889907837, "total_loss": 45.35243606567383, "vf_explained_var": 0.7311395406723022, "vf_loss": 45.355045318603516, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9531.979, "load_time_ms": 19.094, "num_steps_trained": 168832}, "node_ip": "10.138.0.2", "episodes_this_iter": 60, "episodes_total": 181, "pid": 45081, "episode_reward_min": -854.594840180001, "time_total_s": 142.54006552696228, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.36621904373169, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a91e0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9158>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a90d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 40695, "timesteps_since_restore": 169125, "date": "2019-05-30_01-11-41", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 18.06542673303096, "mean_inference_ms": 1.9083971874995467, "mean_processing_ms": 6.295043284345532}, "training_iteration": 4, "timesteps_total": 169125, "episode_reward_mean": -615.5636339902364, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -451.4136148315598, "episode_len_mean": 325.0, "timestamp": 1559178701, "off_policy_estimator": {}, "time_since_restore": 142.54006552696228, "custom_metrics": {"cost1_max": 189.3805832297872, "cost1_mean": 150.02863971190664, "cost2_mean": -65.26920186440486, "cost2_max": -30.325491595708307, "system_level_velocity_max": 15.396457786366586, "cost2_min": -100.9515044111373, "system_level_velocity_min": 9.504290479220677, "system_level_velocity_mean": 12.36577144670128, "outflow_rate_mean": 960.3486044674958, "cost1_min": 115.2686537410929, "outflow_rate_min": 717.9890947420025, "outflow_rate_max": 1219.2133461283174}, "iterations_since_restore": 4}
{"info": {"num_steps_sampled": 211272, "sample_time_ms": 24485.269, "update_time_ms": 302.182, "learner": {"default_policy": {"kl": 0.009171704761683941, "policy_loss": -0.0040584951639175415, "entropy": 1.3853340148925781, "total_loss": 34.65122604370117, "vf_explained_var": 0.7994916439056396, "vf_loss": 34.65482711791992, "cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9492.005, "load_time_ms": 16.554, "num_steps_trained": 210944}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 221, "pid": 45081, "episode_reward_min": -802.4658019329423, "time_total_s": 172.0107114315033, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.470645904541016, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f730>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f7b8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9fd08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 42147, "timesteps_since_restore": 211272, "date": "2019-05-30_01-12-11", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.988803338398135, "mean_inference_ms": 1.918277370457912, "mean_processing_ms": 6.4786578389454315}, "training_iteration": 5, "timesteps_total": 211272, "episode_reward_mean": -563.7019886446445, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -428.5024584695856, "episode_len_mean": 325.0, "timestamp": 1559178731, "off_policy_estimator": {}, "time_since_restore": 172.0107114315033, "custom_metrics": {"cost1_max": 196.83593439413465, "cost1_mean": 163.6960814798373, "cost2_mean": -77.52496675435557, "cost2_max": -36.62895703778272, "system_level_velocity_max": 16.031839484456484, "cost2_min": -119.87704699101499, "system_level_velocity_min": 10.376248661463135, "system_level_velocity_mean": 13.4653265452079, "outflow_rate_mean": 1051.4919515740419, "cost1_min": 124.25002616832099, "outflow_rate_min": 741.4684326375709, "outflow_rate_max": 1259.4686154875526}, "iterations_since_restore": 5}
{"info": {"num_steps_sampled": 254058, "sample_time_ms": 23872.585, "update_time_ms": 253.779, "learner": {"default_policy": {"kl": 0.0077275801450014114, "policy_loss": -0.002117314375936985, "entropy": 1.3696173429489136, "total_loss": 33.157981872558594, "vf_explained_var": 0.7882463932037354, "vf_loss": 33.15970993041992, "cur_kl_coeff": 0.050000011920928955, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9555.773, "load_time_ms": 14.792, "num_steps_trained": 253696}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 261, "pid": 45081, "episode_reward_min": -858.3095468298045, "time_total_s": 202.79454135894775, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.783829927444458, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a96a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9620>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9598>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 42786, "timesteps_since_restore": 254058, "date": "2019-05-30_01-12-42", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.98762214139151, "mean_inference_ms": 1.9175680926706136, "mean_processing_ms": 6.398356712494053}, "training_iteration": 6, "timesteps_total": 254058, "episode_reward_mean": -542.6014577127065, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -341.9667547243539, "episode_len_mean": 325.0, "timestamp": 1559178762, "off_policy_estimator": {}, "time_since_restore": 202.79454135894775, "custom_metrics": {"cost1_max": 211.90479226267792, "cost1_mean": 173.75302112010323, "cost2_mean": -89.65315956463576, "cost2_max": -36.62895703778272, "system_level_velocity_max": 17.34646800582169, "cost2_min": -130.0843308153564, "system_level_velocity_min": 10.376248661463135, "system_level_velocity_mean": 14.308957722499915, "outflow_rate_mean": 1113.2926824554916, "cost1_min": 124.25002616832099, "outflow_rate_min": 747.7335459662288, "outflow_rate_max": 1369.2656183578147}, "iterations_since_restore": 6}
{"info": {"num_steps_sampled": 298336, "sample_time_ms": 23928.946, "update_time_ms": 218.407, "learner": {"default_policy": {"kl": 0.007283187936991453, "policy_loss": -0.0014839381910860538, "entropy": 1.381303310394287, "total_loss": 45.15151596069336, "vf_explained_var": 0.6970698833465576, "vf_loss": 45.15263366699219, "cur_kl_coeff": 0.050000011920928955, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9731.361, "load_time_ms": 13.611, "num_steps_trained": 297856}, "node_ip": "10.138.0.2", "episodes_this_iter": 62, "episodes_total": 323, "pid": 45081, "episode_reward_min": -1023.1233678567571, "time_total_s": 237.946218252182, "num_metric_batches_dropped": 0, "time_this_iter_s": 35.15167689323425, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007f28>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007950>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 44278, "timesteps_since_restore": 298336, "date": "2019-05-30_01-13-17", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 18.093320088531193, "mean_inference_ms": 1.9114983161078642, "mean_processing_ms": 6.560340580335919}, "training_iteration": 7, "timesteps_total": 298336, "episode_reward_mean": -528.5426259690221, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -23.451462719462125, "episode_len_mean": 319.12, "timestamp": 1559178797, "off_policy_estimator": {}, "time_since_restore": 237.946218252182, "custom_metrics": {"cost1_max": 216.65063019560415, "cost1_mean": 179.61155180894545, "cost2_mean": -99.34725678987624, "cost2_max": -18.479388773592447, "system_level_velocity_max": 18.962880042908214, "cost2_min": -130.0843308153564, "system_level_velocity_min": 10.186427930218121, "system_level_velocity_mean": 15.232606782258326, "outflow_rate_mean": 1157.2561582591256, "cost1_min": 17.89268704002455, "outflow_rate_min": 461.6005835850076, "outflow_rate_max": 1403.9992510544407}, "iterations_since_restore": 7}
{"info": {"num_steps_sampled": 341601, "sample_time_ms": 23444.281, "update_time_ms": 192.047, "learner": {"default_policy": {"kl": 0.007006598170846701, "policy_loss": -0.0018539626616984606, "entropy": 1.377928376197815, "total_loss": 32.02326965332031, "vf_explained_var": 0.7910335063934326, "vf_loss": 32.02477264404297, "cur_kl_coeff": 0.050000011920928955, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9878.302, "load_time_ms": 12.655, "num_steps_trained": 341120}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 363, "pid": 45081, "episode_reward_min": -1023.1233678567571, "time_total_s": 269.02337408065796, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.077155828475952, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9d90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9d08>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9bf8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 43265, "timesteps_since_restore": 341601, "date": "2019-05-30_01-13-48", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 18.1239704486248, "mean_inference_ms": 1.9025139787631355, "mean_processing_ms": 6.640521901291363}, "training_iteration": 8, "timesteps_total": 341601, "episode_reward_mean": -538.3256394231419, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -23.451462719462125, "episode_len_mean": 319.12, "timestamp": 1559178828, "off_policy_estimator": {}, "time_since_restore": 269.02337408065796, "custom_metrics": {"cost1_max": 217.11113370164577, "cost1_mean": 179.41482013570828, "cost2_mean": -102.42882676334584, "cost2_max": -18.479388773592447, "system_level_velocity_max": 18.962880042908214, "cost2_min": -128.32849658547124, "system_level_velocity_min": 10.186427930218121, "system_level_velocity_mean": 15.248684095821503, "outflow_rate_mean": 1165.349619574251, "cost1_min": 17.89268704002455, "outflow_rate_min": 461.6005835850076, "outflow_rate_max": 1403.9992510544407}, "iterations_since_restore": 8}
{"info": {"num_steps_sampled": 385276, "sample_time_ms": 23052.839, "update_time_ms": 172.34, "learner": {"default_policy": {"kl": 0.007087412290275097, "policy_loss": -0.0017248556250706315, "entropy": 1.3804097175598145, "total_loss": 32.69437789916992, "vf_explained_var": 0.8097618222236633, "vf_loss": 32.69574737548828, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10076.537, "load_time_ms": 11.918, "num_steps_trained": 384768}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 403, "pid": 45081, "episode_reward_min": -901.7866272561768, "time_total_s": 300.72263503074646, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.6992609500885, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a5ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a5a60>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a59d8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a5950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 43675, "timesteps_since_restore": 385276, "date": "2019-05-30_01-14-20", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 18.109126419074173, "mean_inference_ms": 1.8878481850390767, "mean_processing_ms": 6.552221796446883}, "training_iteration": 9, "timesteps_total": 385276, "episode_reward_mean": -548.599718027436, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -23.451462719462125, "episode_len_mean": 319.12, "timestamp": 1559178860, "off_policy_estimator": {}, "time_since_restore": 300.72263503074646, "custom_metrics": {"cost1_max": 218.2326076972364, "cost1_mean": 177.50948714867693, "cost2_mean": -103.22089491282468, "cost2_max": -18.479388773592447, "system_level_velocity_max": 18.962880042908214, "cost2_min": -123.59108130763349, "system_level_velocity_min": 11.096602202956896, "system_level_velocity_mean": 15.08814768388177, "outflow_rate_mean": 1160.9736071694, "cost1_min": 17.89268704002455, "outflow_rate_min": 461.6005835850076, "outflow_rate_max": 1392.1992744467511}, "iterations_since_restore": 9}
{"info": {"num_steps_sampled": 429280, "sample_time_ms": 22920.686, "update_time_ms": 156.274, "learner": {"default_policy": {"kl": 0.005600892938673496, "policy_loss": -0.0015490642981603742, "entropy": 1.3728020191192627, "total_loss": 41.462745666503906, "vf_explained_var": 0.7750406265258789, "vf_loss": 41.464012145996094, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10276.304, "load_time_ms": 11.445, "num_steps_trained": 428672}, "node_ip": "10.138.0.2", "episodes_this_iter": 57, "episodes_total": 460, "pid": 45081, "episode_reward_min": -849.384378873276, "time_total_s": 334.6436893939972, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.92105436325073, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a5620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a5598>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a5268>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a5158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 44004, "timesteps_since_restore": 429280, "date": "2019-05-30_01-14-54", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 18.037360839830225, "mean_inference_ms": 1.8664421119572063, "mean_processing_ms": 6.509496387239022}, "training_iteration": 10, "timesteps_total": 429280, "episode_reward_mean": -543.1464562538262, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -312.33266572782094, "episode_len_mean": 325.0, "timestamp": 1559178894, "off_policy_estimator": {}, "time_since_restore": 334.6436893939972, "custom_metrics": {"cost1_max": 218.2326076972364, "cost1_mean": 183.29590852261677, "cost2_mean": -104.1839673844641, "cost2_max": -88.44969218534763, "system_level_velocity_max": 18.191081312673273, "cost2_min": -122.95523894712372, "system_level_velocity_min": 11.64056592733147, "system_level_velocity_mean": 15.243971401205638, "outflow_rate_mean": 1191.7531690458497, "cost1_min": 137.21909210380483, "outflow_rate_min": 934.3137373838541, "outflow_rate_max": 1421.0167745941837}, "iterations_since_restore": 10}
{"info": {"num_steps_sampled": 471224, "sample_time_ms": 20829.135, "update_time_ms": 9.872, "learner": {"default_policy": {"kl": 0.00626992154866457, "policy_loss": -0.0019636412616819143, "entropy": 1.3676440715789795, "total_loss": 33.04836654663086, "vf_explained_var": 0.8146649599075317, "vf_loss": 33.05002212524414, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10489.285, "load_time_ms": 6.336, "num_steps_trained": 470528}, "node_ip": "10.138.0.2", "episodes_this_iter": 44, "episodes_total": 504, "pid": 45081, "episode_reward_min": -835.7315535146342, "time_total_s": 366.1873404979706, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.54365110397339, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a57b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a5510>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007ea0>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 41944, "timesteps_since_restore": 471224, "date": "2019-05-30_01-15-25", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.914809262215034, "mean_inference_ms": 1.8489993156424307, "mean_processing_ms": 6.532616686323368}, "training_iteration": 11, "timesteps_total": 471224, "episode_reward_mean": -536.4952366831674, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -33.67543400214426, "episode_len_mean": 322.1, "timestamp": 1559178925, "off_policy_estimator": {}, "time_since_restore": 366.1873404979706, "custom_metrics": {"cost1_max": 218.2281599207011, "cost1_mean": 181.48351792348672, "cost2_mean": -104.2480719485702, "cost2_max": -24.10217397396646, "system_level_velocity_max": 18.334526789324602, "cost2_min": -122.09932132996104, "system_level_velocity_min": 11.283637087046722, "system_level_velocity_mean": 15.244169174473738, "outflow_rate_mean": 1189.0407079257309, "cost1_min": 22.87953802863664, "outflow_rate_min": 465.10626898076305, "outflow_rate_max": 1421.0167745941837}, "iterations_since_restore": 11}
{"info": {"num_steps_sampled": 514947, "sample_time_ms": 20692.498, "update_time_ms": 9.984, "learner": {"default_policy": {"kl": 0.008754760958254337, "policy_loss": -0.0022547603584825993, "entropy": 1.3566757440567017, "total_loss": 27.64143180847168, "vf_explained_var": 0.853417694568634, "vf_loss": 27.643251419067383, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10745.733, "load_time_ms": 6.331, "num_steps_trained": 514176}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 544, "pid": 45081, "episode_reward_min": -835.7315535146342, "time_total_s": 397.03022742271423, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.842886924743652, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b8488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b8400>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b8378>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b82f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 43723, "timesteps_since_restore": 514947, "date": "2019-05-30_01-15-56", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.79358488662629, "mean_inference_ms": 1.8320021421042056, "mean_processing_ms": 6.474263629849709}, "training_iteration": 12, "timesteps_total": 514947, "episode_reward_mean": -533.9283373090494, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -33.67543400214426, "episode_len_mean": 322.1, "timestamp": 1559178956, "off_policy_estimator": {}, "time_since_restore": 397.03022742271423, "custom_metrics": {"cost1_max": 220.5075764635228, "cost1_mean": 181.66691357885705, "cost2_mean": -104.36094415767776, "cost2_max": -24.10217397396646, "system_level_velocity_max": 18.334526789324602, "cost2_min": -121.48153476757949, "system_level_velocity_min": 11.283637087046722, "system_level_velocity_mean": 15.253138406261707, "outflow_rate_mean": 1195.9713699236888, "cost1_min": 22.87953802863664, "outflow_rate_min": 465.10626898076305, "outflow_rate_max": 1419.826333768972}, "iterations_since_restore": 12}
{"info": {"num_steps_sampled": 558314, "sample_time_ms": 20768.194, "update_time_ms": 10.118, "learner": {"default_policy": {"kl": 0.007027935702353716, "policy_loss": -0.002200755523517728, "entropy": 1.358464002609253, "total_loss": 30.36685562133789, "vf_explained_var": 0.832444965839386, "vf_loss": 30.368703842163086, "cur_kl_coeff": 0.050000011920928955, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10972.399, "load_time_ms": 6.477, "num_steps_trained": 557440}, "node_ip": "10.138.0.2", "episodes_this_iter": 56, "episodes_total": 600, "pid": 45081, "episode_reward_min": -796.6229829117867, "time_total_s": 429.69490122795105, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.664673805236816, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9fc80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f2f0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9fb70>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 43367, "timesteps_since_restore": 558314, "date": "2019-05-30_01-16-29", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.662177620259506, "mean_inference_ms": 1.807935280683901, "mean_processing_ms": 6.449294985159351}, "training_iteration": 13, "timesteps_total": 558314, "episode_reward_mean": -561.1820495064451, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -301.55285759306685, "episode_len_mean": 325.0, "timestamp": 1559178989, "off_policy_estimator": {}, "time_since_restore": 429.69490122795105, "custom_metrics": {"cost1_max": 220.5075764635228, "cost1_mean": 177.60274575802288, "cost2_mean": -101.08540251916779, "cost2_max": -57.90066968761977, "system_level_velocity_max": 18.379403399327913, "cost2_min": -120.20395568103561, "system_level_velocity_min": 10.907425554225098, "system_level_velocity_mean": 14.792286596938744, "outflow_rate_mean": 1175.7382670983234, "cost1_min": 129.82055358051738, "outflow_rate_min": 935.4352247017156, "outflow_rate_max": 1419.826333768972}, "iterations_since_restore": 13}
{"info": {"num_steps_sampled": 597661, "sample_time_ms": 20810.907, "update_time_ms": 10.272, "learner": {"default_policy": {"kl": 0.006787949241697788, "policy_loss": -0.0024558817967772484, "entropy": 1.3550633192062378, "total_loss": 30.885894775390625, "vf_explained_var": 0.8249028325080872, "vf_loss": 30.888010025024414, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11252.522, "load_time_ms": 6.474, "num_steps_trained": 596736}, "node_ip": "10.138.0.2", "episodes_this_iter": 47, "episodes_total": 647, "pid": 45081, "episode_reward_min": -796.6229829117867, "time_total_s": 464.3310375213623, "num_metric_batches_dropped": 0, "time_this_iter_s": 34.636136293411255, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87ba8c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87ba840>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87ba7b8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87ba730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 39347, "timesteps_since_restore": 597661, "date": "2019-05-30_01-17-04", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.60647636418109, "mean_inference_ms": 1.8017402930495898, "mean_processing_ms": 6.509266973546849}, "training_iteration": 14, "timesteps_total": 597661, "episode_reward_mean": -509.29682549816914, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -24.85724532200327, "episode_len_mean": 310.18, "timestamp": 1559179024, "off_policy_estimator": {}, "time_since_restore": 464.3310375213623, "custom_metrics": {"cost1_max": 219.82185054985405, "cost1_mean": 169.6548344292583, "cost2_mean": -91.18907934029961, "cost2_max": -21.25082918758761, "system_level_velocity_max": 18.705950618645552, "cost2_min": -118.2877139984135, "system_level_velocity_min": 10.34612297454803, "system_level_velocity_mean": 14.959209949136593, "outflow_rate_mean": 1131.4066199066, "cost1_min": 17.89043285110627, "outflow_rate_min": 437.2949997643919, "outflow_rate_max": 1409.8718275778251}, "iterations_since_restore": 14}
{"info": {"num_steps_sampled": 635334, "sample_time_ms": 20797.417, "update_time_ms": 10.734, "learner": {"default_policy": {"kl": 0.008870327845215797, "policy_loss": -0.002778216963633895, "entropy": 1.3479430675506592, "total_loss": 24.02800750732422, "vf_explained_var": 0.8467218279838562, "vf_loss": 24.030344009399414, "cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11264.642, "load_time_ms": 6.458, "num_steps_trained": 634368}, "node_ip": "10.138.0.2", "episodes_this_iter": 43, "episodes_total": 690, "pid": 45081, "episode_reward_min": -786.0971978242413, "time_total_s": 493.76837062835693, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.43733310699463, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87baa60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87ba9d8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87ba048>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bad90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 37673, "timesteps_since_restore": 635334, "date": "2019-05-30_01-17-33", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.570166368447516, "mean_inference_ms": 1.8005417453701498, "mean_processing_ms": 6.5257492801160835}, "training_iteration": 15, "timesteps_total": 635334, "episode_reward_mean": -461.50714989951416, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -24.85724532200327, "episode_len_mean": 310.18, "timestamp": 1559179053, "off_policy_estimator": {}, "time_since_restore": 493.76837062835693, "custom_metrics": {"cost1_max": 219.82185054985405, "cost1_mean": 172.7955678968372, "cost2_mean": -84.66547753615598, "cost2_max": -21.25082918758761, "system_level_velocity_max": 18.705950618645552, "cost2_min": -113.03214097981392, "system_level_velocity_min": 10.34612297454803, "system_level_velocity_mean": 15.2153955907451, "outflow_rate_mean": 1135.9946160334391, "cost1_min": 17.89043285110627, "outflow_rate_min": 437.2949997643919, "outflow_rate_max": 1400.4033756714628}, "iterations_since_restore": 15}
{"info": {"num_steps_sampled": 671968, "sample_time_ms": 20480.624, "update_time_ms": 10.41, "learner": {"default_policy": {"kl": 0.00732324318960309, "policy_loss": -0.0027317951899021864, "entropy": 1.3450790643692017, "total_loss": 23.418384552001953, "vf_explained_var": 0.8500491976737976, "vf_loss": 23.42074966430664, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11257.76, "load_time_ms": 6.307, "num_steps_trained": 670976}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 730, "pid": 45081, "episode_reward_min": -704.7762630903514, "time_total_s": 521.3114314079285, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.543060779571533, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9fc80>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9fb70>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f2f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 36634, "timesteps_since_restore": 671968, "date": "2019-05-30_01-18-01", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.458566360249343, "mean_inference_ms": 1.797520063010814, "mean_processing_ms": 6.485598673795449}, "training_iteration": 16, "timesteps_total": 671968, "episode_reward_mean": -445.0125139694834, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -33.388745902574534, "episode_len_mean": 322.1, "timestamp": 1559179081, "off_policy_estimator": {}, "time_since_restore": 521.3114314079285, "custom_metrics": {"cost1_max": 219.36989236219353, "cost1_mean": 182.17578571488008, "cost2_mean": -81.65909642346898, "cost2_max": -24.15232739395269, "system_level_velocity_max": 18.45166242374424, "cost2_min": -111.89528623738751, "system_level_velocity_min": 11.439183854753107, "system_level_velocity_mean": 15.350396186713876, "outflow_rate_mean": 1170.780908276947, "cost1_min": 22.993966404116797, "outflow_rate_min": 465.10626898076305, "outflow_rate_max": 1400.4033756714628}, "iterations_since_restore": 16}
{"info": {"num_steps_sampled": 707627, "sample_time_ms": 20143.368, "update_time_ms": 10.918, "learner": {"default_policy": {"kl": 0.007645280100405216, "policy_loss": -0.002692651469260454, "entropy": 1.3525431156158447, "total_loss": 29.6566219329834, "vf_explained_var": 0.8233916163444519, "vf_loss": 29.658933639526367, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11055.243, "load_time_ms": 6.157, "num_steps_trained": 706560}, "node_ip": "10.138.0.2", "episodes_this_iter": 58, "episodes_total": 788, "pid": 45081, "episode_reward_min": -646.6005042431494, "time_total_s": 551.053703546524, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.74227213859558, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a51e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a59d8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a5ae8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a56a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 35659, "timesteps_since_restore": 707627, "date": "2019-05-30_01-18-30", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.27353308104716, "mean_inference_ms": 1.7902681854715659, "mean_processing_ms": 6.4907672158882885}, "training_iteration": 17, "timesteps_total": 707627, "episode_reward_mean": -426.08377810917483, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -23.956554969421678, "episode_len_mean": 322.02, "timestamp": 1559179110, "off_policy_estimator": {}, "time_since_restore": 551.053703546524, "custom_metrics": {"cost1_max": 221.83519507611544, "cost1_mean": 181.10720773945093, "cost2_mean": -75.03373784255241, "cost2_max": -17.443873030094274, "system_level_velocity_max": 18.669932536908544, "cost2_min": -113.14096123420958, "system_level_velocity_min": 11.283702298866721, "system_level_velocity_mean": 15.307259564080832, "outflow_rate_mean": 1152.2504072558122, "cost1_min": 17.854092778325434, "outflow_rate_min": 477.24354782665716, "outflow_rate_max": 1382.4976653695758}, "iterations_since_restore": 17}
{"info": {"num_steps_sampled": 741746, "sample_time_ms": 19888.321, "update_time_ms": 10.887, "learner": {"default_policy": {"kl": 0.009019019082188606, "policy_loss": -0.0026926747523248196, "entropy": 1.334736704826355, "total_loss": 19.559757232666016, "vf_explained_var": 0.8770629167556763, "vf_loss": 19.562000274658203, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10880.649, "load_time_ms": 6.126, "num_steps_trained": 740608}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 830, "pid": 45081, "episode_reward_min": -652.7120382619084, "time_total_s": 577.7998659610748, "num_metric_batches_dropped": 0, "time_this_iter_s": 26.74616241455078, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a5048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a5488>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a5b70>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a52f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 34119, "timesteps_since_restore": 741746, "date": "2019-05-30_01-18-57", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.103550150689276, "mean_inference_ms": 1.7828501718290461, "mean_processing_ms": 6.514871744543621}, "training_iteration": 18, "timesteps_total": 741746, "episode_reward_mean": -418.7481873968095, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -23.956554969421678, "episode_len_mean": 322.02, "timestamp": 1559179137, "off_policy_estimator": {}, "time_since_restore": 577.7998659610748, "custom_metrics": {"cost1_max": 221.83519507611544, "cost1_mean": 178.29042717266918, "cost2_mean": -68.92474483682305, "cost2_max": -17.443873030094274, "system_level_velocity_max": 18.669932536908544, "cost2_min": -113.14096123420958, "system_level_velocity_min": 10.91248065429236, "system_level_velocity_mean": 15.153405186782768, "outflow_rate_mean": 1124.5268765688772, "cost1_min": 17.854092778325434, "outflow_rate_min": 477.24354782665716, "outflow_rate_max": 1382.4976653695758}, "iterations_since_restore": 18}
{"info": {"num_steps_sampled": 774322, "sample_time_ms": 19513.21, "update_time_ms": 10.382, "learner": {"default_policy": {"kl": 0.010186831466853619, "policy_loss": -0.004872683435678482, "entropy": 1.331968069076538, "total_loss": 21.851783752441406, "vf_explained_var": 0.8495609760284424, "vf_loss": 21.85614776611328, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10655.948, "load_time_ms": 6.189, "num_steps_trained": 773120}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 872, "pid": 45081, "episode_reward_min": -652.7120382619084, "time_total_s": 603.4959309101105, "num_metric_batches_dropped": 0, "time_this_iter_s": 25.696064949035645, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007ae8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007950>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007e18>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 32576, "timesteps_since_restore": 774322, "date": "2019-05-30_01-19-23", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.8918362052401, "mean_inference_ms": 1.7689016446919796, "mean_processing_ms": 6.4819875151089965}, "training_iteration": 19, "timesteps_total": 774322, "episode_reward_mean": -400.3992576756235, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -176.98051915796367, "episode_len_mean": 323.82, "timestamp": 1559179163, "off_policy_estimator": {}, "time_since_restore": 603.4959309101105, "custom_metrics": {"cost1_max": 215.8587757898383, "cost1_mean": 179.34387138169578, "cost2_mean": -62.37010943252037, "cost2_max": -44.73965557702011, "system_level_velocity_max": 18.56269789683117, "cost2_min": -90.05274296379783, "system_level_velocity_min": 10.91248065429236, "system_level_velocity_mean": 15.23066438340241, "outflow_rate_mean": 1111.3575027597776, "cost1_min": 129.39997910578444, "outflow_rate_min": 901.2902557603687, "outflow_rate_max": 1344.3573287780077}, "iterations_since_restore": 19}
{"info": {"num_steps_sampled": 810431, "sample_time_ms": 19124.818, "update_time_ms": 10.245, "learner": {"default_policy": {"kl": 0.010821087285876274, "policy_loss": -0.004038449842482805, "entropy": 1.3224408626556396, "total_loss": 34.82851791381836, "vf_explained_var": 0.8236761689186096, "vf_loss": 34.83201599121094, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10472.913, "load_time_ms": 5.909, "num_steps_trained": 809216}, "node_ip": "10.138.0.2", "episodes_this_iter": 56, "episodes_total": 928, "pid": 45081, "episode_reward_min": -674.0543501627383, "time_total_s": 631.6872735023499, "num_metric_batches_dropped": 0, "time_this_iter_s": 28.19134259223938, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a98c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9840>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a97b8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 36109, "timesteps_since_restore": 810431, "date": "2019-05-30_01-19-51", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.60710599992264, "mean_inference_ms": 1.7505424575751412, "mean_processing_ms": 6.468476773506458}, "training_iteration": 20, "timesteps_total": 810431, "episode_reward_mean": -396.48443425084207, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -176.98051915796367, "episode_len_mean": 323.54, "timestamp": 1559179191, "off_policy_estimator": {}, "time_since_restore": 631.6872735023499, "custom_metrics": {"cost1_max": 222.87405874976912, "cost1_mean": 183.87200050177142, "cost2_mean": -68.75613475089814, "cost2_max": -44.53823116441895, "system_level_velocity_max": 18.63160961996139, "cost2_min": -114.36934749387146, "system_level_velocity_min": 11.351033583855827, "system_level_velocity_mean": 15.598627425887122, "outflow_rate_mean": 1135.421831703529, "cost1_min": 136.52349116690732, "outflow_rate_min": 901.2902557603687, "outflow_rate_max": 1412.0787143543264}, "iterations_since_restore": 20}
{"info": {"num_steps_sampled": 848486, "sample_time_ms": 18890.191, "update_time_ms": 10.248, "learner": {"default_policy": {"kl": 0.008289857767522335, "policy_loss": -0.0035848834086209536, "entropy": 1.293263554573059, "total_loss": 31.521162033081055, "vf_explained_var": 0.8556773066520691, "vf_loss": 31.524328231811523, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10339.316, "load_time_ms": 5.684, "num_steps_trained": 847232}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 969, "pid": 45081, "episode_reward_min": -736.2828704368801, "time_total_s": 659.5410168170929, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.853743314743042, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9d08>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9c80>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9bf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 38055, "timesteps_since_restore": 848486, "date": "2019-05-30_01-20-19", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.49274089672878, "mean_inference_ms": 1.7410042021769672, "mean_processing_ms": 6.469103083295343}, "training_iteration": 21, "timesteps_total": 848486, "episode_reward_mean": -434.5831263336515, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -176.98051915796367, "episode_len_mean": 323.54, "timestamp": 1559179219, "off_policy_estimator": {}, "time_since_restore": 659.5410168170929, "custom_metrics": {"cost1_max": 222.87405874976912, "cost1_mean": 183.1909068793276, "cost2_mean": -82.23864335428982, "cost2_max": -44.53823116441895, "system_level_velocity_max": 18.746336941418186, "cost2_min": -114.36934749387146, "system_level_velocity_min": 11.351033583855827, "system_level_velocity_mean": 15.469253527208437, "outflow_rate_mean": 1156.5784033218267, "cost1_min": 136.52349116690732, "outflow_rate_min": 901.6, "outflow_rate_max": 1412.0787143543264}, "iterations_since_restore": 21}
{"info": {"num_steps_sampled": 888339, "sample_time_ms": 18917.789, "update_time_ms": 10.421, "learner": {"default_policy": {"kl": 0.010555223561823368, "policy_loss": -0.00336673716083169, "entropy": 1.2765430212020874, "total_loss": 35.66456985473633, "vf_explained_var": 0.8418182730674744, "vf_loss": 35.66740798950195, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10226.867, "load_time_ms": 5.689, "num_steps_trained": 887040}, "node_ip": "10.138.0.2", "episodes_this_iter": 44, "episodes_total": 1013, "pid": 45081, "episode_reward_min": -736.2828704368801, "time_total_s": 689.5337071418762, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.992690324783325, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f9d8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f378>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9fd08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 39853, "timesteps_since_restore": 888339, "date": "2019-05-30_01-20-49", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.42327275515962, "mean_inference_ms": 1.7335719225514372, "mean_processing_ms": 6.443653322848656}, "training_iteration": 22, "timesteps_total": 888339, "episode_reward_mean": -461.5349405713346, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -108.02902154355337, "episode_len_mean": 323.0, "timestamp": 1559179249, "off_policy_estimator": {}, "time_since_restore": 689.5337071418762, "custom_metrics": {"cost1_max": 222.87405874976912, "cost1_mean": 182.83567714651315, "cost2_mean": -92.46439196545526, "cost2_max": -52.03687114482447, "system_level_velocity_max": 18.785602464896385, "cost2_min": -118.7142484435487, "system_level_velocity_min": 11.351033583855827, "system_level_velocity_mean": 15.434865494060881, "outflow_rate_mean": 1173.9902719526203, "cost1_min": 84.75723027275593, "outflow_rate_min": 807.9152781785647, "outflow_rate_max": 1412.0787143543264}, "iterations_since_restore": 22}
{"info": {"num_steps_sampled": 927659, "sample_time_ms": 18826.741, "update_time_ms": 10.282, "learner": {"default_policy": {"kl": 0.010247668251395226, "policy_loss": -0.0033263254445046186, "entropy": 1.283003330230713, "total_loss": 28.668413162231445, "vf_explained_var": 0.8644942045211792, "vf_loss": 28.671228408813477, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10082.923, "load_time_ms": 5.527, "num_steps_trained": 926336}, "node_ip": "10.138.0.2", "episodes_this_iter": 51, "episodes_total": 1064, "pid": 45081, "episode_reward_min": -708.9111716838504, "time_total_s": 719.838785648346, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.305078506469727, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b6a60>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b69d8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b6950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 39320, "timesteps_since_restore": 927659, "date": "2019-05-30_01-21-19", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.381121875836197, "mean_inference_ms": 1.7279540731279948, "mean_processing_ms": 6.431553882252408}, "training_iteration": 23, "timesteps_total": 927659, "episode_reward_mean": -478.9741740039216, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -108.02902154355337, "episode_len_mean": 322.72, "timestamp": 1559179279, "off_policy_estimator": {}, "time_since_restore": 719.838785648346, "custom_metrics": {"cost1_max": 222.96610430392732, "cost1_mean": 183.51968914089636, "cost2_mean": -99.57229821158444, "cost2_max": -52.03687114482447, "system_level_velocity_max": 18.785602464896385, "cost2_min": -121.67886628909568, "system_level_velocity_min": 10.602835418721558, "system_level_velocity_mean": 15.490744856380127, "outflow_rate_mean": 1193.6362614885466, "cost1_min": 84.75723027275593, "outflow_rate_min": 807.9152781785647, "outflow_rate_max": 1417.1632933255264}, "iterations_since_restore": 23}
{"info": {"num_steps_sampled": 966315, "sample_time_ms": 18523.208, "update_time_ms": 10.343, "learner": {"default_policy": {"kl": 0.012783931568264961, "policy_loss": -0.005285667255520821, "entropy": 1.2767525911331177, "total_loss": 26.508995056152344, "vf_explained_var": 0.8692916035652161, "vf_loss": 26.513639450073242, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9862.854, "load_time_ms": 5.633, "num_steps_trained": 964992}, "node_ip": "10.138.0.2", "episodes_this_iter": 47, "episodes_total": 1111, "pid": 45081, "episode_reward_min": -710.1523963276245, "time_total_s": 749.2039654254913, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.365179777145386, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9c80>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab032620>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab032730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 38656, "timesteps_since_restore": 966315, "date": "2019-05-30_01-21-49", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.333138492293784, "mean_inference_ms": 1.7229208700463294, "mean_processing_ms": 6.439705800202645}, "training_iteration": 24, "timesteps_total": 966315, "episode_reward_mean": -472.7495097196848, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -97.11488854618392, "episode_len_mean": 322.64, "timestamp": 1559179309, "off_policy_estimator": {}, "time_since_restore": 749.2039654254913, "custom_metrics": {"cost1_max": 222.96610430392732, "cost1_mean": 184.28966646011978, "cost2_mean": -99.20290414141354, "cost2_max": -47.251370108712194, "system_level_velocity_max": 18.802807289360707, "cost2_min": -121.67886628909568, "system_level_velocity_min": 10.602835418721558, "system_level_velocity_mean": 15.566577704601384, "outflow_rate_mean": 1197.0927004136865, "cost1_min": 79.91824352748611, "outflow_rate_min": 765.5557090601028, "outflow_rate_max": 1417.1632933255264}, "iterations_since_restore": 24}
{"info": {"num_steps_sampled": 1004919, "sample_time_ms": 18610.593, "update_time_ms": 9.811, "learner": {"default_policy": {"kl": 0.010096455924212933, "policy_loss": -0.004288980271667242, "entropy": 1.25734281539917, "total_loss": 24.285913467407227, "vf_explained_var": 0.8791970014572144, "vf_loss": 24.289697647094727, "cur_kl_coeff": 0.050000011920928955, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9874.987, "load_time_ms": 5.714, "num_steps_trained": 1003520}, "node_ip": "10.138.0.2", "episodes_this_iter": 44, "episodes_total": 1155, "pid": 45081, "episode_reward_min": -710.1523963276245, "time_total_s": 779.6392793655396, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.435313940048218, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b66a8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b6510>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b6620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 38604, "timesteps_since_restore": 1004919, "date": "2019-05-30_01-22-19", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.298200697041594, "mean_inference_ms": 1.718738567708847, "mean_processing_ms": 6.444292034251337}, "training_iteration": 25, "timesteps_total": 1004919, "episode_reward_mean": -449.16317763597965, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -32.018316081395376, "episode_len_mean": 317.95, "timestamp": 1559179339, "off_policy_estimator": {}, "time_since_restore": 779.6392793655396, "custom_metrics": {"cost1_max": 222.95213048558605, "cost1_mean": 183.97653168042712, "cost2_mean": -95.75140967897774, "cost2_max": -23.976089675380816, "system_level_velocity_max": 18.806693931004727, "cost2_min": -121.62119425431075, "system_level_velocity_min": 11.906623305946036, "system_level_velocity_mean": 15.827839889640789, "outflow_rate_mean": 1186.439204125897, "cost1_min": 23.78173795634855, "outflow_rate_min": 502.7100746898351, "outflow_rate_max": 1397.4670809248562}, "iterations_since_restore": 25}
{"info": {"num_steps_sampled": 1043729, "sample_time_ms": 18891.08, "update_time_ms": 9.833, "learner": {"default_policy": {"kl": 0.00971241481602192, "policy_loss": -0.003480912884697318, "entropy": 1.2603222131729126, "total_loss": 28.903522491455078, "vf_explained_var": 0.844192624092102, "vf_loss": 28.906517028808594, "cur_kl_coeff": 0.050000011920928955, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9837.205, "load_time_ms": 5.957, "num_steps_trained": 1042304}, "node_ip": "10.138.0.2", "episodes_this_iter": 50, "episodes_total": 1205, "pid": 45081, "episode_reward_min": -758.6467970331177, "time_total_s": 809.610600233078, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.971320867538452, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b6ae8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b6a60>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b67b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 38810, "timesteps_since_restore": 1043729, "date": "2019-05-30_01-22-49", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.280281515959768, "mean_inference_ms": 1.7180832587390718, "mean_processing_ms": 6.442601264060322}, "training_iteration": 26, "timesteps_total": 1043729, "episode_reward_mean": -451.11847004243515, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -32.018316081395376, "episode_len_mean": 317.95, "timestamp": 1559179369, "off_policy_estimator": {}, "time_since_restore": 809.610600233078, "custom_metrics": {"cost1_max": 220.70732126874555, "cost1_mean": 183.81445467859555, "cost2_mean": -96.10634536093988, "cost2_max": -23.976089675380816, "system_level_velocity_max": 18.806693931004727, "cost2_min": -121.62119425431075, "system_level_velocity_min": 11.745999298238784, "system_level_velocity_mean": 15.823717303446047, "outflow_rate_mean": 1177.5838311535128, "cost1_min": 23.78173795634855, "outflow_rate_min": 502.7100746898351, "outflow_rate_max": 1376.3015971460763}, "iterations_since_restore": 26}
{"info": {"num_steps_sampled": 1081586, "sample_time_ms": 18848.487, "update_time_ms": 9.91, "learner": {"default_policy": {"kl": 0.008879635483026505, "policy_loss": -0.003258165204897523, "entropy": 1.250818133354187, "total_loss": 19.56273078918457, "vf_explained_var": 0.8878702521324158, "vf_loss": 19.5655460357666, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9835.241, "load_time_ms": 5.994, "num_steps_trained": 1080064}, "node_ip": "10.138.0.2", "episodes_this_iter": 45, "episodes_total": 1250, "pid": 45081, "episode_reward_min": -758.6467970331177, "time_total_s": 838.9221930503845, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.31159281730652, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab032730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab032620>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9b70>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 37857, "timesteps_since_restore": 1081586, "date": "2019-05-30_01-23-19", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.277589933125384, "mean_inference_ms": 1.7201109636590202, "mean_processing_ms": 6.445287140920776}, "training_iteration": 27, "timesteps_total": 1081586, "episode_reward_mean": -461.7970740863822, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -97.37260555307745, "episode_len_mean": 322.92, "timestamp": 1559179399, "off_policy_estimator": {}, "time_since_restore": 838.9221930503845, "custom_metrics": {"cost1_max": 220.61496164739603, "cost1_mean": 183.3587009721924, "cost2_mean": -94.19843065454077, "cost2_max": -48.114191513048546, "system_level_velocity_max": 18.628389069828465, "cost2_min": -119.97594627426007, "system_level_velocity_min": 11.745999298238784, "system_level_velocity_mean": 15.517566893045917, "outflow_rate_mean": 1169.6458115269163, "cost1_min": 79.75803147007193, "outflow_rate_min": 766.6896069177591, "outflow_rate_max": 1367.2249685103202}, "iterations_since_restore": 27}
{"info": {"num_steps_sampled": 1119686, "sample_time_ms": 19182.337, "update_time_ms": 10.215, "learner": {"default_policy": {"kl": 0.009161455556750298, "policy_loss": -0.003650125116109848, "entropy": 1.243578314781189, "total_loss": 23.613481521606445, "vf_explained_var": 0.8624723553657532, "vf_loss": 23.616674423217773, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9737.849, "load_time_ms": 6.02, "num_steps_trained": 1118080}, "node_ip": "10.138.0.2", "episodes_this_iter": 45, "episodes_total": 1295, "pid": 45081, "episode_reward_min": -758.6467970331177, "time_total_s": 868.0362000465393, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.114006996154785, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f598>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f840>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9fb70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 38100, "timesteps_since_restore": 1119686, "date": "2019-05-30_01-23-48", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.28100996805896, "mean_inference_ms": 1.7231216864877956, "mean_processing_ms": 6.458161700819988}, "training_iteration": 28, "timesteps_total": 1119686, "episode_reward_mean": -462.84071062446327, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -94.33855374179113, "episode_len_mean": 320.84, "timestamp": 1559179428, "off_policy_estimator": {}, "time_since_restore": 868.0362000465393, "custom_metrics": {"cost1_max": 220.61496164739603, "cost1_mean": 181.08704871241505, "cost2_mean": -92.81584455526931, "cost2_max": -48.114191513048546, "system_level_velocity_max": 19.022061229717576, "cost2_min": -125.46270983282135, "system_level_velocity_min": 11.745999298238784, "system_level_velocity_mean": 15.459569298989063, "outflow_rate_mean": 1160.9954760217618, "cost1_min": 79.75803147007193, "outflow_rate_min": 766.6896069177591, "outflow_rate_max": 1368.11860260771}, "iterations_since_restore": 28}
{"info": {"num_steps_sampled": 1156789, "sample_time_ms": 19645.759, "update_time_ms": 9.986, "learner": {"default_policy": {"kl": 0.009918879717588425, "policy_loss": -0.003726216731593013, "entropy": 1.234969973564148, "total_loss": 23.908466339111328, "vf_explained_var": 0.8564358353614807, "vf_loss": 23.911697387695312, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9690.59, "load_time_ms": 5.964, "num_steps_trained": 1155072}, "node_ip": "10.138.0.2", "episodes_this_iter": 44, "episodes_total": 1339, "pid": 45081, "episode_reward_min": -689.0741520786161, "time_total_s": 897.8752319812775, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.83903193473816, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab032620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007a60>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007c80>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 37103, "timesteps_since_restore": 1156789, "date": "2019-05-30_01-24-18", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.27854776947688, "mean_inference_ms": 1.7267575865075897, "mean_processing_ms": 6.458937903624644}, "training_iteration": 29, "timesteps_total": 1156789, "episode_reward_mean": -437.02396097576616, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -94.33855374179113, "episode_len_mean": 322.72, "timestamp": 1559179458, "off_policy_estimator": {}, "time_since_restore": 897.8752319812775, "custom_metrics": {"cost1_max": 221.90298769066294, "cost1_mean": 188.47905220805012, "cost2_mean": -92.83143653974204, "cost2_max": -48.2533339929565, "system_level_velocity_max": 19.022061229717576, "cost2_min": -125.46270983282135, "system_level_velocity_min": 12.380531658269481, "system_level_velocity_mean": 15.980894779803561, "outflow_rate_mean": 1193.9380481942649, "cost1_min": 80.84038260098622, "outflow_rate_min": 777.6025638575337, "outflow_rate_max": 1376.8446233615396}, "iterations_since_restore": 29}
{"info": {"num_steps_sampled": 1192780, "sample_time_ms": 19879.431, "update_time_ms": 9.875, "learner": {"default_policy": {"kl": 0.009270465932786465, "policy_loss": -0.0044244760647416115, "entropy": 1.229433536529541, "total_loss": 24.188581466674805, "vf_explained_var": 0.8465777039527893, "vf_loss": 24.192541122436523, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9574.002, "load_time_ms": 6.059, "num_steps_trained": 1191040}, "node_ip": "10.138.0.2", "episodes_this_iter": 53, "episodes_total": 1392, "pid": 45081, "episode_reward_min": -639.2360784009597, "time_total_s": 927.2282497882843, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.353017807006836, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9488>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9378>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a92f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 35991, "timesteps_since_restore": 1192780, "date": "2019-05-30_01-24-47", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.260526100526533, "mean_inference_ms": 1.7299943444872556, "mean_processing_ms": 6.4675813305418295}, "training_iteration": 30, "timesteps_total": 1192780, "episode_reward_mean": -414.53742755907865, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -33.875059476735636, "episode_len_mean": 321.92, "timestamp": 1559179487, "off_policy_estimator": {}, "time_since_restore": 927.2282497882843, "custom_metrics": {"cost1_max": 221.90298769066294, "cost1_mean": 189.50575755574596, "cost2_mean": -89.19967299395395, "cost2_max": -24.703170679045197, "system_level_velocity_max": 18.748641446075666, "cost2_min": -125.02006084616352, "system_level_velocity_min": 11.637908246344978, "system_level_velocity_mean": 16.135606446671037, "outflow_rate_mean": 1194.4096583146288, "cost1_min": 24.551246557671195, "outflow_rate_min": 472.1492185913592, "outflow_rate_max": 1376.8446233615396}, "iterations_since_restore": 30}
{"info": {"num_steps_sampled": 1227726, "sample_time_ms": 19979.54, "update_time_ms": 9.589, "learner": {"default_policy": {"kl": 0.012063870206475258, "policy_loss": -0.0034631649032235146, "entropy": 1.2361284494400024, "total_loss": 22.371992111206055, "vf_explained_var": 0.8479059934616089, "vf_loss": 22.374849319458008, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9455.821, "load_time_ms": 6.088, "num_steps_trained": 1225984}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 1434, "pid": 45081, "episode_reward_min": -696.2590259243067, "time_total_s": 954.8947596549988, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.666509866714478, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b6730>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b6840>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b68c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 34946, "timesteps_since_restore": 1227726, "date": "2019-05-30_01-25-15", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.211646781777052, "mean_inference_ms": 1.727411031379264, "mean_processing_ms": 6.469922345925343}, "training_iteration": 31, "timesteps_total": 1227726, "episode_reward_mean": -406.1112783004694, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -33.875059476735636, "episode_len_mean": 322.12, "timestamp": 1559179515, "off_policy_estimator": {}, "time_since_restore": 954.8947596549988, "custom_metrics": {"cost1_max": 220.88036935722442, "cost1_mean": 189.22977367586384, "cost2_mean": -86.72079283650027, "cost2_max": -24.703170679045197, "system_level_velocity_max": 18.74220341290455, "cost2_min": -116.80940575877074, "system_level_velocity_min": 11.637908246344978, "system_level_velocity_mean": 16.136797904580888, "outflow_rate_mean": 1187.149086214424, "cost1_min": 24.551246557671195, "outflow_rate_min": 472.1492185913592, "outflow_rate_max": 1365.7224675454252}, "iterations_since_restore": 31}
{"info": {"num_steps_sampled": 1265061, "sample_time_ms": 19966.632, "update_time_ms": 9.506, "learner": {"default_policy": {"kl": 0.010777493007481098, "policy_loss": -0.004952766466885805, "entropy": 1.2218139171600342, "total_loss": 24.55501365661621, "vf_explained_var": 0.85691899061203, "vf_loss": 24.559425354003906, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9402.646, "load_time_ms": 6.096, "num_steps_trained": 1263232}, "node_ip": "10.138.0.2", "episodes_this_iter": 46, "episodes_total": 1480, "pid": 45081, "episode_reward_min": -696.2590259243067, "time_total_s": 984.2271752357483, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.33241558074951, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6e18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b6488>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b6f28>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b6d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 37335, "timesteps_since_restore": 1265061, "date": "2019-05-30_01-25-44", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.134990113322683, "mean_inference_ms": 1.7218045580624284, "mean_processing_ms": 6.461239147176172}, "training_iteration": 32, "timesteps_total": 1265061, "episode_reward_mean": -418.7393803970678, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -280.4128908475759, "episode_len_mean": 325.0, "timestamp": 1559179544, "off_policy_estimator": {}, "time_since_restore": 984.2271752357483, "custom_metrics": {"cost1_max": 220.88036935722442, "cost1_mean": 187.8009412081545, "cost2_mean": -87.08444210678985, "cost2_max": -48.54695499794404, "system_level_velocity_max": 18.726126690249572, "cost2_min": -117.94841779292278, "system_level_velocity_min": 11.853867545209198, "system_level_velocity_mean": 15.858673864358284, "outflow_rate_mean": 1177.9313707407052, "cost1_min": 139.29352626146655, "outflow_rate_min": 891.9942849264704, "outflow_rate_max": 1365.7224675454252}, "iterations_since_restore": 32}
{"info": {"num_steps_sampled": 1301318, "sample_time_ms": 19928.503, "update_time_ms": 9.473, "learner": {"default_policy": {"kl": 0.01273837499320507, "policy_loss": -0.006328592076897621, "entropy": 1.2227215766906738, "total_loss": 21.58783531188965, "vf_explained_var": 0.8728743195533752, "vf_loss": 21.59352684020996, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9401.526, "load_time_ms": 6.081, "num_steps_trained": 1299456}, "node_ip": "10.138.0.2", "episodes_this_iter": 52, "episodes_total": 1532, "pid": 45081, "episode_reward_min": -675.481614841296, "time_total_s": 1014.1404547691345, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.91327953338623, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab0327b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab032620>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9158>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a90d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 36257, "timesteps_since_restore": 1301318, "date": "2019-05-30_01-26-14", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.065530120554524, "mean_inference_ms": 1.7165908742788896, "mean_processing_ms": 6.461367867138907}, "training_iteration": 33, "timesteps_total": 1301318, "episode_reward_mean": -445.4090308703811, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -289.5745494673063, "episode_len_mean": 325.0, "timestamp": 1559179574, "off_policy_estimator": {}, "time_since_restore": 1014.1404547691345, "custom_metrics": {"cost1_max": 219.38551529071515, "cost1_mean": 181.8088470275721, "cost2_mean": -88.25506252049583, "cost2_max": -42.82725494510075, "system_level_velocity_max": 18.5157219701056, "cost2_min": -117.94841779292278, "system_level_velocity_min": 11.853867545209198, "system_level_velocity_mean": 15.312794043566049, "outflow_rate_mean": 1154.9624721348875, "cost1_min": 139.29352626146655, "outflow_rate_min": 891.9942849264704, "outflow_rate_max": 1380.8309353866798}, "iterations_since_restore": 33}
{"info": {"num_steps_sampled": 1335135, "sample_time_ms": 19615.658, "update_time_ms": 9.427, "learner": {"default_policy": {"kl": 0.009557396173477173, "policy_loss": -0.004892662633210421, "entropy": 1.2314457893371582, "total_loss": 19.191848754882812, "vf_explained_var": 0.872326672077179, "vf_loss": 19.19626235961914, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9632.667, "load_time_ms": 5.821, "num_steps_trained": 1333248}, "node_ip": "10.138.0.2", "episodes_this_iter": 43, "episodes_total": 1575, "pid": 45081, "episode_reward_min": -648.1496084523753, "time_total_s": 1042.8288414478302, "num_metric_batches_dropped": 0, "time_this_iter_s": 28.68838667869568, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf96488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf96400>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf96378>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf962f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 33817, "timesteps_since_restore": 1335135, "date": "2019-05-30_01-26-43", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.99449724886795, "mean_inference_ms": 1.7105022652976043, "mean_processing_ms": 6.452048047624966}, "training_iteration": 34, "timesteps_total": 1335135, "episode_reward_mean": -415.96298980947626, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -31.85575502513587, "episode_len_mean": 322.1, "timestamp": 1559179603, "off_policy_estimator": {}, "time_since_restore": 1042.8288414478302, "custom_metrics": {"cost1_max": 219.38551529071515, "cost1_mean": 182.99757398157323, "cost2_mean": -82.34488717610895, "cost2_max": -22.608722079163044, "system_level_velocity_max": 18.785273988260546, "cost2_min": -116.11461161982861, "system_level_velocity_min": 12.214907850172057, "system_level_velocity_mean": 15.604255182268053, "outflow_rate_mean": 1155.1330519308058, "cost1_min": 23.255770732488976, "outflow_rate_min": 473.20973104725, "outflow_rate_max": 1380.8309353866798}, "iterations_since_restore": 34}
{"info": {"num_steps_sampled": 1369334, "sample_time_ms": 20935.562, "update_time_ms": 11.888, "learner": {"default_policy": {"kl": 0.011482631787657738, "policy_loss": -0.004454864654690027, "entropy": 1.222814679145813, "total_loss": 20.97643280029297, "vf_explained_var": 0.8809254169464111, "vf_loss": 20.980314254760742, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9552.884, "load_time_ms": 6.614, "num_steps_trained": 1367424}, "node_ip": "10.138.0.2", "episodes_this_iter": 46, "episodes_total": 1621, "pid": 45081, "episode_reward_min": -593.6084851381511, "time_total_s": 1085.6990718841553, "num_metric_batches_dropped": 0, "time_this_iter_s": 42.87023043632507, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a98c8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9730>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 34199, "timesteps_since_restore": 1369334, "date": "2019-05-30_01-27-29", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.069843083695872, "mean_inference_ms": 1.743807855617275, "mean_processing_ms": 6.488130789411448}, "training_iteration": 35, "timesteps_total": 1369334, "episode_reward_mean": -390.7393885241896, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -31.85575502513587, "episode_len_mean": 322.1, "timestamp": 1559179649, "off_policy_estimator": {}, "time_since_restore": 1085.6990718841553, "custom_metrics": {"cost1_max": 220.52092018486678, "cost1_mean": 185.98618603363786, "cost2_mean": -77.3573890367117, "cost2_max": -22.608722079163044, "system_level_velocity_max": 18.785273988260546, "cost2_min": -108.95754878269348, "system_level_velocity_min": 12.375328635083033, "system_level_velocity_mean": 15.889337564484393, "outflow_rate_mean": 1162.9407487336161, "cost1_min": 23.255770732488976, "outflow_rate_min": 473.20973104725, "outflow_rate_max": 1353.8201482681602}, "iterations_since_restore": 35}
{"info": {"num_steps_sampled": 1405740, "sample_time_ms": 20795.857, "update_time_ms": 11.847, "learner": {"default_policy": {"kl": 0.010034243576228619, "policy_loss": -0.004185679368674755, "entropy": 1.215775728225708, "total_loss": 22.438785552978516, "vf_explained_var": 0.8758777976036072, "vf_loss": 22.442468643188477, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9493.418, "load_time_ms": 6.523, "num_steps_trained": 1403776}, "node_ip": "10.138.0.2", "episodes_this_iter": 47, "episodes_total": 1668, "pid": 45081, "episode_reward_min": -641.3003784972931, "time_total_s": 1113.6684396266937, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.969367742538452, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b6598>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b67b8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b61e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 36406, "timesteps_since_restore": 1405740, "date": "2019-05-30_01-27-57", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.19312144045659, "mean_inference_ms": 1.7810542558522258, "mean_processing_ms": 6.524008754739815}, "training_iteration": 36, "timesteps_total": 1405740, "episode_reward_mean": -394.5607808914976, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -271.227263799625, "episode_len_mean": 325.0, "timestamp": 1559179677, "off_policy_estimator": {}, "time_since_restore": 1113.6684396266937, "custom_metrics": {"cost1_max": 220.52092018486678, "cost1_mean": 189.96549531257983, "cost2_mean": -82.21196443417315, "cost2_max": -52.50395050788132, "system_level_velocity_max": 18.764732578544685, "cost2_min": -114.60547387654078, "system_level_velocity_min": 12.375328635083033, "system_level_velocity_mean": 16.011878044597157, "outflow_rate_mean": 1189.3414536798566, "cost1_min": 147.3794230533721, "outflow_rate_min": 939.0266063348416, "outflow_rate_max": 1362.4870151988464}, "iterations_since_restore": 36}
{"info": {"num_steps_sampled": 1442200, "sample_time_ms": 20669.579, "update_time_ms": 11.502, "learner": {"default_policy": {"kl": 0.009535280987620354, "policy_loss": -0.004039285238832235, "entropy": 1.2206394672393799, "total_loss": 23.800405502319336, "vf_explained_var": 0.8527082204818726, "vf_loss": 23.803966522216797, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9693.341, "load_time_ms": 6.41, "num_steps_trained": 1440128}, "node_ip": "10.138.0.2", "episodes_this_iter": 47, "episodes_total": 1715, "pid": 45081, "episode_reward_min": -672.1235811264064, "time_total_s": 1143.7067427635193, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.03830313682556, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b6158>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b6ae8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b60d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 36460, "timesteps_since_restore": 1442200, "date": "2019-05-30_01-28-28", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.187612055886856, "mean_inference_ms": 1.7840747754368564, "mean_processing_ms": 6.530545925516992}, "training_iteration": 37, "timesteps_total": 1442200, "episode_reward_mean": -410.13059005952925, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -279.71248676915303, "episode_len_mean": 325.0, "timestamp": 1559179708, "off_policy_estimator": {}, "time_since_restore": 1143.7067427635193, "custom_metrics": {"cost1_max": 219.1444053019044, "cost1_mean": 191.22194407644514, "cost2_mean": -86.91267165512231, "cost2_max": -53.41838395951953, "system_level_velocity_max": 18.527944729922712, "cost2_min": -114.60547387654078, "system_level_velocity_min": 11.781985533163574, "system_level_velocity_mean": 16.0776651309128, "outflow_rate_mean": 1202.012315192778, "cost1_min": 140.84406593857955, "outflow_rate_min": 939.0266063348416, "outflow_rate_max": 1362.4870151988464}, "iterations_since_restore": 37}
{"info": {"num_steps_sampled": 1477850, "sample_time_ms": 20345.944, "update_time_ms": 11.27, "learner": {"default_policy": {"kl": 0.011466028168797493, "policy_loss": -0.005081927869468927, "entropy": 1.200881004333496, "total_loss": 19.89019012451172, "vf_explained_var": 0.8630325794219971, "vf_loss": 19.894699096679688, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9876.211, "load_time_ms": 6.486, "num_steps_trained": 1475712}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 1757, "pid": 45081, "episode_reward_min": -672.1235811264064, "time_total_s": 1171.4344511032104, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.727708339691162, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a91e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9268>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9620>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 35650, "timesteps_since_restore": 1477850, "date": "2019-05-30_01-28-55", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.134646350642797, "mean_inference_ms": 1.7796802260272528, "mean_processing_ms": 6.527115417767906}, "training_iteration": 38, "timesteps_total": 1477850, "episode_reward_mean": -411.87366210118637, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -286.0420634800611, "episode_len_mean": 325.0, "timestamp": 1559179735, "off_policy_estimator": {}, "time_since_restore": 1171.4344511032104, "custom_metrics": {"cost1_max": 219.1444053019044, "cost1_mean": 191.02740980750295, "cost2_mean": -85.55569767529349, "cost2_max": -54.23246020180301, "system_level_velocity_max": 18.433655993711298, "cost2_min": -113.69273171084458, "system_level_velocity_min": 11.781985533163574, "system_level_velocity_mean": 16.035474411438635, "outflow_rate_mean": 1199.4925501851076, "cost1_min": 140.84406593857955, "outflow_rate_min": 973.6513566176474, "outflow_rate_max": 1353.9140184312137}, "iterations_since_restore": 38}
{"info": {"num_steps_sampled": 1511850, "sample_time_ms": 19999.326, "update_time_ms": 11.61, "learner": {"default_policy": {"kl": 0.01184372790157795, "policy_loss": -0.0066799018532037735, "entropy": 1.1932907104492188, "total_loss": 18.020017623901367, "vf_explained_var": 0.8601073026657104, "vf_loss": 18.026105880737305, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9957.066, "load_time_ms": 6.369, "num_steps_trained": 1509632}, "node_ip": "10.138.0.2", "episodes_this_iter": 51, "episodes_total": 1808, "pid": 45081, "episode_reward_min": -605.9146946142106, "time_total_s": 1198.6298258304596, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.195374727249146, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59ef7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59ef730>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59ef6a8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59ef620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 34000, "timesteps_since_restore": 1511850, "date": "2019-05-30_01-29-23", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 16.05910054954131, "mean_inference_ms": 1.7734802996533636, "mean_processing_ms": 6.514347439268908}, "training_iteration": 39, "timesteps_total": 1511850, "episode_reward_mean": -383.4909606330199, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -274.3338456697299, "episode_len_mean": 324.8, "timestamp": 1559179763, "off_policy_estimator": {}, "time_since_restore": 1198.6298258304596, "custom_metrics": {"cost1_max": 219.67643078918334, "cost1_mean": 192.19670709692923, "cost2_mean": -77.46390408942773, "cost2_max": -47.54757764551545, "system_level_velocity_max": 18.606574163092233, "cost2_min": -110.42441243286201, "system_level_velocity_min": 11.328926421953781, "system_level_velocity_mean": 16.21594111482623, "outflow_rate_mean": 1194.3144033788344, "cost1_min": 131.8350788699415, "outflow_rate_min": 907.3658507462685, "outflow_rate_max": 1344.0755582140741}, "iterations_since_restore": 39}
{"info": {"num_steps_sampled": 1546882, "sample_time_ms": 19755.072, "update_time_ms": 11.755, "learner": {"default_policy": {"kl": 0.011579100973904133, "policy_loss": -0.005593252833932638, "entropy": 1.1863617897033691, "total_loss": 19.07942771911621, "vf_explained_var": 0.867027223110199, "vf_loss": 19.084442138671875, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10057.577, "load_time_ms": 6.393, "num_steps_trained": 1544576}, "node_ip": "10.138.0.2", "episodes_this_iter": 45, "episodes_total": 1853, "pid": 45081, "episode_reward_min": -605.9146946142106, "time_total_s": 1226.5460319519043, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.916206121444702, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9950>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a97b8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 35032, "timesteps_since_restore": 1546882, "date": "2019-05-30_01-29-51", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.988975696252705, "mean_inference_ms": 1.7675198359235207, "mean_processing_ms": 6.509428889371273}, "training_iteration": 40, "timesteps_total": 1546882, "episode_reward_mean": -375.71338451005084, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -272.57768506961634, "episode_len_mean": 324.62, "timestamp": 1559179791, "off_policy_estimator": {}, "time_since_restore": 1226.5460319519043, "custom_metrics": {"cost1_max": 219.67643078918334, "cost1_mean": 192.33601693314938, "cost2_mean": -74.9733777446389, "cost2_max": -47.54757764551545, "system_level_velocity_max": 18.606574163092233, "cost2_min": -107.9433275977453, "system_level_velocity_min": 11.328926421953781, "system_level_velocity_mean": 16.265535977456263, "outflow_rate_mean": 1191.6598663631887, "cost1_min": 131.8350788699415, "outflow_rate_min": 907.3658507462685, "outflow_rate_max": 1333.0570641028355}, "iterations_since_restore": 40}
{"info": {"num_steps_sampled": 1582313, "sample_time_ms": 19662.728, "update_time_ms": 11.897, "learner": {"default_policy": {"kl": 0.015557986684143543, "policy_loss": -0.0066290549002587795, "entropy": 1.1665043830871582, "total_loss": 20.742393493652344, "vf_explained_var": 0.8555970788002014, "vf_loss": 20.748245239257812, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10154.846, "load_time_ms": 6.595, "num_steps_trained": 1579904}, "node_ip": "10.138.0.2", "episodes_this_iter": 44, "episodes_total": 1897, "pid": 45081, "episode_reward_min": -638.6501322851113, "time_total_s": 1254.2619950771332, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.715963125228882, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59efc80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59ef0d0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59ef048>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59ef158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 35431, "timesteps_since_restore": 1582313, "date": "2019-05-30_01-30-18", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.930959729437623, "mean_inference_ms": 1.7616512872636738, "mean_processing_ms": 6.506164827767748}, "training_iteration": 41, "timesteps_total": 1582313, "episode_reward_mean": -389.1556764577854, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -272.57768506961634, "episode_len_mean": 324.82, "timestamp": 1559179818, "off_policy_estimator": {}, "time_since_restore": 1254.2619950771332, "custom_metrics": {"cost1_max": 219.67643078918334, "cost1_mean": 190.8595181508333, "cost2_mean": -76.9061262911053, "cost2_max": -51.13804253232112, "system_level_velocity_max": 18.606574163092233, "cost2_min": -107.9433275977453, "system_level_velocity_min": 10.928905312269817, "system_level_velocity_mean": 16.10189015920594, "outflow_rate_mean": 1186.2667618098571, "cost1_min": 128.26419190510444, "outflow_rate_min": 908.116321925891, "outflow_rate_max": 1341.6703664192946}, "iterations_since_restore": 41}
{"info": {"num_steps_sampled": 1616643, "sample_time_ms": 19569.474, "update_time_ms": 11.935, "learner": {"default_policy": {"kl": 0.013142171315848827, "policy_loss": -0.005947205703705549, "entropy": 1.170218825340271, "total_loss": 20.5179386138916, "vf_explained_var": 0.8329169154167175, "vf_loss": 20.523229598999023, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10060.809, "load_time_ms": 6.603, "num_steps_trained": 1614208}, "node_ip": "10.138.0.2", "episodes_this_iter": 46, "episodes_total": 1943, "pid": 45081, "episode_reward_min": -638.6501322851113, "time_total_s": 1281.70224070549, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.440245628356934, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf96bf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf96a60>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf96ae8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf96b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 34330, "timesteps_since_restore": 1616643, "date": "2019-05-30_01-30-46", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.864913766938335, "mean_inference_ms": 1.7575232381811032, "mean_processing_ms": 6.495549913809582}, "training_iteration": 42, "timesteps_total": 1616643, "episode_reward_mean": -378.4241708643907, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -103.1669859374039, "episode_len_mean": 321.82, "timestamp": 1559179846, "off_policy_estimator": {}, "time_since_restore": 1281.70224070549, "custom_metrics": {"cost1_max": 217.53959851246512, "cost1_mean": 190.32870447764913, "cost2_mean": -75.61810096791167, "cost2_max": -48.917318346030605, "system_level_velocity_max": 18.53501863810598, "cost2_min": -102.07574325611665, "system_level_velocity_min": 10.928905312269817, "system_level_velocity_mean": 16.22683411377909, "outflow_rate_mean": 1181.8674565371255, "cost1_min": 78.42089668780778, "outflow_rate_min": 720.4784065020832, "outflow_rate_max": 1341.6703664192946}, "iterations_since_restore": 42}
{"info": {"num_steps_sampled": 1650072, "sample_time_ms": 19488.348, "update_time_ms": 12.374, "learner": {"default_policy": {"kl": 0.018021579831838608, "policy_loss": -0.008242516778409481, "entropy": 1.155834674835205, "total_loss": 18.58940315246582, "vf_explained_var": 0.8407089710235596, "vf_loss": 18.596744537353516, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9863.771, "load_time_ms": 6.621, "num_steps_trained": 1647616}, "node_ip": "10.138.0.2", "episodes_this_iter": 50, "episodes_total": 1993, "pid": 45081, "episode_reward_min": -523.1159124445704, "time_total_s": 1308.8290252685547, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.126784563064575, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf967b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf96620>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf96730>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf966a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 33429, "timesteps_since_restore": 1650072, "date": "2019-05-30_01-31-13", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.824462804839575, "mean_inference_ms": 1.755940880100753, "mean_processing_ms": 6.492365972068532}, "training_iteration": 43, "timesteps_total": 1650072, "episode_reward_mean": -359.1251884953336, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -103.1669859374039, "episode_len_mean": 321.82, "timestamp": 1559179873, "off_policy_estimator": {}, "time_since_restore": 1308.8290252685547, "custom_metrics": {"cost1_max": 216.09229619382958, "cost1_mean": 191.01894870245403, "cost2_mean": -70.39690013883505, "cost2_max": -48.917318346030605, "system_level_velocity_max": 18.374748796617816, "cost2_min": -104.48449293489087, "system_level_velocity_min": 12.286633847175516, "system_level_velocity_mean": 16.34179362696502, "outflow_rate_mean": 1172.7194255540176, "cost1_min": 78.42089668780778, "outflow_rate_min": 720.4784065020832, "outflow_rate_max": 1318.7217254174395}, "iterations_since_restore": 43}
{"info": {"num_steps_sampled": 1682602, "sample_time_ms": 19663.084, "update_time_ms": 12.357, "learner": {"default_policy": {"kl": 0.015674123540520668, "policy_loss": -0.006972467061132193, "entropy": 1.150530457496643, "total_loss": 16.53182601928711, "vf_explained_var": 0.8540686368942261, "vf_loss": 16.53801727294922, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9480.945, "load_time_ms": 6.539, "num_steps_trained": 1680128}, "node_ip": "10.138.0.2", "episodes_this_iter": 45, "episodes_total": 2038, "pid": 45081, "episode_reward_min": -519.2310729582645, "time_total_s": 1335.2978224754333, "num_metric_batches_dropped": 0, "time_this_iter_s": 26.468797206878662, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf96c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf96158>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf960d0>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf96048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 32530, "timesteps_since_restore": 1682602, "date": "2019-05-30_01-31-39", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.785641022452205, "mean_inference_ms": 1.755291546449834, "mean_processing_ms": 6.499300482062528}, "training_iteration": 44, "timesteps_total": 1682602, "episode_reward_mean": -349.8558519537298, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -33.2225650978133, "episode_len_mean": 320.54, "timestamp": 1559179899, "off_policy_estimator": {}, "time_since_restore": 1335.2978224754333, "custom_metrics": {"cost1_max": 216.7430741871854, "cost1_mean": 188.433243363672, "cost2_mean": -65.36885954465716, "cost2_max": -23.90843592616679, "system_level_velocity_max": 18.480970761329132, "cost2_min": -104.48449293489087, "system_level_velocity_min": 12.619286179097788, "system_level_velocity_mean": 16.279619794502615, "outflow_rate_mean": 1151.4503846435064, "cost1_min": 23.006074018728672, "outflow_rate_min": 460.7989278777953, "outflow_rate_max": 1305.464068081743}, "iterations_since_restore": 44}
{"info": {"num_steps_sampled": 1717311, "sample_time_ms": 18155.804, "update_time_ms": 10.221, "learner": {"default_policy": {"kl": 0.011382239870727062, "policy_loss": -0.0034145184326916933, "entropy": 1.1343889236450195, "total_loss": 19.65050506591797, "vf_explained_var": 0.8446311950683594, "vf_loss": 19.65335464477539, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9574.643, "load_time_ms": 5.582, "num_steps_trained": 1714816}, "node_ip": "10.138.0.2", "episodes_this_iter": 47, "episodes_total": 2085, "pid": 45081, "episode_reward_min": -485.1573654428573, "time_total_s": 1364.0221529006958, "num_metric_batches_dropped": 0, "time_this_iter_s": 28.72433042526245, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007620>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007f28>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 34709, "timesteps_since_restore": 1717311, "date": "2019-05-30_01-32-08", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.750599543701973, "mean_inference_ms": 1.754816145994354, "mean_processing_ms": 6.502862563820371}, "training_iteration": 45, "timesteps_total": 1717311, "episode_reward_mean": -343.32527173667853, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -24.11214587938113, "episode_len_mean": 316.46, "timestamp": 1559179928, "off_policy_estimator": {}, "time_since_restore": 1364.0221529006958, "custom_metrics": {"cost1_max": 217.27754586932556, "cost1_mean": 187.9513973102773, "cost2_mean": -67.27448018588588, "cost2_max": -18.384246038457707, "system_level_velocity_max": 18.53247514125658, "cost2_min": -102.59274642335285, "system_level_velocity_min": 12.496901289872532, "system_level_velocity_mean": 16.446215352372057, "outflow_rate_mean": 1155.3024080812718, "cost1_min": 18.136997154347753, "outflow_rate_min": 460.7989278777953, "outflow_rate_max": 1308.6727633910116}, "iterations_since_restore": 45}
{"info": {"num_steps_sampled": 1751637, "sample_time_ms": 18316.683, "update_time_ms": 10.811, "learner": {"default_policy": {"kl": 0.011862004175782204, "policy_loss": -0.0054966602474451065, "entropy": 1.1319729089736938, "total_loss": 19.18638038635254, "vf_explained_var": 0.835307776927948, "vf_loss": 19.1912841796875, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9664.702, "load_time_ms": 5.505, "num_steps_trained": 1749120}, "node_ip": "10.138.0.2", "episodes_this_iter": 50, "episodes_total": 2135, "pid": 45081, "episode_reward_min": -525.0329270307477, "time_total_s": 1394.5161881446838, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.494035243988037, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9e18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9f28>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9d08>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 34326, "timesteps_since_restore": 1751637, "date": "2019-05-30_01-32-39", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.743414667518184, "mean_inference_ms": 1.7577196737021663, "mean_processing_ms": 6.517051400468841}, "training_iteration": 46, "timesteps_total": 1751637, "episode_reward_mean": -353.3006286266103, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -24.11214587938113, "episode_len_mean": 318.02, "timestamp": 1559179959, "off_policy_estimator": {}, "time_since_restore": 1394.5161881446838, "custom_metrics": {"cost1_max": 219.04231120226433, "cost1_mean": 190.98024822281582, "cost2_mean": -71.95566875051432, "cost2_max": -18.384246038457707, "system_level_velocity_max": 18.601261686477173, "cost2_min": -102.59274642335285, "system_level_velocity_min": 12.496901289872532, "system_level_velocity_mean": 16.56325607669361, "outflow_rate_mean": 1174.4084708345429, "cost1_min": 18.136997154347753, "outflow_rate_min": 460.7989278777953, "outflow_rate_max": 1308.794128720026}, "iterations_since_restore": 46}
{"info": {"num_steps_sampled": 1785475, "sample_time_ms": 18204.96, "update_time_ms": 11.039, "learner": {"default_policy": {"kl": 0.017989736050367355, "policy_loss": -0.007584437262266874, "entropy": 1.1095350980758667, "total_loss": 15.703121185302734, "vf_explained_var": 0.8612197041511536, "vf_loss": 15.709807395935059, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9532.981, "load_time_ms": 5.553, "num_steps_trained": 1782912}, "node_ip": "10.138.0.2", "episodes_this_iter": 43, "episodes_total": 2178, "pid": 45081, "episode_reward_min": -552.7636996142471, "time_total_s": 1422.1186468601227, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.602458715438843, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59fdc80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59fd1e0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59fd378>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59fd2f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 33838, "timesteps_since_restore": 1785475, "date": "2019-05-30_01-33-06", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.734030743769631, "mean_inference_ms": 1.7584547306012388, "mean_processing_ms": 6.516703444613521}, "training_iteration": 47, "timesteps_total": 1785475, "episode_reward_mean": -372.8835661078323, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -24.11214587938113, "episode_len_mean": 322.02, "timestamp": 1559179986, "off_policy_estimator": {}, "time_since_restore": 1422.1186468601227, "custom_metrics": {"cost1_max": 219.04231120226433, "cost1_mean": 188.19546100733243, "cost2_mean": -70.95751964347176, "cost2_max": -18.384246038457707, "system_level_velocity_max": 18.601261686477173, "cost2_min": -98.46985615203232, "system_level_velocity_min": 12.395381450261755, "system_level_velocity_mean": 16.083794472463683, "outflow_rate_mean": 1156.8690825018673, "cost1_min": 18.136997154347753, "outflow_rate_min": 466.37774969826376, "outflow_rate_max": 1308.794128720026}, "iterations_since_restore": 47}
{"info": {"num_steps_sampled": 1819309, "sample_time_ms": 18305.211, "update_time_ms": 11.353, "learner": {"default_policy": {"kl": 0.014849704690277576, "policy_loss": -0.006103239953517914, "entropy": 1.0956003665924072, "total_loss": 16.86869239807129, "vf_explained_var": 0.8489207625389099, "vf_loss": 16.874053955078125, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9561.919, "load_time_ms": 5.356, "num_steps_trained": 1816704}, "node_ip": "10.138.0.2", "episodes_this_iter": 46, "episodes_total": 2224, "pid": 45081, "episode_reward_min": -552.7636996142471, "time_total_s": 1451.1426904201508, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.024043560028076, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59fb598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59fb510>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59fb488>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59fb400>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 33834, "timesteps_since_restore": 1819309, "date": "2019-05-30_01-33-35", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.694361274193838, "mean_inference_ms": 1.7570620216402153, "mean_processing_ms": 6.514335006726409}, "training_iteration": 48, "timesteps_total": 1819309, "episode_reward_mean": -371.62388066727027, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -262.8126883747477, "episode_len_mean": 325.0, "timestamp": 1559180015, "off_policy_estimator": {}, "time_since_restore": 1451.1426904201508, "custom_metrics": {"cost1_max": 218.80022824602773, "cost1_mean": 189.50388854078525, "cost2_mean": -69.06338226724543, "cost2_max": -50.97913872131038, "system_level_velocity_max": 18.5894264342784, "cost2_min": -97.91912073241971, "system_level_velocity_min": 12.395381450261755, "system_level_velocity_mean": 16.031672048605497, "outflow_rate_mean": 1160.1078078755218, "cost1_min": 146.8770036846176, "outflow_rate_min": 908.2957516629708, "outflow_rate_max": 1326.1841903451048}, "iterations_since_restore": 48}
{"info": {"num_steps_sampled": 1854593, "sample_time_ms": 18560.549, "update_time_ms": 11.493, "learner": {"default_policy": {"kl": 0.012160949409008026, "policy_loss": -0.0049031758680939674, "entropy": 1.0911481380462646, "total_loss": 19.717247009277344, "vf_explained_var": 0.8404164910316467, "vf_loss": 19.721542358398438, "cur_kl_coeff": 0.05000000819563866, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9533.087, "load_time_ms": 5.463, "num_steps_trained": 1851904}, "node_ip": "10.138.0.2", "episodes_this_iter": 49, "episodes_total": 2273, "pid": 45081, "episode_reward_min": -531.2290824393622, "time_total_s": 1480.5924875736237, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.4497971534729, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a99d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9bf8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a96a8>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": false, "timesteps_this_iter": 35284, "timesteps_since_restore": 1854593, "date": "2019-05-30_01-34-05", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.678082123872484, "mean_inference_ms": 1.7577084465294797, "mean_processing_ms": 6.518557332501998}, "training_iteration": 49, "timesteps_total": 1854593, "episode_reward_mean": -366.78407513035563, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -262.8126883747477, "episode_len_mean": 325.0, "timestamp": 1559180045, "off_policy_estimator": {}, "time_since_restore": 1480.5924875736237, "custom_metrics": {"cost1_max": 218.80022824602773, "cost1_mean": 194.04420923537754, "cost2_mean": -72.82496396388596, "cost2_max": -50.97913872131038, "system_level_velocity_max": 18.5894264342784, "cost2_min": -100.84812268713662, "system_level_velocity_min": 12.648661501200834, "system_level_velocity_mean": 16.414032794168353, "outflow_rate_mean": 1185.0898985067, "cost1_min": 146.8770036846176, "outflow_rate_min": 911.9947871044423, "outflow_rate_max": 1326.1841903451048}, "iterations_since_restore": 49}
{"info": {"num_steps_sampled": 1890724, "sample_time_ms": 18815.504, "update_time_ms": 11.412, "learner": {"default_policy": {"kl": 0.01316794753074646, "policy_loss": -0.005295803304761648, "entropy": 1.0702743530273438, "total_loss": 21.518033981323242, "vf_explained_var": 0.8329117298126221, "vf_loss": 21.52267074584961, "cur_kl_coeff": 0.05000000447034836, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9399.842, "load_time_ms": 5.644, "num_steps_trained": 1888000}, "node_ip": "10.138.0.2", "episodes_this_iter": 45, "episodes_total": 2318, "pid": 45081, "episode_reward_min": -569.909203474354, "time_total_s": 1509.7305674552917, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.13807988166809, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "max_seq_len": 20, "custom_model": null, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "grayscale": false, "use_lstm": false, "lstm_cell_size": 256, "dim": 84, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "use_gae": true, "input_evaluation": ["is", "wis"], "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "batch_mode": "truncate_episodes", "compress_observations": false, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "grad_clip": null, "clip_actions": false, "kl_target": 0.01, "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bb158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb0d0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null, "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb048>)"}, "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87ba2f0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "vf_clip_param": 1000000.0}, "done": true, "timesteps_this_iter": 36131, "timesteps_since_restore": 1890724, "date": "2019-05-30_01-34-34", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 15.685961722657435, "mean_inference_ms": 1.7597988320042364, "mean_processing_ms": 6.521729342557047}, "training_iteration": 50, "timesteps_total": 1890724, "episode_reward_mean": -377.1978624570613, "experiment_id": "ea63206812354fd787f06c77d4cea296", "num_healthy_workers": 20, "episode_reward_max": -263.92935835371674, "episode_len_mean": 325.0, "timestamp": 1559180074, "off_policy_estimator": {}, "time_since_restore": 1509.7305674552917, "custom_metrics": {"cost1_max": 219.7130003957489, "cost1_mean": 196.48623168824383, "cost2_mean": -79.22962874016348, "cost2_max": -53.77163152349053, "system_level_velocity_max": 18.75739634315338, "cost2_min": -102.59334487841645, "system_level_velocity_min": 12.6205980521973, "system_level_velocity_mean": 16.58791035799615, "outflow_rate_mean": 1200.7915246665384, "cost1_min": 151.2901795574041, "outflow_rate_min": 1007.1608226377725, "outflow_rate_max": 1326.1841903451048}, "iterations_since_restore": 50}

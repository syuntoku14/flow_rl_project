{"info": {"num_steps_sampled": 40925, "sample_time_ms": 39753.864, "update_time_ms": 1587.223, "learner": {"default_policy": {"policy_loss": -2.612514617794659e-05, "entropy": 1.419553279876709, "total_loss": 36.48398208618164, "cur_kl_coeff": 0.20000003278255463, "vf_explained_var": -4.307042672735406e-06, "vf_loss": 36.48380661010742, "kl": 0.001012700144201517, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9408.665, "load_time_ms": 62.956, "num_steps_trained": 40832}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 40, "pid": 45052, "episode_reward_min": -1008.3899989107099, "time_total_s": 50.96687364578247, "num_metric_batches_dropped": 0, "time_this_iter_s": 50.96687364578247, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f0d0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f1e0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f158>)"}}, "done": false, "timesteps_this_iter": 40925, "off_policy_estimator": {}, "date": "2019-05-30_01-10-10", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 19.35221707614538, "mean_inference_ms": 1.9387496612995825, "mean_processing_ms": 5.823970920395121}, "training_iteration": 1, "timesteps_total": 40925, "episode_reward_mean": -702.4999163490478, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -399.93424508533974, "episode_len_mean": 325.0, "timestamp": 1559178610, "episodes_this_iter": 40, "timesteps_since_restore": 40925, "time_since_restore": 50.96687364578247, "custom_metrics": {"cost1_mean": 122.96853785619552, "cost1_max": 141.5060960918307, "cost2_mean": -47.841181662746536, "cost2_max": -21.79467615231519, "system_level_velocity_max": 11.76611662263578, "cost2_min": -77.37546200893566, "system_level_velocity_min": 9.190426921655042, "system_level_velocity_mean": 10.2312243708004, "outflow_rate_mean": 741.5526089035246, "cost1_min": 108.19351598895935, "outflow_rate_min": 383.9858536585365, "outflow_rate_max": 896.9898570183084}, "iterations_since_restore": 1}
{"info": {"num_steps_sampled": 82451, "sample_time_ms": 29925.895, "update_time_ms": 797.809, "learner": {"default_policy": {"policy_loss": -0.0007389176753349602, "entropy": 1.40817129611969, "total_loss": 63.120689392089844, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": -2.4982441004794964e-07, "vf_loss": 63.1212272644043, "kl": 0.0019803105387836695, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9135.349, "load_time_ms": 34.415, "num_steps_trained": 82304}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 80, "pid": 45052, "episode_reward_min": -1008.3899989107099, "time_total_s": 80.01663446426392, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.049760818481445, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f620>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f730>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f6a8>)"}}, "done": false, "timesteps_this_iter": 41526, "off_policy_estimator": {}, "date": "2019-05-30_01-10-39", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 18.675297365159103, "mean_inference_ms": 1.9156235162248152, "mean_processing_ms": 5.820769559651888}, "training_iteration": 2, "timesteps_total": 82451, "episode_reward_mean": -700.7116546584978, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -399.93424508533974, "episode_len_mean": 325.0, "timestamp": 1559178639, "episodes_this_iter": 40, "timesteps_since_restore": 82451, "time_since_restore": 80.01663446426392, "custom_metrics": {"cost1_mean": 122.86020109405949, "cost1_max": 144.39605177235015, "cost2_mean": -47.4986458340685, "cost2_max": -21.79467615231519, "system_level_velocity_max": 11.794839570242747, "cost2_min": -78.21047790784004, "system_level_velocity_min": 8.771683428058857, "system_level_velocity_mean": 10.225219907811416, "outflow_rate_mean": 741.0666644169979, "cost1_min": 104.5637657475401, "outflow_rate_min": 383.9858536585365, "outflow_rate_max": 965.1928908436624}, "iterations_since_restore": 2}
{"info": {"num_steps_sampled": 124634, "sample_time_ms": 26880.463, "update_time_ms": 533.763, "learner": {"default_policy": {"policy_loss": -0.0010759396245703101, "entropy": 1.4017397165298462, "total_loss": 52.38461685180664, "cur_kl_coeff": 0.05000000074505806, "vf_explained_var": 0.42395085096359253, "vf_loss": 52.38547134399414, "kl": 0.004435318987816572, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9232.71, "load_time_ms": 24.436, "num_steps_trained": 124416}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 120, "pid": 45052, "episode_reward_min": -1008.3899989107099, "time_total_s": 110.3452320098877, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.32859754562378, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aafc9510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aafc9378>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aafc9488>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aafc9400>)"}}, "done": false, "timesteps_this_iter": 42183, "off_policy_estimator": {}, "date": "2019-05-30_01-11-09", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 18.06407016905995, "mean_inference_ms": 1.895323597007759, "mean_processing_ms": 5.8150271965325855}, "training_iteration": 3, "timesteps_total": 124634, "episode_reward_mean": -691.4932107519589, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -399.93424508533974, "episode_len_mean": 325.0, "timestamp": 1559178669, "episodes_this_iter": 40, "timesteps_since_restore": 124634, "time_since_restore": 110.3452320098877, "custom_metrics": {"cost1_mean": 124.3960397711371, "cost1_max": 144.39605177235015, "cost2_mean": -48.84770409269959, "cost2_max": -21.79467615231519, "system_level_velocity_max": 11.872799111065811, "cost2_min": -90.62610299165252, "system_level_velocity_min": 8.771683428058857, "system_level_velocity_mean": 10.35653274783347, "outflow_rate_mean": 752.0305155922717, "cost1_min": 104.5637657475401, "outflow_rate_min": 383.9858536585365, "outflow_rate_max": 965.1928908436624}, "iterations_since_restore": 3}
{"info": {"num_steps_sampled": 168109, "sample_time_ms": 25795.234, "update_time_ms": 403.1, "learner": {"default_policy": {"policy_loss": -0.00281523447483778, "entropy": 1.381587028503418, "total_loss": 57.740989685058594, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6663218140602112, "vf_loss": 57.74345016479492, "kl": 0.014418966136872768, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9353.706, "load_time_ms": 19.203, "num_steps_trained": 167808}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 180, "pid": 45052, "episode_reward_min": -863.6067270253579, "time_total_s": 142.71272015571594, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.36748814582825, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aafc9620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aafc9ae8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aafc99d8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aafc9b70>)"}}, "done": false, "timesteps_this_iter": 43475, "off_policy_estimator": {}, "date": "2019-05-30_01-11-42", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.81349574581835, "mean_inference_ms": 1.8967965856128557, "mean_processing_ms": 6.152999868443344}, "training_iteration": 4, "timesteps_total": 168109, "episode_reward_mean": -669.2260481213556, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -491.4425131434033, "episode_len_mean": 325.0, "timestamp": 1559178702, "episodes_this_iter": 60, "timesteps_since_restore": 168109, "time_since_restore": 142.71272015571594, "custom_metrics": {"cost1_mean": 136.58913190010458, "cost1_max": 169.0348766637063, "cost2_mean": -58.23993252808362, "cost2_max": -29.00079590713029, "system_level_velocity_max": 13.814509969768803, "cost2_min": -100.28862999197851, "system_level_velocity_min": 9.190560267319574, "system_level_velocity_mean": 11.294070284756314, "outflow_rate_mean": 851.3595213120603, "cost1_min": 108.68179935764687, "outflow_rate_min": 695.9699352911896, "outflow_rate_max": 1152.8575449427417}, "iterations_since_restore": 4}
{"info": {"num_steps_sampled": 208811, "sample_time_ms": 24559.741, "update_time_ms": 324.645, "learner": {"default_policy": {"policy_loss": -0.0037109986878931522, "entropy": 1.3642390966415405, "total_loss": 43.309547424316406, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7951451539993286, "vf_loss": 43.31294250488281, "kl": 0.01259405817836523, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9230.366, "load_time_ms": 16.685, "num_steps_trained": 208384}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 220, "pid": 45052, "episode_reward_min": -849.017209571318, "time_total_s": 171.16568756103516, "num_metric_batches_dropped": 0, "time_this_iter_s": 28.452967405319214, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007f28>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007950>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007d08>)"}}, "done": false, "timesteps_this_iter": 40702, "off_policy_estimator": {}, "date": "2019-05-30_01-12-10", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.817327556533474, "mean_inference_ms": 1.9052153445658957, "mean_processing_ms": 6.349440186512762}, "training_iteration": 5, "timesteps_total": 208811, "episode_reward_mean": -625.2416960495613, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -462.919715992031, "episode_len_mean": 325.0, "timestamp": 1559178730, "episodes_this_iter": 40, "timesteps_since_restore": 208811, "time_since_restore": 171.16568756103516, "custom_metrics": {"cost1_mean": 147.1325435533282, "cost1_max": 182.69414068894375, "cost2_mean": -64.66811794509358, "cost2_max": -29.686240844472618, "system_level_velocity_max": 15.047197627637816, "cost2_min": -100.28862999197851, "system_level_velocity_min": 9.286895021804066, "system_level_velocity_mean": 12.139810833821576, "outflow_rate_mean": 940.5831605583994, "cost1_min": 111.42262643667885, "outflow_rate_min": 705.1120000000001, "outflow_rate_max": 1174.9691255114908}, "iterations_since_restore": 5}
{"info": {"num_steps_sampled": 249007, "sample_time_ms": 23924.864, "update_time_ms": 272.183, "learner": {"default_policy": {"policy_loss": -0.0033246080856770277, "entropy": 1.3408122062683105, "total_loss": 44.08055877685547, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8052003383636475, "vf_loss": 44.08365249633789, "kl": 0.009265814907848835, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9155.754, "load_time_ms": 14.977, "num_steps_trained": 248576}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 261, "pid": 45052, "episode_reward_min": -849.017209571318, "time_total_s": 200.79538655281067, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.629698991775513, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9fa60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f950>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f9d8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f8c8>)"}}, "done": false, "timesteps_this_iter": 40196, "off_policy_estimator": {}, "date": "2019-05-30_01-12-40", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.720141227722124, "mean_inference_ms": 1.9066115250019784, "mean_processing_ms": 6.28261888055681}, "training_iteration": 6, "timesteps_total": 249007, "episode_reward_mean": -566.2317449843413, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -24.492924538837514, "episode_len_mean": 322.02, "timestamp": 1559178760, "episodes_this_iter": 41, "timesteps_since_restore": 249007, "time_since_restore": 200.79538655281067, "custom_metrics": {"cost1_mean": 154.70765083504955, "cost1_max": 187.45302114430515, "cost2_mean": -67.88683929763127, "cost2_max": -17.836652446878364, "system_level_velocity_max": 17.638667545488822, "cost2_min": -103.506785910197, "system_level_velocity_min": 9.658194021993511, "system_level_velocity_mean": 12.975783892400436, "outflow_rate_mean": 1001.7341855681917, "cost1_min": 17.92329195860178, "outflow_rate_min": 483.934671032216, "outflow_rate_max": 1211.3775526932086}, "iterations_since_restore": 6}
{"info": {"num_steps_sampled": 289261, "sample_time_ms": 23676.363, "update_time_ms": 234.396, "learner": {"default_policy": {"policy_loss": -0.0030268309637904167, "entropy": 1.3269600868225098, "total_loss": 46.36476135253906, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7658603191375732, "vf_loss": 46.367584228515625, "kl": 0.008166679181158543, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9134.581, "load_time_ms": 13.528, "num_steps_trained": 288768}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 321, "pid": 45052, "episode_reward_min": -868.248823692962, "time_total_s": 232.0869312286377, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.291544675827026, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a99d8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9a60>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9950>)"}}, "done": false, "timesteps_this_iter": 40254, "off_policy_estimator": {}, "date": "2019-05-30_01-13-11", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.74462052897843, "mean_inference_ms": 1.9171587484210766, "mean_processing_ms": 6.421688158751699}, "training_iteration": 7, "timesteps_total": 289261, "episode_reward_mean": -509.09330894376654, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -24.492924538837514, "episode_len_mean": 322.02, "timestamp": 1559178791, "episodes_this_iter": 60, "timesteps_since_restore": 289261, "time_since_restore": 232.0869312286377, "custom_metrics": {"cost1_mean": 167.85461044204928, "cost1_max": 204.19304002472148, "cost2_mean": -75.59575250393289, "cost2_max": -17.836652446878364, "system_level_velocity_max": 17.638667545488822, "cost2_min": -114.61998235284089, "system_level_velocity_min": 11.10837334949179, "system_level_velocity_mean": 14.080411980561607, "outflow_rate_mean": 1097.9090011434355, "cost1_min": 17.92329195860178, "outflow_rate_min": 483.934671032216, "outflow_rate_max": 1306.612297562815}, "iterations_since_restore": 7}
{"info": {"num_steps_sampled": 330817, "sample_time_ms": 23224.632, "update_time_ms": 205.972, "learner": {"default_policy": {"policy_loss": -0.0011076165828853846, "entropy": 1.3082242012023926, "total_loss": 37.51670837402344, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7843565940856934, "vf_loss": 37.51764678955078, "kl": 0.006860281340777874, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9208.86, "load_time_ms": 12.716, "num_steps_trained": 330240}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 362, "pid": 45052, "episode_reward_min": -868.248823692962, "time_total_s": 261.98591136932373, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.898980140686035, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a91e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a96a8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9158>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9620>)"}}, "done": false, "timesteps_this_iter": 41556, "off_policy_estimator": {}, "date": "2019-05-30_01-13-41", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.738799510267388, "mean_inference_ms": 1.915155574837968, "mean_processing_ms": 6.528896523199015}, "training_iteration": 8, "timesteps_total": 330817, "episode_reward_mean": -504.51399301058177, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -24.150625414505466, "episode_len_mean": 322.02, "timestamp": 1559178821, "episodes_this_iter": 41, "timesteps_since_restore": 330817, "time_since_restore": 261.98591136932373, "custom_metrics": {"cost1_mean": 175.2339523288591, "cost1_max": 211.75485577312404, "cost2_mean": -89.16877818904038, "cost2_max": -18.76929531288803, "system_level_velocity_max": 17.878539130834636, "cost2_min": -133.1180554242539, "system_level_velocity_min": 11.195322595760551, "system_level_velocity_mean": 14.662935074124043, "outflow_rate_mean": 1151.167960589841, "cost1_min": 18.036362915883103, "outflow_rate_min": 474.10711434370273, "outflow_rate_max": 1370.2797153198087}, "iterations_since_restore": 8}
{"info": {"num_steps_sampled": 372819, "sample_time_ms": 22961.418, "update_time_ms": 184.101, "learner": {"default_policy": {"policy_loss": -0.0024782356340438128, "entropy": 1.3189153671264648, "total_loss": 36.63604736328125, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.7748373746871948, "vf_loss": 36.63832092285156, "kl": 0.008193958550691605, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9251.015, "load_time_ms": 11.963, "num_steps_trained": 372224}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 403, "pid": 45052, "episode_reward_min": -852.2373166210878, "time_total_s": 292.52509212493896, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.539180755615234, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a5268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a5158>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a51e0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a50d0>)"}}, "done": false, "timesteps_this_iter": 42002, "off_policy_estimator": {}, "date": "2019-05-30_01-14-12", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.683536947411934, "mean_inference_ms": 1.9055607936026164, "mean_processing_ms": 6.474845098971539}, "training_iteration": 9, "timesteps_total": 372819, "episode_reward_mean": -499.8689345386416, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -24.150625414505466, "episode_len_mean": 320.97, "timestamp": 1559178852, "episodes_this_iter": 41, "timesteps_since_restore": 372819, "time_since_restore": 292.52509212493896, "custom_metrics": {"cost1_mean": 179.70405745440672, "cost1_max": 214.66666875119535, "cost2_mean": -99.05835397064175, "cost2_max": -18.76929531288803, "system_level_velocity_max": 17.878539130834636, "cost2_min": -133.1180554242539, "system_level_velocity_min": 10.021759575890224, "system_level_velocity_mean": 15.116710351550878, "outflow_rate_mean": 1184.6531998104208, "cost1_min": 18.036362915883103, "outflow_rate_min": 474.10711434370273, "outflow_rate_max": 1402.3311945990522}, "iterations_since_restore": 9}
{"info": {"num_steps_sampled": 416330, "sample_time_ms": 22895.158, "update_time_ms": 166.468, "learner": {"default_policy": {"policy_loss": -0.0007141444948501885, "entropy": 1.311937689781189, "total_loss": 42.19771957397461, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7402898073196411, "vf_loss": 42.19829559326172, "kl": 0.005405462812632322, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9377.505, "load_time_ms": 11.209, "num_steps_trained": 415616}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 461, "pid": 45052, "episode_reward_min": -852.2373166210878, "time_total_s": 325.43646025657654, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.91136813163757, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f6a8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f7b8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f400>)"}}, "done": false, "timesteps_this_iter": 43511, "off_policy_estimator": {}, "date": "2019-05-30_01-14-45", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.743511304735076, "mean_inference_ms": 1.8948367679672977, "mean_processing_ms": 6.505362923276311}, "training_iteration": 10, "timesteps_total": 416330, "episode_reward_mean": -514.8800755044206, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -33.708635833842706, "episode_len_mean": 321.05, "timestamp": 1559178885, "episodes_this_iter": 58, "timesteps_since_restore": 416330, "time_since_restore": 325.43646025657654, "custom_metrics": {"cost1_mean": 181.16775604033177, "cost1_max": 214.8616801483234, "cost2_mean": -106.02787876961092, "cost2_max": -25.165850106206356, "system_level_velocity_max": 18.290060911736855, "cost2_min": -136.7729505419208, "system_level_velocity_min": 9.346772978694531, "system_level_velocity_mean": 15.26930297026461, "outflow_rate_mean": 1200.3061065019087, "cost1_min": 22.79809804345132, "outflow_rate_min": 462.43348918263234, "outflow_rate_max": 1402.3311945990522}, "iterations_since_restore": 10}
{"info": {"num_steps_sampled": 458363, "sample_time_ms": 21001.475, "update_time_ms": 8.849, "learner": {"default_policy": {"policy_loss": -0.0014753045979887247, "entropy": 1.3036704063415527, "total_loss": 33.52006530761719, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.7895907759666443, "vf_loss": 33.52139663696289, "kl": 0.005994783248752356, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9497.531, "load_time_ms": 5.369, "num_steps_trained": 457600}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 503, "pid": 45052, "episode_reward_min": -834.7343706163193, "time_total_s": 356.95970487594604, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.523244619369507, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9fc80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f2f0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9fb70>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f488>)"}}, "done": false, "timesteps_this_iter": 42033, "off_policy_estimator": {}, "date": "2019-05-30_01-15-16", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.738943083851076, "mean_inference_ms": 1.8843971833202822, "mean_processing_ms": 6.53925971856721}, "training_iteration": 11, "timesteps_total": 458363, "episode_reward_mean": -528.1421490481998, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -33.708635833842706, "episode_len_mean": 322.1, "timestamp": 1559178916, "episodes_this_iter": 42, "timesteps_since_restore": 458363, "time_since_restore": 356.95970487594604, "custom_metrics": {"cost1_mean": 181.90565295441004, "cost1_max": 214.8616801483234, "cost2_mean": -108.11942543711677, "cost2_max": -25.165850106206356, "system_level_velocity_max": 18.290060911736855, "cost2_min": -136.7729505419208, "system_level_velocity_min": 9.346772978694531, "system_level_velocity_mean": 15.305808508662407, "outflow_rate_mean": 1208.807004847992, "cost1_min": 22.79809804345132, "outflow_rate_min": 462.43348918263234, "outflow_rate_max": 1403.9830091429048}, "iterations_since_restore": 11}
{"info": {"num_steps_sampled": 501610, "sample_time_ms": 20959.167, "update_time_ms": 8.833, "learner": {"default_policy": {"policy_loss": -0.0014617055421695113, "entropy": 1.2965378761291504, "total_loss": 33.41749954223633, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8084211349487305, "vf_loss": 33.418792724609375, "kl": 0.006547524593770504, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9711.569, "load_time_ms": 5.199, "num_steps_trained": 500736}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 543, "pid": 45052, "episode_reward_min": -841.2130251187509, "time_total_s": 387.73321771621704, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.773512840270996, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b8048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a5e18>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a5f28>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a5ea0>)"}}, "done": false, "timesteps_this_iter": 43247, "off_policy_estimator": {}, "date": "2019-05-30_01-15-47", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.681081611092594, "mean_inference_ms": 1.8707276840366327, "mean_processing_ms": 6.4831259998200315}, "training_iteration": 12, "timesteps_total": 501610, "episode_reward_mean": -532.4146423013511, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -317.4998768186083, "episode_len_mean": 324.8, "timestamp": 1559178947, "episodes_this_iter": 40, "timesteps_since_restore": 501610, "time_since_restore": 387.73321771621704, "custom_metrics": {"cost1_mean": 185.10035090569264, "cost1_max": 217.23111535249532, "cost2_mean": -110.79586023840444, "cost2_max": -90.17522979932497, "system_level_velocity_max": 18.050448451353184, "cost2_min": -136.7729505419208, "system_level_velocity_min": 11.772160854410316, "system_level_velocity_mean": 15.4645698639202, "outflow_rate_mean": 1226.713539736844, "cost1_min": 139.5415654363964, "outflow_rate_min": 956.304118815531, "outflow_rate_max": 1423.643217915835}, "iterations_since_restore": 12}
{"info": {"num_steps_sampled": 547545, "sample_time_ms": 21065.276, "update_time_ms": 9.372, "learner": {"default_policy": {"policy_loss": -0.001484862295910716, "entropy": 1.2879598140716553, "total_loss": 40.91960144042969, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7770465612411499, "vf_loss": 40.92087936401367, "kl": 0.00825734343379736, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 9944.058, "load_time_ms": 5.175, "num_steps_trained": 546560}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 601, "pid": 45052, "episode_reward_min": -841.2130251187509, "time_total_s": 421.4392650127411, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.70604729652405, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a5a60>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007950>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a5840>)"}}, "done": false, "timesteps_this_iter": 45935, "off_policy_estimator": {}, "date": "2019-05-30_01-16-21", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.656663738174984, "mean_inference_ms": 1.8495168458581952, "mean_processing_ms": 6.482542381655333}, "training_iteration": 13, "timesteps_total": 547545, "episode_reward_mean": -546.3629250149772, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -116.84087908909324, "episode_len_mean": 320.82, "timestamp": 1559178981, "episodes_this_iter": 58, "timesteps_since_restore": 547545, "time_since_restore": 421.4392650127411, "custom_metrics": {"cost1_mean": 180.9093502584109, "cost1_max": 217.23111535249532, "cost2_mean": -114.43735863546948, "cost2_max": -55.262026895873845, "system_level_velocity_max": 18.469310963091388, "cost2_min": -140.79994967238932, "system_level_velocity_min": 11.955997195725859, "system_level_velocity_mean": 15.335344346829922, "outflow_rate_mean": 1211.693500279894, "cost1_min": 83.3158224696596, "outflow_rate_min": 807.1561899926039, "outflow_rate_max": 1424.7876002524122}, "iterations_since_restore": 13}
{"info": {"num_steps_sampled": 591482, "sample_time_ms": 20937.76, "update_time_ms": 9.116, "learner": {"default_policy": {"policy_loss": -0.001723993569612503, "entropy": 1.2751405239105225, "total_loss": 30.60839080810547, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8280675411224365, "vf_loss": 30.60991096496582, "kl": 0.008178574964404106, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10332.882, "load_time_ms": 5.576, "num_steps_trained": 590464}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 643, "pid": 45052, "episode_reward_min": -853.4979786464859, "time_total_s": 456.42958974838257, "num_metric_batches_dropped": 0, "time_this_iter_s": 34.99032473564148, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87ba488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87ba2f0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87ba400>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87ba378>)"}}, "done": false, "timesteps_this_iter": 43937, "off_policy_estimator": {}, "date": "2019-05-30_01-16-56", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.667560562635714, "mean_inference_ms": 1.8383695954777326, "mean_processing_ms": 6.5088705769610495}, "training_iteration": 14, "timesteps_total": 591482, "episode_reward_mean": -571.8839515087283, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -116.84087908909324, "episode_len_mean": 321.02, "timestamp": 1559179016, "episodes_this_iter": 42, "timesteps_since_restore": 591482, "time_since_restore": 456.42958974838257, "custom_metrics": {"cost1_mean": 177.63020447499613, "cost1_max": 217.0496130330602, "cost2_mean": -117.37736124884705, "cost2_max": -55.262026895873845, "system_level_velocity_max": 18.469310963091388, "cost2_min": -150.78764587950116, "system_level_velocity_min": 12.197155519746786, "system_level_velocity_mean": 15.024086094407537, "outflow_rate_mean": 1197.9433998079785, "cost1_min": 83.3158224696596, "outflow_rate_min": 807.1561899926039, "outflow_rate_max": 1424.7876002524122}, "iterations_since_restore": 14}
{"info": {"num_steps_sampled": 633726, "sample_time_ms": 21289.875, "update_time_ms": 8.97, "learner": {"default_policy": {"policy_loss": -0.0006025440525263548, "entropy": 1.2903978824615479, "total_loss": 31.231122970581055, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.8161735534667969, "vf_loss": 31.231569290161133, "kl": 0.0063131218776106834, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10533.742, "load_time_ms": 5.504, "num_steps_trained": 632704}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 685, "pid": 45052, "episode_reward_min": -853.4979786464859, "time_total_s": 490.4138214588165, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.98423171043396, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a11e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a1048>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a1158>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a10d0>)"}}, "done": false, "timesteps_this_iter": 42244, "off_policy_estimator": {}, "date": "2019-05-30_01-17-30", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.692330333106455, "mean_inference_ms": 1.8342073090290645, "mean_processing_ms": 6.490122844516346}, "training_iteration": 15, "timesteps_total": 633726, "episode_reward_mean": -544.9478842056371, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -116.84087908909324, "episode_len_mean": 323.0, "timestamp": 1559179050, "episodes_this_iter": 42, "timesteps_since_restore": 633726, "time_since_restore": 490.4138214588165, "custom_metrics": {"cost1_mean": 182.74918573926087, "cost1_max": 214.76815080107605, "cost2_mean": -116.5305210257638, "cost2_max": -55.262026895873845, "system_level_velocity_max": 18.469310963091388, "cost2_min": -150.78764587950116, "system_level_velocity_min": 12.197155519746786, "system_level_velocity_mean": 15.299446581898168, "outflow_rate_mean": 1224.0103354947037, "cost1_min": 83.3158224696596, "outflow_rate_min": 807.1561899926039, "outflow_rate_max": 1415.5115935283}, "iterations_since_restore": 15}
{"info": {"num_steps_sampled": 677846, "sample_time_ms": 21290.164, "update_time_ms": 8.789, "learner": {"default_policy": {"policy_loss": -0.0019837080035358667, "entropy": 1.283301830291748, "total_loss": 25.773012161254883, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8408233523368835, "vf_loss": 25.774782180786133, "kl": 0.008535378612577915, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10872.467, "load_time_ms": 5.639, "num_steps_trained": 676736}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 727, "pid": 45052, "episode_reward_min": -834.5818765020456, "time_total_s": 523.4485993385315, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.034777879714966, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f598>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f488>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f620>)"}}, "done": false, "timesteps_this_iter": 44120, "off_policy_estimator": {}, "date": "2019-05-30_01-18-03", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.720047653686578, "mean_inference_ms": 1.8288286108010359, "mean_processing_ms": 6.470411310096025}, "training_iteration": 16, "timesteps_total": 677846, "episode_reward_mean": -534.4656651115384, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -223.75128270435965, "episode_len_mean": 323.9, "timestamp": 1559179083, "episodes_this_iter": 42, "timesteps_since_restore": 677846, "time_since_restore": 523.4485993385315, "custom_metrics": {"cost1_mean": 184.233932323755, "cost1_max": 214.76815080107605, "cost2_mean": -117.41077723402346, "cost2_max": -75.15268653326021, "system_level_velocity_max": 17.911531228794992, "cost2_min": -150.78764587950116, "system_level_velocity_min": 12.087439763624726, "system_level_velocity_mean": 15.315961553367075, "outflow_rate_mean": 1234.6000450869337, "cost1_min": 137.78667765225754, "outflow_rate_min": 1011.426477646777, "outflow_rate_max": 1415.5115935283}, "iterations_since_restore": 16}
{"info": {"num_steps_sampled": 719795, "sample_time_ms": 21202.047, "update_time_ms": 9.018, "learner": {"default_policy": {"policy_loss": -0.0020213776733726263, "entropy": 1.2757728099822998, "total_loss": 34.69692611694336, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7675930857658386, "vf_loss": 34.69873046875, "kl": 0.008694358170032501, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11009.711, "load_time_ms": 5.628, "num_steps_trained": 718592}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 783, "pid": 45052, "episode_reward_min": -834.5818765020456, "time_total_s": 555.2364058494568, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.787806510925293, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a5d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a5bf8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a5400>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a5378>)"}}, "done": false, "timesteps_this_iter": 41949, "off_policy_estimator": {}, "date": "2019-05-30_01-18-35", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.7090589402152, "mean_inference_ms": 1.8217074767205055, "mean_processing_ms": 6.491047970582042}, "training_iteration": 17, "timesteps_total": 719795, "episode_reward_mean": -521.833093407296, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -223.75128270435965, "episode_len_mean": 323.9, "timestamp": 1559179115, "episodes_this_iter": 56, "timesteps_since_restore": 719795, "time_since_restore": 555.2364058494568, "custom_metrics": {"cost1_mean": 184.2577666153851, "cost1_max": 211.2551839250475, "cost2_mean": -114.58847770293774, "cost2_max": -75.15268653326021, "system_level_velocity_max": 17.535024403208762, "cost2_min": -139.53904377774728, "system_level_velocity_min": 11.981906791720377, "system_level_velocity_mean": 15.27463720365822, "outflow_rate_mean": 1233.9930125938156, "cost1_min": 137.78667765225754, "outflow_rate_min": 1011.426477646777, "outflow_rate_max": 1392.8855806619642}, "iterations_since_restore": 17}
{"info": {"num_steps_sampled": 761431, "sample_time_ms": 21377.627, "update_time_ms": 9.184, "learner": {"default_policy": {"policy_loss": -0.0016496101161465049, "entropy": 1.2702006101608276, "total_loss": 25.290353775024414, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.8149189352989197, "vf_loss": 25.29183578491211, "kl": 0.00669809291139245, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11122.046, "load_time_ms": 5.562, "num_steps_trained": 760192}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 826, "pid": 45052, "episode_reward_min": -811.4947608929357, "time_total_s": 588.0066654682159, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.770259618759155, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a5a60>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f598>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f488>)"}}, "done": false, "timesteps_this_iter": 41636, "off_policy_estimator": {}, "date": "2019-05-30_01-19-08", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.68602665529518, "mean_inference_ms": 1.81679591030942, "mean_processing_ms": 6.512346818973764}, "training_iteration": 18, "timesteps_total": 761431, "episode_reward_mean": -493.6833723090232, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -33.26095573350313, "episode_len_mean": 322.1, "timestamp": 1559179148, "episodes_this_iter": 43, "timesteps_since_restore": 761431, "time_since_restore": 588.0066654682159, "custom_metrics": {"cost1_mean": 184.52266123127498, "cost1_max": 211.2551839250475, "cost2_mean": -109.19306330023818, "cost2_max": -24.69935682207974, "system_level_velocity_max": 18.37770321571377, "cost2_min": -139.53904377774728, "system_level_velocity_min": 11.981906791720377, "system_level_velocity_mean": 15.396531771617969, "outflow_rate_mean": 1232.227834520857, "cost1_min": 22.941786021520123, "outflow_rate_min": 466.74083028559994, "outflow_rate_max": 1381.5592641432333}, "iterations_since_restore": 18}
{"info": {"num_steps_sampled": 804036, "sample_time_ms": 21278.703, "update_time_ms": 9.224, "learner": {"default_policy": {"policy_loss": -0.001974940998479724, "entropy": 1.2760605812072754, "total_loss": 27.672508239746094, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8099874258041382, "vf_loss": 27.674325942993164, "kl": 0.006160239689052105, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11267.898, "load_time_ms": 5.571, "num_steps_trained": 802688}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 869, "pid": 45052, "episode_reward_min": -740.1980121595471, "time_total_s": 619.0302240848541, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.023558616638184, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a92f0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9400>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9378>)"}}, "done": false, "timesteps_this_iter": 42605, "off_policy_estimator": {}, "date": "2019-05-30_01-19-39", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.62826490243646, "mean_inference_ms": 1.8110987157051028, "mean_processing_ms": 6.49146316115598}, "training_iteration": 19, "timesteps_total": 804036, "episode_reward_mean": -489.75684133973596, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -24.039448148341247, "episode_len_mean": 319.12, "timestamp": 1559179179, "episodes_this_iter": 43, "timesteps_since_restore": 804036, "time_since_restore": 619.0302240848541, "custom_metrics": {"cost1_mean": 181.5539477883963, "cost1_max": 209.89566094802228, "cost2_mean": -107.64036378702502, "cost2_max": -17.606236474407474, "system_level_velocity_max": 18.37770321571377, "cost2_min": -143.67460685005267, "system_level_velocity_min": 12.32584826987549, "system_level_velocity_mean": 15.301972947737006, "outflow_rate_mean": 1221.325039220319, "cost1_min": 17.83711420301373, "outflow_rate_min": 466.74083028559994, "outflow_rate_max": 1379.7144287019064}, "iterations_since_restore": 19}
{"info": {"num_steps_sampled": 845784, "sample_time_ms": 21165.201, "update_time_ms": 9.576, "learner": {"default_policy": {"policy_loss": -0.0034523881040513515, "entropy": 1.2736567258834839, "total_loss": 30.06485366821289, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7915587425231934, "vf_loss": 30.06805419921875, "kl": 0.01004969235509634, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11313.607, "load_time_ms": 5.731, "num_steps_trained": 844416}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 925, "pid": 45052, "episode_reward_min": -784.4207413201116, "time_total_s": 651.2707974910736, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.24057340621948, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b61e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6048>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b6158>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b60d0>)"}}, "done": false, "timesteps_this_iter": 41748, "off_policy_estimator": {}, "date": "2019-05-30_01-20-11", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.590829580580625, "mean_inference_ms": 1.8045501020763306, "mean_processing_ms": 6.504522760618074}, "training_iteration": 20, "timesteps_total": 845784, "episode_reward_mean": -499.5449766485207, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -24.039448148341247, "episode_len_mean": 322.02, "timestamp": 1559179211, "episodes_this_iter": 56, "timesteps_since_restore": 845784, "time_since_restore": 651.2707974910736, "custom_metrics": {"cost1_mean": 182.0958567557987, "cost1_max": 206.8534912869366, "cost2_mean": -108.19566869502638, "cost2_max": -17.606236474407474, "system_level_velocity_max": 17.707560945995766, "cost2_min": -143.67460685005267, "system_level_velocity_min": 11.412836234446674, "system_level_velocity_mean": 15.202884811945808, "outflow_rate_mean": 1222.149419208177, "cost1_min": 17.83711420301373, "outflow_rate_min": 487.8590816741719, "outflow_rate_max": 1360.9802942627002}, "iterations_since_restore": 20}
{"info": {"num_steps_sampled": 886263, "sample_time_ms": 20970.47, "update_time_ms": 9.509, "learner": {"default_policy": {"policy_loss": -0.0019569238647818565, "entropy": 1.2693458795547485, "total_loss": 23.20583152770996, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8291183710098267, "vf_loss": 23.20758819580078, "kl": 0.008010041899979115, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11323.945, "load_time_ms": 5.794, "num_steps_trained": 884864}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 966, "pid": 45052, "episode_reward_min": -784.4207413201116, "time_total_s": 680.9482350349426, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.67743754386902, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007c80>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007f28>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007d90>)"}}, "done": false, "timesteps_this_iter": 40479, "off_policy_estimator": {}, "date": "2019-05-30_01-20-41", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.566579158126835, "mean_inference_ms": 1.8002226203314244, "mean_processing_ms": 6.506813479380438}, "training_iteration": 21, "timesteps_total": 886263, "episode_reward_mean": -490.2742831548734, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -356.18022044095056, "episode_len_mean": 324.88, "timestamp": 1559179241, "episodes_this_iter": 41, "timesteps_since_restore": 886263, "time_since_restore": 680.9482350349426, "custom_metrics": {"cost1_mean": 184.9076447730284, "cost1_max": 207.86851821722635, "cost2_mean": -105.6994123961102, "cost2_max": -82.74651291270379, "system_level_velocity_max": 17.36526215121001, "cost2_min": -137.38581249740054, "system_level_velocity_min": 11.412836234446674, "system_level_velocity_mean": 15.318929292614547, "outflow_rate_mean": 1234.410221816175, "cost1_min": 135.7401547003584, "outflow_rate_min": 1010.3913254765171, "outflow_rate_max": 1366.707442580485}, "iterations_since_restore": 21}
{"info": {"num_steps_sampled": 927641, "sample_time_ms": 21011.71, "update_time_ms": 9.424, "learner": {"default_policy": {"policy_loss": -0.0023590971250087023, "entropy": 1.2686408758163452, "total_loss": 25.18739891052246, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8188759088516235, "vf_loss": 25.189552307128906, "kl": 0.008186346851289272, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11329.86, "load_time_ms": 5.97, "num_steps_trained": 926208}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1010, "pid": 45052, "episode_reward_min": -774.1912024056327, "time_total_s": 712.193751335144, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.245516300201416, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b66a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6510>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b6620>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b6598>)"}}, "done": false, "timesteps_this_iter": 41378, "off_policy_estimator": {}, "date": "2019-05-30_01-21-12", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.4978275284292, "mean_inference_ms": 1.7929548698347828, "mean_processing_ms": 6.488638080599008}, "training_iteration": 22, "timesteps_total": 927641, "episode_reward_mean": -483.70414197482864, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -24.068269131105353, "episode_len_mean": 321.91, "timestamp": 1559179272, "episodes_this_iter": 44, "timesteps_since_restore": 927641, "time_since_restore": 712.193751335144, "custom_metrics": {"cost1_mean": 182.80045702018344, "cost1_max": 208.8459647305741, "cost2_mean": -103.90602784947913, "cost2_max": -19.251881821947695, "system_level_velocity_max": 19.50032749560404, "cost2_min": -139.14405727876405, "system_level_velocity_min": 12.106430642199276, "system_level_velocity_mean": 15.319513864635603, "outflow_rate_mean": 1224.1811409069126, "cost1_min": 18.68585233428217, "outflow_rate_min": 497.50056700217027, "outflow_rate_max": 1366.707442580485}, "iterations_since_restore": 22}
{"info": {"num_steps_sampled": 969159, "sample_time_ms": 20927.098, "update_time_ms": 9.338, "learner": {"default_policy": {"policy_loss": -0.0023109177127480507, "entropy": 1.2469875812530518, "total_loss": 29.606916427612305, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.78304523229599, "vf_loss": 29.609006881713867, "kl": 0.008752543479204178, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11237.281, "load_time_ms": 6.208, "num_steps_trained": 967680}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1062, "pid": 45052, "episode_reward_min": -763.407435285626, "time_total_s": 744.1229684352875, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.929217100143433, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007a60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007c80>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007d90>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007f28>)"}}, "done": false, "timesteps_this_iter": 41518, "off_policy_estimator": {}, "date": "2019-05-30_01-21-44", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.4219505553832, "mean_inference_ms": 1.7844547335657208, "mean_processing_ms": 6.488163598109845}, "training_iteration": 23, "timesteps_total": 969159, "episode_reward_mean": -483.9479044875232, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -24.068269131105353, "episode_len_mean": 322.03, "timestamp": 1559179304, "episodes_this_iter": 52, "timesteps_since_restore": 969159, "time_since_restore": 744.1229684352875, "custom_metrics": {"cost1_mean": 183.89437387253705, "cost1_max": 208.8459647305741, "cost2_mean": -105.75769196888297, "cost2_max": -19.251881821947695, "system_level_velocity_max": 19.50032749560404, "cost2_min": -139.14405727876405, "system_level_velocity_min": 12.328555162793032, "system_level_velocity_mean": 15.4193136993513, "outflow_rate_mean": 1226.2036179148865, "cost1_min": 18.68585233428217, "outflow_rate_min": 497.50056700217027, "outflow_rate_max": 1379.255904035693}, "iterations_since_restore": 23}
{"info": {"num_steps_sampled": 1009392, "sample_time_ms": 20722.301, "update_time_ms": 9.399, "learner": {"default_policy": {"policy_loss": -0.00194746523629874, "entropy": 1.2519376277923584, "total_loss": 24.587970733642578, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8174862265586853, "vf_loss": 24.58971405029297, "kl": 0.008101118728518486, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10927.475, "load_time_ms": 5.921, "num_steps_trained": 1007872}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1106, "pid": 45052, "episode_reward_min": -763.407435285626, "time_total_s": 773.943142414093, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.820173978805542, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b6950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9488>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9378>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a92f0>)"}}, "done": false, "timesteps_this_iter": 40233, "off_policy_estimator": {}, "date": "2019-05-30_01-22-14", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.369733031626033, "mean_inference_ms": 1.7772666471224574, "mean_processing_ms": 6.493242447896206}, "training_iteration": 24, "timesteps_total": 1009392, "episode_reward_mean": -483.4707812703501, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -335.0560501528744, "episode_len_mean": 325.0, "timestamp": 1559179334, "episodes_this_iter": 44, "timesteps_since_restore": 1009392, "time_since_restore": 773.943142414093, "custom_metrics": {"cost1_mean": 186.88153415432237, "cost1_max": 210.23737063455775, "cost2_mean": -107.86671716932227, "cost2_max": -83.06718208558232, "system_level_velocity_max": 17.614325762151026, "cost2_min": -136.3123516735913, "system_level_velocity_min": 12.258109454073526, "system_level_velocity_mean": 15.501867155342575, "outflow_rate_mean": 1240.476132999209, "cost1_min": 147.87366929804583, "outflow_rate_min": 1051.6143396226419, "outflow_rate_max": 1400.6000718581583}, "iterations_since_restore": 24}
{"info": {"num_steps_sampled": 1050915, "sample_time_ms": 20340.707, "update_time_ms": 9.286, "learner": {"default_policy": {"policy_loss": -0.006950904615223408, "entropy": 1.2800641059875488, "total_loss": 25.87801170349121, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8136194348335266, "vf_loss": 25.88458251953125, "kl": 0.015280487947165966, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10921.592, "load_time_ms": 5.801, "num_steps_trained": 1049344}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1149, "pid": 45052, "episode_reward_min": -928.5293603148679, "time_total_s": 804.0598618984222, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.116719484329224, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b6f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6e18>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b6ea0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b6d90>)"}}, "done": false, "timesteps_this_iter": 41523, "off_policy_estimator": {}, "date": "2019-05-30_01-22-44", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.316517545729454, "mean_inference_ms": 1.770779045777534, "mean_processing_ms": 6.488657538663838}, "training_iteration": 25, "timesteps_total": 1050915, "episode_reward_mean": -493.5747171840646, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -335.0560501528744, "episode_len_mean": 325.0, "timestamp": 1559179364, "episodes_this_iter": 43, "timesteps_since_restore": 1050915, "time_since_restore": 804.0598618984222, "custom_metrics": {"cost1_mean": 185.23582166923833, "cost1_max": 210.23737063455775, "cost2_mean": -107.01301099945339, "cost2_max": -74.64013519162003, "system_level_velocity_max": 17.614325762151026, "cost2_min": -135.86218343982654, "system_level_velocity_min": 12.258109454073526, "system_level_velocity_mean": 15.361426591406287, "outflow_rate_mean": 1227.9334814361255, "cost1_min": 147.5939219394767, "outflow_rate_min": 711.0886362612688, "outflow_rate_max": 1400.6000718581583}, "iterations_since_restore": 25}
{"info": {"num_steps_sampled": 1094755, "sample_time_ms": 20521.119, "update_time_ms": 9.319, "learner": {"default_policy": {"policy_loss": -0.0030902342405170202, "entropy": 1.2973055839538574, "total_loss": 33.44178771972656, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.7816199660301208, "vf_loss": 33.44459915161133, "kl": 0.011181151494383812, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10798.276, "load_time_ms": 5.692, "num_steps_trained": 1093120}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1202, "pid": 45052, "episode_reward_min": -965.7128910860285, "time_total_s": 837.6571953296661, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.5973334312439, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9400>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9048>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9f28>)"}}, "done": false, "timesteps_this_iter": 43840, "off_policy_estimator": {}, "date": "2019-05-30_01-23-17", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.29775797885213, "mean_inference_ms": 1.7666639501196741, "mean_processing_ms": 6.491863454511611}, "training_iteration": 26, "timesteps_total": 1094755, "episode_reward_mean": -515.6700128695626, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -23.466720725629095, "episode_len_mean": 322.02, "timestamp": 1559179397, "episodes_this_iter": 53, "timesteps_since_restore": 1094755, "time_since_restore": 837.6571953296661, "custom_metrics": {"cost1_mean": 181.57300281348697, "cost1_max": 211.5311129221705, "cost2_mean": -107.54014776343361, "cost2_max": -18.56063068908755, "system_level_velocity_max": 17.77478423141302, "cost2_min": -139.92113699259258, "system_level_velocity_min": 11.937557243184441, "system_level_velocity_mean": 15.232101702811322, "outflow_rate_mean": 1202.0212604438354, "cost1_min": 17.896768953019226, "outflow_rate_min": 492.0625426222078, "outflow_rate_max": 1384.0821185913387}, "iterations_since_restore": 26}
{"info": {"num_steps_sampled": 1137736, "sample_time_ms": 20654.409, "update_time_ms": 9.13, "learner": {"default_policy": {"policy_loss": -0.0018640325870364904, "entropy": 1.2885595560073853, "total_loss": 32.578514099121094, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.8027423620223999, "vf_loss": 32.580135345458984, "kl": 0.009797793813049793, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10815.23, "load_time_ms": 5.658, "num_steps_trained": 1136000}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1247, "pid": 45052, "episode_reward_min": -965.7128910860285, "time_total_s": 870.940877199173, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.283681869506836, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9fd08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f378>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f950>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f9d8>)"}}, "done": false, "timesteps_this_iter": 42981, "off_policy_estimator": {}, "date": "2019-05-30_01-23-51", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.321534004909825, "mean_inference_ms": 1.7663168787054926, "mean_processing_ms": 6.510591965787281}, "training_iteration": 27, "timesteps_total": 1137736, "episode_reward_mean": -525.8417678853286, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -23.466720725629095, "episode_len_mean": 319.85, "timestamp": 1559179431, "episodes_this_iter": 45, "timesteps_since_restore": 1137736, "time_since_restore": 870.940877199173, "custom_metrics": {"cost1_mean": 181.17271969917252, "cost1_max": 214.54240361359913, "cost2_mean": -111.21888330194594, "cost2_max": -18.56063068908755, "system_level_velocity_max": 18.213198010283385, "cost2_min": -139.92113699259258, "system_level_velocity_min": 11.937557243184441, "system_level_velocity_mean": 15.328040792703984, "outflow_rate_mean": 1195.351862771873, "cost1_min": 17.896768953019226, "outflow_rate_min": 492.0625426222078, "outflow_rate_max": 1408.7234174204068}, "iterations_since_restore": 27}
{"info": {"num_steps_sampled": 1180814, "sample_time_ms": 20607.494, "update_time_ms": 9.143, "learner": {"default_policy": {"policy_loss": -0.002553346334025264, "entropy": 1.2881964445114136, "total_loss": 33.483673095703125, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8107039928436279, "vf_loss": 33.485992431640625, "kl": 0.009330698288977146, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10916.347, "load_time_ms": 5.637, "num_steps_trained": 1179008}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1290, "pid": 45052, "episode_reward_min": -964.723410201336, "time_total_s": 904.2768466472626, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.3359694480896, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9268>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9f28>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a91e0>)"}}, "done": false, "timesteps_this_iter": 43078, "off_policy_estimator": {}, "date": "2019-05-30_01-24-24", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.33695624148647, "mean_inference_ms": 1.766257777438574, "mean_processing_ms": 6.509781271904774}, "training_iteration": 28, "timesteps_total": 1180814, "episode_reward_mean": -535.1256979893019, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -121.60180381440392, "episode_len_mean": 321.73, "timestamp": 1559179464, "episodes_this_iter": 43, "timesteps_since_restore": 1180814, "time_since_restore": 904.2768466472626, "custom_metrics": {"cost1_mean": 181.93171080870692, "cost1_max": 214.54240361359913, "cost2_mean": -111.72086110843821, "cost2_max": -57.617570377595285, "system_level_velocity_max": 18.213198010283385, "cost2_min": -148.93444145753182, "system_level_velocity_min": 12.011504266016184, "system_level_velocity_mean": 15.31322965276353, "outflow_rate_mean": 1190.6086224619653, "cost1_min": 82.97785056769577, "outflow_rate_min": 710.2810994687129, "outflow_rate_max": 1408.7234174204068}, "iterations_since_restore": 28}
{"info": {"num_steps_sampled": 1222788, "sample_time_ms": 20619.011, "update_time_ms": 9.219, "learner": {"default_policy": {"policy_loss": -0.0028982663061469793, "entropy": 1.28177809715271, "total_loss": 28.890958786010742, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8267958760261536, "vf_loss": 28.89365577697754, "kl": 0.008037696592509747, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10990.211, "load_time_ms": 5.733, "num_steps_trained": 1220864}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1333, "pid": 45052, "episode_reward_min": -945.9953919049934, "time_total_s": 936.1633846759796, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.88653802871704, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b6ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6598>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b67b8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b6ae8>)"}}, "done": false, "timesteps_this_iter": 41974, "off_policy_estimator": {}, "date": "2019-05-30_01-24-56", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.32801724366334, "mean_inference_ms": 1.7635198822835862, "mean_processing_ms": 6.4968000059425695}, "training_iteration": 29, "timesteps_total": 1222788, "episode_reward_mean": -519.5125229711275, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -25.284277498158133, "episode_len_mean": 320.92, "timestamp": 1559179496, "episodes_this_iter": 43, "timesteps_since_restore": 1222788, "time_since_restore": 936.1633846759796, "custom_metrics": {"cost1_mean": 181.7385661171456, "cost1_max": 210.80208965403807, "cost2_mean": -108.162857503537, "cost2_max": -20.06789259500633, "system_level_velocity_max": 17.784420340534997, "cost2_min": -148.93444145753182, "system_level_velocity_min": 12.17090108523769, "system_level_velocity_mean": 15.337164467264065, "outflow_rate_mean": 1190.7275340801648, "cost1_min": 17.980665868490238, "outflow_rate_min": 450.3077675576719, "outflow_rate_max": 1393.6235594402099}, "iterations_since_restore": 29}
{"info": {"num_steps_sampled": 1264078, "sample_time_ms": 20510.98, "update_time_ms": 9.155, "learner": {"default_policy": {"policy_loss": -0.0037326517049223185, "entropy": 1.2657935619354248, "total_loss": 30.548864364624023, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8075885772705078, "vf_loss": 30.55224609375, "kl": 0.014106273651123047, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11041.427, "load_time_ms": 5.878, "num_steps_trained": 1262080}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1390, "pid": 45052, "episode_reward_min": -942.028142662312, "time_total_s": 967.8368170261383, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.67343235015869, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87ba400>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87ba268>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87ba378>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87ba2f0>)"}}, "done": false, "timesteps_this_iter": 41290, "off_policy_estimator": {}, "date": "2019-05-30_01-25-28", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.282450308463936, "mean_inference_ms": 1.7569951175753482, "mean_processing_ms": 6.504273898846377}, "training_iteration": 30, "timesteps_total": 1264078, "episode_reward_mean": -497.14534096963905, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -25.284277498158133, "episode_len_mean": 319.14, "timestamp": 1559179528, "episodes_this_iter": 57, "timesteps_since_restore": 1264078, "time_since_restore": 967.8368170261383, "custom_metrics": {"cost1_mean": 179.99632107339437, "cost1_max": 212.2845704109677, "cost2_mean": -103.33077525883307, "cost2_max": -20.06789259500633, "system_level_velocity_max": 18.911673469177536, "cost2_min": -147.00183499064906, "system_level_velocity_min": 12.513573581890668, "system_level_velocity_mean": 15.292288186227111, "outflow_rate_mean": 1190.966941857495, "cost1_min": 17.980665868490238, "outflow_rate_min": 450.3077675576719, "outflow_rate_max": 1385.8967245074246}, "iterations_since_restore": 30}
{"info": {"num_steps_sampled": 1305116, "sample_time_ms": 20496.371, "update_time_ms": 9.066, "learner": {"default_policy": {"policy_loss": -0.005508385598659515, "entropy": 1.2749121189117432, "total_loss": 28.79922866821289, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8158532381057739, "vf_loss": 28.804346084594727, "kl": 0.01573098637163639, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11082.385, "load_time_ms": 5.893, "num_steps_trained": 1303040}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1432, "pid": 45052, "episode_reward_min": -952.7737563732472, "time_total_s": 997.779242515564, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.94242548942566, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a91e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9268>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9048>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9f28>)"}}, "done": false, "timesteps_this_iter": 41038, "off_policy_estimator": {}, "date": "2019-05-30_01-25-58", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.24008345766838, "mean_inference_ms": 1.7515612946495744, "mean_processing_ms": 6.50321349623842}, "training_iteration": 31, "timesteps_total": 1305116, "episode_reward_mean": -493.2954039556669, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -32.64560525024918, "episode_len_mean": 322.12, "timestamp": 1559179558, "episodes_this_iter": 42, "timesteps_since_restore": 1305116, "time_since_restore": 997.779242515564, "custom_metrics": {"cost1_mean": 181.37147310942066, "cost1_max": 212.2845704109677, "cost2_mean": -101.51833220382248, "cost2_max": -24.424770987720738, "system_level_velocity_max": 18.911673469177536, "cost2_min": -147.00183499064906, "system_level_velocity_min": 11.96066629515139, "system_level_velocity_mean": 15.255910678492258, "outflow_rate_mean": 1196.9626992694255, "cost1_min": 24.58937140861079, "outflow_rate_min": 504.77807277306727, "outflow_rate_max": 1380.106601473923}, "iterations_since_restore": 31}
{"info": {"num_steps_sampled": 1346271, "sample_time_ms": 20478.511, "update_time_ms": 9.275, "learner": {"default_policy": {"policy_loss": -0.0025816725101321936, "entropy": 1.254256248474121, "total_loss": 24.608421325683594, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8306443691253662, "vf_loss": 24.610780715942383, "kl": 0.008937963284552097, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11046.503, "load_time_ms": 5.789, "num_steps_trained": 1344128}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1475, "pid": 45052, "episode_reward_min": -952.7737563732472, "time_total_s": 1028.4844181537628, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.705175638198853, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9400>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9158>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9ae8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9b70>)"}}, "done": false, "timesteps_this_iter": 41155, "off_policy_estimator": {}, "date": "2019-05-30_01-26-29", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.185796279413776, "mean_inference_ms": 1.7465713162066931, "mean_processing_ms": 6.485185237527385}, "training_iteration": 32, "timesteps_total": 1346271, "episode_reward_mean": -500.4287087735073, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -24.648980017139316, "episode_len_mean": 322.02, "timestamp": 1559179589, "episodes_this_iter": 43, "timesteps_since_restore": 1346271, "time_since_restore": 1028.4844181537628, "custom_metrics": {"cost1_mean": 179.85784722411321, "cost1_max": 212.2845704109677, "cost2_mean": -102.28998165654126, "cost2_max": -20.19471210422128, "system_level_velocity_max": 18.905480308454198, "cost2_min": -147.00183499064906, "system_level_velocity_min": 11.88914974235456, "system_level_velocity_mean": 15.134322747680455, "outflow_rate_mean": 1188.745477439958, "cost1_min": 18.1097081868912, "outflow_rate_min": 457.848998964932, "outflow_rate_max": 1380.106601473923}, "iterations_since_restore": 32}
{"info": {"num_steps_sampled": 1385994, "sample_time_ms": 22002.355, "update_time_ms": 11.301, "learner": {"default_policy": {"policy_loss": -0.004599618725478649, "entropy": 1.278802514076233, "total_loss": 29.73255157470703, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7971280813217163, "vf_loss": 29.736854553222656, "kl": 0.011888259090483189, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11036.031, "load_time_ms": 5.594, "num_steps_trained": 1383808}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1531, "pid": 45052, "episode_reward_min": -929.8769732655705, "time_total_s": 1075.5892148017883, "num_metric_batches_dropped": 0, "time_this_iter_s": 47.10479664802551, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b6c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b6d90>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b6bf8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b6950>)"}}, "done": false, "timesteps_this_iter": 39723, "off_policy_estimator": {}, "date": "2019-05-30_01-27-34", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.381203559743224, "mean_inference_ms": 1.7878365269791774, "mean_processing_ms": 6.545226006218245}, "training_iteration": 33, "timesteps_total": 1385994, "episode_reward_mean": -486.25688253357106, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -24.648980017139316, "episode_len_mean": 320.04, "timestamp": 1559179654, "episodes_this_iter": 56, "timesteps_since_restore": 1385994, "time_since_restore": 1075.5892148017883, "custom_metrics": {"cost1_mean": 180.38890971952785, "cost1_max": 214.771740454189, "cost2_mean": -102.15509887067967, "cost2_max": -20.19471210422128, "system_level_velocity_max": 18.905480308454198, "cost2_min": -136.18725108259883, "system_level_velocity_min": 11.88914974235456, "system_level_velocity_mean": 15.319159075301565, "outflow_rate_mean": 1196.4655890229553, "cost1_min": 18.1097081868912, "outflow_rate_min": 457.848998964932, "outflow_rate_max": 1405.277367511521}, "iterations_since_restore": 33}
{"info": {"num_steps_sampled": 1428438, "sample_time_ms": 22142.239, "update_time_ms": 11.629, "learner": {"default_policy": {"policy_loss": -0.0045531922951340675, "entropy": 1.2786670923233032, "total_loss": 31.529815673828125, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8057360053062439, "vf_loss": 31.534029006958008, "kl": 0.0135673051699996, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11206.204, "load_time_ms": 5.784, "num_steps_trained": 1426176}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1573, "pid": 45052, "episode_reward_min": -916.124651773349, "time_total_s": 1108.5350077152252, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.94579291343689, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87ae378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87ae1e0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87ae2f0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87ae268>)"}}, "done": false, "timesteps_this_iter": 42444, "off_policy_estimator": {}, "date": "2019-05-30_01-28-07", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.52718621304085, "mean_inference_ms": 1.8181767715075972, "mean_processing_ms": 6.588515439013765}, "training_iteration": 34, "timesteps_total": 1428438, "episode_reward_mean": -508.54277394486684, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -122.7197715621794, "episode_len_mean": 322.74, "timestamp": 1559179687, "episodes_this_iter": 42, "timesteps_since_restore": 1428438, "time_since_restore": 1108.5350077152252, "custom_metrics": {"cost1_mean": 180.54519342738223, "cost1_max": 214.771740454189, "cost2_mean": -104.02485403062856, "cost2_max": -53.49930788285232, "system_level_velocity_max": 18.199524026800358, "cost2_min": -141.56959505342292, "system_level_velocity_min": 11.944252225723226, "system_level_velocity_mean": 15.196451458739235, "outflow_rate_mean": 1191.5611646501575, "cost1_min": 84.37785183995607, "outflow_rate_min": 711.0634140435836, "outflow_rate_max": 1405.277367511521}, "iterations_since_restore": 34}
{"info": {"num_steps_sampled": 1468610, "sample_time_ms": 22148.512, "update_time_ms": 11.931, "learner": {"default_policy": {"policy_loss": -0.0022130226716399193, "entropy": 1.2976419925689697, "total_loss": 29.949548721313477, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8183330297470093, "vf_loss": 29.951467514038086, "kl": 0.011823776178061962, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11283.395, "load_time_ms": 6.142, "num_steps_trained": 1466240}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1616, "pid": 45052, "episode_reward_min": -916.124651773349, "time_total_s": 1139.4807980060577, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.94579029083252, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87b6b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87b66a8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87b6730>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87b6840>)"}}, "done": false, "timesteps_this_iter": 40172, "off_policy_estimator": {}, "date": "2019-05-30_01-28-38", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.487869953791733, "mean_inference_ms": 1.8151215221124495, "mean_processing_ms": 6.577384417848589}, "training_iteration": 35, "timesteps_total": 1468610, "episode_reward_mean": -518.381094335737, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -311.71733619107573, "episode_len_mean": 324.72, "timestamp": 1559179718, "episodes_this_iter": 43, "timesteps_since_restore": 1468610, "time_since_restore": 1139.4807980060577, "custom_metrics": {"cost1_mean": 179.2821496903736, "cost1_max": 214.771740454189, "cost2_mean": -102.2102269057545, "cost2_max": -51.33578309138013, "system_level_velocity_max": 17.972823709108912, "cost2_min": -141.56959505342292, "system_level_velocity_min": 11.944252225723226, "system_level_velocity_mean": 14.988496457659597, "outflow_rate_mean": 1183.7464567116087, "cost1_min": 141.03964536743922, "outflow_rate_min": 711.0634140435836, "outflow_rate_max": 1405.277367511521}, "iterations_since_restore": 35}
{"info": {"num_steps_sampled": 1508535, "sample_time_ms": 21858.651, "update_time_ms": 11.937, "learner": {"default_policy": {"policy_loss": -0.003629531944170594, "entropy": 1.266815423965454, "total_loss": 31.55009651184082, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8172245621681213, "vf_loss": 31.553386688232422, "kl": 0.013395214453339577, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11281.189, "load_time_ms": 5.927, "num_steps_trained": 1506048}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1664, "pid": 45052, "episode_reward_min": -792.6072531591698, "time_total_s": 1170.161580324173, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.680782318115234, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab032620>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007a60>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007c80>)"}}, "done": false, "timesteps_this_iter": 39925, "off_policy_estimator": {}, "date": "2019-05-30_01-29-09", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.434288112284342, "mean_inference_ms": 1.8095142723596729, "mean_processing_ms": 6.563680870300058}, "training_iteration": 36, "timesteps_total": 1508535, "episode_reward_mean": -506.2841683898309, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -319.25563481649857, "episode_len_mean": 325.0, "timestamp": 1559179749, "episodes_this_iter": 48, "timesteps_since_restore": 1508535, "time_since_restore": 1170.161580324173, "custom_metrics": {"cost1_mean": 179.30367940292192, "cost1_max": 214.04902219431204, "cost2_mean": -100.47607169523042, "cost2_max": -49.53714804354367, "system_level_velocity_max": 18.011749250111958, "cost2_min": -141.56959505342292, "system_level_velocity_min": 11.22567327916417, "system_level_velocity_mean": 14.977714369427606, "outflow_rate_mean": 1188.8793009805675, "cost1_min": 132.14766101575236, "outflow_rate_min": 901.8508760330576, "outflow_rate_max": 1395.2653197560016}, "iterations_since_restore": 36}
{"info": {"num_steps_sampled": 1545513, "sample_time_ms": 21541.153, "update_time_ms": 12.105, "learner": {"default_policy": {"policy_loss": -0.004519701469689608, "entropy": 1.3187326192855835, "total_loss": 31.693464279174805, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8395959138870239, "vf_loss": 31.69759750366211, "kl": 0.015464810654520988, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11186.798, "load_time_ms": 6.068, "num_steps_trained": 1542912}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1713, "pid": 45052, "episode_reward_min": -748.6498611040577, "time_total_s": 1199.3229887485504, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.16140842437744, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59efbf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59efae8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59efb70>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59efa60>)"}}, "done": false, "timesteps_this_iter": 36978, "off_policy_estimator": {}, "date": "2019-05-30_01-29-38", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.367545670863393, "mean_inference_ms": 1.803330746920875, "mean_processing_ms": 6.564621032775551}, "training_iteration": 37, "timesteps_total": 1545513, "episode_reward_mean": -470.9581947401419, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -32.66445506176196, "episode_len_mean": 318.59, "timestamp": 1559179778, "episodes_this_iter": 49, "timesteps_since_restore": 1545513, "time_since_restore": 1199.3229887485504, "custom_metrics": {"cost1_mean": 176.39771373434226, "cost1_max": 214.04902219431204, "cost2_mean": -93.73453685936633, "cost2_max": -23.85877111753075, "system_level_velocity_max": 18.460125235879193, "cost2_min": -131.20795984670372, "system_level_velocity_min": 11.22567327916417, "system_level_velocity_mean": 15.13096899252334, "outflow_rate_mean": 1176.1411569955592, "cost1_min": 22.95808659324467, "outflow_rate_min": 477.1206855028346, "outflow_rate_max": 1405.3302289577377}, "iterations_since_restore": 37}
{"info": {"num_steps_sampled": 1585511, "sample_time_ms": 21389.815, "update_time_ms": 12.227, "learner": {"default_policy": {"policy_loss": -0.002994802314788103, "entropy": 1.2577582597732544, "total_loss": 31.043983459472656, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8439682126045227, "vf_loss": 31.04671287536621, "kl": 0.010659627616405487, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10999.986, "load_time_ms": 6.381, "num_steps_trained": 1582848}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1757, "pid": 45052, "episode_reward_min": -748.6498611040577, "time_total_s": 1229.2665197849274, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.943531036376953, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59ef7b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59ef6a8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59ef730>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59ef620>)"}}, "done": false, "timesteps_this_iter": 39998, "off_policy_estimator": {}, "date": "2019-05-30_01-30-08", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.315242604188217, "mean_inference_ms": 1.7988312429627884, "mean_processing_ms": 6.5660028092398735}, "training_iteration": 38, "timesteps_total": 1585511, "episode_reward_mean": -460.5158946045014, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -31.13985227705219, "episode_len_mean": 315.69, "timestamp": 1559179808, "episodes_this_iter": 44, "timesteps_since_restore": 1585511, "time_since_restore": 1229.2665197849274, "custom_metrics": {"cost1_mean": 176.94960983966746, "cost1_max": 218.85001688998426, "cost2_mean": -94.23307549831263, "cost2_max": -23.340341032925345, "system_level_velocity_max": 18.472365768686966, "cost2_min": -132.40441647664414, "system_level_velocity_min": 10.914795335344397, "system_level_velocity_mean": 15.375091559766622, "outflow_rate_mean": 1181.9198227624738, "cost1_min": 22.82183770794583, "outflow_rate_min": 477.1206855028346, "outflow_rate_max": 1431.4296124842897}, "iterations_since_restore": 38}
{"info": {"num_steps_sampled": 1627001, "sample_time_ms": 21555.483, "update_time_ms": 12.026, "learner": {"default_policy": {"policy_loss": -0.0036195251159369946, "entropy": 1.2515780925750732, "total_loss": 30.560047149658203, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8502997756004333, "vf_loss": 30.563392639160156, "kl": 0.010879699140787125, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10873.401, "load_time_ms": 6.536, "num_steps_trained": 1624320}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1807, "pid": 45052, "episode_reward_min": -768.8783605614635, "time_total_s": 1261.5299379825592, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.263418197631836, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf967b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf96620>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf96730>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf966a8>)"}}, "done": false, "timesteps_this_iter": 41490, "off_policy_estimator": {}, "date": "2019-05-30_01-30-40", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.289984403202126, "mean_inference_ms": 1.796765170745695, "mean_processing_ms": 6.564863711359979}, "training_iteration": 39, "timesteps_total": 1627001, "episode_reward_mean": -486.3522994011561, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -31.13985227705219, "episode_len_mean": 314.79, "timestamp": 1559179840, "episodes_this_iter": 50, "timesteps_since_restore": 1627001, "time_since_restore": 1261.5299379825592, "custom_metrics": {"cost1_mean": 177.74166463418342, "cost1_max": 218.85001688998426, "cost2_mean": -103.9132682851554, "cost2_max": -23.340341032925345, "system_level_velocity_max": 18.644183558037014, "cost2_min": -137.84751929278394, "system_level_velocity_min": 10.914795335344397, "system_level_velocity_mean": 15.469243783569484, "outflow_rate_mean": 1191.37332341566, "cost1_min": 22.82183770794583, "outflow_rate_min": 512.5194798574704, "outflow_rate_max": 1431.4296124842897}, "iterations_since_restore": 39}
{"info": {"num_steps_sampled": 1668352, "sample_time_ms": 21724.715, "update_time_ms": 11.871, "learner": {"default_policy": {"policy_loss": -0.004224794451147318, "entropy": 1.2447547912597656, "total_loss": 30.369956970214844, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8477346897125244, "vf_loss": 30.373863220214844, "kl": 0.012888303026556969, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10773.742, "load_time_ms": 6.18, "num_steps_trained": 1665664}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1855, "pid": 45052, "episode_reward_min": -768.8783605614635, "time_total_s": 1293.8951659202576, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.365227937698364, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab032620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9620>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab032730>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab0327b8>)"}}, "done": false, "timesteps_this_iter": 41351, "off_policy_estimator": {}, "date": "2019-05-30_01-31-13", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.297684990170545, "mean_inference_ms": 1.7965602819905178, "mean_processing_ms": 6.579204853719213}, "training_iteration": 40, "timesteps_total": 1668352, "episode_reward_mean": -517.1871170986614, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -105.21427916687615, "episode_len_mean": 320.66, "timestamp": 1559179873, "episodes_this_iter": 48, "timesteps_since_restore": 1668352, "time_since_restore": 1293.8951659202576, "custom_metrics": {"cost1_mean": 180.71193248969251, "cost1_max": 218.339412549382, "cost2_mean": -110.3119980624928, "cost2_max": -54.384637694034595, "system_level_velocity_max": 18.644183558037014, "cost2_min": -137.84751929278394, "system_level_velocity_min": 10.51792562398383, "system_level_velocity_mean": 15.379492281311634, "outflow_rate_mean": 1204.1547042817563, "cost1_min": 77.1147716458207, "outflow_rate_min": 733.9314368315893, "outflow_rate_max": 1428.1344471116918}, "iterations_since_restore": 40}
{"info": {"num_steps_sampled": 1710824, "sample_time_ms": 21972.547, "update_time_ms": 11.925, "learner": {"default_policy": {"policy_loss": -0.004469504114240408, "entropy": 1.2417616844177246, "total_loss": 27.98089599609375, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8567035794258118, "vf_loss": 27.985029220581055, "kl": 0.01332214567810297, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 10852.472, "load_time_ms": 6.488, "num_steps_trained": 1708032}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1899, "pid": 45052, "episode_reward_min": -768.8783605614635, "time_total_s": 1327.1397035121918, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.244537591934204, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59fd158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf96f28>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59fd0d0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59fd048>)"}}, "done": false, "timesteps_this_iter": 42472, "off_policy_estimator": {}, "date": "2019-05-30_01-31-46", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.30647538693924, "mean_inference_ms": 1.796241113535728, "mean_processing_ms": 6.581751308299903}, "training_iteration": 41, "timesteps_total": 1710824, "episode_reward_mean": -540.173781897244, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -34.93007645651555, "episode_len_mean": 321.94, "timestamp": 1559179906, "episodes_this_iter": 44, "timesteps_since_restore": 1710824, "time_since_restore": 1327.1397035121918, "custom_metrics": {"cost1_mean": 177.65476661575957, "cost1_max": 220.70440914728454, "cost2_mean": -111.44863394691167, "cost2_max": -26.141968220543273, "system_level_velocity_max": 18.666446685238988, "cost2_min": -135.91411566592868, "system_level_velocity_min": 10.51792562398383, "system_level_velocity_mean": 15.066072852017557, "outflow_rate_mean": 1188.9831555958926, "cost1_min": 24.109408379196836, "outflow_rate_min": 475.9131644541374, "outflow_rate_max": 1441.4996374458879}, "iterations_since_restore": 41}
{"info": {"num_steps_sampled": 1752481, "sample_time_ms": 22089.071, "update_time_ms": 12.243, "learner": {"default_policy": {"policy_loss": -0.004167376551777124, "entropy": 1.269197940826416, "total_loss": 31.534990310668945, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.8450178503990173, "vf_loss": 31.538860321044922, "kl": 0.011817394755780697, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11243.927, "load_time_ms": 6.896, "num_steps_trained": 1749632}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1945, "pid": 45052, "episode_reward_min": -774.4019212998232, "time_total_s": 1362.972627878189, "num_metric_batches_dropped": 0, "time_this_iter_s": 35.832924365997314, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59fdbf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59fda60>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59fdb70>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59fdae8>)"}}, "done": false, "timesteps_this_iter": 41657, "off_policy_estimator": {}, "date": "2019-05-30_01-32-22", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.29004532180175, "mean_inference_ms": 1.7933034817544624, "mean_processing_ms": 6.580620128146496}, "training_iteration": 42, "timesteps_total": 1752481, "episode_reward_mean": -524.2098239421463, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -23.545239253263098, "episode_len_mean": 318.96, "timestamp": 1559179942, "episodes_this_iter": 46, "timesteps_since_restore": 1752481, "time_since_restore": 1362.972627878189, "custom_metrics": {"cost1_mean": 177.3532999379707, "cost1_max": 220.70440914728454, "cost2_mean": -110.32072465069533, "cost2_max": -19.025877527875412, "system_level_velocity_max": 18.666446685238988, "cost2_min": -136.98491854443122, "system_level_velocity_min": 11.518140930069169, "system_level_velocity_mean": 15.198239950723256, "outflow_rate_mean": 1195.2750900548174, "cost1_min": 17.90907948108976, "outflow_rate_min": 475.9131644541374, "outflow_rate_max": 1441.4996374458879}, "iterations_since_restore": 42}
{"info": {"num_steps_sampled": 1792936, "sample_time_ms": 20588.656, "update_time_ms": 10.028, "learner": {"default_policy": {"policy_loss": -0.005394183099269867, "entropy": 1.2997387647628784, "total_loss": 30.716676712036133, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8617382049560547, "vf_loss": 30.721691131591797, "kl": 0.015130688436329365, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11346.148, "load_time_ms": 6.98, "num_steps_trained": 1790080}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 1995, "pid": 45052, "episode_reward_min": -774.4019212998232, "time_total_s": 1396.052815914154, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.080188035964966, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a91e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9048>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9268>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9ae8>)"}}, "done": false, "timesteps_this_iter": 40455, "off_policy_estimator": {}, "date": "2019-05-30_01-32-55", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.280327427457067, "mean_inference_ms": 1.7915681428994767, "mean_processing_ms": 6.579114556102532}, "training_iteration": 43, "timesteps_total": 1792936, "episode_reward_mean": -530.1341893154897, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -23.545239253263098, "episode_len_mean": 322.02, "timestamp": 1559179975, "episodes_this_iter": 50, "timesteps_since_restore": 1792936, "time_since_restore": 1396.052815914154, "custom_metrics": {"cost1_mean": 175.18178799544933, "cost1_max": 220.40706124896553, "cost2_mean": -107.28837621466045, "cost2_max": -19.025877527875412, "system_level_velocity_max": 18.647158938401148, "cost2_min": -136.98491854443122, "system_level_velocity_min": 10.545752217926147, "system_level_velocity_mean": 14.825702992312666, "outflow_rate_mean": 1182.1475635308568, "cost1_min": 17.90907948108976, "outflow_rate_min": 493.8123238995481, "outflow_rate_max": 1439.1552047279658}, "iterations_since_restore": 43}
{"info": {"num_steps_sampled": 1831841, "sample_time_ms": 20502.038, "update_time_ms": 9.504, "learner": {"default_policy": {"policy_loss": -0.003442657645791769, "entropy": 1.254090428352356, "total_loss": 31.02185821533203, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.8542645573616028, "vf_loss": 31.024988174438477, "kl": 0.012578384950757027, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11203.578, "load_time_ms": 6.725, "num_steps_trained": 1828864}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 2040, "pid": 45052, "episode_reward_min": -757.4822471004454, "time_total_s": 1426.68075299263, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.627937078475952, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59fb158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59fdf28>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59fb0d0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59fb048>)"}}, "done": false, "timesteps_this_iter": 38905, "off_policy_estimator": {}, "date": "2019-05-30_01-33-26", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.261791356390173, "mean_inference_ms": 1.7903616002568146, "mean_processing_ms": 6.581334113618242}, "training_iteration": 44, "timesteps_total": 1831841, "episode_reward_mean": -520.6469399403358, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -307.53682231531116, "episode_len_mean": 325.0, "timestamp": 1559180006, "episodes_this_iter": 45, "timesteps_since_restore": 1831841, "time_since_restore": 1426.68075299263, "custom_metrics": {"cost1_mean": 176.6037819903926, "cost1_max": 219.24257920383897, "cost2_mean": -105.00274070046936, "cost2_max": -60.64106956297147, "system_level_velocity_max": 18.479348597802137, "cost2_min": -136.52806754339286, "system_level_velocity_min": 10.545752217926147, "system_level_velocity_mean": 14.786415141405282, "outflow_rate_mean": 1184.2987226305863, "cost1_min": 124.4351444787069, "outflow_rate_min": 909.6900475847148, "outflow_rate_max": 1424.5841391941397}, "iterations_since_restore": 44}
{"info": {"num_steps_sampled": 1871375, "sample_time_ms": 20687.336, "update_time_ms": 9.32, "learner": {"default_policy": {"policy_loss": -0.004519871436059475, "entropy": 1.2786786556243896, "total_loss": 32.89179229736328, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8438205718994141, "vf_loss": 32.89588165283203, "kl": 0.017380578443408012, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11129.461, "load_time_ms": 6.579, "num_steps_trained": 1868288}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 2085, "pid": 45052, "episode_reward_min": -757.4822471004454, "time_total_s": 1458.741304397583, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.060551404953, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59fdae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59fdb70>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59fdbf8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59fda60>)"}}, "done": false, "timesteps_this_iter": 39534, "off_policy_estimator": {}, "date": "2019-05-30_01-33-58", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.227886409467665, "mean_inference_ms": 1.7887692042308736, "mean_processing_ms": 6.584544936919403}, "training_iteration": 45, "timesteps_total": 1871375, "episode_reward_mean": -494.30501211224214, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -102.79850983754284, "episode_len_mean": 322.92, "timestamp": 1559180038, "episodes_this_iter": 45, "timesteps_since_restore": 1871375, "time_since_restore": 1458.741304397583, "custom_metrics": {"cost1_mean": 178.61848373512103, "cost1_max": 219.24257920383897, "cost2_mean": -103.5950463016942, "cost2_max": -57.73354310849249, "system_level_velocity_max": 18.638793015247547, "cost2_min": -137.92704923164632, "system_level_velocity_min": 10.545752217926147, "system_level_velocity_mean": 15.086273819788495, "outflow_rate_mean": 1189.1418900967299, "cost1_min": 79.13853382151409, "outflow_rate_min": 782.893236005935, "outflow_rate_max": 1426.4867188237831}, "iterations_since_restore": 45}
{"info": {"num_steps_sampled": 1912828, "sample_time_ms": 20970.733, "update_time_ms": 9.24, "learner": {"default_policy": {"policy_loss": -0.004708591382950544, "entropy": 1.231967568397522, "total_loss": 27.96295738220215, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8603179454803467, "vf_loss": 27.967287063598633, "kl": 0.015111967921257019, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11099.409, "load_time_ms": 6.768, "num_steps_trained": 1909632}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 2136, "pid": 45052, "episode_reward_min": -746.7865709767724, "time_total_s": 1491.9540524482727, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.2127480506897, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007ea0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007d90>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007d08>)"}}, "done": false, "timesteps_this_iter": 41453, "off_policy_estimator": {}, "date": "2019-05-30_01-34-31", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.229777409861693, "mean_inference_ms": 1.7894395880424212, "mean_processing_ms": 6.587913315146944}, "training_iteration": 46, "timesteps_total": 1912828, "episode_reward_mean": -505.44603059133624, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -102.79850983754284, "episode_len_mean": 321.74, "timestamp": 1559180071, "episodes_this_iter": 51, "timesteps_since_restore": 1912828, "time_since_restore": 1491.9540524482727, "custom_metrics": {"cost1_mean": 179.0664854926233, "cost1_max": 219.15716806237367, "cost2_mean": -107.15229368262838, "cost2_max": -57.73354310849249, "system_level_velocity_max": 18.83278448300901, "cost2_min": -137.92704923164632, "system_level_velocity_min": 10.844119381572215, "system_level_velocity_mean": 15.180979488283901, "outflow_rate_mean": 1191.2615720352662, "cost1_min": 79.13853382151409, "outflow_rate_min": 782.893236005935, "outflow_rate_max": 1436.6195208506467}, "iterations_since_restore": 46}
{"info": {"num_steps_sampled": 1955572, "sample_time_ms": 21225.684, "update_time_ms": 9.192, "learner": {"default_policy": {"policy_loss": -0.004415655042976141, "entropy": 1.2084846496582031, "total_loss": 21.53759002685547, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8879958987236023, "vf_loss": 21.541624069213867, "kl": 0.015285174362361431, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11292.426, "load_time_ms": 6.844, "num_steps_trained": 1952256}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 2180, "pid": 45052, "episode_reward_min": -746.7865709767724, "time_total_s": 1525.611704826355, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.657652378082275, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007f28>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007620>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007a60>)"}}, "done": false, "timesteps_this_iter": 42744, "off_policy_estimator": {}, "date": "2019-05-30_01-35-05", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.245982746847766, "mean_inference_ms": 1.7901050450595448, "mean_processing_ms": 6.589759927246682}, "training_iteration": 47, "timesteps_total": 1955572, "episode_reward_mean": -534.9037185799974, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -182.701232842801, "episode_len_mean": 323.82, "timestamp": 1559180105, "episodes_this_iter": 44, "timesteps_since_restore": 1955572, "time_since_restore": 1525.611704826355, "custom_metrics": {"cost1_mean": 180.60980724250922, "cost1_max": 223.03193251617105, "cost2_mean": -113.60920365394709, "cost2_max": -63.65613911865634, "system_level_velocity_max": 18.907632213985625, "cost2_min": -136.08725405067375, "system_level_velocity_min": 11.92763700760238, "system_level_velocity_mean": 15.163506194898229, "outflow_rate_mean": 1206.0204574829977, "cost1_min": 141.45901902074175, "outflow_rate_min": 1020.7445950413223, "outflow_rate_max": 1436.6195208506467}, "iterations_since_restore": 47}
{"info": {"num_steps_sampled": 1996367, "sample_time_ms": 21386.301, "update_time_ms": 9.419, "learner": {"default_policy": {"policy_loss": -0.006374419201165438, "entropy": 1.2619915008544922, "total_loss": 25.99558448791504, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.8676502704620361, "vf_loss": 26.001461029052734, "kl": 0.019738029688596725, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11402.492, "load_time_ms": 6.455, "num_steps_trained": 1992960}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 2226, "pid": 45052, "episode_reward_min": -745.4600729963449, "time_total_s": 1558.262927055359, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.651222229003906, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59fd400>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59fdae8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59fda60>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59fdb70>)"}}, "done": false, "timesteps_this_iter": 40795, "off_policy_estimator": {}, "date": "2019-05-30_01-35-37", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.247436742828388, "mean_inference_ms": 1.7901724897994873, "mean_processing_ms": 6.594368080025675}, "training_iteration": 48, "timesteps_total": 1996367, "episode_reward_mean": -533.938950695409, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -105.8617739356135, "episode_len_mean": 320.94, "timestamp": 1559180137, "episodes_this_iter": 46, "timesteps_since_restore": 1996367, "time_since_restore": 1558.262927055359, "custom_metrics": {"cost1_mean": 176.43302923137693, "cost1_max": 223.03193251617105, "cost2_mean": -109.63328414777742, "cost2_max": -61.46560287947959, "system_level_velocity_max": 18.907632213985625, "cost2_min": -133.8111625559684, "system_level_velocity_min": 11.681436791138637, "system_level_velocity_mean": 14.974887494461385, "outflow_rate_mean": 1182.708220150775, "cost1_min": 79.48342754249289, "outflow_rate_min": 757.4587061397813, "outflow_rate_max": 1436.1686780190728}, "iterations_since_restore": 48}
{"info": {"num_steps_sampled": 2035900, "sample_time_ms": 21225.055, "update_time_ms": 9.638, "learner": {"default_policy": {"policy_loss": -0.005058521404862404, "entropy": 1.2657110691070557, "total_loss": 25.778316497802734, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8689935803413391, "vf_loss": 25.782983779907227, "kl": 0.01559825986623764, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11469.877, "load_time_ms": 5.98, "num_steps_trained": 2032384}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 2273, "pid": 45052, "episode_reward_min": -711.2801600456755, "time_total_s": 1589.6040308475494, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.34110379219055, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59fd510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59fd598>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59fdf28>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59fd268>)"}}, "done": false, "timesteps_this_iter": 39533, "off_policy_estimator": {}, "date": "2019-05-30_01-36-09", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.237976790663485, "mean_inference_ms": 1.7896365617161996, "mean_processing_ms": 6.592517985155577}, "training_iteration": 49, "timesteps_total": 2035900, "episode_reward_mean": -505.20111318569724, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -105.8617739356135, "episode_len_mean": 320.94, "timestamp": 1559180169, "episodes_this_iter": 47, "timesteps_since_restore": 2035900, "time_since_restore": 1589.6040308475494, "custom_metrics": {"cost1_mean": 176.83337037582842, "cost1_max": 220.36088858731472, "cost2_mean": -102.97052762600697, "cost2_max": -61.46560287947959, "system_level_velocity_max": 18.770869098005925, "cost2_min": -130.39352434844216, "system_level_velocity_min": 11.681436791138637, "system_level_velocity_mean": 15.00552888374482, "outflow_rate_mean": 1180.2469562122953, "cost1_min": 79.48342754249289, "outflow_rate_min": 757.4587061397813, "outflow_rate_max": 1429.6257244745889}, "iterations_since_restore": 49}
{"info": {"num_steps_sampled": 2074943, "sample_time_ms": 20997.539, "update_time_ms": 9.968, "learner": {"default_policy": {"policy_loss": -0.0052067795768380165, "entropy": 1.254865050315857, "total_loss": 27.170106887817383, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.857928991317749, "vf_loss": 27.17487144470215, "kl": 0.01756163127720356, "cur_lr": 0.0005000000237487257}}, "grad_time_ms": 11622.983, "load_time_ms": 5.987, "num_steps_trained": 2071424}, "node_ip": "10.138.0.2", "num_healthy_workers": 20, "episodes_total": 2321, "pid": 45052, "episode_reward_min": -706.3297211503797, "time_total_s": 1621.2320861816406, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.628055334091187, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "vf_clip_param": 1000000.0, "model": {"lstm_use_prev_action_reward": false, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "free_log_std": false, "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "custom_model": null, "framestack": true, "conv_filters": null, "zero_mean": true}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "observation_filter": "NoFilter", "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "synchronize_filters": true, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a97b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9d90>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9158>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9840>)"}}, "done": true, "timesteps_this_iter": 39043, "off_policy_estimator": {}, "date": "2019-05-30_01-36-41", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_env_wait_ms": 17.21759841662246, "mean_inference_ms": 1.7878685731243351, "mean_processing_ms": 6.593772606824222}, "training_iteration": 50, "timesteps_total": 2074943, "episode_reward_mean": -482.41688643502704, "experiment_id": "138c10c51f454eb4a63bdabac930a71e", "episode_reward_max": -117.23817538307527, "episode_len_mean": 321.64, "timestamp": 1559180201, "episodes_this_iter": 48, "timesteps_since_restore": 2074943, "time_since_restore": 1621.2320861816406, "custom_metrics": {"cost1_mean": 181.0900093427016, "cost1_max": 219.16263865698332, "cost2_mean": -101.40808460874975, "cost2_max": -54.183575630529226, "system_level_velocity_max": 18.770869098005925, "cost2_min": -130.39352434844216, "system_level_velocity_min": 11.784375018168198, "system_level_velocity_mean": 15.312282597231466, "outflow_rate_mean": 1200.464842009628, "cost1_min": 86.52582021309202, "outflow_rate_min": 816.2866774221283, "outflow_rate_max": 1429.6257244745889}, "iterations_since_restore": 50}

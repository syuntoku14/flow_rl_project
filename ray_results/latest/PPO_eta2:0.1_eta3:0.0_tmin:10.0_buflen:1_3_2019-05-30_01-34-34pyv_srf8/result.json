{"info": {"num_steps_sampled": 42622, "sample_time_ms": 21846.833, "update_time_ms": 1049.264, "load_time_ms": 96.398, "grad_time_ms": 14904.271, "learner": {"default_policy": {"kl": 0.00139624101575464, "cur_lr": 0.0005000000237487257, "entropy": 1.4294075965881348, "total_loss": 36.93232727050781, "vf_explained_var": -3.7800475638505304e-06, "vf_loss": 36.93295669555664, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0009111426188610494}}, "num_steps_trained": 42496}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 42, "pid": 4718, "episode_reward_min": -1024.4387054345634, "time_total_s": 38.039538621902466, "num_metric_batches_dropped": 0, "time_this_iter_s": 38.039538621902466, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9c80>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a96a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a99d8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9bf8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42622, "timesteps_since_restore": 42622, "sampler_perf": {"mean_inference_ms": 1.7592240344381278, "mean_env_wait_ms": 18.0600518226684, "mean_processing_ms": 5.79659119139733}, "date": "2019-05-30_01-35-23", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 1, "timesteps_total": 42622, "episode_reward_mean": -706.3353750353352, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -26.277519908140423, "episode_len_mean": 311.0, "timestamp": 1559180123, "off_policy_estimator": {}, "time_since_restore": 38.039538621902466, "custom_metrics": {"cost1_mean": 115.76471493338654, "cost1_max": 139.76618123987174, "cost2_mean": -49.16952618862049, "cost2_max": -18.62834706575463, "system_level_velocity_max": 18.355514181391598, "cost2_min": -93.44057214344772, "system_level_velocity_min": 8.311611951747292, "system_level_velocity_mean": 10.368852095207298, "outflow_rate_mean": 716.5776845127666, "cost1_min": 17.130763475697933, "outflow_rate_min": 380.22177049180345, "outflow_rate_max": 914.9694642857143}, "iterations_since_restore": 1}
{"info": {"num_steps_sampled": 85195, "sample_time_ms": 20768.433, "update_time_ms": 530.086, "load_time_ms": 50.902, "grad_time_ms": 13597.53, "learner": {"default_policy": {"kl": 0.005224145948886871, "cur_lr": 0.0005000000237487257, "entropy": 1.414497971534729, "total_loss": 62.47665786743164, "vf_explained_var": -4.441623104867176e-07, "vf_loss": 62.478092193603516, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.001956416992470622}}, "num_steps_trained": 84992}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 83, "pid": 4718, "episode_reward_min": -1024.4387054345634, "time_total_s": 70.12276339530945, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.08322477340698, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59fd0d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59fd158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59fd048>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59fd8c8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42573, "timesteps_since_restore": 85195, "sampler_perf": {"mean_inference_ms": 1.7294515999342945, "mean_env_wait_ms": 17.381521245124897, "mean_processing_ms": 5.743612165411054}, "date": "2019-05-30_01-35-55", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 2, "timesteps_total": 85195, "episode_reward_mean": -705.2739443057324, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -26.277519908140423, "episode_len_mean": 314.421686746988, "timestamp": 1559180155, "off_policy_estimator": {}, "time_since_restore": 70.12276339530945, "custom_metrics": {"cost1_mean": 116.45943423014089, "cost1_max": 140.65461035418292, "cost2_mean": -46.93269997053194, "cost2_max": -18.62834706575463, "system_level_velocity_max": 18.355514181391598, "cost2_min": -93.44057214344772, "system_level_velocity_min": 8.311611951747292, "system_level_velocity_mean": 10.26427035559725, "outflow_rate_mean": 715.2834130673971, "cost1_min": 17.130763475697933, "outflow_rate_min": 380.22177049180345, "outflow_rate_max": 936.8413624253907}, "iterations_since_restore": 2}
{"info": {"num_steps_sampled": 126275, "sample_time_ms": 20573.5, "update_time_ms": 356.587, "load_time_ms": 35.933, "grad_time_ms": 12921.576, "learner": {"default_policy": {"kl": 0.007632571272552013, "cur_lr": 0.0005000000237487257, "entropy": 1.4258944988250732, "total_loss": 57.293968200683594, "vf_explained_var": 0.3866268992424011, "vf_loss": 57.29621505737305, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0030171400867402554}}, "num_steps_trained": 125952}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 123, "pid": 4718, "episode_reward_min": -1278.0683585276495, "time_total_s": 101.97380828857422, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.85104489326477, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a91e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9048>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9598>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41080, "timesteps_since_restore": 126275, "sampler_perf": {"mean_inference_ms": 1.7061845569339014, "mean_env_wait_ms": 16.575364708993646, "mean_processing_ms": 5.6761464553130505}, "date": "2019-05-30_01-36-27", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 3, "timesteps_total": 126275, "episode_reward_mean": -694.3260304063135, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -31.662558724677364, "episode_len_mean": 319.2, "timestamp": 1559180187, "off_policy_estimator": {}, "time_since_restore": 101.97380828857422, "custom_metrics": {"cost1_mean": 118.36702769316923, "cost1_max": 147.4829630689409, "cost2_mean": -44.6222905568372, "cost2_max": -20.81453391260704, "system_level_velocity_max": 18.355514181391598, "cost2_min": -73.43098686560737, "system_level_velocity_min": 4.847284137855838, "system_level_velocity_mean": 10.211816781133143, "outflow_rate_mean": 719.0252055505837, "cost1_min": 22.670460383881377, "outflow_rate_min": 105.0, "outflow_rate_max": 936.8413624253907}, "iterations_since_restore": 3}
{"info": {"num_steps_sampled": 162154, "sample_time_ms": 20305.97, "update_time_ms": 269.747, "load_time_ms": 27.904, "grad_time_ms": 11936.548, "learner": {"default_policy": {"kl": 0.006006506271660328, "cur_lr": 0.0005000000237487257, "entropy": 1.4199262857437134, "total_loss": 84.39754486083984, "vf_explained_var": 0.5743194818496704, "vf_loss": 84.39862060546875, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00167881790548563}}, "num_steps_trained": 161792}, "node_ip": "10.138.0.2", "episodes_this_iter": 60, "episodes_total": 183, "pid": 4718, "episode_reward_min": -1278.0683585276495, "time_total_s": 130.5679862499237, "num_metric_batches_dropped": 0, "time_this_iter_s": 28.594177961349487, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f0d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f1e0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87ba378>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 35879, "timesteps_since_restore": 162154, "sampler_perf": {"mean_inference_ms": 1.694009329035711, "mean_env_wait_ms": 15.763926197298188, "mean_processing_ms": 5.96509151099177}, "date": "2019-05-30_01-36-55", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 4, "timesteps_total": 162154, "episode_reward_mean": -640.0700672728104, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -448.1647237540811, "episode_len_mean": 325.0, "timestamp": 1559180215, "off_policy_estimator": {}, "time_since_restore": 130.5679862499237, "custom_metrics": {"cost1_mean": 126.7496343817582, "cost1_max": 153.03684603656288, "cost2_mean": -44.78032985305993, "cost2_max": -25.81016036365577, "system_level_velocity_max": 13.2115720946134, "cost2_min": -70.05808208126226, "system_level_velocity_min": 4.847284137855838, "system_level_velocity_mean": 10.68109583155082, "outflow_rate_mean": 766.900222622143, "cost1_min": 57.890792292425466, "outflow_rate_min": 105.0, "outflow_rate_max": 966.0648933190544}, "iterations_since_restore": 4}
{"info": {"num_steps_sampled": 196748, "sample_time_ms": 20326.933, "update_time_ms": 217.781, "load_time_ms": 23.465, "grad_time_ms": 11614.062, "learner": {"default_policy": {"kl": 0.0074039059691131115, "cur_lr": 0.0005000000237487257, "entropy": 1.397969126701355, "total_loss": 59.58160400390625, "vf_explained_var": 0.7405461072921753, "vf_loss": 59.58332061767578, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.002456194721162319}}, "num_steps_trained": 196352}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 224, "pid": 4718, "episode_reward_min": -885.8310849480907, "time_total_s": 161.39445114135742, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.826464891433716, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb8c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bb7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb840>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bbbf8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 34594, "timesteps_since_restore": 196748, "sampler_perf": {"mean_inference_ms": 1.7266070732724195, "mean_env_wait_ms": 15.489816820548251, "mean_processing_ms": 6.184485330098938}, "date": "2019-05-30_01-37-26", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 5, "timesteps_total": 196748, "episode_reward_mean": -557.9213013553044, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -31.091951765072594, "episode_len_mean": 322.1, "timestamp": 1559180246, "off_policy_estimator": {}, "time_since_restore": 161.39445114135742, "custom_metrics": {"cost1_mean": 135.2103291008401, "cost1_max": 174.99031249655937, "cost2_mean": -45.570851631813795, "cost2_max": -21.52711631839474, "system_level_velocity_max": 18.461059807206603, "cost2_min": -76.7757700270337, "system_level_velocity_min": 8.352946524662926, "system_level_velocity_mean": 11.658207159260133, "outflow_rate_mean": 829.3977987753517, "cost1_min": 22.814942123050006, "outflow_rate_min": 506.5568824271422, "outflow_rate_max": 1167.028406139315}, "iterations_since_restore": 5}
{"info": {"num_steps_sampled": 234369, "sample_time_ms": 20051.41, "update_time_ms": 183.032, "load_time_ms": 20.451, "grad_time_ms": 11132.31, "learner": {"default_policy": {"kl": 0.00850910134613514, "cur_lr": 0.0005000000237487257, "entropy": 1.378907561302185, "total_loss": 63.965030670166016, "vf_explained_var": 0.7584471106529236, "vf_loss": 63.967315673828125, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.003130286931991577}}, "num_steps_trained": 233856}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 264, "pid": 4718, "episode_reward_min": -742.6513903878185, "time_total_s": 188.89933252334595, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.504881381988525, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab032730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab0327b8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007a60>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 37621, "timesteps_since_restore": 234369, "sampler_perf": {"mean_inference_ms": 1.7541391054403739, "mean_env_wait_ms": 15.461415801928311, "mean_processing_ms": 6.166443225206729}, "date": "2019-05-30_01-37-54", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 6, "timesteps_total": 234369, "episode_reward_mean": -531.6631093119088, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -31.091951765072594, "episode_len_mean": 322.1, "timestamp": 1559180274, "off_policy_estimator": {}, "time_since_restore": 188.89933252334595, "custom_metrics": {"cost1_mean": 143.77508664748814, "cost1_max": 183.04870002496648, "cost2_mean": -52.09480526420645, "cost2_max": -21.52711631839474, "system_level_velocity_max": 18.461059807206603, "cost2_min": -99.03213804269112, "system_level_velocity_min": 8.352946524662926, "system_level_velocity_mean": 12.387991425754535, "outflow_rate_mean": 900.9615077425645, "cost1_min": 22.814942123050006, "outflow_rate_min": 506.5568824271422, "outflow_rate_max": 1185.6691025401235}, "iterations_since_restore": 6}
{"info": {"num_steps_sampled": 274572, "sample_time_ms": 20574.958, "update_time_ms": 158.305, "load_time_ms": 18.294, "grad_time_ms": 10922.133, "learner": {"default_policy": {"kl": 0.006729915738105774, "cur_lr": 0.0005000000237487257, "entropy": 1.3618407249450684, "total_loss": 63.95507049560547, "vf_explained_var": 0.7112228274345398, "vf_loss": 63.9570198059082, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.002617675345391035}}, "num_steps_trained": 274048}, "node_ip": "10.138.0.2", "episodes_this_iter": 60, "episodes_total": 324, "pid": 4718, "episode_reward_min": -882.1175543495193, "time_total_s": 222.38747191429138, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.488139390945435, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bb598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb6a8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb730>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 40203, "timesteps_since_restore": 274572, "sampler_perf": {"mean_inference_ms": 1.771678035640572, "mean_env_wait_ms": 15.581477010313906, "mean_processing_ms": 6.295997170266553}, "date": "2019-05-30_01-38-27", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 7, "timesteps_total": 274572, "episode_reward_mean": -518.8244711632785, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -333.65375066837225, "episode_len_mean": 325.0, "timestamp": 1559180307, "off_policy_estimator": {}, "time_since_restore": 222.38747191429138, "custom_metrics": {"cost1_mean": 164.56949269663568, "cost1_max": 208.95012261378304, "cost2_mean": -74.14468442775228, "cost2_max": -33.01722323122643, "system_level_velocity_max": 17.43655109156682, "cost2_min": -116.49617143474372, "system_level_velocity_min": 11.097042722090135, "system_level_velocity_mean": 13.84100133874508, "outflow_rate_mean": 1056.868075036287, "cost1_min": 130.38302128493498, "outflow_rate_min": 724.3581670954408, "outflow_rate_max": 1329.671645362745}, "iterations_since_restore": 7}
{"info": {"num_steps_sampled": 317921, "sample_time_ms": 20798.8, "update_time_ms": 139.546, "load_time_ms": 16.769, "grad_time_ms": 10819.985, "learner": {"default_policy": {"kl": 0.005107209552079439, "cur_lr": 0.0005000000237487257, "entropy": 1.3611630201339722, "total_loss": 45.269832611083984, "vf_explained_var": 0.7763040065765381, "vf_loss": 45.27047348022461, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0011497284285724163}}, "num_steps_trained": 317312}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 364, "pid": 4718, "episode_reward_min": -942.6383450614484, "time_total_s": 254.9648416042328, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.577369689941406, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9598>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9e18>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 43349, "timesteps_since_restore": 317921, "sampler_perf": {"mean_inference_ms": 1.7810515916234726, "mean_env_wait_ms": 15.836161862031727, "mean_processing_ms": 6.422485947482417}, "date": "2019-05-30_01-39-00", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 8, "timesteps_total": 317921, "episode_reward_mean": -534.2538366505543, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -333.65375066837225, "episode_len_mean": 325.0, "timestamp": 1559180340, "off_policy_estimator": {}, "time_since_restore": 254.9648416042328, "custom_metrics": {"cost1_mean": 175.26664210702066, "cost1_max": 211.74626026778748, "cost2_mean": -90.16775764021214, "cost2_max": -40.55823505460719, "system_level_velocity_max": 17.46498288244326, "cost2_min": -123.40070723855678, "system_level_velocity_min": 11.097042722090135, "system_level_velocity_mean": 14.648409639566703, "outflow_rate_mean": 1131.4251592006674, "cost1_min": 131.17970279034887, "outflow_rate_min": 726.9171712707181, "outflow_rate_max": 1377.5347242324067}, "iterations_since_restore": 8}
{"info": {"num_steps_sampled": 360875, "sample_time_ms": 20849.792, "update_time_ms": 125.298, "load_time_ms": 15.636, "grad_time_ms": 10802.682, "learner": {"default_policy": {"kl": 0.004949466325342655, "cur_lr": 0.0005000000237487257, "entropy": 1.366665244102478, "total_loss": 46.4174690246582, "vf_explained_var": 0.7777325510978699, "vf_loss": 46.418983459472656, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0020122688729315996}}, "num_steps_trained": 360192}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 405, "pid": 4718, "episode_reward_min": -942.6383450614484, "time_total_s": 286.9920516014099, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.027209997177124, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bb950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bbc80>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bbae8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42954, "timesteps_since_restore": 360875, "sampler_perf": {"mean_inference_ms": 1.7933121452987495, "mean_env_wait_ms": 16.099758655743013, "mean_processing_ms": 6.401029716862899}, "date": "2019-05-30_01-39-32", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 9, "timesteps_total": 360875, "episode_reward_mean": -553.2353981456291, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -212.00006808124007, "episode_len_mean": 323.9, "timestamp": 1559180372, "off_policy_estimator": {}, "time_since_restore": 286.9920516014099, "custom_metrics": {"cost1_mean": 177.2243216185026, "cost1_max": 211.74626026778748, "cost2_mean": -96.84798835907696, "cost2_max": -40.55823505460719, "system_level_velocity_max": 17.792351810709846, "cost2_min": -123.40070723855678, "system_level_velocity_min": 11.232300594129622, "system_level_velocity_mean": 14.844823056589865, "outflow_rate_mean": 1144.7482167408043, "cost1_min": 131.42284574504671, "outflow_rate_min": 726.9171712707181, "outflow_rate_max": 1377.5347242324067}, "iterations_since_restore": 9}
{"info": {"num_steps_sampled": 404502, "sample_time_ms": 21077.92, "update_time_ms": 113.607, "load_time_ms": 14.565, "grad_time_ms": 10887.359, "learner": {"default_policy": {"kl": 0.005924286786466837, "cur_lr": 0.0005000000237487257, "entropy": 1.3581299781799316, "total_loss": 47.48418045043945, "vf_explained_var": 0.7731651663780212, "vf_loss": 47.48598098754883, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.002097418764606118}}, "num_steps_trained": 403712}, "node_ip": "10.138.0.2", "episodes_this_iter": 55, "episodes_total": 460, "pid": 4718, "episode_reward_min": -937.8413311209962, "time_total_s": 321.87227058410645, "num_metric_batches_dropped": 0, "time_this_iter_s": 34.88021898269653, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f99d8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f98c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f9950>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f9840>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 43627, "timesteps_since_restore": 404502, "sampler_perf": {"mean_inference_ms": 1.8008575527317023, "mean_env_wait_ms": 16.408695644017858, "mean_processing_ms": 6.442483458217912}, "date": "2019-05-30_01-40-07", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 10, "timesteps_total": 404502, "episode_reward_mean": -535.145956755782, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -212.00006808124007, "episode_len_mean": 323.9, "timestamp": 1559180407, "off_policy_estimator": {}, "time_since_restore": 321.87227058410645, "custom_metrics": {"cost1_mean": 182.28449053885387, "cost1_max": 212.21507401741192, "cost2_mean": -100.45739052089348, "cost2_max": -59.82952158802442, "system_level_velocity_max": 17.792351810709846, "cost2_min": -129.92013294205347, "system_level_velocity_min": 11.313408613352028, "system_level_velocity_mean": 15.226328525340444, "outflow_rate_mean": 1180.5165269800048, "cost1_min": 132.94619480796558, "outflow_rate_min": 794.6705328798184, "outflow_rate_max": 1395.95607420019}, "iterations_since_restore": 10}
{"info": {"num_steps_sampled": 448984, "sample_time_ms": 21090.83, "update_time_ms": 9.611, "load_time_ms": 5.537, "grad_time_ms": 10571.421, "learner": {"default_policy": {"kl": 0.008309283293783665, "cur_lr": 0.0005000000237487257, "entropy": 1.3553344011306763, "total_loss": 40.91523742675781, "vf_explained_var": 0.7980068922042847, "vf_loss": 40.918155670166016, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.003335278481245041}}, "num_steps_trained": 448128}, "node_ip": "10.138.0.2", "episodes_this_iter": 44, "episodes_total": 504, "pid": 4718, "episode_reward_min": -941.7338418575188, "time_total_s": 355.70356130599976, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.83129072189331, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9e18>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9400>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 44482, "timesteps_since_restore": 448984, "sampler_perf": {"mean_inference_ms": 1.799102391694679, "mean_env_wait_ms": 16.562240493550508, "mean_processing_ms": 6.498738922646839}, "date": "2019-05-30_01-40-41", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 11, "timesteps_total": 448984, "episode_reward_mean": -554.507768732569, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -333.11099146490534, "episode_len_mean": 325.0, "timestamp": 1559180441, "off_policy_estimator": {}, "time_since_restore": 355.70356130599976, "custom_metrics": {"cost1_mean": 181.29079314890666, "cost1_max": 212.21507401741192, "cost2_mean": -104.82052192510496, "cost2_max": -72.92295293706846, "system_level_velocity_max": 17.68459937159242, "cost2_min": -131.74385990723664, "system_level_velocity_min": 10.95858486266991, "system_level_velocity_mean": 15.077428903487887, "outflow_rate_mean": 1186.688423748729, "cost1_min": 129.6985301298974, "outflow_rate_min": 794.6705328798184, "outflow_rate_max": 1395.95607420019}, "iterations_since_restore": 11}
{"info": {"num_steps_sampled": 491762, "sample_time_ms": 21188.745, "update_time_ms": 9.419, "load_time_ms": 5.648, "grad_time_ms": 10427.779, "learner": {"default_policy": {"kl": 0.006523632910102606, "cur_lr": 0.0005000000237487257, "entropy": 1.3541544675827026, "total_loss": 38.39598083496094, "vf_explained_var": 0.799376368522644, "vf_loss": 38.3972053527832, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.001547628198750317}}, "num_steps_trained": 490880}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 546, "pid": 4718, "episode_reward_min": -941.7338418575188, "time_total_s": 387.3327844142914, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.629223108291626, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f9400>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87ba378>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42778, "timesteps_since_restore": 491762, "sampler_perf": {"mean_inference_ms": 1.7965169216317667, "mean_env_wait_ms": 16.671476377374432, "mean_processing_ms": 6.482398277832805}, "date": "2019-05-30_01-41-12", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 12, "timesteps_total": 491762, "episode_reward_mean": -565.6550711261489, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -224.62975276570782, "episode_len_mean": 323.98, "timestamp": 1559180472, "off_policy_estimator": {}, "time_since_restore": 387.3327844142914, "custom_metrics": {"cost1_mean": 178.3511288692303, "cost1_max": 209.54563525057625, "cost2_mean": -106.41602894250276, "cost2_max": -72.92295293706846, "system_level_velocity_max": 17.765902132645085, "cost2_min": -131.74385990723664, "system_level_velocity_min": 10.95858486266991, "system_level_velocity_mean": 14.88068348904161, "outflow_rate_mean": 1175.9090280167015, "cost1_min": 129.6985301298974, "outflow_rate_min": 874.3135795104682, "outflow_rate_max": 1378.1602165930713}, "iterations_since_restore": 12}
{"info": {"num_steps_sampled": 533027, "sample_time_ms": 21265.442, "update_time_ms": 9.262, "load_time_ms": 5.688, "grad_time_ms": 10361.947, "learner": {"default_policy": {"kl": 0.006904907990247011, "cur_lr": 0.0005000000237487257, "entropy": 1.34980046749115, "total_loss": 39.79459762573242, "vf_explained_var": 0.7636169791221619, "vf_loss": 39.79610824584961, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0018586503574624658}}, "num_steps_trained": 532096}, "node_ip": "10.138.0.2", "episodes_this_iter": 54, "episodes_total": 600, "pid": 4718, "episode_reward_min": -906.2876086586741, "time_total_s": 419.29253578186035, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.95975136756897, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f0d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f1e0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9fd90>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41265, "timesteps_since_restore": 533027, "sampler_perf": {"mean_inference_ms": 1.7895055240900808, "mean_env_wait_ms": 16.696390677009536, "mean_processing_ms": 6.507552168290383}, "date": "2019-05-30_01-41-44", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 13, "timesteps_total": 533027, "episode_reward_mean": -505.8831988568552, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -224.62975276570782, "episode_len_mean": 323.98, "timestamp": 1559180504, "off_policy_estimator": {}, "time_since_restore": 419.29253578186035, "custom_metrics": {"cost1_mean": 184.62180347982508, "cost1_max": 209.9020632300609, "cost2_mean": -104.31225530795719, "cost2_max": -73.08455054224085, "system_level_velocity_max": 17.765902132645085, "cost2_min": -128.21662460080196, "system_level_velocity_min": 11.238738247643132, "system_level_velocity_mean": 15.334573082296735, "outflow_rate_mean": 1208.6370867638702, "cost1_min": 131.35475553420105, "outflow_rate_min": 874.3135795104682, "outflow_rate_max": 1378.1602165930713}, "iterations_since_restore": 13}
{"info": {"num_steps_sampled": 572498, "sample_time_ms": 21373.559, "update_time_ms": 9.67, "load_time_ms": 5.743, "grad_time_ms": 10474.02, "learner": {"default_policy": {"kl": 0.0062455544248223305, "cur_lr": 0.0005000000237487257, "entropy": 1.34159517288208, "total_loss": 27.655681610107422, "vf_explained_var": 0.8023560643196106, "vf_loss": 27.656818389892578, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0014485983410850167}}, "num_steps_trained": 571520}, "node_ip": "10.138.0.2", "episodes_this_iter": 45, "episodes_total": 645, "pid": 4718, "episode_reward_min": -807.0068800893521, "time_total_s": 450.08400416374207, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.791468381881714, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f9488>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59cdf28>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 39471, "timesteps_since_restore": 572498, "sampler_perf": {"mean_inference_ms": 1.7841396904119795, "mean_env_wait_ms": 16.682317050937254, "mean_processing_ms": 6.542454786958822}, "date": "2019-05-30_01-42-15", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 14, "timesteps_total": 572498, "episode_reward_mean": -455.52248529814545, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -31.619468477326787, "episode_len_mean": 322.1, "timestamp": 1559180535, "off_policy_estimator": {}, "time_since_restore": 450.08400416374207, "custom_metrics": {"cost1_mean": 189.72315840265168, "cost1_max": 211.72387670265732, "cost2_mean": -101.00436251148604, "cost2_max": -21.54613382024445, "system_level_velocity_max": 18.3666860998676, "cost2_min": -128.69296260074645, "system_level_velocity_min": 11.90985019971535, "system_level_velocity_mean": 15.851982223641057, "outflow_rate_mean": 1233.82517166954, "cost1_min": 22.741891793907605, "outflow_rate_min": 511.17688865063195, "outflow_rate_max": 1369.9817780445512}, "iterations_since_restore": 14}
{"info": {"num_steps_sampled": 613130, "sample_time_ms": 21239.295, "update_time_ms": 9.861, "load_time_ms": 5.823, "grad_time_ms": 10469.801, "learner": {"default_policy": {"kl": 0.004958667792379856, "cur_lr": 0.0005000000237487257, "entropy": 1.351656436920166, "total_loss": 22.5533447265625, "vf_explained_var": 0.8231745958328247, "vf_loss": 22.554275512695312, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0011797929182648659}}, "num_steps_trained": 612096}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 685, "pid": 4718, "episode_reward_min": -807.0068800893521, "time_total_s": 479.53658533096313, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.45258116722107, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bbd08>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bb400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb8c8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bbea0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 40632, "timesteps_since_restore": 613130, "sampler_perf": {"mean_inference_ms": 1.7819650071140103, "mean_env_wait_ms": 16.688085520666938, "mean_processing_ms": 6.516955135762942}, "date": "2019-05-30_01-42-45", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 15, "timesteps_total": 613130, "episode_reward_mean": -453.2871650850499, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -31.619468477326787, "episode_len_mean": 322.1, "timestamp": 1559180565, "off_policy_estimator": {}, "time_since_restore": 479.53658533096313, "custom_metrics": {"cost1_mean": 189.97059569474027, "cost1_max": 211.72387670265732, "cost2_mean": -101.32929488316807, "cost2_max": -21.54613382024445, "system_level_velocity_max": 18.3666860998676, "cost2_min": -138.47244598718623, "system_level_velocity_min": 11.90985019971535, "system_level_velocity_mean": 15.891155499783506, "outflow_rate_mean": 1238.6817756878988, "cost1_min": 22.741891793907605, "outflow_rate_min": 511.17688865063195, "outflow_rate_max": 1362.502381141631}, "iterations_since_restore": 15}
{"info": {"num_steps_sampled": 655143, "sample_time_ms": 21408.639, "update_time_ms": 9.826, "load_time_ms": 6.025, "grad_time_ms": 10725.262, "learner": {"default_policy": {"kl": 0.007506097201257944, "cur_lr": 0.0005000000237487257, "entropy": 1.337829828262329, "total_loss": 25.922697067260742, "vf_explained_var": 0.8061639666557312, "vf_loss": 25.924503326416016, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.001991883385926485}}, "num_steps_trained": 654080}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 727, "pid": 4718, "episode_reward_min": -767.2504605091866, "time_total_s": 511.28695344924927, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.750368118286133, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab0078c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007ea0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007d90>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42013, "timesteps_since_restore": 655143, "sampler_perf": {"mean_inference_ms": 1.7801415063012838, "mean_env_wait_ms": 16.688067559116686, "mean_processing_ms": 6.479247219489086}, "date": "2019-05-30_01-43-16", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 16, "timesteps_total": 655143, "episode_reward_mean": -463.03289357228624, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -327.55969254763977, "episode_len_mean": 325.0, "timestamp": 1559180596, "off_policy_estimator": {}, "time_since_restore": 511.28695344924927, "custom_metrics": {"cost1_mean": 191.16119710761154, "cost1_max": 211.72387670265732, "cost2_mean": -104.68222579128178, "cost2_max": -73.58748924102574, "system_level_velocity_max": 17.82982842378231, "cost2_min": -138.47244598718623, "system_level_velocity_min": 12.404447913379947, "system_level_velocity_mean": 15.812608180862226, "outflow_rate_mean": 1248.4446725404564, "cost1_min": 152.71919988859952, "outflow_rate_min": 1063.4945670170468, "outflow_rate_max": 1348.2850444793296}, "iterations_since_restore": 16}
{"info": {"num_steps_sampled": 697175, "sample_time_ms": 21302.264, "update_time_ms": 9.839, "load_time_ms": 6.035, "grad_time_ms": 10882.843, "learner": {"default_policy": {"kl": 0.007690383121371269, "cur_lr": 0.0005000000237487257, "entropy": 1.3277992010116577, "total_loss": 28.730134963989258, "vf_explained_var": 0.7768333554267883, "vf_loss": 28.732421875, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0024792382027953863}}, "num_steps_trained": 696064}, "node_ip": "10.138.0.2", "episodes_this_iter": 58, "episodes_total": 785, "pid": 4718, "episode_reward_min": -889.8795722502501, "time_total_s": 545.2756590843201, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.9887056350708, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9e18>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9400>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9598>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42032, "timesteps_since_restore": 697175, "sampler_perf": {"mean_inference_ms": 1.7809531041385476, "mean_env_wait_ms": 16.774658594025638, "mean_processing_ms": 6.514361258010756}, "date": "2019-05-30_01-43-50", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 17, "timesteps_total": 697175, "episode_reward_mean": -489.29585112938963, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -339.4695148558079, "episode_len_mean": 325.0, "timestamp": 1559180630, "off_policy_estimator": {}, "time_since_restore": 545.2756590843201, "custom_metrics": {"cost1_mean": 188.60446624742661, "cost1_max": 208.01149938917962, "cost2_mean": -108.70713793471026, "cost2_max": -81.16003045242437, "system_level_velocity_max": 17.45887372605228, "cost2_min": -133.53540981849676, "system_level_velocity_min": 11.613458502735057, "system_level_velocity_mean": 15.557440098992396, "outflow_rate_mean": 1243.4018692539848, "cost1_min": 138.92280467607623, "outflow_rate_min": 916.2460653574067, "outflow_rate_max": 1361.9576480428232}, "iterations_since_restore": 17}
{"info": {"num_steps_sampled": 737748, "sample_time_ms": 21113.029, "update_time_ms": 9.919, "load_time_ms": 6.271, "grad_time_ms": 10897.563, "learner": {"default_policy": {"kl": 0.006286580581218004, "cur_lr": 0.0005000000237487257, "entropy": 1.308950424194336, "total_loss": 21.301687240600586, "vf_explained_var": 0.828511118888855, "vf_loss": 21.303157806396484, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.001627952209673822}}, "num_steps_trained": 736512}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 825, "pid": 4718, "episode_reward_min": -889.8795722502501, "time_total_s": 576.1068341732025, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.831175088882446, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb7b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bbbf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb840>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb6a8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 40573, "timesteps_since_restore": 737748, "sampler_perf": {"mean_inference_ms": 1.7852766936330309, "mean_env_wait_ms": 16.828157355462984, "mean_processing_ms": 6.5409205679807805}, "date": "2019-05-30_01-44-21", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 18, "timesteps_total": 737748, "episode_reward_mean": -484.34713149582996, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -354.03185122377096, "episode_len_mean": 325.0, "timestamp": 1559180661, "off_policy_estimator": {}, "time_since_restore": 576.1068341732025, "custom_metrics": {"cost1_mean": 188.36859773095009, "cost1_max": 207.75192754713294, "cost2_mean": -106.50098853723674, "cost2_max": -84.13537640081313, "system_level_velocity_max": 17.270383641878418, "cost2_min": -130.3476184200154, "system_level_velocity_min": 11.613458502735057, "system_level_velocity_mean": 15.539724069133088, "outflow_rate_mean": 1243.8158496750264, "cost1_min": 138.92280467607623, "outflow_rate_min": 916.2460653574067, "outflow_rate_max": 1364.4092523133438}, "iterations_since_restore": 18}
{"info": {"num_steps_sampled": 779272, "sample_time_ms": 21094.19, "update_time_ms": 9.735, "load_time_ms": 6.346, "grad_time_ms": 10777.173, "learner": {"default_policy": {"kl": 0.007800268474966288, "cur_lr": 0.0005000000237487257, "entropy": 1.301909327507019, "total_loss": 23.730371475219727, "vf_explained_var": 0.8208324313163757, "vf_loss": 23.731945037841797, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0017685008933767676}}, "num_steps_trained": 777984}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 867, "pid": 4718, "episode_reward_min": -889.8795722502501, "time_total_s": 606.7382621765137, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.631428003311157, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9bf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f9b70>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f9ae8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41524, "timesteps_since_restore": 779272, "sampler_perf": {"mean_inference_ms": 1.7888519213053962, "mean_env_wait_ms": 16.865404545139334, "mean_processing_ms": 6.519572775417516}, "date": "2019-05-30_01-44-52", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 19, "timesteps_total": 779272, "episode_reward_mean": -480.455599559842, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -352.4259165469326, "episode_len_mean": 325.0, "timestamp": 1559180692, "off_policy_estimator": {}, "time_since_restore": 606.7382621765137, "custom_metrics": {"cost1_mean": 188.16586912551057, "cost1_max": 207.75192754713294, "cost2_mean": -104.44133455324493, "cost2_max": -82.64373419402682, "system_level_velocity_max": 17.270383641878418, "cost2_min": -130.3476184200154, "system_level_velocity_min": 11.613458502735057, "system_level_velocity_mean": 15.529668073939517, "outflow_rate_mean": 1240.746806283465, "cost1_min": 138.92280467607623, "outflow_rate_min": 916.2460653574067, "outflow_rate_max": 1364.4092523133438}, "iterations_since_restore": 19}
{"info": {"num_steps_sampled": 818899, "sample_time_ms": 20938.516, "update_time_ms": 9.603, "load_time_ms": 6.267, "grad_time_ms": 10603.638, "learner": {"default_policy": {"kl": 0.009258788079023361, "cur_lr": 0.0005000000237487257, "entropy": 1.3077173233032227, "total_loss": 23.904319763183594, "vf_explained_var": 0.8176305890083313, "vf_loss": 23.905643463134766, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.001555928960442543}}, "num_steps_trained": 817536}, "node_ip": "10.138.0.2", "episodes_this_iter": 58, "episodes_total": 925, "pid": 4718, "episode_reward_min": -837.1794939343849, "time_total_s": 638.3177909851074, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.57952880859375, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb400>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bbea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb8c8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb598>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 39627, "timesteps_since_restore": 818899, "sampler_perf": {"mean_inference_ms": 1.794283355331754, "mean_env_wait_ms": 16.920381162433088, "mean_processing_ms": 6.543224654690079}, "date": "2019-05-30_01-45-24", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 20, "timesteps_total": 818899, "episode_reward_mean": -461.2944560912877, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -312.2448384109877, "episode_len_mean": 325.0, "timestamp": 1559180724, "off_policy_estimator": {}, "time_since_restore": 638.3177909851074, "custom_metrics": {"cost1_mean": 189.70972107697742, "cost1_max": 210.63117202825154, "cost2_mean": -100.84869146334029, "cost2_max": -69.86338075924472, "system_level_velocity_max": 17.762644754284516, "cost2_min": -123.99393299685033, "system_level_velocity_min": 11.878033606035864, "system_level_velocity_mean": 15.680954652392488, "outflow_rate_mean": 1242.0470034105854, "cost1_min": 141.71678983308135, "outflow_rate_min": 932.4671214892663, "outflow_rate_max": 1347.1357518660768}, "iterations_since_restore": 20}
{"info": {"num_steps_sampled": 860422, "sample_time_ms": 20729.503, "update_time_ms": 9.625, "load_time_ms": 6.057, "grad_time_ms": 10516.59, "learner": {"default_policy": {"kl": 0.010929039679467678, "cur_lr": 0.0005000000237487257, "entropy": 1.3070377111434937, "total_loss": 18.414337158203125, "vf_explained_var": 0.8520899415016174, "vf_loss": 18.416898727416992, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0028341172728687525}}, "num_steps_trained": 859008}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 965, "pid": 4718, "episode_reward_min": -797.6310725017347, "time_total_s": 669.1979591846466, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.880168199539185, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a92f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9d08>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9598>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41523, "timesteps_since_restore": 860422, "sampler_perf": {"mean_inference_ms": 1.7957063088180754, "mean_env_wait_ms": 16.93205530920476, "mean_processing_ms": 6.560477117210347}, "date": "2019-05-30_01-45-55", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 21, "timesteps_total": 860422, "episode_reward_mean": -466.95782704658654, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -312.2448384109877, "episode_len_mean": 325.0, "timestamp": 1559180755, "off_policy_estimator": {}, "time_since_restore": 669.1979591846466, "custom_metrics": {"cost1_mean": 188.21069469552273, "cost1_max": 210.63117202825154, "cost2_mean": -100.51577584931023, "cost2_max": -69.86338075924472, "system_level_velocity_max": 17.762644754284516, "cost2_min": -128.89603441684775, "system_level_velocity_min": 11.603948513593359, "system_level_velocity_mean": 15.552843712966931, "outflow_rate_mean": 1233.7125559141136, "cost1_min": 138.09347219780975, "outflow_rate_min": 970.7362824119374, "outflow_rate_max": 1347.1357518660768}, "iterations_since_restore": 21}
{"info": {"num_steps_sampled": 902298, "sample_time_ms": 20667.997, "update_time_ms": 9.79, "load_time_ms": 6.189, "grad_time_ms": 10558.801, "learner": {"default_policy": {"kl": 0.008237265050411224, "cur_lr": 0.0005000000237487257, "entropy": 1.3163771629333496, "total_loss": 22.242107391357422, "vf_explained_var": 0.8260946273803711, "vf_loss": 22.24388885498047, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0019880207255482674}}, "num_steps_trained": 900864}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 1007, "pid": 4718, "episode_reward_min": -797.6310725017347, "time_total_s": 700.6327505111694, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.434791326522827, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9a60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9268>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9ea0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41876, "timesteps_since_restore": 902298, "sampler_perf": {"mean_inference_ms": 1.7939753715570959, "mean_env_wait_ms": 16.938959893309534, "mean_processing_ms": 6.538058691926385}, "date": "2019-05-30_01-46-26", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 22, "timesteps_total": 902298, "episode_reward_mean": -486.3813126098478, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -337.17518084869187, "episode_len_mean": 325.0, "timestamp": 1559180786, "off_policy_estimator": {}, "time_since_restore": 700.6327505111694, "custom_metrics": {"cost1_mean": 185.775176944176, "cost1_max": 208.54768447191387, "cost2_mean": -104.20613755097976, "cost2_max": -74.29340852506192, "system_level_velocity_max": 17.47969773086773, "cost2_min": -129.72948942690428, "system_level_velocity_min": 11.603948513593359, "system_level_velocity_mean": 15.315907488851616, "outflow_rate_mean": 1226.4526246865787, "cost1_min": 138.09347219780975, "outflow_rate_min": 970.7362824119374, "outflow_rate_max": 1344.598430239131}, "iterations_since_restore": 22}
{"info": {"num_steps_sampled": 942587, "sample_time_ms": 20774.105, "update_time_ms": 10.008, "load_time_ms": 6.137, "grad_time_ms": 10434.098, "learner": {"default_policy": {"kl": 0.008614622056484222, "cur_lr": 0.0005000000237487257, "entropy": 1.294704556465149, "total_loss": 24.564651489257812, "vf_explained_var": 0.7992756962776184, "vf_loss": 24.56635093688965, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0019136401824653149}}, "num_steps_trained": 941056}, "node_ip": "10.138.0.2", "episodes_this_iter": 53, "episodes_total": 1060, "pid": 4718, "episode_reward_min": -745.4555667349318, "time_total_s": 732.4202785491943, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.787528038024902, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f91e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f92f0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f9268>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 40289, "timesteps_since_restore": 942587, "sampler_perf": {"mean_inference_ms": 1.793639498853903, "mean_env_wait_ms": 16.95495362558375, "mean_processing_ms": 6.532763508559978}, "date": "2019-05-30_01-46-58", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 23, "timesteps_total": 942587, "episode_reward_mean": -465.0925408663833, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -335.959195366523, "episode_len_mean": 325.0, "timestamp": 1559180818, "off_policy_estimator": {}, "time_since_restore": 732.4202785491943, "custom_metrics": {"cost1_mean": 190.2822562400569, "cost1_max": 210.50500039873364, "cost2_mean": -104.87165391806647, "cost2_max": -82.04099036940087, "system_level_velocity_max": 17.671292298108533, "cost2_min": -129.72948942690428, "system_level_velocity_min": 12.081042345680533, "system_level_velocity_mean": 15.740266207955347, "outflow_rate_mean": 1255.9794085153044, "cost1_min": 148.51916203788718, "outflow_rate_min": 1080.7080861244017, "outflow_rate_max": 1371.3372347165027}, "iterations_since_restore": 23}
{"info": {"num_steps_sampled": 983765, "sample_time_ms": 20902.958, "update_time_ms": 9.865, "load_time_ms": 6.357, "grad_time_ms": 10721.184, "learner": {"default_policy": {"kl": 0.008633820340037346, "cur_lr": 0.0005000000237487257, "entropy": 1.2971917390823364, "total_loss": 22.450706481933594, "vf_explained_var": 0.8146472573280334, "vf_loss": 22.45363426208496, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.003144884016364813}}, "num_steps_trained": 982144}, "node_ip": "10.138.0.2", "episodes_this_iter": 45, "episodes_total": 1105, "pid": 4718, "episode_reward_min": -750.0215413785523, "time_total_s": 767.3843479156494, "num_metric_batches_dropped": 0, "time_this_iter_s": 34.96406936645508, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a598d0d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a598d048>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f9ea0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41178, "timesteps_since_restore": 983765, "sampler_perf": {"mean_inference_ms": 1.794786002254246, "mean_env_wait_ms": 16.971770842534724, "mean_processing_ms": 6.552111042201916}, "date": "2019-05-30_01-47-33", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 24, "timesteps_total": 983765, "episode_reward_mean": -460.91330496676693, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -228.35845472563966, "episode_len_mean": 323.93, "timestamp": 1559180853, "off_policy_estimator": {}, "time_since_restore": 767.3843479156494, "custom_metrics": {"cost1_mean": 190.9947100467732, "cost1_max": 210.50500039873364, "cost2_mean": -105.91831029854036, "cost2_max": -72.27076919258928, "system_level_velocity_max": 17.671292298108533, "cost2_min": -129.00829790516167, "system_level_velocity_min": 12.120162876867099, "system_level_velocity_mean": 15.86149006075329, "outflow_rate_mean": 1262.3468920115458, "cost1_min": 138.9379763795335, "outflow_rate_min": 1059.1410531303698, "outflow_rate_max": 1389.280292298483}, "iterations_since_restore": 24}
{"info": {"num_steps_sampled": 1025662, "sample_time_ms": 21111.446, "update_time_ms": 9.721, "load_time_ms": 6.431, "grad_time_ms": 10795.668, "learner": {"default_policy": {"kl": 0.008539952337741852, "cur_lr": 0.0005000000237487257, "entropy": 1.291892647743225, "total_loss": 22.474817276000977, "vf_explained_var": 0.827889084815979, "vf_loss": 22.477643966674805, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0030400401446968317}}, "num_steps_trained": 1024000}, "node_ip": "10.138.0.2", "episodes_this_iter": 43, "episodes_total": 1148, "pid": 4718, "episode_reward_min": -763.2313657454602, "time_total_s": 799.6706430912018, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.28629517555237, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bbf28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bbc80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb950>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb510>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41897, "timesteps_since_restore": 1025662, "sampler_perf": {"mean_inference_ms": 1.79499630680145, "mean_env_wait_ms": 16.992264590019104, "mean_processing_ms": 6.5515945562583875}, "date": "2019-05-30_01-48-05", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 25, "timesteps_total": 1025662, "episode_reward_mean": -477.564907452718, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -24.534672356483547, "episode_len_mean": 320.95, "timestamp": 1559180885, "off_policy_estimator": {}, "time_since_restore": 799.6706430912018, "custom_metrics": {"cost1_mean": 186.5217734676495, "cost1_max": 210.71782836049593, "cost2_mean": -107.22965443657962, "cost2_max": -17.911544826604455, "system_level_velocity_max": 17.671292298108533, "cost2_min": -129.00829790516167, "system_level_velocity_min": 12.120162876867099, "system_level_velocity_mean": 15.619765469795313, "outflow_rate_mean": 1238.5589761526433, "cost1_min": 17.705001006452253, "outflow_rate_min": 468.51797875626045, "outflow_rate_max": 1389.280292298483}, "iterations_since_restore": 25}
{"info": {"num_steps_sampled": 1067577, "sample_time_ms": 21299.089, "update_time_ms": 9.892, "load_time_ms": 5.988, "grad_time_ms": 10668.747, "learner": {"default_policy": {"kl": 0.008537737652659416, "cur_lr": 0.0005000000237487257, "entropy": 1.286866307258606, "total_loss": 27.690624237060547, "vf_explained_var": 0.7996499538421631, "vf_loss": 27.693321228027344, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.002909915056079626}}, "num_steps_trained": 1065856}, "node_ip": "10.138.0.2", "episodes_this_iter": 53, "episodes_total": 1201, "pid": 4718, "episode_reward_min": -789.7589347864779, "time_total_s": 832.0225872993469, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.35194420814514, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9950>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9ea0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41915, "timesteps_since_restore": 1067577, "sampler_perf": {"mean_inference_ms": 1.796571782108189, "mean_env_wait_ms": 17.01716395993486, "mean_processing_ms": 6.560957202832395}, "date": "2019-05-30_01-48-37", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 26, "timesteps_total": 1067577, "episode_reward_mean": -483.6005252478669, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -24.534672356483547, "episode_len_mean": 322.02, "timestamp": 1559180917, "off_policy_estimator": {}, "time_since_restore": 832.0225872993469, "custom_metrics": {"cost1_mean": 186.19993074202307, "cost1_max": 213.4224385166239, "cost2_mean": -108.03649227770815, "cost2_max": -17.911544826604455, "system_level_velocity_max": 17.794577421445908, "cost2_min": -130.17334555845866, "system_level_velocity_min": 11.902474786697745, "system_level_velocity_mean": 15.521436568695307, "outflow_rate_mean": 1232.8536785028182, "cost1_min": 17.705001006452253, "outflow_rate_min": 468.51797875626045, "outflow_rate_max": 1389.7933900020298}, "iterations_since_restore": 26}
{"info": {"num_steps_sampled": 1108804, "sample_time_ms": 21270.931, "update_time_ms": 9.744, "load_time_ms": 5.831, "grad_time_ms": 10596.407, "learner": {"default_policy": {"kl": 0.00931584369391203, "cur_lr": 0.0005000000237487257, "entropy": 1.284936785697937, "total_loss": 23.0452880859375, "vf_explained_var": 0.8324078917503357, "vf_loss": 23.047697067260742, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0026423227973282337}}, "num_steps_trained": 1107072}, "node_ip": "10.138.0.2", "episodes_this_iter": 46, "episodes_total": 1247, "pid": 4718, "episode_reward_min": -789.7589347864779, "time_total_s": 865.0086941719055, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.986106872558594, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bbd90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bb510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb6a8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bbf28>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41227, "timesteps_since_restore": 1108804, "sampler_perf": {"mean_inference_ms": 1.7983298760611235, "mean_env_wait_ms": 17.049649351254626, "mean_processing_ms": 6.582738648224327}, "date": "2019-05-30_01-49-11", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 27, "timesteps_total": 1108804, "episode_reward_mean": -485.23990128965704, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -215.41124101865384, "episode_len_mean": 322.72, "timestamp": 1559180951, "off_policy_estimator": {}, "time_since_restore": 865.0086941719055, "custom_metrics": {"cost1_mean": 186.9512578843327, "cost1_max": 213.4224385166239, "cost2_mean": -109.71422179286422, "cost2_max": -69.45944377203901, "system_level_velocity_max": 17.80195986629935, "cost2_min": -130.24878776021734, "system_level_velocity_min": 11.902474786697745, "system_level_velocity_mean": 15.550215129307883, "outflow_rate_mean": 1235.7769730182472, "cost1_min": 131.8776348468159, "outflow_rate_min": 1021.5638746777229, "outflow_rate_max": 1389.7933900020298}, "iterations_since_restore": 27}
{"info": {"num_steps_sampled": 1151532, "sample_time_ms": 21417.123, "update_time_ms": 10.048, "load_time_ms": 5.534, "grad_time_ms": 10657.11, "learner": {"default_policy": {"kl": 0.010588777251541615, "cur_lr": 0.0005000000237487257, "entropy": 1.2820698022842407, "total_loss": 24.279264450073242, "vf_explained_var": 0.8301217555999756, "vf_loss": 24.28270721435547, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0037073970306664705}}, "num_steps_trained": 1149696}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 1287, "pid": 4718, "episode_reward_min": -859.1979762482678, "time_total_s": 897.924164056778, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.91546988487244, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f97b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f96a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f9730>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f9620>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42728, "timesteps_since_restore": 1151532, "sampler_perf": {"mean_inference_ms": 1.800949719729797, "mean_env_wait_ms": 17.0953432268182, "mean_processing_ms": 6.582034333246139}, "date": "2019-05-30_01-49-44", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 28, "timesteps_total": 1151532, "episode_reward_mean": -502.0025902747108, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -215.41124101865384, "episode_len_mean": 322.72, "timestamp": 1559180984, "off_policy_estimator": {}, "time_since_restore": 897.924164056778, "custom_metrics": {"cost1_mean": 185.69742789042473, "cost1_max": 214.49209302906337, "cost2_mean": -112.20947083168852, "cost2_max": -69.45944377203901, "system_level_velocity_max": 17.958122569443105, "cost2_min": -144.65605225779672, "system_level_velocity_min": 11.669107554740922, "system_level_velocity_mean": 15.462629396923862, "outflow_rate_mean": 1232.272627622985, "cost1_min": 131.8776348468159, "outflow_rate_min": 1000.393808708415, "outflow_rate_max": 1404.9735952309495}, "iterations_since_restore": 28}
{"info": {"num_steps_sampled": 1194615, "sample_time_ms": 21549.847, "update_time_ms": 10.261, "load_time_ms": 5.231, "grad_time_ms": 10922.194, "learner": {"default_policy": {"kl": 0.011406567879021168, "cur_lr": 0.0005000000237487257, "entropy": 1.278988003730774, "total_loss": 25.907127380371094, "vf_explained_var": 0.8274428844451904, "vf_loss": 25.9108829498291, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.004040081985294819}}, "num_steps_trained": 1192704}, "node_ip": "10.138.0.2", "episodes_this_iter": 44, "episodes_total": 1331, "pid": 4718, "episode_reward_min": -859.1979762482678, "time_total_s": 932.548930644989, "num_metric_batches_dropped": 0, "time_this_iter_s": 34.62476658821106, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f99d8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f98c8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 43083, "timesteps_since_restore": 1194615, "sampler_perf": {"mean_inference_ms": 1.8042246379368927, "mean_env_wait_ms": 17.140163057189525, "mean_processing_ms": 6.576261742135085}, "date": "2019-05-30_01-50-18", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 29, "timesteps_total": 1194615, "episode_reward_mean": -511.8127490187321, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -31.08362083366007, "episode_len_mean": 322.1, "timestamp": 1559181018, "off_policy_estimator": {}, "time_since_restore": 932.548930644989, "custom_metrics": {"cost1_mean": 184.57383597242864, "cost1_max": 215.82833473723355, "cost2_mean": -112.6267472658661, "cost2_max": -22.604059230015864, "system_level_velocity_max": 18.558998875171095, "cost2_min": -144.65605225779672, "system_level_velocity_min": 11.669107554740922, "system_level_velocity_mean": 15.471080129272298, "outflow_rate_mean": 1225.2236651221838, "cost1_min": 22.942438053931596, "outflow_rate_min": 506.5568824271423, "outflow_rate_max": 1418.968433540174}, "iterations_since_restore": 29}
{"info": {"num_steps_sampled": 1237391, "sample_time_ms": 21559.508, "update_time_ms": 10.811, "load_time_ms": 5.554, "grad_time_ms": 11049.264, "learner": {"default_policy": {"kl": 0.011412455700337887, "cur_lr": 0.0005000000237487257, "entropy": 1.2735413312911987, "total_loss": 27.750537872314453, "vf_explained_var": 0.8189553022384644, "vf_loss": 27.754411697387695, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.004158742725849152}}, "num_steps_trained": 1235456}, "node_ip": "10.138.0.2", "episodes_this_iter": 56, "episodes_total": 1387, "pid": 4718, "episode_reward_min": -798.5483378161571, "time_total_s": 965.5199327468872, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.97100210189819, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab032620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f1e0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59cdf28>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42776, "timesteps_since_restore": 1237391, "sampler_perf": {"mean_inference_ms": 1.8053806216009565, "mean_env_wait_ms": 17.19419178040005, "mean_processing_ms": 6.5897975745199355}, "date": "2019-05-30_01-50-51", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 30, "timesteps_total": 1237391, "episode_reward_mean": -527.2208241407069, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -31.08362083366007, "episode_len_mean": 322.1, "timestamp": 1559181051, "off_policy_estimator": {}, "time_since_restore": 965.5199327468872, "custom_metrics": {"cost1_mean": 181.81756270783524, "cost1_max": 215.82833473723355, "cost2_mean": -113.45005927171826, "cost2_max": -22.604059230015864, "system_level_velocity_max": 18.558998875171095, "cost2_min": -135.9810076723707, "system_level_velocity_min": 11.54853630470288, "system_level_velocity_mean": 15.256685434139772, "outflow_rate_mean": 1213.3103506958814, "cost1_min": 22.942438053931596, "outflow_rate_min": 506.5568824271423, "outflow_rate_max": 1418.968433540174}, "iterations_since_restore": 30}
{"info": {"num_steps_sampled": 1279772, "sample_time_ms": 21630.318, "update_time_ms": 10.731, "load_time_ms": 5.778, "grad_time_ms": 11019.736, "learner": {"default_policy": {"kl": 0.010544870980083942, "cur_lr": 0.0005000000237487257, "entropy": 1.2738828659057617, "total_loss": 25.387880325317383, "vf_explained_var": 0.8296340703964233, "vf_loss": 25.390745162963867, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0031257793307304382}}, "num_steps_trained": 1277824}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 1428, "pid": 4718, "episode_reward_min": -798.5483378161571, "time_total_s": 996.7904694080353, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.27053666114807, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab0078c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007620>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007d90>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42381, "timesteps_since_restore": 1279772, "sampler_perf": {"mean_inference_ms": 1.806241920608262, "mean_env_wait_ms": 17.214520366423567, "mean_processing_ms": 6.594794847924987}, "date": "2019-05-30_01-51-23", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 31, "timesteps_total": 1279772, "episode_reward_mean": -528.2714879589535, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -289.11332135859436, "episode_len_mean": 325.0, "timestamp": 1559181083, "off_policy_estimator": {}, "time_since_restore": 996.7904694080353, "custom_metrics": {"cost1_mean": 183.47557155776633, "cost1_max": 214.14545986418386, "cost2_mean": -113.0673966719749, "cost2_max": -80.01761349538566, "system_level_velocity_max": 17.894995735351404, "cost2_min": -135.9810076723707, "system_level_velocity_min": 11.54853630470288, "system_level_velocity_mean": 15.235051534164581, "outflow_rate_mean": 1222.501119003263, "cost1_min": 139.01103088536698, "outflow_rate_min": 891.8293770491804, "outflow_rate_max": 1406.6649147785956}, "iterations_since_restore": 31}
{"info": {"num_steps_sampled": 1322459, "sample_time_ms": 21900.584, "update_time_ms": 10.674, "load_time_ms": 5.449, "grad_time_ms": 11131.391, "learner": {"default_policy": {"kl": 0.011060484685003757, "cur_lr": 0.0005000000237487257, "entropy": 1.2542506456375122, "total_loss": 26.32112693786621, "vf_explained_var": 0.8326236605644226, "vf_loss": 26.324495315551758, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.003642478259280324}}, "num_steps_trained": 1320448}, "node_ip": "10.138.0.2", "episodes_this_iter": 43, "episodes_total": 1471, "pid": 4718, "episode_reward_min": -798.5483378161571, "time_total_s": 1032.0617768764496, "num_metric_batches_dropped": 0, "time_this_iter_s": 35.27130746841431, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9ff28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9fea0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9730>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42687, "timesteps_since_restore": 1322459, "sampler_perf": {"mean_inference_ms": 1.807496633463934, "mean_env_wait_ms": 17.23585792875228, "mean_processing_ms": 6.588960435969143}, "date": "2019-05-30_01-51-58", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 32, "timesteps_total": 1322459, "episode_reward_mean": -507.8314899926939, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -331.3212516238487, "episode_len_mean": 325.0, "timestamp": 1559181118, "off_policy_estimator": {}, "time_since_restore": 1032.0617768764496, "custom_metrics": {"cost1_mean": 186.45535720019612, "cost1_max": 209.2361296585446, "cost2_mean": -112.18011948784304, "cost2_max": -82.93340721262297, "system_level_velocity_max": 17.47102802869654, "cost2_min": -130.5696822484603, "system_level_velocity_min": 11.949291546067437, "system_level_velocity_mean": 15.465860074800842, "outflow_rate_mean": 1243.806393647727, "cost1_min": 142.0180978592366, "outflow_rate_min": 1050.5860172510472, "outflow_rate_max": 1378.7596809186248}, "iterations_since_restore": 32}
{"info": {"num_steps_sampled": 1365069, "sample_time_ms": 21832.563, "update_time_ms": 10.82, "load_time_ms": 5.543, "grad_time_ms": 11330.935, "learner": {"default_policy": {"kl": 0.012025300413370132, "cur_lr": 0.0005000000237487257, "entropy": 1.2480101585388184, "total_loss": 25.877321243286133, "vf_explained_var": 0.823488175868988, "vf_loss": 25.880855560302734, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.00383797287940979}}, "num_steps_trained": 1362944}, "node_ip": "10.138.0.2", "episodes_this_iter": 56, "episodes_total": 1527, "pid": 4718, "episode_reward_min": -810.8442716346558, "time_total_s": 1065.1637806892395, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.10200381278992, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a598e378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a598e268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a598e2f0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a598e1e0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42610, "timesteps_since_restore": 1365069, "sampler_perf": {"mean_inference_ms": 1.808309189343846, "mean_env_wait_ms": 17.283450814398098, "mean_processing_ms": 6.600077312910568}, "date": "2019-05-30_01-52-31", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 33, "timesteps_total": 1365069, "episode_reward_mean": -508.5734542899418, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -348.0943259573479, "episode_len_mean": 325.0, "timestamp": 1559181151, "off_policy_estimator": {}, "time_since_restore": 1065.1637806892395, "custom_metrics": {"cost1_mean": 186.45289619709797, "cost1_max": 209.5023805711841, "cost2_mean": -114.02452610573623, "cost2_max": -94.50244885985143, "system_level_velocity_max": 17.618539637215328, "cost2_min": -135.33422791994437, "system_level_velocity_min": 12.192852404499957, "system_level_velocity_mean": 15.429384847846748, "outflow_rate_mean": 1248.0877381548664, "cost1_min": 146.72568246458664, "outflow_rate_min": 1052.5065902964964, "outflow_rate_max": 1381.645841902913}, "iterations_since_restore": 33}
{"info": {"num_steps_sampled": 1406734, "sample_time_ms": 21637.784, "update_time_ms": 10.486, "load_time_ms": 5.629, "grad_time_ms": 11135.133, "learner": {"default_policy": {"kl": 0.013895397074520588, "cur_lr": 0.0005000000237487257, "entropy": 1.239211082458496, "total_loss": 20.522294998168945, "vf_explained_var": 0.8459844589233398, "vf_loss": 20.526220321655273, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.004274874459952116}}, "num_steps_trained": 1404544}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 1568, "pid": 4718, "episode_reward_min": -810.8442716346558, "time_total_s": 1096.2093596458435, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.045578956604004, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a598e840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a598e950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a598e9d8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a598e8c8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41665, "timesteps_since_restore": 1406734, "sampler_perf": {"mean_inference_ms": 1.8073512460252903, "mean_env_wait_ms": 17.285953782601105, "mean_processing_ms": 6.601633024137021}, "date": "2019-05-30_01-53-02", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 34, "timesteps_total": 1406734, "episode_reward_mean": -511.54524522498764, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -348.0943259573479, "episode_len_mean": 325.0, "timestamp": 1559181182, "off_policy_estimator": {}, "time_since_restore": 1096.2093596458435, "custom_metrics": {"cost1_mean": 185.47353327711593, "cost1_max": 209.7568937048837, "cost2_mean": -113.29227925862646, "cost2_max": -94.50244885985143, "system_level_velocity_max": 17.629388748492257, "cost2_min": -139.09678541762096, "system_level_velocity_min": 12.016060699492092, "system_level_velocity_mean": 15.345158097088559, "outflow_rate_mean": 1247.8373183623557, "cost1_min": 143.90221732859447, "outflow_rate_min": 1052.5065902964964, "outflow_rate_max": 1395.4013505650196}, "iterations_since_restore": 34}
{"info": {"num_steps_sampled": 1448829, "sample_time_ms": 21616.554, "update_time_ms": 10.452, "load_time_ms": 5.346, "grad_time_ms": 11293.507, "learner": {"default_policy": {"kl": 0.009289676323533058, "cur_lr": 0.0005000000237487257, "entropy": 1.2159112691879272, "total_loss": 21.32860565185547, "vf_explained_var": 0.8360177874565125, "vf_loss": 21.330665588378906, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.002291005337610841}}, "num_steps_trained": 1446528}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 1610, "pid": 4718, "episode_reward_min": -789.9284033768726, "time_total_s": 1129.8793847560883, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.67002511024475, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bbea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb840>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb400>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42095, "timesteps_since_restore": 1448829, "sampler_perf": {"mean_inference_ms": 1.8053364203010356, "mean_env_wait_ms": 17.268611567930655, "mean_processing_ms": 6.587510636402024}, "date": "2019-05-30_01-53-36", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 35, "timesteps_total": 1448829, "episode_reward_mean": -494.79317143740883, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -349.0060320063242, "episode_len_mean": 325.0, "timestamp": 1559181216, "off_policy_estimator": {}, "time_since_restore": 1129.8793847560883, "custom_metrics": {"cost1_mean": 186.80944514862432, "cost1_max": 209.7568937048837, "cost2_mean": -112.02739106152266, "cost2_max": -94.01525253610619, "system_level_velocity_max": 17.629388748492257, "cost2_min": -139.09678541762096, "system_level_velocity_min": 12.016060699492092, "system_level_velocity_mean": 15.42908872783804, "outflow_rate_mean": 1257.9434074449728, "cost1_min": 143.90221732859447, "outflow_rate_min": 1060.4582003797689, "outflow_rate_max": 1395.4013505650196}, "iterations_since_restore": 35}
{"info": {"num_steps_sampled": 1490554, "sample_time_ms": 21458.654, "update_time_ms": 10.457, "load_time_ms": 5.679, "grad_time_ms": 11486.062, "learner": {"default_policy": {"kl": 0.011015661992132664, "cur_lr": 0.0005000000237487257, "entropy": 1.2179306745529175, "total_loss": 22.264842987060547, "vf_explained_var": 0.8252914547920227, "vf_loss": 22.267934799194336, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.003369484795257449}}, "num_steps_trained": 1488128}, "node_ip": "10.138.0.2", "episodes_this_iter": 51, "episodes_total": 1661, "pid": 4718, "episode_reward_min": -805.2595200656273, "time_total_s": 1162.6082019805908, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.72881722450256, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab0078c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007840>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007d90>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41725, "timesteps_since_restore": 1490554, "sampler_perf": {"mean_inference_ms": 1.8027634746366306, "mean_env_wait_ms": 17.26522882241342, "mean_processing_ms": 6.579935301447336}, "date": "2019-05-30_01-54-09", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 36, "timesteps_total": 1490554, "episode_reward_mean": -479.60276372797017, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -33.10273665770178, "episode_len_mean": 322.12, "timestamp": 1559181249, "off_policy_estimator": {}, "time_since_restore": 1162.6082019805908, "custom_metrics": {"cost1_mean": 186.0955927919345, "cost1_max": 206.21725356108067, "cost2_mean": -109.68626372307152, "cost2_max": -22.953270028339922, "system_level_velocity_max": 18.537016076186937, "cost2_min": -132.38062242342212, "system_level_velocity_min": 11.615744885569702, "system_level_velocity_mean": 15.543764752319454, "outflow_rate_mean": 1256.819092536066, "cost1_min": 24.186612586828375, "outflow_rate_min": 510.4088222968832, "outflow_rate_max": 1380.7833671307055}, "iterations_since_restore": 36}
{"info": {"num_steps_sampled": 1530837, "sample_time_ms": 21333.377, "update_time_ms": 10.767, "load_time_ms": 5.764, "grad_time_ms": 11502.29, "learner": {"default_policy": {"kl": 0.011921175755560398, "cur_lr": 0.0005000000237487257, "entropy": 1.2213951349258423, "total_loss": 20.243629455566406, "vf_explained_var": 0.8391225934028625, "vf_loss": 20.247583389282227, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0042528146877884865}}, "num_steps_trained": 1528320}, "node_ip": "10.138.0.2", "episodes_this_iter": 48, "episodes_total": 1709, "pid": 4718, "episode_reward_min": -805.2595200656273, "time_total_s": 1194.525059223175, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.91685724258423, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f0d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9fea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9ff28>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9fd90>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 40283, "timesteps_since_restore": 1530837, "sampler_perf": {"mean_inference_ms": 1.7988869486930503, "mean_env_wait_ms": 17.242532406247037, "mean_processing_ms": 6.591973417272206}, "date": "2019-05-30_01-54-41", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 37, "timesteps_total": 1530837, "episode_reward_mean": -477.9758239837757, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -33.10273665770178, "episode_len_mean": 322.12, "timestamp": 1559181281, "off_policy_estimator": {}, "time_since_restore": 1194.525059223175, "custom_metrics": {"cost1_mean": 184.70968622579275, "cost1_max": 206.21725356108067, "cost2_mean": -106.76679450543361, "cost2_max": -22.953270028339922, "system_level_velocity_max": 18.537016076186937, "cost2_min": -132.3522919206152, "system_level_velocity_min": 11.615744885569702, "system_level_velocity_mean": 15.478478514326476, "outflow_rate_mean": 1252.902557700938, "cost1_min": 24.186612586828375, "outflow_rate_min": 510.4088222968832, "outflow_rate_max": 1380.7833671307055}, "iterations_since_restore": 37}
{"info": {"num_steps_sampled": 1572751, "sample_time_ms": 21258.662, "update_time_ms": 10.603, "load_time_ms": 5.812, "grad_time_ms": 11579.49, "learner": {"default_policy": {"kl": 0.008698317222297192, "cur_lr": 0.0005000000237487257, "entropy": 1.1962543725967407, "total_loss": 20.296302795410156, "vf_explained_var": 0.8422461748123169, "vf_loss": 20.29895782470703, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0028714437503367662}}, "num_steps_trained": 1570176}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 1751, "pid": 4718, "episode_reward_min": -678.0503403718648, "time_total_s": 1227.4549052715302, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.9298460483551, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a598eae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a598ef28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a598ea60>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a598eea0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41914, "timesteps_since_restore": 1572751, "sampler_perf": {"mean_inference_ms": 1.7968596395559888, "mean_env_wait_ms": 17.222711982419007, "mean_processing_ms": 6.5882120155146735}, "date": "2019-05-30_01-55-14", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 38, "timesteps_total": 1572751, "episode_reward_mean": -484.44267729143905, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -366.3469689485153, "episode_len_mean": 325.0, "timestamp": 1559181314, "off_policy_estimator": {}, "time_since_restore": 1227.4549052715302, "custom_metrics": {"cost1_mean": 185.5047174883938, "cost1_max": 206.46256517974794, "cost2_mean": -106.92886120723293, "cost2_max": -63.14746120434267, "system_level_velocity_max": 17.36519003150911, "cost2_min": -127.51325873360301, "system_level_velocity_min": 12.27219593126753, "system_level_velocity_mean": 15.387534833125748, "outflow_rate_mean": 1258.941497102813, "cost1_min": 140.06602869872665, "outflow_rate_min": 1051.1843564932099, "outflow_rate_max": 1380.7833671307055}, "iterations_since_restore": 38}
{"info": {"num_steps_sampled": 1614731, "sample_time_ms": 21265.537, "update_time_ms": 10.647, "load_time_ms": 5.944, "grad_time_ms": 11585.247, "learner": {"default_policy": {"kl": 0.012615333311259747, "cur_lr": 0.0005000000237487257, "entropy": 1.1710284948349, "total_loss": 22.607797622680664, "vf_explained_var": 0.8252835869789124, "vf_loss": 22.611921310424805, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0044365436770021915}}, "num_steps_trained": 1612032}, "node_ip": "10.138.0.2", "episodes_this_iter": 52, "episodes_total": 1803, "pid": 4718, "episode_reward_min": -767.0454894859876, "time_total_s": 1262.1938779354095, "num_metric_batches_dropped": 0, "time_this_iter_s": 34.738972663879395, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f9488>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f9400>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41980, "timesteps_since_restore": 1614731, "sampler_perf": {"mean_inference_ms": 1.7946185317539902, "mean_env_wait_ms": 17.216364397970857, "mean_processing_ms": 6.585602528995338}, "date": "2019-05-30_01-55-48", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 39, "timesteps_total": 1614731, "episode_reward_mean": -484.3308897567395, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -31.384514863943245, "episode_len_mean": 319.2, "timestamp": 1559181348, "off_policy_estimator": {}, "time_since_restore": 1262.1938779354095, "custom_metrics": {"cost1_mean": 182.19836411760753, "cost1_max": 206.46256517974794, "cost2_mean": -107.5549396583452, "cost2_max": -21.89315585888398, "system_level_velocity_max": 18.385863996115162, "cost2_min": -127.51325873360301, "system_level_velocity_min": 12.188084069472845, "system_level_velocity_mean": 15.412237664873398, "outflow_rate_mean": 1245.5731456149417, "cost1_min": 22.521715137539278, "outflow_rate_min": 481.99009215424053, "outflow_rate_max": 1384.0306459842002}, "iterations_since_restore": 39}
{"info": {"num_steps_sampled": 1655882, "sample_time_ms": 21231.256, "update_time_ms": 10.128, "load_time_ms": 5.652, "grad_time_ms": 11569.308, "learner": {"default_policy": {"kl": 0.01391705870628357, "cur_lr": 0.0005000000237487257, "entropy": 1.1521636247634888, "total_loss": 20.520002365112305, "vf_explained_var": 0.8408511281013489, "vf_loss": 20.523012161254883, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.003356735920533538}}, "num_steps_trained": 1653120}, "node_ip": "10.138.0.2", "episodes_this_iter": 49, "episodes_total": 1852, "pid": 4718, "episode_reward_min": -767.0454894859876, "time_total_s": 1294.665094614029, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.471216678619385, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bbae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bb8c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb6a8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb620>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41151, "timesteps_since_restore": 1655882, "sampler_perf": {"mean_inference_ms": 1.791269802025585, "mean_env_wait_ms": 17.207902607069624, "mean_processing_ms": 6.599670448141453}, "date": "2019-05-30_01-56-21", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 40, "timesteps_total": 1655882, "episode_reward_mean": -484.98917112812217, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -25.65320081698471, "episode_len_mean": 316.22, "timestamp": 1559181381, "off_policy_estimator": {}, "time_since_restore": 1294.665094614029, "custom_metrics": {"cost1_mean": 179.5538107750894, "cost1_max": 204.57762256666388, "cost2_mean": -105.88741319673349, "cost2_max": -19.747650052009284, "system_level_velocity_max": 18.385863996115162, "cost2_min": -126.44104205000005, "system_level_velocity_min": 11.065343965730602, "system_level_velocity_mean": 15.356456467767632, "outflow_rate_mean": 1229.505870033941, "cost1_min": 17.46453005664783, "outflow_rate_min": 440.0050268646629, "outflow_rate_max": 1384.0306459842002}, "iterations_since_restore": 40}
{"info": {"num_steps_sampled": 1696316, "sample_time_ms": 21138.892, "update_time_ms": 10.156, "load_time_ms": 5.769, "grad_time_ms": 11614.737, "learner": {"default_policy": {"kl": 0.014076835475862026, "cur_lr": 0.0005000000237487257, "entropy": 1.1478594541549683, "total_loss": 18.213077545166016, "vf_explained_var": 0.8575904369354248, "vf_loss": 18.216205596923828, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0034801566507667303}}, "num_steps_trained": 1693440}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 1892, "pid": 4718, "episode_reward_min": -751.0079105614961, "time_total_s": 1325.4771111011505, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.812016487121582, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a92f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9f28>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9268>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 40434, "timesteps_since_restore": 1696316, "sampler_perf": {"mean_inference_ms": 1.790066695843444, "mean_env_wait_ms": 17.19346664282384, "mean_processing_ms": 6.5970377502832385}, "date": "2019-05-30_01-56-52", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 41, "timesteps_total": 1696316, "episode_reward_mean": -475.83134926598, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -25.65320081698471, "episode_len_mean": 318.04, "timestamp": 1559181412, "off_policy_estimator": {}, "time_since_restore": 1325.4771111011505, "custom_metrics": {"cost1_mean": 182.15941356267922, "cost1_max": 204.887293454474, "cost2_mean": -105.93160114923961, "cost2_max": -19.747650052009284, "system_level_velocity_max": 18.385863996115162, "cost2_min": -125.98630767062338, "system_level_velocity_min": 11.065343965730602, "system_level_velocity_mean": 15.493392649437212, "outflow_rate_mean": 1240.2793882584067, "cost1_min": 17.46453005664783, "outflow_rate_min": 440.0050268646629, "outflow_rate_max": 1376.281672473868}, "iterations_since_restore": 41}
{"info": {"num_steps_sampled": 1739246, "sample_time_ms": 20900.708, "update_time_ms": 9.978, "load_time_ms": 6.083, "grad_time_ms": 11583.02, "learner": {"default_policy": {"kl": 0.012721799314022064, "cur_lr": 0.0005000000237487257, "entropy": 1.1533831357955933, "total_loss": 19.92948341369629, "vf_explained_var": 0.8558732271194458, "vf_loss": 19.933616638183594, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.004450018052011728}}, "num_steps_trained": 1736320}, "node_ip": "10.138.0.2", "episodes_this_iter": 44, "episodes_total": 1936, "pid": 4718, "episode_reward_min": -751.0079105614961, "time_total_s": 1358.0416309833527, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.56451988220215, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87ba378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87ba268>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9ae8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42930, "timesteps_since_restore": 1739246, "sampler_perf": {"mean_inference_ms": 1.7882622496487743, "mean_env_wait_ms": 17.179177514190336, "mean_processing_ms": 6.586510282192506}, "date": "2019-05-30_01-57-24", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 42, "timesteps_total": 1739246, "episode_reward_mean": -490.0524842222427, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -232.30931388366665, "episode_len_mean": 323.92, "timestamp": 1559181444, "off_policy_estimator": {}, "time_since_restore": 1358.0416309833527, "custom_metrics": {"cost1_mean": 185.42112079301072, "cost1_max": 207.25798395506354, "cost2_mean": -109.67799081505744, "cost2_max": -68.93277553164513, "system_level_velocity_max": 17.607293786802543, "cost2_min": -126.78693664736913, "system_level_velocity_min": 12.46556824255042, "system_level_velocity_mean": 15.420663086998367, "outflow_rate_mean": 1256.8833159244502, "cost1_min": 138.3273603670693, "outflow_rate_min": 1024.6743017567176, "outflow_rate_max": 1377.688879252317}, "iterations_since_restore": 42}
{"info": {"num_steps_sampled": 1779196, "sample_time_ms": 20807.832, "update_time_ms": 9.811, "load_time_ms": 5.991, "grad_time_ms": 11548.845, "learner": {"default_policy": {"kl": 0.015331532806158066, "cur_lr": 0.0005000000237487257, "entropy": 1.166812777519226, "total_loss": 21.19559669494629, "vf_explained_var": 0.85567706823349, "vf_loss": 21.20010757446289, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.004892867989838123}}, "num_steps_trained": 1776256}, "node_ip": "10.138.0.2", "episodes_this_iter": 55, "episodes_total": 1991, "pid": 4718, "episode_reward_min": -722.5979177113487, "time_total_s": 1389.8657746315002, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.824143648147583, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab032730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab032620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab0327b8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bbd08>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 39950, "timesteps_since_restore": 1779196, "sampler_perf": {"mean_inference_ms": 1.7855760256954563, "mean_env_wait_ms": 17.168612780294907, "mean_processing_ms": 6.59013608269983}, "date": "2019-05-30_01-57-56", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 43, "timesteps_total": 1779196, "episode_reward_mean": -500.4891069554404, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -250.8862907173555, "episode_len_mean": 323.64, "timestamp": 1559181476, "off_policy_estimator": {}, "time_since_restore": 1389.8657746315002, "custom_metrics": {"cost1_mean": 180.63372494383944, "cost1_max": 207.25798395506354, "cost2_mean": -106.88852020332142, "cost2_max": -35.61959555874243, "system_level_velocity_max": 17.392250135160626, "cost2_min": -126.78693664736913, "system_level_velocity_min": 11.169798188258543, "system_level_velocity_mean": 15.009971782173611, "outflow_rate_mean": 1237.1875510658592, "cost1_min": 122.73531222858301, "outflow_rate_min": 737.9624168514409, "outflow_rate_max": 1377.688879252317}, "iterations_since_restore": 43}
{"info": {"num_steps_sampled": 1819434, "sample_time_ms": 20852.674, "update_time_ms": 9.846, "load_time_ms": 5.812, "grad_time_ms": 11545.043, "learner": {"default_policy": {"kl": 0.017562972381711006, "cur_lr": 0.0005000000237487257, "entropy": 1.1634111404418945, "total_loss": 21.343215942382812, "vf_explained_var": 0.862791121006012, "vf_loss": 21.348962783813477, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.00618853559717536}}, "num_steps_trained": 1816448}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 2033, "pid": 4718, "episode_reward_min": -729.4262307482496, "time_total_s": 1421.3212447166443, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.455470085144043, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59900d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a598eae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a5990048>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a598eea0>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 40238, "timesteps_since_restore": 1819434, "sampler_perf": {"mean_inference_ms": 1.7838476633000047, "mean_env_wait_ms": 17.143966089056562, "mean_processing_ms": 6.593792303730018}, "date": "2019-05-30_01-58-28", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 44, "timesteps_total": 1819434, "episode_reward_mean": -497.8787537991749, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -31.38512617474188, "episode_len_mean": 320.74, "timestamp": 1559181508, "off_policy_estimator": {}, "time_since_restore": 1421.3212447166443, "custom_metrics": {"cost1_mean": 175.35826720277046, "cost1_max": 204.45037494656907, "cost2_mean": -101.13520436874464, "cost2_max": -21.35018765287619, "system_level_velocity_max": 18.388111218838127, "cost2_min": -123.44472126613786, "system_level_velocity_min": 11.053187251498137, "system_level_velocity_mean": 14.777293899188715, "outflow_rate_mean": 1207.9689694886783, "cost1_min": 22.636624531310602, "outflow_rate_min": 510.482880093598, "outflow_rate_max": 1370.5700000000006}, "iterations_since_restore": 44}
{"info": {"num_steps_sampled": 1860516, "sample_time_ms": 20883.807, "update_time_ms": 9.862, "load_time_ms": 6.029, "grad_time_ms": 11369.22, "learner": {"default_policy": {"kl": 0.013899080455303192, "cur_lr": 0.0005000000237487257, "entropy": 1.148893117904663, "total_loss": 22.44125747680664, "vf_explained_var": 0.8585054278373718, "vf_loss": 22.446271896362305, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.005361913703382015}}, "num_steps_trained": 1857408}, "node_ip": "10.138.0.2", "episodes_this_iter": 45, "episodes_total": 2078, "pid": 4718, "episode_reward_min": -729.4262307482496, "time_total_s": 1453.538169145584, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.21692442893982, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bbea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bbf28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb840>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb950>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41082, "timesteps_since_restore": 1860516, "sampler_perf": {"mean_inference_ms": 1.7824578299790759, "mean_env_wait_ms": 17.114045983324328, "mean_processing_ms": 6.58967947752496}, "date": "2019-05-30_01-59-00", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 45, "timesteps_total": 1860516, "episode_reward_mean": -489.39597080727515, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -31.38512617474188, "episode_len_mean": 321.92, "timestamp": 1559181540, "off_policy_estimator": {}, "time_since_restore": 1453.538169145584, "custom_metrics": {"cost1_mean": 177.1614795347947, "cost1_max": 204.45037494656907, "cost2_mean": -99.02322912175974, "cost2_max": -21.35018765287619, "system_level_velocity_max": 18.388111218838127, "cost2_min": -122.32800536455167, "system_level_velocity_min": 10.706946657144117, "system_level_velocity_mean": 14.924213988772403, "outflow_rate_mean": 1213.1621060075192, "cost1_min": 22.636624531310602, "outflow_rate_min": 510.482880093598, "outflow_rate_max": 1372.5776680643455}, "iterations_since_restore": 45}
{"info": {"num_steps_sampled": 1902869, "sample_time_ms": 20925.631, "update_time_ms": 9.689, "load_time_ms": 6.21, "grad_time_ms": 11299.297, "learner": {"default_policy": {"kl": 0.012931826524436474, "cur_lr": 0.0005000000237487257, "entropy": 1.1311854124069214, "total_loss": 22.026453018188477, "vf_explained_var": 0.8532735109329224, "vf_loss": 22.03074073791504, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.004610298667103052}}, "num_steps_trained": 1899648}, "node_ip": "10.138.0.2", "episodes_this_iter": 52, "episodes_total": 2130, "pid": 4718, "episode_reward_min": -785.1818300598961, "time_total_s": 1485.9630289077759, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.42485976219177, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a598e950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a598e9d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a598e840>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a598e8c8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42353, "timesteps_since_restore": 1902869, "sampler_perf": {"mean_inference_ms": 1.7818448264250504, "mean_env_wait_ms": 17.128906745705123, "mean_processing_ms": 6.591520966981302}, "date": "2019-05-30_01-59-32", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 46, "timesteps_total": 1902869, "episode_reward_mean": -517.3051364418621, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -366.6184057894588, "episode_len_mean": 325.0, "timestamp": 1559181572, "off_policy_estimator": {}, "time_since_restore": 1485.9630289077759, "custom_metrics": {"cost1_mean": 178.29554987864663, "cost1_max": 205.70586932391643, "cost2_mean": -103.68504012972502, "cost2_max": -34.12243228469863, "system_level_velocity_max": 17.287793096762307, "cost2_min": -125.07785072870982, "system_level_velocity_min": 10.57730010030161, "system_level_velocity_mean": 14.79492755776232, "outflow_rate_mean": 1228.67712090907, "cost1_min": 116.55900262299281, "outflow_rate_min": 735.0057637280282, "outflow_rate_max": 1372.9800204097232}, "iterations_since_restore": 46}
{"info": {"num_steps_sampled": 1944036, "sample_time_ms": 20616.215, "update_time_ms": 9.246, "load_time_ms": 6.363, "grad_time_ms": 11284.098, "learner": {"default_policy": {"kl": 0.013066154904663563, "cur_lr": 0.0005000000237487257, "entropy": 1.1325112581253052, "total_loss": 18.537450790405273, "vf_explained_var": 0.8762339949607849, "vf_loss": 18.542461395263672, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.005335583351552486}}, "num_steps_trained": 1940736}, "node_ip": "10.138.0.2", "episodes_this_iter": 43, "episodes_total": 2173, "pid": 4718, "episode_reward_min": -785.1818300598961, "time_total_s": 1514.6079144477844, "num_metric_batches_dropped": 0, "time_this_iter_s": 28.644885540008545, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59910d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007d90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a5991048>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007620>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41167, "timesteps_since_restore": 1944036, "sampler_perf": {"mean_inference_ms": 1.779826451641397, "mean_env_wait_ms": 17.11274037608985, "mean_processing_ms": 6.590570522227289}, "date": "2019-05-30_02-00-01", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 47, "timesteps_total": 1944036, "episode_reward_mean": -521.0651725049886, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -384.9640528574398, "episode_len_mean": 325.0, "timestamp": 1559181601, "off_policy_estimator": {}, "time_since_restore": 1514.6079144477844, "custom_metrics": {"cost1_mean": 179.41409428413743, "cost1_max": 205.70586932391643, "cost2_mean": -105.92527952991779, "cost2_max": -68.30157812474175, "system_level_velocity_max": 17.287793096762307, "cost2_min": -125.07785072870982, "system_level_velocity_min": 10.57730010030161, "system_level_velocity_mean": 14.861449979284941, "outflow_rate_mean": 1237.495386199737, "cost1_min": 128.49909947896555, "outflow_rate_min": 1014.9598901098902, "outflow_rate_max": 1372.9800204097232}, "iterations_since_restore": 47}
{"info": {"num_steps_sampled": 1985461, "sample_time_ms": 20345.163, "update_time_ms": 9.361, "load_time_ms": 6.365, "grad_time_ms": 11208.402, "learner": {"default_policy": {"kl": 0.018847234547138214, "cur_lr": 0.0005000000237487257, "entropy": 1.1166276931762695, "total_loss": 20.862279891967773, "vf_explained_var": 0.8566301465034485, "vf_loss": 20.867992401123047, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.006184682250022888}}, "num_steps_trained": 1982080}, "node_ip": "10.138.0.2", "episodes_this_iter": 44, "episodes_total": 2217, "pid": 4718, "episode_reward_min": -740.6209592709553, "time_total_s": 1544.0631659030914, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.455251455307007, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a5991950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a5991840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59918c8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59917b8>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 41425, "timesteps_since_restore": 1985461, "sampler_perf": {"mean_inference_ms": 1.7752409934275835, "mean_env_wait_ms": 17.055007776081883, "mean_processing_ms": 6.579242385146793}, "date": "2019-05-30_02-00-31", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 48, "timesteps_total": 1985461, "episode_reward_mean": -504.8784085569345, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -382.7184908513771, "episode_len_mean": 325.0, "timestamp": 1559181631, "off_policy_estimator": {}, "time_since_restore": 1544.0631659030914, "custom_metrics": {"cost1_mean": 181.72782564873782, "cost1_max": 205.70586932391643, "cost2_mean": -104.79989653707021, "cost2_max": -67.45094164143848, "system_level_velocity_max": 17.287793096762307, "cost2_min": -125.07785072870982, "system_level_velocity_min": 11.982293218727136, "system_level_velocity_mean": 15.100783978002518, "outflow_rate_mean": 1249.800535815208, "cost1_min": 143.54903909030153, "outflow_rate_min": 1023.1925950413222, "outflow_rate_max": 1372.9800204097232}, "iterations_since_restore": 48}
{"info": {"num_steps_sampled": 2027972, "sample_time_ms": 19933.094, "update_time_ms": 9.111, "load_time_ms": 6.225, "grad_time_ms": 11110.257, "learner": {"default_policy": {"kl": 0.017249111086130142, "cur_lr": 0.0005000000237487257, "entropy": 1.119558334350586, "total_loss": 22.31644630432129, "vf_explained_var": 0.8522083163261414, "vf_loss": 22.322532653808594, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0065195998176932335}}, "num_steps_trained": 2024576}, "node_ip": "10.138.0.2", "episodes_this_iter": 49, "episodes_total": 2266, "pid": 4718, "episode_reward_min": -733.294891646845, "time_total_s": 1573.6995677947998, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.636401891708374, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a5990268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59900d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59901e0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a5990158>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": false, "timesteps_this_iter": 42511, "timesteps_since_restore": 2027972, "sampler_perf": {"mean_inference_ms": 1.7701984855204633, "mean_env_wait_ms": 17.004620982534906, "mean_processing_ms": 6.562093645440764}, "date": "2019-05-30_02-01-00", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 49, "timesteps_total": 2027972, "episode_reward_mean": -495.4395710624371, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -379.37736948397736, "episode_len_mean": 325.0, "timestamp": 1559181660, "off_policy_estimator": {}, "time_since_restore": 1573.6995677947998, "custom_metrics": {"cost1_mean": 183.08267868659314, "cost1_max": 202.78146840658033, "cost2_mean": -104.69213559897027, "cost2_max": -67.45094164143848, "system_level_velocity_max": 17.21207785885435, "cost2_min": -129.7341177201962, "system_level_velocity_min": 11.34573966828993, "system_level_velocity_mean": 15.225935529151922, "outflow_rate_mean": 1258.087608521674, "cost1_min": 140.22382104089687, "outflow_rate_min": 1023.1925950413222, "outflow_rate_max": 1367.1572824302136}, "iterations_since_restore": 49}
{"info": {"num_steps_sampled": 2069443, "sample_time_ms": 19577.297, "update_time_ms": 9.6, "load_time_ms": 6.141, "grad_time_ms": 11065.611, "learner": {"default_policy": {"kl": 0.016315996646881104, "cur_lr": 0.0005000000237487257, "entropy": 1.0999126434326172, "total_loss": 19.371248245239258, "vf_explained_var": 0.8683807253837585, "vf_loss": 19.3762149810791, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.005376976914703846}}, "num_steps_trained": 2065920}, "node_ip": "10.138.0.2", "episodes_this_iter": 47, "episodes_total": 2313, "pid": 4718, "episode_reward_min": -906.8440373121126, "time_total_s": 1602.1434111595154, "num_metric_batches_dropped": 0, "time_this_iter_s": 28.443843364715576, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "remote_worker_envs": false, "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "grayscale": false, "dim": 84, "lstm_cell_size": 256, "use_lstm": false, "framestack": true, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "output_compress_columns": ["obs", "new_obs"], "simple_optimizer": false, "use_gae": true, "grad_clip": null, "compress_observations": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "vf_share_layers": false, "lr_schedule": null, "kl_target": 0.01, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "synchronize_filters": true, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "clip_param": 0.3, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "remote_env_batch_wait_ms": 0, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007d08>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007b70>)", "on_train_result": null, "on_sample_end": null, "on_postprocess_traj": null}}, "done": true, "timesteps_this_iter": 41471, "timesteps_since_restore": 2069443, "sampler_perf": {"mean_inference_ms": 1.7639096009262019, "mean_env_wait_ms": 16.961640665257008, "mean_processing_ms": 6.557270176307915}, "date": "2019-05-30_02-01-29", "hostname": "flow-main", "policy_reward_mean": {}, "num_healthy_workers": 20, "training_iteration": 50, "timesteps_total": 2069443, "episode_reward_mean": -512.853049509204, "experiment_id": "dabcec213d7d4e918dbc12051e72d8e0", "episode_reward_max": -369.49102437638646, "episode_len_mean": 325.0, "timestamp": 1559181689, "off_policy_estimator": {}, "time_since_restore": 1602.1434111595154, "custom_metrics": {"cost1_mean": 181.75760953981637, "cost1_max": 203.77200331671514, "cost2_mean": -107.11898561899196, "cost2_max": -87.87390097575809, "system_level_velocity_max": 17.262600480104396, "cost2_min": -129.7341177201962, "system_level_velocity_min": 11.215792646034835, "system_level_velocity_mean": 15.062810027608158, "outflow_rate_mean": 1252.1983639089647, "cost1_min": 135.74647742355307, "outflow_rate_min": 812.0230186647522, "outflow_rate_max": 1367.1572824302136}, "iterations_since_restore": 50}

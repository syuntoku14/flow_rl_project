{"info": {"num_steps_sampled": 40471, "sample_time_ms": 36180.116, "update_time_ms": 1139.792, "load_time_ms": 75.712, "grad_time_ms": 11530.196, "learner": {"default_policy": {"vf_loss": 38.3417854309082, "cur_lr": 0.0005000000237487257, "total_loss": 38.341522216796875, "cur_kl_coeff": 0.20000003278255463, "vf_explained_var": -3.879772066284204e-06, "entropy": 1.4140561819076538, "kl": 0.0012717602076008916, "policy_loss": -0.0005198877188377082}}, "num_steps_trained": 40448}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 40, "pid": 1275, "episode_reward_min": -1044.4877092868, "time_total_s": 49.08351159095764, "num_metric_batches_dropped": 0, "time_this_iter_s": 49.08351159095764, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9b70>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a98c8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9620>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a90d0>)"}}, "done": false, "timesteps_this_iter": 40471, "timesteps_since_restore": 40471, "date": "2019-05-30_01-38-00", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.806054721659573, "mean_env_wait_ms": 18.03462060885169, "mean_processing_ms": 5.770957977889222}, "training_iteration": 1, "timesteps_total": 40471, "episode_reward_mean": -700.590552238267, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -528.0168906973927, "episode_len_mean": 325.0, "timestamp": 1559180280, "off_policy_estimator": {}, "time_since_restore": 49.08351159095764, "custom_metrics": {"cost1_mean": 119.37041451790523, "cost1_max": 146.50247290339627, "cost2_mean": -43.43103596712082, "cost2_max": -28.62224225071446, "system_level_velocity_max": 12.007005679369216, "cost2_min": -78.80975959074127, "system_level_velocity_min": 8.006068671210736, "system_level_velocity_mean": 9.967896710513145, "outflow_rate_mean": 709.0327656880645, "cost1_min": 94.1586526716483, "outflow_rate_min": 409.1574193548388, "outflow_rate_max": 997.7629968162677}, "iterations_since_restore": 1}
{"info": {"num_steps_sampled": 83495, "sample_time_ms": 28117.239, "update_time_ms": 576.17, "load_time_ms": 41.507, "grad_time_ms": 11585.968, "learner": {"default_policy": {"vf_loss": 62.58768844604492, "cur_lr": 0.0005000000237487257, "total_loss": 62.58683395385742, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 4.8027330194599926e-05, "entropy": 1.395596981048584, "kl": 0.0037923171184957027, "policy_loss": -0.0012291355524212122}}, "num_steps_trained": 83456}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 81, "pid": 1275, "episode_reward_min": -1044.4877092868, "time_total_s": 80.90021872520447, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.816707134246826, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bbea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bbd08>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bbd90>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bbe18>)"}}, "done": false, "timesteps_this_iter": 43024, "timesteps_since_restore": 83495, "date": "2019-05-30_01-38-32", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8188917637131543, "mean_env_wait_ms": 17.842763290281795, "mean_processing_ms": 5.817427417630903}, "training_iteration": 2, "timesteps_total": 83495, "episode_reward_mean": -703.2775123617034, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -32.83325555532082, "episode_len_mean": 321.41975308641975, "timestamp": 1559180312, "off_policy_estimator": {}, "time_since_restore": 80.90021872520447, "custom_metrics": {"cost1_mean": 118.89921305017937, "cost1_max": 146.50247290339627, "cost2_mean": -45.87325174240763, "cost2_max": -20.247252004129418, "system_level_velocity_max": 18.1338648287559, "cost2_min": -78.83337876628306, "system_level_velocity_min": 7.963387110259896, "system_level_velocity_mean": 10.101962348518482, "outflow_rate_mean": 721.7709643708948, "cost1_min": 22.53579782173685, "outflow_rate_min": 383.32799999999986, "outflow_rate_max": 997.7629968162677}, "iterations_since_restore": 2}
{"info": {"num_steps_sampled": 125856, "sample_time_ms": 25622.639, "update_time_ms": 388.061, "load_time_ms": 29.732, "grad_time_ms": 11436.291, "learner": {"default_policy": {"vf_loss": 49.699241638183594, "cur_lr": 0.0005000000237487257, "total_loss": 49.69828414916992, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.4543236792087555, "entropy": 1.3892544507980347, "kl": 0.005464557092636824, "policy_loss": -0.0012345988070592284}}, "num_steps_trained": 125696}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 122, "pid": 1275, "episode_reward_min": -1044.4877092868, "time_total_s": 112.78297543525696, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.88275671005249, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59cdf28>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab032620>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9fd90>)"}}, "done": false, "timesteps_this_iter": 42361, "timesteps_since_restore": 125856, "date": "2019-05-30_01-39-04", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8265982296739776, "mean_env_wait_ms": 17.676920870514472, "mean_processing_ms": 5.873561394371348}, "training_iteration": 3, "timesteps_total": 125856, "episode_reward_mean": -692.7914625997383, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -32.39032833837983, "episode_len_mean": 319.2, "timestamp": 1559180344, "off_policy_estimator": {}, "time_since_restore": 112.78297543525696, "custom_metrics": {"cost1_mean": 120.35785421666513, "cost1_max": 150.007287896152, "cost2_mean": -47.244700087024, "cost2_max": -19.90127390670919, "system_level_velocity_max": 18.1338648287559, "cost2_min": -78.83337876628306, "system_level_velocity_min": 7.963387110259896, "system_level_velocity_mean": 10.335567902808425, "outflow_rate_mean": 739.0705810200412, "cost1_min": 22.235032092280726, "outflow_rate_min": 383.32799999999986, "outflow_rate_max": 964.5462259735918}, "iterations_since_restore": 3}
{"info": {"num_steps_sampled": 169367, "sample_time_ms": 24724.262, "update_time_ms": 293.338, "load_time_ms": 23.75, "grad_time_ms": 11586.945, "learner": {"default_policy": {"vf_loss": 70.95181274414062, "cur_lr": 0.0005000000237487257, "total_loss": 70.94960021972656, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.6027753949165344, "entropy": 1.3697761297225952, "kl": 0.006656875368207693, "policy_loss": -0.0025471895933151245}}, "num_steps_trained": 169088}, "node_ip": "10.138.0.2", "episodes_this_iter": 60, "episodes_total": 182, "pid": 1275, "episode_reward_min": -1164.9436685824642, "time_total_s": 146.97636103630066, "num_metric_batches_dropped": 0, "time_this_iter_s": 34.1933856010437, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9158>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9048>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bbf28>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f90d0>)"}}, "done": false, "timesteps_this_iter": 43511, "timesteps_since_restore": 169367, "date": "2019-05-30_01-39-38", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8640491195639788, "mean_env_wait_ms": 17.548742205814047, "mean_processing_ms": 6.331395988843781}, "training_iteration": 4, "timesteps_total": 169367, "episode_reward_mean": -679.9141849842356, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -32.39032833837983, "episode_len_mean": 322.1, "timestamp": 1559180378, "off_policy_estimator": {}, "time_since_restore": 146.97636103630066, "custom_metrics": {"cost1_mean": 130.89265132653398, "cost1_max": 159.66039289676482, "cost2_mean": -54.91299047985493, "cost2_max": -19.90127390670919, "system_level_velocity_max": 18.015698318555902, "cost2_min": -88.54606143536017, "system_level_velocity_min": 5.55168689139119, "system_level_velocity_mean": 11.008183396898493, "outflow_rate_mean": 818.8107827900967, "cost1_min": 22.235032092280726, "outflow_rate_min": 453.0, "outflow_rate_max": 1087.3394421537714}, "iterations_since_restore": 4}
{"info": {"num_steps_sampled": 211600, "sample_time_ms": 23568.658, "update_time_ms": 236.888, "load_time_ms": 20.21, "grad_time_ms": 11623.09, "learner": {"default_policy": {"vf_loss": 45.37468719482422, "cur_lr": 0.0005000000237487257, "total_loss": 45.371788024902344, "cur_kl_coeff": 0.05000000074505806, "vf_explained_var": 0.7903925776481628, "entropy": 1.3606306314468384, "kl": 0.01055079884827137, "policy_loss": -0.0034260060638189316}}, "num_steps_trained": 211200}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 222, "pid": 1275, "episode_reward_min": -1164.9436685824642, "time_total_s": 177.81255412101746, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.836193084716797, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb8c8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bb400>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bbea0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb488>)"}}, "done": false, "timesteps_this_iter": 42233, "timesteps_since_restore": 211600, "date": "2019-05-30_01-40-09", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.863711459002877, "mean_env_wait_ms": 17.441381924792317, "mean_processing_ms": 6.4955808217541176}, "training_iteration": 5, "timesteps_total": 211600, "episode_reward_mean": -657.4930119075821, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -474.5993344784608, "episode_len_mean": 325.0, "timestamp": 1559180409, "off_policy_estimator": {}, "time_since_restore": 177.81255412101746, "custom_metrics": {"cost1_mean": 142.57538529382998, "cost1_max": 182.3088508530428, "cost2_mean": -63.90509128873112, "cost2_max": -38.31698755677831, "system_level_velocity_max": 14.857935332475313, "cost2_min": -99.38084541083026, "system_level_velocity_min": 5.55168689139119, "system_level_velocity_mean": 11.767874337440611, "outflow_rate_mean": 906.7269240880596, "cost1_min": 68.07406403506519, "outflow_rate_min": 453.0, "outflow_rate_max": 1200.1412321996986}, "iterations_since_restore": 5}
{"info": {"num_steps_sampled": 254329, "sample_time_ms": 22979.838, "update_time_ms": 199.598, "load_time_ms": 17.798, "grad_time_ms": 11588.413, "learner": {"default_policy": {"vf_loss": 45.946502685546875, "cur_lr": 0.0005000000237487257, "total_loss": 45.94424057006836, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.7963839769363403, "entropy": 1.3471698760986328, "kl": 0.00958741270005703, "policy_loss": -0.0027476807590574026}}, "num_steps_trained": 253824}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 263, "pid": 1275, "episode_reward_min": -888.430107282896, "time_total_s": 209.37339067459106, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.56083655357361, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9510>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9a60>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9268>)"}}, "done": false, "timesteps_this_iter": 42729, "timesteps_since_restore": 254329, "date": "2019-05-30_01-40-41", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8468293315525512, "mean_env_wait_ms": 17.361785147754016, "mean_processing_ms": 6.376736457610969}, "training_iteration": 6, "timesteps_total": 254329, "episode_reward_mean": -588.271272576489, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -32.49647223210667, "episode_len_mean": 322.1, "timestamp": 1559180441, "off_policy_estimator": {}, "time_since_restore": 209.37339067459106, "custom_metrics": {"cost1_mean": 155.45655652139078, "cost1_max": 190.21689040621033, "cost2_mean": -73.0350674453123, "cost2_max": -24.01563154901175, "system_level_velocity_max": 18.49883973003071, "cost2_min": -124.07307592084618, "system_level_velocity_min": 9.8404316648583, "system_level_velocity_mean": 12.951560619304313, "outflow_rate_mean": 1002.7124377717264, "cost1_min": 23.060976045947836, "outflow_rate_min": 482.8201534989533, "outflow_rate_max": 1224.7635654863855}, "iterations_since_restore": 6}
{"info": {"num_steps_sampled": 295775, "sample_time_ms": 22761.399, "update_time_ms": 172.837, "load_time_ms": 16.239, "grad_time_ms": 11444.173, "learner": {"default_policy": {"vf_loss": 44.678035736083984, "cur_lr": 0.0005000000237487257, "total_loss": 44.67589569091797, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.7699606418609619, "entropy": 1.3448795080184937, "kl": 0.008076786063611507, "policy_loss": -0.0025441546458750963}}, "num_steps_trained": 295168}, "node_ip": "10.138.0.2", "episodes_this_iter": 60, "episodes_total": 323, "pid": 1275, "episode_reward_min": -888.430107282896, "time_total_s": 241.51666378974915, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.14327311515808, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9730>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f96a8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f97b8>)"}}, "done": false, "timesteps_this_iter": 41446, "timesteps_since_restore": 295775, "date": "2019-05-30_01-41-13", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8369241808433867, "mean_env_wait_ms": 17.331836546141393, "mean_processing_ms": 6.460949760960041}, "training_iteration": 7, "timesteps_total": 295775, "episode_reward_mean": -511.79645197897133, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -32.49647223210667, "episode_len_mean": 322.1, "timestamp": 1559180473, "off_policy_estimator": {}, "time_since_restore": 241.51666378974915, "custom_metrics": {"cost1_mean": 175.09456775669446, "cost1_max": 205.93428963357312, "cost2_mean": -87.79727539580915, "cost2_max": -24.01563154901175, "system_level_velocity_max": 18.49883973003071, "cost2_min": -124.07307592084618, "system_level_velocity_min": 11.159820855717342, "system_level_velocity_mean": 14.531045621082235, "outflow_rate_mean": 1134.6989169460048, "cost1_min": 23.060976045947836, "outflow_rate_min": 482.8201534989533, "outflow_rate_max": 1323.9465667989707}, "iterations_since_restore": 7}
{"info": {"num_steps_sampled": 337004, "sample_time_ms": 22387.188, "update_time_ms": 152.568, "load_time_ms": 14.949, "grad_time_ms": 11343.957, "learner": {"default_policy": {"vf_loss": 32.4912109375, "cur_lr": 0.0005000000237487257, "total_loss": 32.48863983154297, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.8091237545013428, "entropy": 1.3405346870422363, "kl": 0.007671657018363476, "policy_loss": -0.0029538036324083805}}, "num_steps_trained": 336384}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 363, "pid": 1275, "episode_reward_min": -838.7704450263914, "time_total_s": 272.022025346756, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.505361557006836, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a92f0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9ae8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9f28>)"}}, "done": false, "timesteps_this_iter": 41229, "timesteps_since_restore": 337004, "date": "2019-05-30_01-41-44", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8296566958358278, "mean_env_wait_ms": 17.29393494289791, "mean_processing_ms": 6.520344365765539}, "training_iteration": 8, "timesteps_total": 337004, "episode_reward_mean": -499.22192563026977, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -340.1009535617311, "episode_len_mean": 325.0, "timestamp": 1559180504, "off_policy_estimator": {}, "time_since_restore": 272.022025346756, "custom_metrics": {"cost1_mean": 182.51919776706265, "cost1_max": 208.99054551171747, "cost2_mean": -95.22902625961818, "cost2_max": -63.59385213187245, "system_level_velocity_max": 17.238321966367177, "cost2_min": -118.9253487859649, "system_level_velocity_min": 11.595385517839215, "system_level_velocity_mean": 15.000680378238009, "outflow_rate_mean": 1184.0929045267999, "cost1_min": 137.64850841832086, "outflow_rate_min": 899.9906565656564, "outflow_rate_max": 1370.0625745682885}, "iterations_since_restore": 8}
{"info": {"num_steps_sampled": 379393, "sample_time_ms": 22104.99, "update_time_ms": 136.934, "load_time_ms": 14.115, "grad_time_ms": 11309.271, "learner": {"default_policy": {"vf_loss": 31.840646743774414, "cur_lr": 0.0005000000237487257, "total_loss": 31.839380264282227, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.7947142720222473, "entropy": 1.340753436088562, "kl": 0.00573968468233943, "policy_loss": -0.0015578470192849636}}, "num_steps_trained": 378752}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 403, "pid": 1275, "episode_reward_min": -842.6626167269065, "time_total_s": 303.0147433280945, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.9927179813385, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bbf28>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb730>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb6a8>)"}}, "done": false, "timesteps_this_iter": 42389, "timesteps_since_restore": 379393, "date": "2019-05-30_01-42-15", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.817437054752732, "mean_env_wait_ms": 17.27142225637528, "mean_processing_ms": 6.453720113113951}, "training_iteration": 9, "timesteps_total": 379393, "episode_reward_mean": -496.470729501298, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -321.2139589649387, "episode_len_mean": 325.0, "timestamp": 1559180535, "off_policy_estimator": {}, "time_since_restore": 303.0147433280945, "custom_metrics": {"cost1_mean": 185.21219650232086, "cost1_max": 214.0443599710812, "cost2_mean": -99.67007642054939, "cost2_max": -76.34095779409003, "system_level_velocity_max": 17.872732220631345, "cost2_min": -129.36459748166385, "system_level_velocity_min": 10.111007519771873, "system_level_velocity_mean": 15.256019185086434, "outflow_rate_mean": 1204.6251827071535, "cost1_min": 120.20326801660636, "outflow_rate_min": 899.9906565656564, "outflow_rate_max": 1387.7877892402496}, "iterations_since_restore": 9}
{"info": {"num_steps_sampled": 422741, "sample_time_ms": 22062.105, "update_time_ms": 124.006, "load_time_ms": 13.423, "grad_time_ms": 11326.029, "learner": {"default_policy": {"vf_loss": 41.062400817871094, "cur_lr": 0.0005000000237487257, "total_loss": 41.06104278564453, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.7501429915428162, "entropy": 1.333435297012329, "kl": 0.0067319790832698345, "policy_loss": -0.0016944665694609284}}, "num_steps_trained": 422016}, "node_ip": "10.138.0.2", "episodes_this_iter": 57, "episodes_total": 460, "pid": 1275, "episode_reward_min": -890.4992624571867, "time_total_s": 336.3012578487396, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.28651452064514, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab032730>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab0327b8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab032620>)"}}, "done": false, "timesteps_this_iter": 43348, "timesteps_since_restore": 422741, "date": "2019-05-30_01-42-48", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8099502380853667, "mean_env_wait_ms": 17.23574790444968, "mean_processing_ms": 6.472335805646781}, "training_iteration": 10, "timesteps_total": 422741, "episode_reward_mean": -508.17349149905726, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -321.1690840290396, "episode_len_mean": 325.0, "timestamp": 1559180568, "off_policy_estimator": {}, "time_since_restore": 336.3012578487396, "custom_metrics": {"cost1_mean": 185.64944623221646, "cost1_max": 217.85211886775886, "cost2_mean": -105.85356756788762, "cost2_max": -76.44546510606165, "system_level_velocity_max": 18.12109798619956, "cost2_min": -134.66164610692928, "system_level_velocity_min": 10.111007519771873, "system_level_velocity_mean": 15.311080333445487, "outflow_rate_mean": 1219.0408716537581, "cost1_min": 120.20326801660636, "outflow_rate_min": 919.4384648187634, "outflow_rate_max": 1411.0445926800476}, "iterations_since_restore": 10}
{"info": {"num_steps_sampled": 465243, "sample_time_ms": 20476.968, "update_time_ms": 10.862, "load_time_ms": 6.463, "grad_time_ms": 11313.889, "learner": {"default_policy": {"vf_loss": 32.47521209716797, "cur_lr": 0.0005000000237487257, "total_loss": 32.47355270385742, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.7930891513824463, "entropy": 1.3384416103363037, "kl": 0.0066101811826229095, "policy_loss": -0.001990207238122821}}, "num_steps_trained": 464512}, "node_ip": "10.138.0.2", "episodes_this_iter": 43, "episodes_total": 503, "pid": 1275, "episode_reward_min": -890.4992624571867, "time_total_s": 368.1406059265137, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.839348077774048, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87ba378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007a60>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007f28>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab0079d8>)"}}, "done": false, "timesteps_this_iter": 42502, "timesteps_since_restore": 465243, "date": "2019-05-30_01-43-20", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8028911395465013, "mean_env_wait_ms": 17.25575102320648, "mean_processing_ms": 6.53044307252698}, "training_iteration": 11, "timesteps_total": 465243, "episode_reward_mean": -533.9512212981608, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -321.1690840290396, "episode_len_mean": 325.0, "timestamp": 1559180600, "off_policy_estimator": {}, "time_since_restore": 368.1406059265137, "custom_metrics": {"cost1_mean": 182.50771862266222, "cost1_max": 217.85211886775886, "cost2_mean": -109.66984542236638, "cost2_max": -84.95797980475325, "system_level_velocity_max": 18.12109798619956, "cost2_min": -134.66164610692928, "system_level_velocity_min": 10.400125293728033, "system_level_velocity_mean": 15.066822894357886, "outflow_rate_mean": 1206.987496196411, "cost1_min": 127.2676257998349, "outflow_rate_min": 913.1464017527537, "outflow_rate_max": 1411.0445926800476}, "iterations_since_restore": 11}
{"info": {"num_steps_sampled": 508395, "sample_time_ms": 20569.253, "update_time_ms": 10.683, "load_time_ms": 6.237, "grad_time_ms": 11305.105, "learner": {"default_policy": {"vf_loss": 28.15492820739746, "cur_lr": 0.0005000000237487257, "total_loss": 28.154239654541016, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.8276201486587524, "entropy": 1.3405190706253052, "kl": 0.004403151571750641, "policy_loss": -0.0009107034420594573}}, "num_steps_trained": 507648}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 543, "pid": 1275, "episode_reward_min": -820.2064245504457, "time_total_s": 400.78226470947266, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.641658782958984, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9ea0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9730>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9f28>)"}}, "done": false, "timesteps_this_iter": 43152, "timesteps_since_restore": 508395, "date": "2019-05-30_01-43-53", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.799622634466964, "mean_env_wait_ms": 17.31413641571628, "mean_processing_ms": 6.492540797223087}, "training_iteration": 12, "timesteps_total": 508395, "episode_reward_mean": -540.0962373697636, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -332.9301429904495, "episode_len_mean": 325.0, "timestamp": 1559180633, "off_policy_estimator": {}, "time_since_restore": 400.78226470947266, "custom_metrics": {"cost1_mean": 181.34937760198682, "cost1_max": 216.1747862736206, "cost2_mean": -109.74472685150998, "cost2_max": -83.20942624872676, "system_level_velocity_max": 18.014773493958597, "cost2_min": -129.2053648794954, "system_level_velocity_min": 10.400125293728033, "system_level_velocity_mean": 14.943155052721147, "outflow_rate_mean": 1202.464093926724, "cost1_min": 127.2676257998349, "outflow_rate_min": 913.1464017527537, "outflow_rate_max": 1409.6768021148423}, "iterations_since_restore": 12}
{"info": {"num_steps_sampled": 550950, "sample_time_ms": 20760.916, "update_time_ms": 10.635, "load_time_ms": 6.336, "grad_time_ms": 11253.612, "learner": {"default_policy": {"vf_loss": 37.99193572998047, "cur_lr": 0.0005000000237487257, "total_loss": 37.98957443237305, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7682647705078125, "entropy": 1.3431119918823242, "kl": 0.00920597929507494, "policy_loss": -0.0025959094054996967}}, "num_steps_trained": 550144}, "node_ip": "10.138.0.2", "episodes_this_iter": 57, "episodes_total": 600, "pid": 1275, "episode_reward_min": -715.0322234606035, "time_total_s": 434.09931445121765, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.317049741744995, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9620>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9730>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bbae8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f96a8>)"}}, "done": false, "timesteps_this_iter": 42555, "timesteps_since_restore": 550950, "date": "2019-05-30_01-44-26", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8097215081337321, "mean_env_wait_ms": 17.43695548010603, "mean_processing_ms": 6.503792775319552}, "training_iteration": 13, "timesteps_total": 550950, "episode_reward_mean": -516.9076576446057, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -340.76473989607615, "episode_len_mean": 325.0, "timestamp": 1559180666, "off_policy_estimator": {}, "time_since_restore": 434.09931445121765, "custom_metrics": {"cost1_mean": 183.95598587873454, "cost1_max": 213.02750392631629, "cost2_mean": -106.30391913568556, "cost2_max": -74.45270292975322, "system_level_velocity_max": 17.52267770136829, "cost2_min": -125.23326304621703, "system_level_velocity_min": 10.400125293728033, "system_level_velocity_mean": 15.134731518805184, "outflow_rate_mean": 1211.6951893120188, "cost1_min": 127.2676257998349, "outflow_rate_min": 913.1464017527537, "outflow_rate_max": 1387.2491805986015}, "iterations_since_restore": 13}
{"info": {"num_steps_sampled": 591802, "sample_time_ms": 20711.456, "update_time_ms": 10.861, "load_time_ms": 6.137, "grad_time_ms": 11100.932, "learner": {"default_policy": {"vf_loss": 28.168302536010742, "cur_lr": 0.0005000000237487257, "total_loss": 28.16598129272461, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.802367091178894, "entropy": 1.3265721797943115, "kl": 0.006885933689773083, "policy_loss": -0.0024918385315686464}}, "num_steps_trained": 590976}, "node_ip": "10.138.0.2", "episodes_this_iter": 43, "episodes_total": 643, "pid": 1275, "episode_reward_min": -714.659969974807, "time_total_s": 466.27086782455444, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.17155337333679, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9378>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f92f0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f91e0>)"}}, "done": false, "timesteps_this_iter": 40852, "timesteps_since_restore": 591802, "date": "2019-05-30_01-44-58", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8156438104951484, "mean_env_wait_ms": 17.49086979743307, "mean_processing_ms": 6.545476091621584}, "training_iteration": 14, "timesteps_total": 591802, "episode_reward_mean": -499.5091697835134, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -233.56070796247337, "episode_len_mean": 323.93, "timestamp": 1559180698, "off_policy_estimator": {}, "time_since_restore": 466.27086782455444, "custom_metrics": {"cost1_mean": 183.18908427487116, "cost1_max": 215.23610767854353, "cost2_mean": -101.99633086207957, "cost2_max": -62.48385653680397, "system_level_velocity_max": 17.576806989882353, "cost2_min": -125.23326304621703, "system_level_velocity_min": 10.739417724342411, "system_level_velocity_mean": 15.128917069507454, "outflow_rate_mean": 1206.837595324949, "cost1_min": 127.86914946235403, "outflow_rate_min": 904.6733985381871, "outflow_rate_max": 1424.8188809546148}, "iterations_since_restore": 14}
{"info": {"num_steps_sampled": 632532, "sample_time_ms": 20756.151, "update_time_ms": 10.887, "load_time_ms": 6.202, "grad_time_ms": 11050.606, "learner": {"default_policy": {"vf_loss": 24.5661678314209, "cur_lr": 0.0005000000237487257, "total_loss": 24.563486099243164, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.810472309589386, "entropy": 1.3196462392807007, "kl": 0.008091461844742298, "policy_loss": -0.0028841132298111916}}, "num_steps_trained": 631680}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 683, "pid": 1275, "episode_reward_min": -724.0538834804056, "time_total_s": 497.03874945640564, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.767881631851196, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59cdf28>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bbd08>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9fd90>)"}}, "done": false, "timesteps_this_iter": 40730, "timesteps_since_restore": 632532, "date": "2019-05-30_01-45-29", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8164156409786472, "mean_env_wait_ms": 17.4880216144019, "mean_processing_ms": 6.51992060512392}, "training_iteration": 15, "timesteps_total": 632532, "episode_reward_mean": -490.6936290635052, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -233.56070796247337, "episode_len_mean": 323.93, "timestamp": 1559180729, "off_policy_estimator": {}, "time_since_restore": 497.03874945640564, "custom_metrics": {"cost1_mean": 182.95076104187595, "cost1_max": 215.23610767854353, "cost2_mean": -99.31906427852948, "cost2_max": -62.48385653680397, "system_level_velocity_max": 17.576806989882353, "cost2_min": -125.23326304621703, "system_level_velocity_min": 10.739417724342411, "system_level_velocity_mean": 15.10370717183567, "outflow_rate_mean": 1208.1467121764576, "cost1_min": 127.86914946235403, "outflow_rate_min": 904.6733985381871, "outflow_rate_max": 1424.8188809546148}, "iterations_since_restore": 15}
{"info": {"num_steps_sampled": 673244, "sample_time_ms": 20779.715, "update_time_ms": 10.811, "load_time_ms": 6.143, "grad_time_ms": 10998.396, "learner": {"default_policy": {"vf_loss": 24.01422691345215, "cur_lr": 0.0005000000237487257, "total_loss": 24.011754989624023, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.8222754001617432, "entropy": 1.3178784847259521, "kl": 0.010121562518179417, "policy_loss": -0.002725559286773205}}, "num_steps_trained": 672384}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 725, "pid": 1275, "episode_reward_min": -724.0538834804056, "time_total_s": 528.3166749477386, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.277925491333008, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007ea0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007b70>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab0078c8>)"}}, "done": false, "timesteps_this_iter": 40712, "timesteps_since_restore": 673244, "date": "2019-05-30_01-46-00", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.816244608812652, "mean_env_wait_ms": 17.470019354851242, "mean_processing_ms": 6.491794425047192}, "training_iteration": 16, "timesteps_total": 673244, "episode_reward_mean": -477.24028634025655, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -25.50716633802989, "episode_len_mean": 320.95, "timestamp": 1559180760, "off_policy_estimator": {}, "time_since_restore": 528.3166749477386, "custom_metrics": {"cost1_mean": 181.86794768629045, "cost1_max": 208.71896037790196, "cost2_mean": -95.26738575209322, "cost2_max": -20.19468988666403, "system_level_velocity_max": 17.427875934107504, "cost2_min": -115.68405826763329, "system_level_velocity_min": 10.739417724342411, "system_level_velocity_mean": 15.192399045901821, "outflow_rate_mean": 1203.903765907234, "cost1_min": 17.56441496414466, "outflow_rate_min": 437.2949997643919, "outflow_rate_max": 1347.7144787185077}, "iterations_since_restore": 16}
{"info": {"num_steps_sampled": 712325, "sample_time_ms": 20729.323, "update_time_ms": 10.621, "load_time_ms": 5.995, "grad_time_ms": 10953.22, "learner": {"default_policy": {"vf_loss": 27.474449157714844, "cur_lr": 0.0005000000237487257, "total_loss": 27.471343994140625, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.7980295419692993, "entropy": 1.3139007091522217, "kl": 0.01141655445098877, "policy_loss": -0.0033881105482578278}}, "num_steps_trained": 711424}, "node_ip": "10.138.0.2", "episodes_this_iter": 60, "episodes_total": 785, "pid": 1275, "episode_reward_min": -733.4611799520461, "time_total_s": 559.4946758747101, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.178000926971436, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9378>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9400>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9e18>)"}}, "done": false, "timesteps_this_iter": 39081, "timesteps_since_restore": 712325, "date": "2019-05-30_01-46-31", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8129050473183559, "mean_env_wait_ms": 17.380227066035523, "mean_processing_ms": 6.527655567816916}, "training_iteration": 17, "timesteps_total": 712325, "episode_reward_mean": -448.525156824446, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -24.283233465501922, "episode_len_mean": 319.04, "timestamp": 1559180791, "off_policy_estimator": {}, "time_since_restore": 559.4946758747101, "custom_metrics": {"cost1_mean": 183.88955939822466, "cost1_max": 208.69650929428138, "cost2_mean": -90.66708239367368, "cost2_max": -18.911641407021957, "system_level_velocity_max": 17.621776292943217, "cost2_min": -115.68405826763329, "system_level_velocity_min": 11.907790742641923, "system_level_velocity_mean": 15.509994902127607, "outflow_rate_mean": 1217.6002276215188, "cost1_min": 17.56441496414466, "outflow_rate_min": 437.2949997643919, "outflow_rate_max": 1350.631233686002}, "iterations_since_restore": 17}
{"info": {"num_steps_sampled": 752141, "sample_time_ms": 20684.163, "update_time_ms": 10.53, "load_time_ms": 5.98, "grad_time_ms": 10886.189, "learner": {"default_policy": {"vf_loss": 20.644245147705078, "cur_lr": 0.0005000000237487257, "total_loss": 20.64065933227539, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8393270969390869, "entropy": 1.2946192026138306, "kl": 0.010444365441799164, "policy_loss": -0.003845682367682457}}, "num_steps_trained": 751232}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 825, "pid": 1275, "episode_reward_min": -733.4611799520461, "time_total_s": 588.8933882713318, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.398712396621704, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f97b8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f96a8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f9620>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f9730>)"}}, "done": false, "timesteps_this_iter": 39816, "timesteps_since_restore": 752141, "date": "2019-05-30_01-47-01", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8142273351013927, "mean_env_wait_ms": 17.34716160892555, "mean_processing_ms": 6.549383558659775}, "training_iteration": 18, "timesteps_total": 752141, "episode_reward_mean": -452.9899589777201, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -24.283233465501922, "episode_len_mean": 322.02, "timestamp": 1559180821, "off_policy_estimator": {}, "time_since_restore": 588.8933882713318, "custom_metrics": {"cost1_mean": 184.63624773579355, "cost1_max": 206.36040213113978, "cost2_mean": -89.68648648060709, "cost2_max": -18.911641407021957, "system_level_velocity_max": 17.621776292943217, "cost2_min": -115.28770062903052, "system_level_velocity_min": 11.641866734289302, "system_level_velocity_mean": 15.45038845482979, "outflow_rate_mean": 1223.6297168597746, "cost1_min": 17.879467097360944, "outflow_rate_min": 470.30216034021953, "outflow_rate_max": 1350.631233686002}, "iterations_since_restore": 18}
{"info": {"num_steps_sampled": 792000, "sample_time_ms": 20738.029, "update_time_ms": 10.458, "load_time_ms": 5.725, "grad_time_ms": 11086.975, "learner": {"default_policy": {"vf_loss": 23.156068801879883, "cur_lr": 0.0005000000237487257, "total_loss": 23.15354347229004, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8230316638946533, "entropy": 1.2802159786224365, "kl": 0.009692844934761524, "policy_loss": -0.0027679833583533764}}, "num_steps_trained": 791040}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 866, "pid": 1275, "episode_reward_min": -636.1875237227681, "time_total_s": 622.4298369884491, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.53644871711731, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9840>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9950>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f98c8>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f99d8>)"}}, "done": false, "timesteps_this_iter": 39859, "timesteps_since_restore": 792000, "date": "2019-05-30_01-47-35", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8141016941446066, "mean_env_wait_ms": 17.355407230431677, "mean_processing_ms": 6.525072083528414}, "training_iteration": 19, "timesteps_total": 792000, "episode_reward_mean": -460.32252512125507, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -347.29384823184733, "episode_len_mean": 325.0, "timestamp": 1559180855, "off_policy_estimator": {}, "time_since_restore": 622.4298369884491, "custom_metrics": {"cost1_mean": 185.60654893812807, "cost1_max": 208.19476818360147, "cost2_mean": -91.93262226186327, "cost2_max": -63.246347045494936, "system_level_velocity_max": 17.467057507331642, "cost2_min": -116.0383441110682, "system_level_velocity_min": 11.641866734289302, "system_level_velocity_mean": 15.376378060868545, "outflow_rate_mean": 1231.2842474240392, "cost1_min": 141.3842923388733, "outflow_rate_min": 986.0201948533307, "outflow_rate_max": 1366.8961667608912}, "iterations_since_restore": 19}
{"info": {"num_steps_sampled": 832467, "sample_time_ms": 20704.138, "update_time_ms": 10.787, "load_time_ms": 5.79, "grad_time_ms": 11035.929, "learner": {"default_policy": {"vf_loss": 30.433019638061523, "cur_lr": 0.0005000000237487257, "total_loss": 30.430742263793945, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7799381017684937, "entropy": 1.2731547355651855, "kl": 0.009783877991139889, "policy_loss": -0.002520819893106818}}, "num_steps_trained": 831488}, "node_ip": "10.138.0.2", "episodes_this_iter": 59, "episodes_total": 925, "pid": 1275, "episode_reward_min": -717.838324860963, "time_total_s": 654.8748619556427, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.4450249671936, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75aaf9f268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87ba268>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87ba378>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9fd90>)"}}, "done": false, "timesteps_this_iter": 40467, "timesteps_since_restore": 832467, "date": "2019-05-30_01-48-07", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8191542768759985, "mean_env_wait_ms": 17.342151852607344, "mean_processing_ms": 6.5447028662332745}, "training_iteration": 20, "timesteps_total": 832467, "episode_reward_mean": -466.5609415243055, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -347.29384823184733, "episode_len_mean": 325.0, "timestamp": 1559180887, "off_policy_estimator": {}, "time_since_restore": 654.8748619556427, "custom_metrics": {"cost1_mean": 185.63693145534347, "cost1_max": 209.49957001972447, "cost2_mean": -95.14149978257203, "cost2_max": -68.3898403748938, "system_level_velocity_max": 17.51422384148331, "cost2_min": -116.0383441110682, "system_level_velocity_min": 11.546624900063087, "system_level_velocity_mean": 15.376693540449578, "outflow_rate_mean": 1231.8808348283744, "cost1_min": 141.37464357323913, "outflow_rate_min": 998.2256436539035, "outflow_rate_max": 1366.8961667608912}, "iterations_since_restore": 20}
{"info": {"num_steps_sampled": 872596, "sample_time_ms": 20791.152, "update_time_ms": 11.043, "load_time_ms": 5.72, "grad_time_ms": 10910.675, "learner": {"default_policy": {"vf_loss": 19.682758331298828, "cur_lr": 0.0005000000237487257, "total_loss": 19.680208206176758, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.849450945854187, "entropy": 1.2649461030960083, "kl": 0.009206206537783146, "policy_loss": -0.002780256327241659}}, "num_steps_trained": 871552}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 966, "pid": 1275, "episode_reward_min": -717.838324860963, "time_total_s": 686.3357615470886, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.460899591445923, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9598>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9488>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab007b70>)"}}, "done": false, "timesteps_this_iter": 40129, "timesteps_since_restore": 872596, "date": "2019-05-30_01-48-39", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8196974173515637, "mean_env_wait_ms": 17.33365803196197, "mean_processing_ms": 6.5665099882044835}, "training_iteration": 21, "timesteps_total": 872596, "episode_reward_mean": -471.4118684864667, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -23.677265360932886, "episode_len_mean": 322.02, "timestamp": 1559180919, "off_policy_estimator": {}, "time_since_restore": 686.3357615470886, "custom_metrics": {"cost1_mean": 182.30099553853483, "cost1_max": 209.49957001972447, "cost2_mean": -94.14588088621217, "cost2_max": -18.332781141030505, "system_level_velocity_max": 17.705637619852425, "cost2_min": -117.92461148029459, "system_level_velocity_min": 11.546624900063087, "system_level_velocity_mean": 15.24911680160072, "outflow_rate_mean": 1218.9024313370362, "cost1_min": 17.787234361515722, "outflow_rate_min": 493.8123238995481, "outflow_rate_max": 1357.5559052250426}, "iterations_since_restore": 21}
{"info": {"num_steps_sampled": 913662, "sample_time_ms": 20767.34, "update_time_ms": 11.01, "load_time_ms": 5.763, "grad_time_ms": 10799.959, "learner": {"default_policy": {"vf_loss": 22.98822021484375, "cur_lr": 0.0005000000237487257, "total_loss": 22.98576545715332, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.830853283405304, "entropy": 1.2693802118301392, "kl": 0.009102456271648407, "policy_loss": -0.00268380343914032}}, "num_steps_trained": 912512}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 1006, "pid": 1275, "episode_reward_min": -727.3961871987959, "time_total_s": 717.6175148487091, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.281753301620483, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9048>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9378>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9400>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9ae8>)"}}, "done": false, "timesteps_this_iter": 41066, "timesteps_since_restore": 913662, "date": "2019-05-30_01-49-10", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.819522224793705, "mean_env_wait_ms": 17.352385132071888, "mean_processing_ms": 6.550379890035654}, "training_iteration": 22, "timesteps_total": 913662, "episode_reward_mean": -468.4986424519138, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -23.677265360932886, "episode_len_mean": 322.02, "timestamp": 1559180950, "off_policy_estimator": {}, "time_since_restore": 717.6175148487091, "custom_metrics": {"cost1_mean": 182.6381816943798, "cost1_max": 207.45326823100697, "cost2_mean": -93.62209760971295, "cost2_max": -18.332781141030505, "system_level_velocity_max": 17.705637619852425, "cost2_min": -117.92461148029459, "system_level_velocity_min": 11.56536883745715, "system_level_velocity_mean": 15.266134628007583, "outflow_rate_mean": 1223.1967852515115, "cost1_min": 17.787234361515722, "outflow_rate_min": 493.8123238995481, "outflow_rate_max": 1357.5559052250426}, "iterations_since_restore": 22}
{"info": {"num_steps_sampled": 955623, "sample_time_ms": 20805.051, "update_time_ms": 10.917, "load_time_ms": 5.625, "grad_time_ms": 10774.882, "learner": {"default_policy": {"vf_loss": 29.98772621154785, "cur_lr": 0.0005000000237487257, "total_loss": 29.9852294921875, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7985935211181641, "entropy": 1.27189040184021, "kl": 0.009023921564221382, "policy_loss": -0.002722387434914708}}, "num_steps_trained": 954368}, "node_ip": "10.138.0.2", "episodes_this_iter": 56, "episodes_total": 1062, "pid": 1275, "episode_reward_min": -727.3961871987959, "time_total_s": 751.013965845108, "num_metric_batches_dropped": 0, "time_this_iter_s": 33.396450996398926, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59f9378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9268>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f91e0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a59f92f0>)"}}, "done": false, "timesteps_this_iter": 41961, "timesteps_since_restore": 955623, "date": "2019-05-30_01-49-43", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.827684351901583, "mean_env_wait_ms": 17.398364944140955, "mean_processing_ms": 6.566101885429742}, "training_iteration": 23, "timesteps_total": 955623, "episode_reward_mean": -481.17749566939597, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -24.961468677342506, "episode_len_mean": 320.77, "timestamp": 1559180983, "off_policy_estimator": {}, "time_since_restore": 751.013965845108, "custom_metrics": {"cost1_mean": 181.828688048969, "cost1_max": 210.28444603570517, "cost2_mean": -98.17256116267352, "cost2_max": -20.45393387999621, "system_level_velocity_max": 17.574755128716028, "cost2_min": -117.6457984455854, "system_level_velocity_min": 11.235518740136206, "system_level_velocity_mean": 15.252716410116095, "outflow_rate_mean": 1216.3823378817358, "cost1_min": 17.785889771168627, "outflow_rate_min": 440.0050268646629, "outflow_rate_max": 1363.1045719191795}, "iterations_since_restore": 23}
{"info": {"num_steps_sampled": 996170, "sample_time_ms": 20754.631, "update_time_ms": 10.99, "load_time_ms": 5.746, "grad_time_ms": 10789.717, "learner": {"default_policy": {"vf_loss": 22.036653518676758, "cur_lr": 0.0005000000237487257, "total_loss": 22.035371780395508, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.840138852596283, "entropy": 1.2527811527252197, "kl": 0.00913175754249096, "policy_loss": -0.0015063441824167967}}, "num_steps_trained": 994816}, "node_ip": "10.138.0.2", "episodes_this_iter": 45, "episodes_total": 1107, "pid": 1275, "episode_reward_min": -709.8736667775537, "time_total_s": 782.8034422397614, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.78947639465332, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59910d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59f9f28>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a59f9ea0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a5991048>)"}}, "done": false, "timesteps_this_iter": 40547, "timesteps_since_restore": 996170, "date": "2019-05-30_01-50-15", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8313742400564699, "mean_env_wait_ms": 17.428214350653274, "mean_processing_ms": 6.6026006445367935}, "training_iteration": 24, "timesteps_total": 996170, "episode_reward_mean": -487.2887513340294, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -24.961468677342506, "episode_len_mean": 320.77, "timestamp": 1559181015, "off_policy_estimator": {}, "time_since_restore": 782.8034422397614, "custom_metrics": {"cost1_mean": 181.9588800727205, "cost1_max": 210.28444603570517, "cost2_mean": -99.81024708067034, "cost2_max": -20.45393387999621, "system_level_velocity_max": 17.59413799903175, "cost2_min": -117.6457984455854, "system_level_velocity_min": 11.235518740136206, "system_level_velocity_mean": 15.267455514148331, "outflow_rate_mean": 1215.225942045786, "cost1_min": 17.785889771168627, "outflow_rate_min": 440.0050268646629, "outflow_rate_max": 1373.331872119815}, "iterations_since_restore": 24}
{"info": {"num_steps_sampled": 1037746, "sample_time_ms": 20807.743, "update_time_ms": 10.81, "load_time_ms": 5.618, "grad_time_ms": 10766.264, "learner": {"default_policy": {"vf_loss": 22.018587112426758, "cur_lr": 0.0005000000237487257, "total_loss": 22.015398025512695, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8403807282447815, "entropy": 1.2409611940383911, "kl": 0.011073436588048935, "policy_loss": -0.00346489530056715}}, "num_steps_trained": 1036288}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 1147, "pid": 1275, "episode_reward_min": -712.186373590866, "time_total_s": 813.8635756969452, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.060133457183838, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bbd90>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb510>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bbf28>)"}}, "done": false, "timesteps_this_iter": 41576, "timesteps_since_restore": 1037746, "date": "2019-05-30_01-50-46", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8309568042021518, "mean_env_wait_ms": 17.432593568352527, "mean_processing_ms": 6.5931473585114295}, "training_iteration": 25, "timesteps_total": 1037746, "episode_reward_mean": -488.9632198055767, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -226.31806061099815, "episode_len_mean": 323.93, "timestamp": 1559181046, "off_policy_estimator": {}, "time_since_restore": 813.8635756969452, "custom_metrics": {"cost1_mean": 183.48065952814298, "cost1_max": 210.72568392549942, "cost2_mean": -98.42862420772292, "cost2_max": -73.5749777457001, "system_level_velocity_max": 17.65043511057873, "cost2_min": -114.78721703815795, "system_level_velocity_min": 11.551643095059632, "system_level_velocity_mean": 15.230967482337642, "outflow_rate_mean": 1222.1133905000156, "cost1_min": 139.19494653803778, "outflow_rate_min": 967.9001646898843, "outflow_rate_max": 1373.331872119815}, "iterations_since_restore": 25}
{"info": {"num_steps_sampled": 1079240, "sample_time_ms": 20909.946, "update_time_ms": 10.359, "load_time_ms": 5.647, "grad_time_ms": 10697.876, "learner": {"default_policy": {"vf_loss": 26.1501407623291, "cur_lr": 0.0005000000237487257, "total_loss": 26.14861297607422, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8101131319999695, "entropy": 1.2205586433410645, "kl": 0.008416475728154182, "policy_loss": -0.0017393010202795267}}, "num_steps_trained": 1077760}, "node_ip": "10.138.0.2", "episodes_this_iter": 55, "episodes_total": 1202, "pid": 1275, "episode_reward_min": -760.0901999911081, "time_total_s": 845.4721050262451, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.608529329299927, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9ae8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9048>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9268>)"}}, "done": false, "timesteps_this_iter": 41494, "timesteps_since_restore": 1079240, "date": "2019-05-30_01-51-18", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8313153932351975, "mean_env_wait_ms": 17.430610345542654, "mean_processing_ms": 6.58761587036498}, "training_iteration": 26, "timesteps_total": 1079240, "episode_reward_mean": -500.1635397618965, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -353.57951680123085, "episode_len_mean": 325.0, "timestamp": 1559181078, "off_policy_estimator": {}, "time_since_restore": 845.4721050262451, "custom_metrics": {"cost1_mean": 180.88038339103917, "cost1_max": 210.72568392549942, "cost2_mean": -96.75357903448861, "cost2_max": -75.32486369951955, "system_level_velocity_max": 17.65043511057873, "cost2_min": -111.93120879211527, "system_level_velocity_min": 11.259242541262472, "system_level_velocity_mean": 14.943070310259625, "outflow_rate_mean": 1211.89813314664, "cost1_min": 134.24808500872507, "outflow_rate_min": 967.9001646898843, "outflow_rate_max": 1357.2185594589741}, "iterations_since_restore": 26}
{"info": {"num_steps_sampled": 1119066, "sample_time_ms": 20984.969, "update_time_ms": 10.246, "load_time_ms": 5.86, "grad_time_ms": 10684.965, "learner": {"default_policy": {"vf_loss": 21.26001739501953, "cur_lr": 0.0005000000237487257, "total_loss": 21.258848190307617, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8455278873443604, "entropy": 1.2049119472503662, "kl": 0.008749427273869514, "policy_loss": -0.001388311036862433}}, "num_steps_trained": 1117568}, "node_ip": "10.138.0.2", "episodes_this_iter": 45, "episodes_total": 1247, "pid": 1275, "episode_reward_min": -760.0901999911081, "time_total_s": 877.2742321491241, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.80212712287903, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a91e0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9ea0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9e18>)"}}, "done": false, "timesteps_this_iter": 39826, "timesteps_since_restore": 1119066, "date": "2019-05-30_01-51-50", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8336650343232148, "mean_env_wait_ms": 17.445789587812772, "mean_processing_ms": 6.610821417509057}, "training_iteration": 27, "timesteps_total": 1119066, "episode_reward_mean": -489.6623462653113, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -347.2438116361261, "episode_len_mean": 324.8, "timestamp": 1559181110, "off_policy_estimator": {}, "time_since_restore": 877.2742321491241, "custom_metrics": {"cost1_mean": 180.99117328584038, "cost1_max": 206.49620842127743, "cost2_mean": -94.5119495751577, "cost2_max": -81.90244994032432, "system_level_velocity_max": 17.351346288260284, "cost2_min": -111.93120879211527, "system_level_velocity_min": 11.259242541262472, "system_level_velocity_mean": 14.980461111173318, "outflow_rate_mean": 1215.7683738808164, "cost1_min": 134.24808500872507, "outflow_rate_min": 973.5244480519482, "outflow_rate_max": 1355.5962528431012}, "iterations_since_restore": 27}
{"info": {"num_steps_sampled": 1158884, "sample_time_ms": 20944.339, "update_time_ms": 10.221, "load_time_ms": 5.736, "grad_time_ms": 10814.343, "learner": {"default_policy": {"vf_loss": 19.149477005004883, "cur_lr": 0.0005000000237487257, "total_loss": 19.147537231445312, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8527635931968689, "entropy": 1.1961711645126343, "kl": 0.010320963338017464, "policy_loss": -0.002197493799030781}}, "num_steps_trained": 1157376}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 1287, "pid": 1275, "episode_reward_min": -707.35500175212, "time_total_s": 907.564380645752, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.290148496627808, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb6a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bbae8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb488>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb620>)"}}, "done": false, "timesteps_this_iter": 39818, "timesteps_since_restore": 1158884, "date": "2019-05-30_01-52-20", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8340493130990811, "mean_env_wait_ms": 17.44830856527186, "mean_processing_ms": 6.6048637150254335}, "training_iteration": 28, "timesteps_total": 1158884, "episode_reward_mean": -471.3893207269079, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -347.2438116361261, "episode_len_mean": 324.8, "timestamp": 1559181140, "off_policy_estimator": {}, "time_since_restore": 907.564380645752, "custom_metrics": {"cost1_mean": 183.90897165020613, "cost1_max": 205.40907347009573, "cost2_mean": -93.05474319391051, "cost2_max": -72.49279388325405, "system_level_velocity_max": 17.346556180333863, "cost2_min": -111.93120879211527, "system_level_velocity_min": 11.497728050015485, "system_level_velocity_mean": 15.257765035645944, "outflow_rate_mean": 1227.6166637431813, "cost1_min": 137.81499948566756, "outflow_rate_min": 990.9145860389611, "outflow_rate_max": 1353.365994687131}, "iterations_since_restore": 28}
{"info": {"num_steps_sampled": 1199538, "sample_time_ms": 20863.582, "update_time_ms": 10.012, "load_time_ms": 5.991, "grad_time_ms": 10697.054, "learner": {"default_policy": {"vf_loss": 21.829051971435547, "cur_lr": 0.0005000000237487257, "total_loss": 21.8278751373291, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8387942314147949, "entropy": 1.1721384525299072, "kl": 0.011957162991166115, "policy_loss": -0.0014756429009139538}}, "num_steps_trained": 1197952}, "node_ip": "10.138.0.2", "episodes_this_iter": 43, "episodes_total": 1330, "pid": 1275, "episode_reward_min": -693.5323681605378, "time_total_s": 939.1169559955597, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.55257534980774, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a598ebf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a598eae8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a598ea60>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a598eb70>)"}}, "done": false, "timesteps_this_iter": 40654, "timesteps_since_restore": 1199538, "date": "2019-05-30_01-52-52", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8310293487373468, "mean_env_wait_ms": 17.414947889800118, "mean_processing_ms": 6.581060500445429}, "training_iteration": 29, "timesteps_total": 1199538, "episode_reward_mean": -462.4658299528956, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -24.190988835413073, "episode_len_mean": 321.82, "timestamp": 1559181172, "off_policy_estimator": {}, "time_since_restore": 939.1169559955597, "custom_metrics": {"cost1_mean": 182.3960965140589, "cost1_max": 205.40907347009573, "cost2_mean": -91.30754331377474, "cost2_max": -17.721539267011288, "system_level_velocity_max": 17.53180493691909, "cost2_min": -104.73335987301446, "system_level_velocity_min": 11.73188344103207, "system_level_velocity_mean": 15.286712942419319, "outflow_rate_mean": 1224.751872717267, "cost1_min": 17.632515886140705, "outflow_rate_min": 489.92492200470633, "outflow_rate_max": 1353.365994687131}, "iterations_since_restore": 29}
{"info": {"num_steps_sampled": 1239863, "sample_time_ms": 20817.032, "update_time_ms": 9.697, "load_time_ms": 5.972, "grad_time_ms": 10652.22, "learner": {"default_policy": {"vf_loss": 21.66262435913086, "cur_lr": 0.0005000000237487257, "total_loss": 21.66120147705078, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8285099267959595, "entropy": 1.1380079984664917, "kl": 0.011249716393649578, "policy_loss": -0.0017054425552487373}}, "num_steps_trained": 1238272}, "node_ip": "10.138.0.2", "episodes_this_iter": 58, "episodes_total": 1388, "pid": 1275, "episode_reward_min": -722.7826451634954, "time_total_s": 970.6043884754181, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.4874324798584, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb488>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a598e0d0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a598e048>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a598e158>)"}}, "done": false, "timesteps_this_iter": 40325, "timesteps_since_restore": 1239863, "date": "2019-05-30_01-53-23", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8270969352996713, "mean_env_wait_ms": 17.367363094966993, "mean_processing_ms": 6.589097127935538}, "training_iteration": 30, "timesteps_total": 1239863, "episode_reward_mean": -472.8191458738025, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -24.190988835413073, "episode_len_mean": 322.02, "timestamp": 1559181203, "off_policy_estimator": {}, "time_since_restore": 970.6043884754181, "custom_metrics": {"cost1_mean": 180.15341563492453, "cost1_max": 203.50761197681993, "cost2_mean": -92.33015049111016, "cost2_max": -17.721539267011288, "system_level_velocity_max": 17.53180493691909, "cost2_min": -108.14612654400088, "system_level_velocity_min": 11.250731776930465, "system_level_velocity_mean": 15.061434925178219, "outflow_rate_mean": 1218.4442748372146, "cost1_min": 17.632515886140705, "outflow_rate_min": 489.92492200470633, "outflow_rate_max": 1342.1545919686694}, "iterations_since_restore": 30}
{"info": {"num_steps_sampled": 1280058, "sample_time_ms": 20595.212, "update_time_ms": 9.518, "load_time_ms": 6.003, "grad_time_ms": 10733.897, "learner": {"default_policy": {"vf_loss": 18.73642349243164, "cur_lr": 0.0005000000237487257, "total_loss": 18.735435485839844, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8454984426498413, "entropy": 1.1234866380691528, "kl": 0.009267650544643402, "policy_loss": -0.0012202151119709015}}, "num_steps_trained": 1278464}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 1428, "pid": 1275, "episode_reward_min": -722.7826451634954, "time_total_s": 1000.6608295440674, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.056441068649292, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9488>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9e18>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9d08>)"}}, "done": false, "timesteps_this_iter": 40195, "timesteps_since_restore": 1280058, "date": "2019-05-30_01-53-53", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.825631396587773, "mean_env_wait_ms": 17.345380178121435, "mean_processing_ms": 6.592637656308835}, "training_iteration": 31, "timesteps_total": 1280058, "episode_reward_mean": -472.95297732300355, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -353.68820530396977, "episode_len_mean": 324.8, "timestamp": 1559181233, "off_policy_estimator": {}, "time_since_restore": 1000.6608295440674, "custom_metrics": {"cost1_mean": 183.019991255699, "cost1_max": 203.50761197681993, "cost2_mean": -94.91995621794591, "cost2_max": -83.49043264407516, "system_level_velocity_max": 17.14426411637723, "cost2_min": -108.14612654400088, "system_level_velocity_min": 11.250731776930465, "system_level_velocity_mean": 15.170179935037346, "outflow_rate_mean": 1233.9866015387502, "cost1_min": 136.8362549206318, "outflow_rate_min": 981.8945514950165, "outflow_rate_max": 1342.1545919686694}, "iterations_since_restore": 31}
{"info": {"num_steps_sampled": 1321329, "sample_time_ms": 20464.814, "update_time_ms": 9.451, "load_time_ms": 6.169, "grad_time_ms": 10938.956, "learner": {"default_policy": {"vf_loss": 18.767913818359375, "cur_lr": 0.0005000000237487257, "total_loss": 18.766281127929688, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8495274186134338, "entropy": 1.115256905555725, "kl": 0.009655022993683815, "policy_loss": -0.0018748791189864278}}, "num_steps_trained": 1319680}, "node_ip": "10.138.0.2", "episodes_this_iter": 42, "episodes_total": 1470, "pid": 1275, "episode_reward_min": -661.2958803335189, "time_total_s": 1032.7196912765503, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.05886173248291, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9a60>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a9048>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9598>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9ae8>)"}}, "done": false, "timesteps_this_iter": 41271, "timesteps_since_restore": 1321329, "date": "2019-05-30_01-54-25", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8203808542431796, "mean_env_wait_ms": 17.320327203319817, "mean_processing_ms": 6.5809753144397725}, "training_iteration": 32, "timesteps_total": 1321329, "episode_reward_mean": -472.33416585799745, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -353.68820530396977, "episode_len_mean": 324.8, "timestamp": 1559181265, "off_policy_estimator": {}, "time_since_restore": 1032.7196912765503, "custom_metrics": {"cost1_mean": 183.18653397039193, "cost1_max": 203.27681248106802, "cost2_mean": -94.54191239239624, "cost2_max": -74.33768356614914, "system_level_velocity_max": 17.138384621996863, "cost2_min": -104.59132599119297, "system_level_velocity_min": 11.646362495544485, "system_level_velocity_mean": 15.202501224488065, "outflow_rate_mean": 1235.0904680384938, "cost1_min": 141.70148311155464, "outflow_rate_min": 1003.7633797509826, "outflow_rate_max": 1342.990660984515}, "iterations_since_restore": 32}
{"info": {"num_steps_sampled": 1362192, "sample_time_ms": 20222.888, "update_time_ms": 9.537, "load_time_ms": 6.121, "grad_time_ms": 11098.082, "learner": {"default_policy": {"vf_loss": 23.025644302368164, "cur_lr": 0.0005000000237487257, "total_loss": 23.024641036987305, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8242900371551514, "entropy": 1.1053088903427124, "kl": 0.009362566284835339, "policy_loss": -0.0012402590364217758}}, "num_steps_trained": 1360512}, "node_ip": "10.138.0.2", "episodes_this_iter": 59, "episodes_total": 1529, "pid": 1275, "episode_reward_min": -689.1569103921554, "time_total_s": 1065.309412240982, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.58972096443176, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bbbf8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bb950>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bbc80>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bbd08>)"}}, "done": false, "timesteps_this_iter": 40863, "timesteps_since_restore": 1362192, "date": "2019-05-30_01-54-58", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8163982298655776, "mean_env_wait_ms": 17.276937561982386, "mean_processing_ms": 6.5870919144642786}, "training_iteration": 33, "timesteps_total": 1362192, "episode_reward_mean": -484.0217917802223, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -24.41039842553659, "episode_len_mean": 320.92, "timestamp": 1559181298, "off_policy_estimator": {}, "time_since_restore": 1065.309412240982, "custom_metrics": {"cost1_mean": 176.87405801300426, "cost1_max": 201.22096616828637, "cost2_mean": -94.24160409701831, "cost2_max": -16.70716545908696, "system_level_velocity_max": 17.569765417075562, "cost2_min": -105.82145313742706, "system_level_velocity_min": 10.31655480734274, "system_level_velocity_mean": 14.854639682227468, "outflow_rate_mean": 1208.5281492809522, "cost1_min": 17.733843059035017, "outflow_rate_min": 485.8629864444024, "outflow_rate_max": 1342.990660984515}, "iterations_since_restore": 33}
{"info": {"num_steps_sampled": 1402869, "sample_time_ms": 19959.632, "update_time_ms": 9.442, "load_time_ms": 6.382, "grad_time_ms": 11126.08, "learner": {"default_policy": {"vf_loss": 15.307531356811523, "cur_lr": 0.0005000000237487257, "total_loss": 15.30601692199707, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8809679746627808, "entropy": 1.0877741575241089, "kl": 0.012225202284753323, "policy_loss": -0.0018188338726758957}}, "num_steps_trained": 1401088}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 1570, "pid": 1275, "episode_reward_min": -689.1569103921554, "time_total_s": 1094.756388425827, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.44697618484497, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a598e268>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a598e488>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a598e400>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a598e2f0>)"}}, "done": false, "timesteps_this_iter": 40677, "timesteps_since_restore": 1402869, "date": "2019-05-30_01-55-27", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8127064302385838, "mean_env_wait_ms": 17.24539307533683, "mean_processing_ms": 6.593303538581484}, "training_iteration": 34, "timesteps_total": 1402869, "episode_reward_mean": -480.89295540533493, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -23.275444915453516, "episode_len_mean": 317.94, "timestamp": 1559181327, "off_policy_estimator": {}, "time_since_restore": 1094.756388425827, "custom_metrics": {"cost1_mean": 175.02611853632828, "cost1_max": 198.39562022437207, "cost2_mean": -95.33431468805526, "cost2_max": -16.70716545908696, "system_level_velocity_max": 18.898750784346998, "cost2_min": -109.48408993165664, "system_level_velocity_min": 10.31655480734274, "system_level_velocity_mean": 14.875890668491753, "outflow_rate_mean": 1203.6090604458968, "cost1_min": 17.733843059035017, "outflow_rate_min": 485.8629864444024, "outflow_rate_max": 1334.0668585536187}, "iterations_since_restore": 34}
{"info": {"num_steps_sampled": 1443852, "sample_time_ms": 20093.29, "update_time_ms": 9.391, "load_time_ms": 6.41, "grad_time_ms": 11168.357, "learner": {"default_policy": {"vf_loss": 17.375125885009766, "cur_lr": 0.0005000000237487257, "total_loss": 17.372909545898438, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8639863729476929, "entropy": 1.081024169921875, "kl": 0.01232802402228117, "policy_loss": -0.0025266825687140226}}, "num_steps_trained": 1442048}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 1611, "pid": 1275, "episode_reward_min": -689.1569103921554, "time_total_s": 1127.59641456604, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.84002614021301, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb950>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87ba268>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87ba378>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bbc80>)"}}, "done": false, "timesteps_this_iter": 40983, "timesteps_since_restore": 1443852, "date": "2019-05-30_01-56-00", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.809447198975376, "mean_env_wait_ms": 17.240328320705416, "mean_processing_ms": 6.579790553321891}, "training_iteration": 35, "timesteps_total": 1443852, "episode_reward_mean": -489.6850108386759, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -23.275444915453516, "episode_len_mean": 322.02, "timestamp": 1559181360, "off_policy_estimator": {}, "time_since_restore": 1127.59641456604, "custom_metrics": {"cost1_mean": 177.41024885055253, "cost1_max": 198.2166651223714, "cost2_mean": -97.60762899729929, "cost2_max": -18.06401323080875, "system_level_velocity_max": 18.898750784346998, "cost2_min": -109.48408993165664, "system_level_velocity_min": 10.31655480734274, "system_level_velocity_mean": 14.857606829864926, "outflow_rate_mean": 1213.9931968206718, "cost1_min": 17.782080941073943, "outflow_rate_min": 496.0238329292389, "outflow_rate_max": 1334.0668585536187}, "iterations_since_restore": 35}
{"info": {"num_steps_sampled": 1484476, "sample_time_ms": 19996.379, "update_time_ms": 9.675, "load_time_ms": 6.285, "grad_time_ms": 11358.466, "learner": {"default_policy": {"vf_loss": 20.810617446899414, "cur_lr": 0.0005000000237487257, "total_loss": 20.809053421020508, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8332876563072205, "entropy": 1.0638072490692139, "kl": 0.009743544273078442, "policy_loss": -0.0018062234157696366}}, "num_steps_trained": 1482624}, "node_ip": "10.138.0.2", "episodes_this_iter": 52, "episodes_total": 1663, "pid": 1275, "episode_reward_min": -629.1489326139308, "time_total_s": 1160.155851840973, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.55943727493286, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9400>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9f268>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9fd90>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9378>)"}}, "done": false, "timesteps_this_iter": 40624, "timesteps_since_restore": 1484476, "date": "2019-05-30_01-56-33", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8081506222684334, "mean_env_wait_ms": 17.22007130481744, "mean_processing_ms": 6.576979216505863}, "training_iteration": 36, "timesteps_total": 1484476, "episode_reward_mean": -472.8319575124653, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -225.7431756367291, "episode_len_mean": 323.82, "timestamp": 1559181393, "off_policy_estimator": {}, "time_since_restore": 1160.155851840973, "custom_metrics": {"cost1_mean": 182.97682563799296, "cost1_max": 200.5390378323395, "cost2_mean": -98.83388121266582, "cost2_max": -68.03162680706313, "system_level_velocity_max": 17.12412726686073, "cost2_min": -112.79267813094637, "system_level_velocity_min": 12.573622970352561, "system_level_velocity_mean": 15.249855290973318, "outflow_rate_mean": 1243.1855251221032, "cost1_min": 128.76184438303108, "outflow_rate_min": 1028.9931990743094, "outflow_rate_max": 1339.69397957193}, "iterations_since_restore": 36}
{"info": {"num_steps_sampled": 1524568, "sample_time_ms": 19816.251, "update_time_ms": 10.019, "load_time_ms": 5.911, "grad_time_ms": 11547.539, "learner": {"default_policy": {"vf_loss": 16.13641929626465, "cur_lr": 0.0005000000237487257, "total_loss": 16.134889602661133, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8747593760490417, "entropy": 1.060346245765686, "kl": 0.00868285819888115, "policy_loss": -0.0017461995594203472}}, "num_steps_trained": 1522688}, "node_ip": "10.138.0.2", "episodes_this_iter": 48, "episodes_total": 1711, "pid": 1275, "episode_reward_min": -628.1539876789798, "time_total_s": 1192.0405902862549, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.884738445281982, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59890d0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007d08>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007a60>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a5989048>)"}}, "done": false, "timesteps_this_iter": 40092, "timesteps_since_restore": 1524568, "date": "2019-05-30_01-57-05", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.806405457301873, "mean_env_wait_ms": 17.197972353103623, "mean_processing_ms": 6.587947127363286}, "training_iteration": 37, "timesteps_total": 1524568, "episode_reward_mean": -461.8610853949748, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -225.7431756367291, "episode_len_mean": 322.72, "timestamp": 1559181425, "off_policy_estimator": {}, "time_since_restore": 1192.0405902862549, "custom_metrics": {"cost1_mean": 184.8952309659807, "cost1_max": 200.5390378323395, "cost2_mean": -99.19313375996745, "cost2_max": -68.03162680706313, "system_level_velocity_max": 17.12412726686073, "cost2_min": -113.68284568095945, "system_level_velocity_min": 12.682675994415712, "system_level_velocity_mean": 15.486456043844585, "outflow_rate_mean": 1250.3854394635173, "cost1_min": 128.76184438303108, "outflow_rate_min": 1028.9931990743094, "outflow_rate_max": 1345.0519438816957}, "iterations_since_restore": 37}
{"info": {"num_steps_sampled": 1565131, "sample_time_ms": 19747.719, "update_time_ms": 10.204, "load_time_ms": 6.013, "grad_time_ms": 11559.802, "learner": {"default_policy": {"vf_loss": 17.28927230834961, "cur_lr": 0.0005000000237487257, "total_loss": 17.287120819091797, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8698749542236328, "entropy": 1.049750566482544, "kl": 0.009226420894265175, "policy_loss": -0.0023808435071259737}}, "num_steps_trained": 1563136}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 1751, "pid": 1275, "episode_reward_min": -630.3294754788772, "time_total_s": 1221.7554047107697, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.71481442451477, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59cdf28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9fea0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f0d0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f158>)"}}, "done": false, "timesteps_this_iter": 40563, "timesteps_since_restore": 1565131, "date": "2019-05-30_01-57-35", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.8038273827331295, "mean_env_wait_ms": 17.165301657342248, "mean_processing_ms": 6.58031489135386}, "training_iteration": 38, "timesteps_total": 1565131, "episode_reward_mean": -471.66102896640905, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -240.47998238827063, "episode_len_mean": 323.9, "timestamp": 1559181455, "off_policy_estimator": {}, "time_since_restore": 1221.7554047107697, "custom_metrics": {"cost1_mean": 184.94059031962533, "cost1_max": 205.2285610355337, "cost2_mean": -101.04136912505291, "cost2_max": -74.70951100019442, "system_level_velocity_max": 17.158947645833376, "cost2_min": -113.68284568095945, "system_level_velocity_min": 12.682675994415712, "system_level_velocity_mean": 15.390394022865895, "outflow_rate_mean": 1245.6457608990133, "cost1_min": 133.06265778121963, "outflow_rate_min": 1050.3202636466253, "outflow_rate_max": 1363.7025092764381}, "iterations_since_restore": 38}
{"info": {"num_steps_sampled": 1606138, "sample_time_ms": 19889.587, "update_time_ms": 10.172, "load_time_ms": 5.992, "grad_time_ms": 11476.691, "learner": {"default_policy": {"vf_loss": 23.755224227905273, "cur_lr": 0.0005000000237487257, "total_loss": 23.75419807434082, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8232685327529907, "entropy": 1.0400769710540771, "kl": 0.010454443283379078, "policy_loss": -0.0012872451916337013}}, "num_steps_trained": 1604096}, "node_ip": "10.138.0.2", "episodes_this_iter": 54, "episodes_total": 1805, "pid": 1275, "episode_reward_min": -669.6054678229597, "time_total_s": 1253.9308111667633, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.17540645599365, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a598e378>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a598ec80>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a598e730>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a598e7b8>)"}}, "done": false, "timesteps_this_iter": 41007, "timesteps_since_restore": 1606138, "date": "2019-05-30_01-58-07", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.7997443356804366, "mean_env_wait_ms": 17.144557789802434, "mean_processing_ms": 6.57093676952097}, "training_iteration": 39, "timesteps_total": 1606138, "episode_reward_mean": -459.21297086124855, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -24.181648871178517, "episode_len_mean": 321.85, "timestamp": 1559181487, "off_policy_estimator": {}, "time_since_restore": 1253.9308111667633, "custom_metrics": {"cost1_mean": 186.4062068778527, "cost1_max": 206.44122744479523, "cost2_mean": -101.37540987919232, "cost2_max": -18.491107736048072, "system_level_velocity_max": 18.217559220135424, "cost2_min": -116.99465222495515, "system_level_velocity_min": 12.36269876199292, "system_level_velocity_mean": 15.625786693273515, "outflow_rate_mean": 1250.9982841226615, "cost1_min": 18.558373724974903, "outflow_rate_min": 497.50056700217027, "outflow_rate_max": 1363.7025092764381}, "iterations_since_restore": 39}
{"info": {"num_steps_sampled": 1647193, "sample_time_ms": 19843.727, "update_time_ms": 10.55, "load_time_ms": 5.803, "grad_time_ms": 11625.306, "learner": {"default_policy": {"vf_loss": 20.990877151489258, "cur_lr": 0.0005000000237487257, "total_loss": 20.987552642822266, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8465264439582825, "entropy": 1.0372127294540405, "kl": 0.01142825186252594, "policy_loss": -0.003608841449022293}}, "num_steps_trained": 1645056}, "node_ip": "10.138.0.2", "episodes_this_iter": 47, "episodes_total": 1852, "pid": 1275, "episode_reward_min": -711.640195921476, "time_total_s": 1286.4645652770996, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.533754110336304, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bbd90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87ba268>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87ba378>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bbd08>)"}}, "done": false, "timesteps_this_iter": 41055, "timesteps_since_restore": 1647193, "date": "2019-05-30_01-58-39", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.7993616986931915, "mean_env_wait_ms": 17.14686440594711, "mean_processing_ms": 6.583811798784966}, "training_iteration": 40, "timesteps_total": 1647193, "episode_reward_mean": -471.7922505173893, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -24.181648871178517, "episode_len_mean": 321.85, "timestamp": 1559181519, "off_policy_estimator": {}, "time_since_restore": 1286.4645652770996, "custom_metrics": {"cost1_mean": 184.71976611555863, "cost1_max": 209.17113265506063, "cost2_mean": -103.17004686728951, "cost2_max": -18.491107736048072, "system_level_velocity_max": 18.217559220135424, "cost2_min": -117.86158728588849, "system_level_velocity_min": 11.944349767134076, "system_level_velocity_mean": 15.448082003732011, "outflow_rate_mean": 1242.2124385361797, "cost1_min": 18.558373724974903, "outflow_rate_min": 497.50056700217027, "outflow_rate_max": 1374.965863552033}, "iterations_since_restore": 40}
{"info": {"num_steps_sampled": 1688680, "sample_time_ms": 19892.462, "update_time_ms": 10.494, "load_time_ms": 5.928, "grad_time_ms": 11736.145, "learner": {"default_policy": {"vf_loss": 20.086566925048828, "cur_lr": 0.0005000000237487257, "total_loss": 20.084653854370117, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8464938402175903, "entropy": 1.050854206085205, "kl": 0.013432332314550877, "policy_loss": -0.0022479163017123938}}, "num_steps_trained": 1686528}, "node_ip": "10.138.0.2", "episodes_this_iter": 40, "episodes_total": 1892, "pid": 1275, "episode_reward_min": -745.5949152421811, "time_total_s": 1318.1342849731445, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.669719696044922, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9ae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9fd90>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9ff28>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9598>)"}}, "done": false, "timesteps_this_iter": 41487, "timesteps_since_restore": 1688680, "date": "2019-05-30_01-59-11", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.7977493774892899, "mean_env_wait_ms": 17.133594886936315, "mean_processing_ms": 6.575775248473801}, "training_iteration": 41, "timesteps_total": 1688680, "episode_reward_mean": -488.13677512868765, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -337.82181947901404, "episode_len_mean": 324.82, "timestamp": 1559181551, "off_policy_estimator": {}, "time_since_restore": 1318.1342849731445, "custom_metrics": {"cost1_mean": 185.34519439553944, "cost1_max": 209.23808410452273, "cost2_mean": -106.57965584095618, "cost2_max": -92.96821548764133, "system_level_velocity_max": 17.64048962319072, "cost2_min": -119.21254222296685, "system_level_velocity_min": 11.944349767134076, "system_level_velocity_mean": 15.305785036451805, "outflow_rate_mean": 1245.1570672869207, "cost1_min": 144.7798429965032, "outflow_rate_min": 1031.5518044257658, "outflow_rate_max": 1382.6555893416196}, "iterations_since_restore": 41}
{"info": {"num_steps_sampled": 1731771, "sample_time_ms": 19931.435, "update_time_ms": 10.676, "load_time_ms": 5.91, "grad_time_ms": 11712.796, "learner": {"default_policy": {"vf_loss": 24.949073791503906, "cur_lr": 0.0005000000237487257, "total_loss": 24.94706153869629, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.814331591129303, "entropy": 1.0553518533706665, "kl": 0.012292010709643364, "policy_loss": -0.002318953163921833}}, "num_steps_trained": 1729536}, "node_ip": "10.138.0.2", "episodes_this_iter": 43, "episodes_total": 1935, "pid": 1275, "episode_reward_min": -774.7405788559553, "time_total_s": 1350.32919216156, "num_metric_batches_dropped": 0, "time_this_iter_s": 32.19490718841553, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab007ea0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75ab007a60>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75ab007f28>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab0078c8>)"}}, "done": false, "timesteps_this_iter": 43091, "timesteps_since_restore": 1731771, "date": "2019-05-30_01-59-43", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.7944829593696887, "mean_env_wait_ms": 17.12474611214354, "mean_processing_ms": 6.556228221414138}, "training_iteration": 42, "timesteps_total": 1731771, "episode_reward_mean": -506.03766793623305, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -343.7687353999205, "episode_len_mean": 325.0, "timestamp": 1559181583, "off_policy_estimator": {}, "time_since_restore": 1350.32919216156, "custom_metrics": {"cost1_mean": 183.95294674758813, "cost1_max": 209.23808410452273, "cost2_mean": -109.28331880082078, "cost2_max": -96.46271219307073, "system_level_velocity_max": 17.522713291395327, "cost2_min": -121.36336495326542, "system_level_velocity_min": 11.5433794162168, "system_level_velocity_mean": 15.164871042732916, "outflow_rate_mean": 1236.0172728440243, "cost1_min": 140.21531534932768, "outflow_rate_min": 1012.3604810063879, "outflow_rate_max": 1382.6555893416196}, "iterations_since_restore": 42}
{"info": {"num_steps_sampled": 1772454, "sample_time_ms": 19750.38, "update_time_ms": 10.548, "load_time_ms": 6.049, "grad_time_ms": 11747.111, "learner": {"default_policy": {"vf_loss": 24.534576416015625, "cur_lr": 0.0005000000237487257, "total_loss": 24.532550811767578, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8151146173477173, "entropy": 1.0309488773345947, "kl": 0.012465733103454113, "policy_loss": -0.002340365666896105}}, "num_steps_trained": 1770112}, "node_ip": "10.138.0.2", "episodes_this_iter": 56, "episodes_total": 1991, "pid": 1275, "episode_reward_min": -788.896666272316, "time_total_s": 1381.4393393993378, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.11014723777771, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a5991510>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a5991378>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a5991400>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a5991488>)"}}, "done": false, "timesteps_this_iter": 40683, "timesteps_since_restore": 1772454, "date": "2019-05-30_02-00-14", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.789392904010794, "mean_env_wait_ms": 17.081614319105515, "mean_processing_ms": 6.55417985582194}, "training_iteration": 43, "timesteps_total": 1772454, "episode_reward_mean": -497.18769967481313, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -349.83611514379345, "episode_len_mean": 325.0, "timestamp": 1559181614, "off_policy_estimator": {}, "time_since_restore": 1381.4393393993378, "custom_metrics": {"cost1_mean": 186.08588186224588, "cost1_max": 210.22914180520013, "cost2_mean": -109.4501699876256, "cost2_max": -97.85677451696546, "system_level_velocity_max": 17.581794425671703, "cost2_min": -122.07651613075275, "system_level_velocity_min": 11.5433794162168, "system_level_velocity_mean": 15.34994596032908, "outflow_rate_mean": 1248.8809947690324, "cost1_min": 140.21531534932768, "outflow_rate_min": 1004.7313281375541, "outflow_rate_max": 1388.5723276370961}, "iterations_since_restore": 43}
{"info": {"num_steps_sampled": 1814577, "sample_time_ms": 19733.971, "update_time_ms": 10.566, "load_time_ms": 5.933, "grad_time_ms": 11887.308, "learner": {"default_policy": {"vf_loss": 17.87639617919922, "cur_lr": 0.0005000000237487257, "total_loss": 17.874614715576172, "cur_kl_coeff": 0.02500000037252903, "vf_explained_var": 0.8590245842933655, "entropy": 1.0189930200576782, "kl": 0.012001876719295979, "policy_loss": -0.0020824135281145573}}, "num_steps_trained": 1812224}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 2032, "pid": 1275, "episode_reward_min": -788.896666272316, "time_total_s": 1412.133430480957, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.694091081619263, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a5991d90>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a5991bf8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a5991c80>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a5991d08>)"}}, "done": false, "timesteps_this_iter": 42123, "timesteps_since_restore": 1814577, "date": "2019-05-30_02-00-45", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.784884059452977, "mean_env_wait_ms": 17.044842061365117, "mean_processing_ms": 6.546288912989054}, "training_iteration": 44, "timesteps_total": 1814577, "episode_reward_mean": -485.84375994314524, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -232.21559614904496, "episode_len_mean": 323.9, "timestamp": 1559181645, "off_policy_estimator": {}, "time_since_restore": 1412.133430480957, "custom_metrics": {"cost1_mean": 187.04277677036364, "cost1_max": 210.22914180520013, "cost2_mean": -109.2393444017078, "cost2_max": -78.03862491819228, "system_level_velocity_max": 17.581794425671703, "cost2_min": -122.07651613075275, "system_level_velocity_min": 11.670932543709952, "system_level_velocity_mean": 15.480221511940194, "outflow_rate_mean": 1256.3359840791643, "cost1_min": 136.73058514259384, "outflow_rate_min": 1004.7313281375541, "outflow_rate_max": 1388.5723276370961}, "iterations_since_restore": 44}
{"info": {"num_steps_sampled": 1857656, "sample_time_ms": 19516.29, "update_time_ms": 10.71, "load_time_ms": 6.018, "grad_time_ms": 11862.118, "learner": {"default_policy": {"vf_loss": 22.297964096069336, "cur_lr": 0.0005000000237487257, "total_loss": 22.29605484008789, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8277063965797424, "entropy": 1.005391240119934, "kl": 0.011474517174065113, "policy_loss": -0.002197214402258396}}, "num_steps_trained": 1855232}, "node_ip": "10.138.0.2", "episodes_this_iter": 44, "episodes_total": 2076, "pid": 1275, "episode_reward_min": -755.8557474387902, "time_total_s": 1442.538339138031, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.404908657073975, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a59906a8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a5990598>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a5990620>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a5990510>)"}}, "done": false, "timesteps_this_iter": 43079, "timesteps_since_restore": 1857656, "date": "2019-05-30_02-01-16", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.7787334827600072, "mean_env_wait_ms": 16.99710926268319, "mean_processing_ms": 6.530674843407358}, "training_iteration": 45, "timesteps_total": 1857656, "episode_reward_mean": -496.26521597718425, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -107.99399376993463, "episode_len_mean": 321.82, "timestamp": 1559181676, "off_policy_estimator": {}, "time_since_restore": 1442.538339138031, "custom_metrics": {"cost1_mean": 183.6278578211521, "cost1_max": 207.94383227057182, "cost2_mean": -110.10298505330404, "cost2_max": -53.586204534198544, "system_level_velocity_max": 17.897124898364726, "cost2_min": -122.18762302445789, "system_level_velocity_min": 10.901596812488213, "system_level_velocity_mean": 15.293301602907455, "outflow_rate_mean": 1241.683391975708, "cost1_min": 77.22773791129667, "outflow_rate_min": 754.1045315061551, "outflow_rate_max": 1385.112942973069}, "iterations_since_restore": 45}
{"info": {"num_steps_sampled": 1900727, "sample_time_ms": 19341.843, "update_time_ms": 10.598, "load_time_ms": 6.061, "grad_time_ms": 11543.883, "learner": {"default_policy": {"vf_loss": 25.047142028808594, "cur_lr": 0.0005000000237487257, "total_loss": 25.045381546020508, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8171048164367676, "entropy": 1.0188928842544556, "kl": 0.009030082263052464, "policy_loss": -0.0019814702682197094}}, "num_steps_trained": 1898240}, "node_ip": "10.138.0.2", "episodes_this_iter": 54, "episodes_total": 2130, "pid": 1275, "episode_reward_min": -755.8557474387902, "time_total_s": 1470.1400184631348, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.60167932510376, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87a9f28>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87a92f0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87a9268>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87a9e18>)"}}, "done": false, "timesteps_this_iter": 43071, "timesteps_since_restore": 1900727, "date": "2019-05-30_02-01-43", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.7720073709617004, "mean_env_wait_ms": 16.943275718720155, "mean_processing_ms": 6.519119145246458}, "training_iteration": 46, "timesteps_total": 1900727, "episode_reward_mean": -513.897159833002, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -107.99399376993463, "episode_len_mean": 322.64, "timestamp": 1559181703, "off_policy_estimator": {}, "time_since_restore": 1470.1400184631348, "custom_metrics": {"cost1_mean": 181.9550378721515, "cost1_max": 206.86169135688607, "cost2_mean": -112.74708692586883, "cost2_max": -53.586204534198544, "system_level_velocity_max": 17.897124898364726, "cost2_min": -128.54342965683114, "system_level_velocity_min": 10.901596812488213, "system_level_velocity_mean": 15.09435297076627, "outflow_rate_mean": 1236.823383931655, "cost1_min": 77.22773791129667, "outflow_rate_min": 754.1045315061551, "outflow_rate_max": 1386.1325541125534}, "iterations_since_restore": 46}
{"info": {"num_steps_sampled": 1942224, "sample_time_ms": 19076.023, "update_time_ms": 10.138, "load_time_ms": 6.441, "grad_time_ms": 11345.619, "learner": {"default_policy": {"vf_loss": 21.05704116821289, "cur_lr": 0.0005000000237487257, "total_loss": 21.05499839782715, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8454676270484924, "entropy": 0.9769209623336792, "kl": 0.011876197531819344, "policy_loss": -0.0023401696234941483}}, "num_steps_trained": 1939712}, "node_ip": "10.138.0.2", "episodes_this_iter": 44, "episodes_total": 2174, "pid": 1275, "episode_reward_min": -705.2487981269311, "time_total_s": 1497.3803226947784, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.240304231643677, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bbae8>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75aaf9fea0>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75aaf9f1e0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75aaf9f0d0>)"}}, "done": false, "timesteps_this_iter": 41497, "timesteps_since_restore": 1942224, "date": "2019-05-30_02-02-11", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.7659056065223842, "mean_env_wait_ms": 16.90086462629584, "mean_processing_ms": 6.511779358184797}, "training_iteration": 47, "timesteps_total": 1942224, "episode_reward_mean": -502.2768574492082, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -25.250541442216626, "episode_len_mean": 321.74, "timestamp": 1559181731, "off_policy_estimator": {}, "time_since_restore": 1497.3803226947784, "custom_metrics": {"cost1_mean": 183.84738063332924, "cost1_max": 207.59549404913489, "cost2_mean": -112.38925610651566, "cost2_max": -16.989385963651642, "system_level_velocity_max": 17.40942140796828, "cost2_min": -128.54342965683114, "system_level_velocity_min": 12.28880467356206, "system_level_velocity_mean": 15.309951026604676, "outflow_rate_mean": 1246.6344121169816, "cost1_min": 17.334705390430223, "outflow_rate_min": 471.3669816052633, "outflow_rate_max": 1386.1325541125534}, "iterations_since_restore": 47}
{"info": {"num_steps_sampled": 1985326, "sample_time_ms": 19046.706, "update_time_ms": 9.82, "load_time_ms": 6.646, "grad_time_ms": 11318.084, "learner": {"default_policy": {"vf_loss": 22.526851654052734, "cur_lr": 0.0005000000237487257, "total_loss": 22.525009155273438, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.833407461643219, "entropy": 0.9540209174156189, "kl": 0.013016925193369389, "policy_loss": -0.0021697510965168476}}, "num_steps_trained": 1982720}, "node_ip": "10.138.0.2", "episodes_this_iter": 41, "episodes_total": 2215, "pid": 1275, "episode_reward_min": -708.1674941626321, "time_total_s": 1526.5251393318176, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.144816637039185, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb1e0>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bbf28>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bbea0>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb950>)"}}, "done": false, "timesteps_this_iter": 43102, "timesteps_since_restore": 1985326, "date": "2019-05-30_02-02-40", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.7594242604727028, "mean_env_wait_ms": 16.85256408393224, "mean_processing_ms": 6.496599382390982}, "training_iteration": 48, "timesteps_total": 1985326, "episode_reward_mean": -497.2279381516593, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -25.250541442216626, "episode_len_mean": 319.12, "timestamp": 1559181760, "off_policy_estimator": {}, "time_since_restore": 1526.5251393318176, "custom_metrics": {"cost1_mean": 182.60682110862527, "cost1_max": 207.59549404913489, "cost2_mean": -111.22832785467622, "cost2_max": -16.989385963651642, "system_level_velocity_max": 18.356722479890873, "cost2_min": -127.13554120437124, "system_level_velocity_min": 12.322541426414963, "system_level_velocity_mean": 15.360866681420196, "outflow_rate_mean": 1238.7915838380463, "cost1_min": 17.334705390430223, "outflow_rate_min": 471.3669816052633, "outflow_rate_max": 1384.1579903147708}, "iterations_since_restore": 48}
{"info": {"num_steps_sampled": 2028251, "sample_time_ms": 18871.576, "update_time_ms": 9.674, "load_time_ms": 6.651, "grad_time_ms": 11307.274, "learner": {"default_policy": {"vf_loss": 27.288928985595703, "cur_lr": 0.0005000000237487257, "total_loss": 27.28523826599121, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.8054386973381042, "entropy": 0.9588897228240967, "kl": 0.013022786937654018, "policy_loss": -0.00402056984603405}}, "num_steps_trained": 2025600}, "node_ip": "10.138.0.2", "episodes_this_iter": 53, "episodes_total": 2268, "pid": 1275, "episode_reward_min": -755.2637506016283, "time_total_s": 1556.7949757575989, "num_metric_batches_dropped": 0, "time_this_iter_s": 30.26983642578125, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75a87bb598>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a87bbbf8>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bbe18>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75a87bb378>)"}}, "done": false, "timesteps_this_iter": 42925, "timesteps_since_restore": 2028251, "date": "2019-05-30_02-03-10", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.7528192121567014, "mean_env_wait_ms": 16.79452152381594, "mean_processing_ms": 6.479615918178784}, "training_iteration": 49, "timesteps_total": 2028251, "episode_reward_mean": -511.26040564241026, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -33.03620733726209, "episode_len_mean": 322.1, "timestamp": 1559181790, "off_policy_estimator": {}, "time_since_restore": 1556.7949757575989, "custom_metrics": {"cost1_mean": 182.25875202517693, "cost1_max": 209.92131532277054, "cost2_mean": -112.34400532469805, "cost2_max": -23.560262741715302, "system_level_velocity_max": 18.356722479890873, "cost2_min": -127.13554120437124, "system_level_velocity_min": 11.837345113952303, "system_level_velocity_mean": 15.153319337003772, "outflow_rate_mean": 1233.7335184636668, "cost1_min": 22.913858126788107, "outflow_rate_min": 474.0705738551221, "outflow_rate_max": 1388.9505027190085}, "iterations_since_restore": 49}
{"info": {"num_steps_sampled": 2069499, "sample_time_ms": 18523.774, "update_time_ms": 9.28, "load_time_ms": 6.803, "grad_time_ms": 11167.489, "learner": {"default_policy": {"vf_loss": 22.763683319091797, "cur_lr": 0.0005000000237487257, "total_loss": 22.76161766052246, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.83490389585495, "entropy": 0.929397702217102, "kl": 0.011939283460378647, "policy_loss": -0.002364359563216567}}, "num_steps_trained": 2066816}, "node_ip": "10.138.0.2", "episodes_this_iter": 47, "episodes_total": 2315, "pid": 1275, "episode_reward_min": -775.484369159665, "time_total_s": 1584.4307079315186, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.635732173919678, "config": {"vf_loss_coeff": 1.0, "tf_session_args": {"gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "lambda": 0.97, "shuffle_buffer_size": 0, "output_compress_columns": ["obs", "new_obs"], "num_gpus_per_worker": 0, "postprocess_inputs": false, "lr": 0.0005, "log_level": "INFO", "synchronize_filters": true, "model": {"custom_model": null, "custom_preprocessor": null, "custom_options": {}, "dim": 84, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "use_lstm": false, "grayscale": false, "framestack": true, "lstm_cell_size": 256, "squash_to_range": false, "zero_mean": true, "conv_filters": null}, "clip_rewards": null, "soft_horizon": false, "horizon": 750, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "remote_env_batch_wait_ms": 0, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "remote_worker_envs": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "monitor": false, "num_workers": 20, "metrics_smoothing_episodes": 100, "train_batch_size": 15000, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "output": null, "kl_coeff": 0.2, "sample_async": false, "optimizer": {}, "compress_observations": false, "grad_clip": null, "lr_schedule": null, "simple_optimizer": false, "straggler_mitigation": false, "preprocessor_pref": "deepmind", "num_gpus": 0, "ignore_worker_failures": false, "num_sgd_iter": 10, "input_evaluation": ["is", "wis"], "clip_actions": false, "kl_target": 0.01, "batch_mode": "truncate_episodes", "num_envs_per_worker": 1, "gamma": 0.99, "collect_metrics_timeout": 180, "input": "sampler", "sample_batch_size": 750, "num_cpus_per_worker": 1, "use_gae": true, "multiagent": {"policies_to_train": ["default_policy"], "policy_mapping_fn": "tune.function(<function <lambda> at 0x7f75ab032730>)", "policy_graphs": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(12,)", "Box(1,)", {}]}}, "custom_resources_per_worker": {}, "clip_param": 0.3, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "env": "eta2:0.1_eta3:0.0_tmin:10.0_buflen:1", "callbacks": {"on_episode_end": "tune.function(<function on_episode_end at 0x7f75a59cdf28>)", "on_postprocess_traj": null, "on_train_result": null, "on_sample_end": null, "on_episode_step": "tune.function(<function on_episode_step at 0x7f75a87bb488>)", "on_episode_start": "tune.function(<function on_episode_start at 0x7f75ab032620>)"}}, "done": true, "timesteps_this_iter": 41248, "timesteps_since_restore": 2069499, "date": "2019-05-30_02-03-38", "hostname": "flow-main", "policy_reward_mean": {}, "sampler_perf": {"mean_inference_ms": 1.7477710114393599, "mean_env_wait_ms": 16.75148430075548, "mean_processing_ms": 6.478277831786161}, "training_iteration": 50, "timesteps_total": 2069499, "episode_reward_mean": -502.9032033940346, "experiment_id": "b6937427da504b06b299599f24bb85a3", "num_healthy_workers": 20, "episode_reward_max": -351.3684584872349, "episode_len_mean": 325.0, "timestamp": 1559181818, "off_policy_estimator": {}, "time_since_restore": 1584.4307079315186, "custom_metrics": {"cost1_mean": 185.39254069999473, "cost1_max": 209.92131532277054, "cost2_mean": -110.97569165009146, "cost2_max": -98.07348195297625, "system_level_velocity_max": 17.47078732396183, "cost2_min": -124.32491496600952, "system_level_velocity_min": 10.320109466820652, "system_level_velocity_mean": 15.27687378391458, "outflow_rate_mean": 1246.1247894611201, "cost1_min": 126.94041832717629, "outflow_rate_min": 968.6825911064698, "outflow_rate_max": 1388.9505027190085}, "iterations_since_restore": 50}
